<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Two-Sample Linear Rank Test to Detect a Difference Between Two Distributions Based on Censored Data — twoSampleLinearRankTestCensored • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Two-Sample Linear Rank Test to Detect a Difference Between Two Distributions Based on Censored Data — twoSampleLinearRankTestCensored"><meta property="og:description" content="Two-sample linear rank test to detect a difference (usually a shift) between two 
  distributions based on censored data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Two-Sample Linear Rank Test to Detect a Difference Between Two Distributions Based on Censored Data</h1>
    
    <div class="hidden name"><code>twoSampleLinearRankTestCensored.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Two-sample linear rank test to detect a difference (usually a shift) between two 
  distributions based on censored data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">x.censored</span>, <span class="va">y</span>, <span class="va">y.censored</span>, 
    censoring.side <span class="op">=</span> <span class="st">"left"</span>, location.shift.null <span class="op">=</span> <span class="fl">0</span>, scale.shift.null <span class="op">=</span> <span class="fl">1</span>, 
    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, test <span class="op">=</span> <span class="st">"logrank"</span>, variance <span class="op">=</span> <span class="st">"hypergeometric"</span>, 
    surv.est <span class="op">=</span> <span class="st">"prentice"</span>, shift.type <span class="op">=</span> <span class="st">"location"</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>numeric vector of values for the first sample.  
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, 
  <code>-Inf</code>) values are allowed but will be removed.</p></dd>
<dt>x.censored</dt>
<dd><p>numeric or logical vector indicating which values of <code>x</code> are censored.  
  This must be the same length as <code>x</code>.  If the mode of <code>x.censored</code> is 
  <code>"logical"</code>, <code>TRUE</code> values correspond to elements of <code>x</code> that are 
  censored, and <code>FALSE</code> values correspond to elements of <code>x</code> that are not 
  censored.  If the mode of <code>x.censored</code> is <code>"numeric"</code>, it must contain only 
  <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to <code>TRUE</code> and <code>0</code> 
  corresponds to <code>FALSE</code>.  Missing (<code>NA</code>) values are allowed but will be 
  removed.</p></dd>
<dt>y</dt>
<dd><p>numeric vector of values for the second sample.  
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, 
  <code>-Inf</code>) values are allowed but will be removed.</p></dd>
<dt>y.censored</dt>
<dd><p>numeric or logical vector indicating which values of <code>y</code> are censored.  
  This must be the same length as <code>y</code>.  If the mode of <code>y.censored</code> is 
  <code>"logical"</code>, <code>TRUE</code> values correspond to elements of <code>y</code> that are 
  censored, and <code>FALSE</code> values correspond to elements of <code>y</code> that are not 
  censored.  If the mode of <code>y.censored</code> is <code>"numeric"</code>, it must contain only 
  <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to <code>TRUE</code> and <code>0</code> 
  corresponds to <code>FALSE</code>.  Missing (<code>NA</code>) values are allowed but will be 
  removed.</p></dd>
<dt>censoring.side</dt>
<dd><p>character string indicating on which side the censoring occurs for the data in 
  <code>x</code> and <code>y</code>.  The possible values are <code>"left"</code> (the default) and 
  <code>"right"</code>.</p></dd>
<dt>location.shift.null</dt>
<dd><p>numeric scalar indicating the hypothesized value of \(\Delta\), the location 
  shift between the two distributions, under the null hypothesis.  The default value is 
  <code>location.shift.null=0</code>.  This argument is ignored if <code>shift.type="scale"</code>.</p></dd>
<dt>scale.shift.null</dt>
<dd><p>numeric scalar indicating the hypothesized value of \(\tau\), the scale shift 
  between the two distributions, under the null hypothesis.  The default value is <br><code>scale.shift.null=1</code>.  This argument is ignored if <code>shift.type="location"</code>.</p></dd>
<dt>alternative</dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values 
  are <code>"two.sided"</code> (the default), <code>"less"</code>, and <code>"greater"</code>.  See the 
  DETAILS section below for more information.</p></dd>
<dt>test</dt>
<dd><p>character string indicating which linear rank test to use.  The possible values are:  
  <code>"logrank"</code> (the default), <code>"tarone-ware"</code>, <code>"gehan"</code>, 
  <code>"peto-peto"</code>, <code>"normal.scores.1"</code>, <code>"normal.scores.2"</code>, 
  and <code>"generalized.sign"</code>.  See the DETAILS section below for more information.</p></dd>
<dt>variance</dt>
<dd><p>character string indicating which kind of variance to compute for the test.  The 
  possible values are: <code>"hypergeometric"</code> (the default), <code>"permutation"</code>, 
  and <code>"asymptotic"</code>.  See the DETAILS section below for more information.</p></dd>
<dt>surv.est</dt>
<dd><p>character string indicating what method to use to estimate the survival function.  
  The possible values are <code>"prentice"</code> (the default), <code>"kaplan-meier"</code>, <br><code>"peto-peto"</code>, and <code>"altshuler"</code>.  When <code>test="logrank"</code> the  
  argument <br><code>surv.est</code> is automatically set to <code>"altshuler"</code> and cannot 
  be changed by the user.  
  See the DETAILS section below for more information.</p></dd>
<dt>shift.type</dt>
<dd><p>character string indicating which kind of shift is being tested.  The possible values 
  are <code>"location"</code> (the default) and <code>"scale"</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>twoSampleLinearRankTestCensored</code> allows you to compare two 
  samples containing censored observations using a linear rank test to determine 
  whether the two samples came from the same distribution.  The help file for 
  <code><a href="twoSampleLinearRankTest.html">twoSampleLinearRankTest</a></code> explains linear rank tests for complete data 
  (i.e., no censored observations are present), and here we assume you are 
  familiar with that material  The sections below explain how linear 
  rank tests can be extended to the case of censored data.
  <br></p>
<p><b><em>Notation</em></b> <br>
  Several authors have proposed extensions of the MWW test to the case of censored 
  data, mainly in the context of survival analysis (e.g., Breslow, 1970; Cox, 1972; 
  Gehan, 1965; Mantel, 1966; Peto and Peto, 1972; Prentice, 1978).  Prentice (1978) 
  showed how all of these proposed tests are extensions of a linear rank test to the 
  case of censored observations.</p>
<p>Survival analysis usually deals with right-censored data, whereas environmental data 
  is rarely right-censored but often left-censored (some observations are reported as 
  less than some detection limit).  Fortunately, all of the methods developed for 
  right-censored data can be applied to left-censored data as well.  (See the 
  sub-section <em>Left-Censored Data below</em>.)</p>
<p>In order to explain Prentice's (1978) generalization of linear rank tests to censored 
  data, we will use the following notation that closely follows Prentice (1978), 
  Prentice and Marek (1979), and Latta (1981).  
  Let \(X\) denote a random variable representing measurements from group 1 with 
  cumulative distribution function (cdf):
  $$F_1(t) = Pr(X \le t) \;\;\;\;\;\; (1)$$
  and let \(x_1, x_2, \ldots, x_m\) denote \(m\) independent observations from this 
  distribution.  Let \(Y\) denote a random variable from group 2 with cdf:
  $$F_2(t) = Pr(Y \le t) \;\;\;\;\;\; (2)$$
  and let \(y_1, y_2, \ldots, y_n\) denote \(n\) independent observations from this 
  distribution.  Set \(N = m + n\), the total number of observations.  
  Assume the data are right-censored so that some observations are only recorded as 
  greater than some censoring level, with possibly several different censoring levels.  
  Let \(t_1, t_2, \ldots, t_k\) denote the \(k\) ordered, unique, uncensored 
  observations for the combined samples (in the context of survival data, \(t\) usually stands 
  for “time of death”).  For \(i = 1, 2, \ldots, k\), let \(d_{1i}\) 
  denote the number of observations from sample 1 (the \(X\) observations) that are 
  equal to \(t_i\), and let \(d_{2i}\) denote the observations from sample 2 (the 
  \(Y\) observations) equal to this value.  Set
  $$d_i = d_{1i} + d_{2i} \;\;\;\;\;\; (3)$$
  the total number of observations equal to \(t_i\).  If there are no tied 
  uncensored observations, then \(t_i = 1\) for \(i = 1, 2, \ldots, k\), 
  otherwise it is greater than 1 for at least on value of \(i\).</p>
<p>For \(i = 1, 2, \ldots, k\), let \(e_{1i}\) denote the number of censored 
  observations from sample 1 (the \(X\) observations) with censoring levels that 
  fall into the interval \([t_i, t_{i+1})\) where \(t_{k+1} = \infty\) by 
  definition, and let \(e_{2i}\) denote the number of censored observations from 
  sample 2 (the \(Y\) observations) with censoring levels that fall into this 
  interval.  Set
  $$e_i = e_{1i} + e_{2i} \;\;\;\;\;\; (4)$$
  the total number of censoring levels that fall into this interval.</p>
<p>Finally, set \(n_{1i}\) equal to the number of observations from sample 1 
  (uncensored and censored) known to be greater than or equal to \(t_i\), i.e., 
  that lie in the interval \([t_i, \infty)\), 
  set \(n_{2i}\) equal to the number of observations from sample 2 
  (uncensored and censored) that lie in this interval, and set
  $$n_i = n_{1i} + n_{2i} \;\;\;\;\;\; (5)$$
  In survival analysis jargon, \(n_{1i}\) denotes the number of people from 
  sample 1 who are “at risk” at time \(t_i\), that is, these people are 
  known to still be alive at this time.  Similarly, \(n_{2i}\) denotes the number 
  of people from sample 2 who are at risk at time \(t_i\), and \(n_i\) denotes 
  the total number of people at risk at time \(t_i\).
  <br></p> 
<p><b><em>Score Statistics for Multiply Censored Data</em></b> <br>
  Prentice's (1978) generalization of the two-sample score (linear rank) statistic is 
  given by:
  $$\nu = \sum_{i=1}^k (d_{1i} c_i + e_{1i} C_i) \;\;\;\;\;\; (6)$$
  where \(c_i\) and \(C_i\) denote the scores associated with the uncensored and 
  censored observations, respectively.  As for complete data, the form of the scores 
  depends upon the assumed underlying distribution.  Table 1 below shows scores for 
  various assumed distributions as presented in Prentice (1978) and Latta (1981) 
  (also see Table 5 of Millard and Deverel, 1988, p.2091).  
  The last column shows what these tests reduce to in the case of complete data 
  (no censored observations).</p>
<p><em>Table 1.  Scores Associated with Various Censored Data Rank Tests</em><br></p><table class="table table"><tr><td></td><td><b>Uncensored</b></td><td><b>Censored</b></td><td></td><td><b>Uncensored</b></td></tr><tr><td><b>Distribution</b></td><td><b>Score</b> (\(c_i\))</td><td><b>Score</b> (\(C_i\))</td><td><b>Test Name</b></td><td><b>Analogue</b></td></tr><tr><td>Logistic</td><td>\(2\hat{F}_i - 1\)</td><td>\(\hat{F}_i\)</td><td>Peto-Peto</td><td>Wilcoxon Rank Sum</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>"</td><td>\(i - n_i\)</td><td>\(i\)</td><td>Gehan or Breslow</td><td>"</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>"</td><td>\(i - \sqrt{n_i}\)</td><td>\(i\)</td><td>Tarone-Ware</td><td>"</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Normal,</td><td>\(\Phi^{-1}(\hat{F}_i)\)</td><td>\(\phi(c_i)/\hat{S}_i\)</td><td>Normal Scores 1</td><td>Normal Scores</td></tr><tr><td>Lognormal</td><td></td><td></td><td></td><td></td></tr><tr><td>"</td><td>"</td><td>\(\frac{n_i C_{i-1} - c_i}{n_i-1}\)</td><td>Normal Scores 2</td><td>"</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Double</td><td>\(sign(\hat{F}_i - 0.5)\)</td><td>\(\frac{\hat{F}_i}{1-\hat{F}_i}, if \hat{F_i} &lt; 0.5\)</td><td>Generalized</td><td>Mood's Median</td></tr><tr><td>Exponential</td><td></td><td>\(1, if \hat{F}_i \ge 0.5\)</td><td>Sign</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Exponential,</td><td>\(-log(\tilde{S}_i) - 1\)</td><td>\(-log(\tilde{S}_i)\)</td><td>Logrank</td><td>Savage Scores</td></tr><tr><td>Extreme Value</td><td></td><td></td><td></td><td></td></tr></table><p>In Table 1 above, \(\Phi\) denotes the cumulative distribution function of the 
  standard normal distribution, \(\phi\) denotes the probability density function 
  of the standard normal distribution, and \(sign\) denotes the <code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></code> 
  function.  Also, the quantities \(\hat{F}_i\) and \(\hat{S}_i\) 
  denote the estimates of the cumulative distribution function (cdf) and survival 
  function, respectively, at time \(t_i\) for the combined sample.  The estimated 
  cdf is related to the estimated survival function by:
  $$\hat{F}_i = 1 - \hat{S}_i \;\;\;\;\;\; (7)$$
  The quantity \(\tilde{S}_i\) denotes the Altshuler (1970) estimate of the 
  survival function at time \(t_i\) for the combined sample (see below).</p>
<p>The argument <code>surv.est</code> determines what method to use estimate the survival 
  function.  When <code>surv.est="prentice"</code> (the default), the survival function is 
  estimated as:
  $$\hat{S}_{i,P} = \prod_{j=1}^{i} \frac{n_j - d_j + 1}{n_j + 1} \;\;\;\;\;\; (8)$$
  (Prentice, 1978).  When <code>surv.est="kaplan-meier"</code>, the survival function is 
  estimated as:
  $$\hat{S}_{i,KM} = \prod_{j=1}^{i} \frac{n_j - d_j}{n_j} \;\;\;\;\;\; (9)$$
  (Kaplan and Meier, 1958), and when <code>surv.est="peto-peto"</code>, the survival 
  function is estimated as:
  $$\hat{S}_{i,PP} = \frac{1}{2} (\hat{S}_{i,KM} + \hat{S}_{i-1, KM}) \;\;\;\;\;\; (10)$$
  where \(\hat{S}_{0,KM} = 0\) (Peto and Peto, 1972).  All three of these estimators 
  of the survival function should produce very similar results.  When 
  <code>surv.est="altshuler"</code>, the survival function is estimated as:
  $$\tilde{S}_i = exp(-\sum_{j=1}^i \frac{d_j}{n_j}) \;\;\;\;\;\; (11)$$
  (Altshuler, 1970).  The scores for the logrank test use this estimator of survival.</p>
<p>Lee and Wang (2003, p. 116) present a slightly different version of the Peto-Peto 
  test. They use the Peto-Peto estimate of the survival function for \(c_i\), but 
  use the Kaplan-Meier estimate of the survival function for \(C_i\).</p>
<p>The scores for the “Normal Scores 1” test shown in Table 1 above are based on 
  the approximation (30) of Prentice (1978).  The scores for the 
  “Normal Scores 2” test are based on equation (7) of Prentice and Marek (1979).  
  For the “Normal Scores 2” test, the following rules are used to construct the 
  scores for the censored observations:  \(C_0 = 0\), and 
  \(C_k = 0\) if \(n_k = 1\).</p>
<p><b><em>The Distribution of the Score Statistic</em></b> <br>
  Under the null hypothesis that the two distributions are the same, the expected 
  value of the score statistic \(\nu\) in Equation (6) is 0.  The variance of 
  \(\nu\) can be computed in at least three different ways.  If the censoring 
  mechanism is the same for both groups, the <b><em>permutation variance</em></b> is 
  appropriate (<code>variance="permutation"</code>) and its estimate is given by:
  $$\hat{\sigma}_{\nu}^2 = \frac{mn}{N(N-1)} \sum_{i=1}^k (d_i c_i^2 + e_i C_i^2) \;\;\;\;\;\; (12)$$
  Often, however, it is not clear whether this assumption is valid, and 
  both Prentice (1978) and Prentice and Marek (1979) caution against 
  using the permuation variance (Prentice and Marek, 1979, state it can lead to 
  inflated estimates of variance).</p>
<p>If the censoring mechanisms for the two groups are not necessarily the same, a more 
  general estimator of the variance is based on a conditional permutation approach.  In 
  this case, the statistic \(\nu\) in Equation (6) is re-written as:
  $$\nu = \sum_{i=1}^k w_i [d_{1i} - d_i \frac{n_{1i}}{n_i}] \;\;\;\;\;\; (13)$$
  where 
  $$w_i = c_i - C_i \;\;\;\;\;\; (14)$$
  \(c_i\) and \(C_i\) are given above in Table 1, 
  and the conditional permutation or <b><em>hypergeometric estimate</em></b> 
  (<code>variance="hypergeometric"</code>) is given by:
  $$\hat{\sigma}_{\nu}^2 = \sum_{i=1}^k d_i w_i^2 (\frac{n_{1i}}{n_i}) (1 - \frac{n_{1i}}{n_i}) (\frac{n_i - d_i}{n_i - 1}) \;\;\;\;\;\; (15)$$
  (Prentice and Marek, 1979; Latta, 1981; Millard and Deverel, 1988).  Note that 
  Equation (13) can be thought of as the sum of weighed values of observed minus 
  expected observations.</p>
<p>Prentice (1978) derived an asymptotic estimator of the variance of the score 
  statistic \(\nu\) given in Equation (6) above based on the log likelihood of the 
  rank vector (<code>variance="asymptotic"</code>).  This estimator is the same as the 
  hypergeometric variance estimator for the logrank and Gehan tests (assuming no 
  tied uncensored observations), but for the Peto-Peto test, this estimator is 
  given by:
  $$\hat{\sigma}_{\nu}^2 = \sum_{i=1}^k \{ \hat{S}_i (1 - a_i) b_i - (a_i - \hat{S}_i) b_i [\hat{S}_i b_i + 2 \sum_{j=i+1}^k \hat{S}_j b_j ]\} \;\;\;\;\;\; (16)$$
  where 
  $$a_i = \prod_{j=1}^i \frac{n_j + 1}{n_j + 2} \;\;\;\;\;\; (17)$$
  $$b_i = 2 d_{1i} + e_{1i} \;\;\;\;\;\; (18)$$
  (Prentice, 1978; Latta, 1981; Millard and Deverel, 1988).  Note that equation (14) 
  of Millard and Deverel (1988) contains a typographical error.
  <br></p> 
<p><b><em>The Treatment of Ties</em></b> <br>
  If the hypergeometric estimator of variance is being used, no modifications need to 
  be made for ties; Equations (13)-(15) already account for ties.  For the case of the 
  permutation or asymptotic variance estimators, Equations (6), (12), and (16) all 
  assume no ties in the uncensored observations.  If ties exist in the uncensored 
  observations, Prentice (1978) suggests computing the scores shown in Table 1 
  above as if there were no ties, and then assigning average scores to the 
  tied observations.  (This modification also applies to the quantities 
  \(a_i\) and \(\hat{S}_i\) in Equation (16) above.)  For this algorithm, the 
  statistic in Equation (6) is not in general the same as the one in Equation (13).
  <br></p> 
<p><b><em>Computing a Test Statistic</em></b> <br>
  Under the null hypothesis that the two distributions are the same, the statistic
  $$z = \frac{\nu}{\hat{\sigma}_{\nu}} \;\;\;\;\;\; (19)$$
  is approximately distributed as a standard normal random variable for “large” 
  sample sizes.  <b>This statistic will tend to be large if the observations in 
  group 1 (the \(X\) observations) tend to be larger than the observations in 
  group 2 (the \(Y\) observations)</b>.
  <br></p> 
<p><b><em>Left-Censored Data</em></b> <br>
  Most of the time, if censored observations occur in environmental data, they are 
  left-censored (e.g., observations are reported as less than one or more detection 
  limits).  For the two-sample test of differences between groups, the methods that 
  apply to right-censored data are easily adapted to left-censored data:  simply 
  multiply the observations by -1, compute the z-statistic shown in Equation 
  (20), then reverse the sign of this statistic before computing the p-value.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"htestCensored"</code> containing the results of the hypothesis test.  
  See the help file for <code><a href="htestCensored.object.html">htestCensored.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Altshuler, B. (1970).  Theory for the Measurement of Competing Risks in Animal 
  Experiments.  <em>Mathematical Biosciences</em> <b>6</b>, 1--11.</p>
<p>Breslow, N.E. (1970).  A Generalized Kruskal-Wallis Test for Comparing K Samples 
  Subject to Unequal Patterns of Censorship.  <em>Biometrika</em> <b>57</b>, 579--594.</p>
<p>Conover, W.J. (1980).  <em>Practical Nonparametric Statistics</em>.  Second Edition.  
  John Wiley and Sons, New York, Chapter 4.</p>
<p>Cox, D.R. (1972).  Regression Models and Life Tables (with Discussion).  
  <em>Journal of the Royal Statistical Society of London, Series B</em> <b>34</b>, 
  187--220.</p>
<p>Divine, G., H.J. Norton, R. Hunt, and J. Dinemann. (2013).  A Review of Analysis 
  and Sample Size Calculation Considerations for Wilcoxon Tests.  <em>Anesthesia 
  \&amp; Analgesia</em> <b>117</b>, 699--710.</p>
<p>Fleming, T.R., and D.P. Harrington. (1981).  A Class of Hypothesis Tests for One and 
  Two Sample Censored Survival Data.  
  <em>Communications in Statistics -- Theory and Methods</em> <b>A10</b>(8), 763--794.</p>
<p>Fleming, T.R., and D.P. Harrington. (1991).  
  <em>Counting Processes \&amp; Survival Analysis</em>.  John Wiley and Sons, New York, 
  Chapter 7.</p>
<p>Gehan, E.A. (1965).  A Generalized Wilcoxon Test for Comparing Arbitrarily 
  Singly-Censored Samples.  <em>Biometrika</em> <b>52</b>, 203--223.</p>
<p>Harrington, D.P., and T.R. Fleming. (1982).  A Class of Rank Test Procedures for 
  Censored Survival Data.  <em>Biometrika</em> <b>69</b>(3), 553--566.</p>
<p>Heller, G., and E. S. Venkatraman. (1996).  Resampling Procedures to Compare Two 
  Survival Distributions in the Presence of Right-Censored Data.  
  <em>Biometrics</em> <b>52</b>, 1204--1213.</p>
<p>Hettmansperger, T.P. (1984).  <em>Statistical Inference Based on Ranks</em>.  
  John Wiley and Sons, New York, 323pp.</p>
<p>Hollander, M., and D.A. Wolfe. (1999). <em>Nonparametric Statistical Methods, 
  Second Edition</em>.  John Wiley and Sons, New York.</p>
<p>Kaplan, E.L., and P. Meier. (1958).  Nonparametric Estimation From Incomplete 
  Observations.  <em>Journal of the American Statistical Association</em> <b>53</b>, 
  457--481.</p>
<p>Latta, R.B. (1981).  A Monte Carlo Study of Some Two-Sample Rank Tests with Censored 
  Data.  <em>Journal of the American Statistical Association</em> <b>76</b>(375), 
  713--719.</p>
<p>Mantel, N. (1966).  Evaluation of Survival Data and Two New Rank Order Statistics 
  Arising in its Consideration.  <em>Cancer Chemotherapy Reports</em> <b>50</b>, 163-170.</p>
<p>Millard, S.P., and S.J. Deverel. (1988).  Nonparametric Statistical Methods for 
  Comparing Two Sites Based on Data With Multiple Nondetect Limits.  
  <em>Water Resources Research</em>, <b>24</b>(12), 2087--2098.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001).  <em>Environmental Statistics with 
  S-PLUS</em>.  CRC Press, Boca Raton, FL, pp.432--435.</p>
<p>Peto, R., and J. Peto. (1972).  Asymptotically Efficient Rank Invariant Test 
  Procedures (with Discussion).  
  <em>Journal of the Royal Statistical Society of London, Series A</em> <b>135</b>, 
  185--206.</p>
<p>Prentice, R.L. (1978).  Linear Rank Tests with Right Censored Data.  
  <em>Biometrika</em> <b>65</b>, 167--179.</p>
<p>Prentice, R.L. (1985).  Linear Rank Tests.  In Kotz, S., and N.L. Johnson, eds. 
  <em>Encyclopedia of Statistical Science</em>.  John Wiley and Sons, New York. 
  Volume 5, pp.51--58.</p>
<p>Prentice, R.L., and P. Marek. (1979).  A Qualitative Discrepancy Between Censored 
  Data Rank Tests.  <em>Biometrics</em> <b>35</b>, 861--867.</p>
<p>Tarone, R.E., and J. Ware. (1977).  On Distribution-Free Tests for Equality of 
  Survival Distributions.  <em>Biometrika</em> <b>64</b>(1), 156--160.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>All of the tests computed by <code>twoSampleLinearRankTestCensored</code> 
  (logrank, Tarone-Ware, Gehan, Peto-Peto, normal scores, and generalized sign) 
  are based on a 
  statistic that is essentially the sum over all uncensored time points of the 
  weighted difference between the observed and expected number of observations at each 
  time point (see Equation (15) above).  The tests differ in how they weight the 
  differences between the observed and expected number of observations.</p>
<p>Prentice and Marek (1979) point out that the Gehan test uses weights that depend on 
  the censoring rates within each group and can lead to non-significant outcomes in 
  the case of heavy censoring when in fact a very large difference between the two 
  groups exists.</p>
<p>Latta (1981) performed a Monte Carlo simulation to study the power of the Gehan, 
  logrank, and Peto-Peto tests using all three different estimators of variance 
  (permutation, hypergeometric, and asymptotic).  He used lognormal, Weibull, and 
  exponential distributions to generate the observations, and studied two different 
  cases of censoring: uniform censoring for both samples vs. no censoring in the first 
  sample and uniform censoring in the second sample.  Latta (1981) used sample sizes 
  of 10 and 50 (both the equal and unequal cases were studied).  Latta (1981) found 
  that all three tests maintained the nominal Type I error level (\(\alpha\)-level) 
  in the case of equal sample sizes and equal censoring.  Also, the Peto-Peto test 
  based on the asymptotic variance appeared to maintain the nominal \(\alpha\)-level 
  in all situations, but the other tests were slightly biased in the case of unequal 
  sample sizes and/or unequal censoring.  In particular, tests based on the 
  hypergeometric variance are slightly biased for unequal sample sizes.  Latta (1981) 
  concludes that if there is no censoring or light censoring, any of the tests may be 
  used (but the hypergeometric variance should not be used if the sample sizes are 
  very different).  In the case of heavy censoring where sample sizes are far apart 
  and/or the censoring is very different between samples, the Peto-Peto test based on 
  the asymptotic variance should be used.</p>
<p>Millard and Deverel (1988) also performed a Monte Carlo simulation similar to 
  Latta's (1981) study.  They only used the lognormal distribution to generate 
  observations, but also looked at the normal scores test and two ad-hoc modifications 
  of the MWW test.  They found the “Normal Scores 2” test shown in Table 1 
  above to be the best behaved test in terms of maintaining the nominal 
  \(\alpha\)-level, but the other tests behaved almost as well.  As Latta (1981) 
  found, when sample sizes and censoring are very different between the two groups, 
  the nominal \(\alpha\)-level of most of the tests is slightly biased.  In the 
  cases where the nominal \(\alpha\)-level was maintained, the Peto-Peto test based 
  on the asymptotic variance appeared to be as powerful or more powerful than the 
  normal scores tests.</p>
<p>Neither of the Monte Carlo studies performed by Latta (1981) and Millard and Deverel 
  (1988) looked at the behavior of the two-sample linear rank tests in the presence of 
  several tied uncensored observations (because both studies generated observations 
  from continuous distributions).  Note that the results shown in Table 9 of 
  Millard and Deverel (1988, p.2097) are not all correct because they did not 
  allow for tied uncensored values.  The last example in the EXAMPLES section below 
  shows the correct values that should appear in that table.</p>
<p>Heller and Venkatraman (1996) performed a Monte Carlo simulation study to compare 
  the behaviors of the Peto-Peto test (using the Prentice, 1978, estimator of survival; 
  they call this the Prentice-Wilcoxon test) 
  and logrank test under varying censoring conditions with sample sizes of 20 and 50 
  per group based on using the following methods to compute p-values:  
  the asymptotic standard normal approximation, 
  a permutation test approach (this is <b>NOT</b> the same as the permutation variance), 
  and a bootstrap approach.  Observed times were generated from Weibull and lognormal 
  survival time distributions with independent uniform censoring.  They found that 
  for the Peto-Peto test, "the asymptotic test procedure was the most accurate; 
  resampling procedures did not improve upon its accuracy."  For the logrank test, 
  with sample sizes of 20 per group, the usual test based on the asymptotic standard 
  normal approximation tended to have a very slightly higher Type I error rate than 
  assumed (however, for an assumed Type I error rate of 0.05, the largest Type I error 
  rate observed was less than 0.065), whereas the permuation and bootstrap tests 
  performed better; with sample sizes of 50 per group there was no difference in 
  test performance.</p>
<p>Fleming and Harrington (1981) introduced a family of tests (sometimes called G-rho 
  tests) that contain the logrank and Peto-Peto tests as special cases.  A single 
  parameter \(\rho\) (rho) controls the weights given to the uncensored and 
  censored observations.  Positive values of \(\rho\) produce tests more sensitive 
  to early differences in the survival function, that is, differences in the cdf at 
  small values.  Negative values of \(\rho\) produce tests more sensitive to late 
  differences in the survival function, that is, differences in the cdf at large 
  values.</p>
<p>The function <code><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></code> in the <span style="R">R</span> package 
  <span class="pkg">survival</span> implements the G-rho family of tests suggested by Flemming and 
  Harrington (1981).  Calling <code>survdiff</code> with <code>rho=0</code> (the default) yields 
  the logrank test.  Calling <code>survdiff</code> with <code>rho=1</code> yields the Peto-Peto 
  test based on the Kaplan-Meier estimate of survival.  The function <code>survdiff</code> 
  always uses the hypergeometric estimate of variance and the Kaplan-Meier estimate of 
  survival, but it uses the “left-continuous” version of the Kaplan-Meier 
  estimate.  The left-continuous K-M estimate of survival is defined as 
  follows:  at each death (unique uncensored observation), the estimated survival is 
  equal to the estimated survival based on the ordinary K-M estimate at the prior 
  death time (or 1 for the first death).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="twoSampleLinearRankTest.html">twoSampleLinearRankTest</a></code>, <code><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></code>, 
  <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code>, <code><a href="htestCensored.object.html">htestCensored.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># The last part of the EXAMPLES section in the help file for </span></span>
<span class="r-in">  <span class="co"># cdfCompareCensored compares the empirical distribution of copper and zinc </span></span>
<span class="r-in">  <span class="co"># between two sites:  Alluvial Fan and Basin-Trough (Millard and Deverel, 1988).  </span></span>
<span class="r-in">  <span class="co"># The data for this example are stored in Millard.Deverel.88.df.  Perform a </span></span>
<span class="r-in">  <span class="co"># test to determine if there is a significant difference between these two </span></span>
<span class="r-in">  <span class="co"># sites (perform a separate test for the copper and the zinc).</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Millard.Deverel.88.df</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Cu.orig Cu Cu.censored Zn.orig  Zn Zn.censored         Zone Location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       &lt; 1  1        TRUE     &lt;10  10        TRUE Alluvial.Fan        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       &lt; 1  1        TRUE       9   9       FALSE Alluvial.Fan        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3  3       FALSE      NA  NA       FALSE Alluvial.Fan        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         3  3       FALSE       5   5       FALSE Alluvial.Fan        4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5  5       FALSE      18  18       FALSE Alluvial.Fan        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         1  1       FALSE     &lt;10  10        TRUE Alluvial.Fan        6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7         4  4       FALSE      12  12       FALSE Alluvial.Fan        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8         4  4       FALSE      10  10       FALSE Alluvial.Fan        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9         2  2       FALSE      11  11       FALSE Alluvial.Fan        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10        2  2       FALSE      11  11       FALSE Alluvial.Fan       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11        1  1       FALSE      19  19       FALSE Alluvial.Fan       11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12        2  2       FALSE       8   8       FALSE Alluvial.Fan       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      &lt; 5  5        TRUE     &lt; 3   3        TRUE Alluvial.Fan       13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14       11 11       FALSE     &lt;10  10        TRUE Alluvial.Fan       14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      &lt; 1  1        TRUE     &lt;10  10        TRUE Alluvial.Fan       15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16        2  2       FALSE      10  10       FALSE Alluvial.Fan       16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17        2  2       FALSE      10  10       FALSE Alluvial.Fan       17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18        2  2       FALSE      10  10       FALSE Alluvial.Fan       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19        2  2       FALSE      10  10       FALSE Alluvial.Fan       19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      &lt;20 20        TRUE     &lt;10  10        TRUE Alluvial.Fan       20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21        2  2       FALSE      10  10       FALSE Alluvial.Fan       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22        2  2       FALSE     &lt;10  10        TRUE Alluvial.Fan       22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23        3  3       FALSE      10  10       FALSE Alluvial.Fan       23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24        3  3       FALSE     &lt;10  10        TRUE Alluvial.Fan       24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25       NA NA       FALSE      10  10       FALSE Alluvial.Fan       25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26      &lt;20 20        TRUE     &lt;10  10        TRUE Alluvial.Fan       26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27      &lt;10 10        TRUE      10  10       FALSE Alluvial.Fan       27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28        7  7       FALSE      10  10       FALSE Alluvial.Fan       28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29        5  5       FALSE      20  20       FALSE Alluvial.Fan       29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30        2  2       FALSE      20  20       FALSE Alluvial.Fan       30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31        2  2       FALSE     &lt;10  10        TRUE Alluvial.Fan       31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32      &lt;10 10        TRUE      20  20       FALSE Alluvial.Fan       32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33        7  7       FALSE      20  20       FALSE Alluvial.Fan       33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34       12 12       FALSE      20  20       FALSE Alluvial.Fan       34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35      &lt; 1  1        TRUE     &lt;10  10        TRUE Alluvial.Fan       35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36       20 20       FALSE      10  10       FALSE Alluvial.Fan       36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37       NA NA       FALSE      20  20       FALSE Alluvial.Fan       37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38       NA NA       FALSE     620 620       FALSE Alluvial.Fan       38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39       16 16       FALSE      40  40       FALSE Alluvial.Fan       39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40      &lt; 5  5        TRUE      50  50       FALSE Alluvial.Fan       40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41        1  1       FALSE      33  33       FALSE Alluvial.Fan       41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42        2  2       FALSE      10  10       FALSE Alluvial.Fan       42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43      &lt; 5  5        TRUE      20  20       FALSE Alluvial.Fan       43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44        3  3       FALSE      10  10       FALSE Alluvial.Fan       44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45        2  2       FALSE      10  10       FALSE Alluvial.Fan       45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46        8  8       FALSE      10  10       FALSE Alluvial.Fan       46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47        7  7       FALSE      30  30       FALSE Alluvial.Fan       47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48        5  5       FALSE      20  20       FALSE Alluvial.Fan       48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49      &lt; 5  5        TRUE      10  10       FALSE Alluvial.Fan       49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50        2  2       FALSE      20  20       FALSE Alluvial.Fan       50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51      &lt;10 10        TRUE      20  20       FALSE Alluvial.Fan       51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52      &lt; 5  5        TRUE      20  20       FALSE Alluvial.Fan       52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53      &lt; 5  5        TRUE     &lt;10  10        TRUE Alluvial.Fan       53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54        2  2       FALSE      20  20       FALSE Alluvial.Fan       54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55       10 10       FALSE      23  23       FALSE Alluvial.Fan       55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56        2  2       FALSE      17  17       FALSE Alluvial.Fan       56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57        4  4       FALSE      10  10       FALSE Alluvial.Fan       57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58      &lt; 5  5        TRUE     &lt;10  10        TRUE Alluvial.Fan       58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59        2  2       FALSE      10  10       FALSE Alluvial.Fan       59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60        3  3       FALSE      20  20       FALSE Alluvial.Fan       60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61        9  9       FALSE      29  29       FALSE Alluvial.Fan       61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62      &lt; 5  5        TRUE      20  20       FALSE Alluvial.Fan       62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63        2  2       FALSE     &lt;10  10        TRUE Alluvial.Fan       63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64        2  2       FALSE      10  10       FALSE Alluvial.Fan       64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65        2  2       FALSE     &lt;10  10        TRUE Alluvial.Fan       65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66        2  2       FALSE      10  10       FALSE Alluvial.Fan       66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67        1  1       FALSE       7   7       FALSE Alluvial.Fan       67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68        1  1       FALSE     &lt;10  10        TRUE Alluvial.Fan       68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69        2  2       FALSE      20  20       FALSE Basin.Trough        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70        2  2       FALSE      10  10       FALSE Basin.Trough        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71       12 12       FALSE      60  60       FALSE Basin.Trough        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72        2  2       FALSE      20  20       FALSE Basin.Trough        4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73        1  1       FALSE      12  12       FALSE Basin.Trough        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74      &lt;10 10        TRUE       8   8       FALSE Basin.Trough        6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75      &lt;10 10        TRUE     &lt;10  10        TRUE Basin.Trough        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76        4  4       FALSE      14  14       FALSE Basin.Trough        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77      &lt;10 10        TRUE     &lt;10  10        TRUE Basin.Trough        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78      &lt; 1  1        TRUE      17  17       FALSE Basin.Trough       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79        1  1       FALSE     &lt; 3   3        TRUE Basin.Trough       11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80      &lt; 2  2        TRUE      11  11       FALSE Basin.Trough       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81      &lt; 2  2        TRUE       5   5       FALSE Basin.Trough       13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82        1  1       FALSE      12  12       FALSE Basin.Trough       14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83        2  2       FALSE       4   4       FALSE Basin.Trough       15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84      &lt;10 10        TRUE       3   3       FALSE Basin.Trough       16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85        3  3       FALSE       6   6       FALSE Basin.Trough       17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86      &lt; 1  1        TRUE       3   3       FALSE Basin.Trough       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87        1  1       FALSE      15  15       FALSE Basin.Trough       19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88        1  1       FALSE      13  13       FALSE Basin.Trough       20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89        3  3       FALSE       4   4       FALSE Basin.Trough       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90      &lt; 5  5        TRUE      20  20       FALSE Basin.Trough       22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91       NA NA       FALSE      20  20       FALSE Basin.Trough       23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92       17 17       FALSE      70  70       FALSE Basin.Trough       24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93       23 23       FALSE      60  60       FALSE Basin.Trough       25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94        9  9       FALSE      40  40       FALSE Basin.Trough       26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95        9  9       FALSE      30  30       FALSE Basin.Trough       27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96        3  3       FALSE      40  40       FALSE Basin.Trough       28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97        3  3       FALSE      17  17       FALSE Basin.Trough       29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98      &lt;15 15        TRUE      10  10       FALSE Basin.Trough       30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99      &lt; 5  5        TRUE      20  20       FALSE Basin.Trough       31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100       4  4       FALSE      20  20       FALSE Basin.Trough       32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101     &lt; 5  5        TRUE       5   5       FALSE Basin.Trough       33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102     &lt; 5  5        TRUE      10  10       FALSE Basin.Trough       34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103     &lt; 5  5        TRUE      50  50       FALSE Basin.Trough       35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104       4  4       FALSE      30  30       FALSE Basin.Trough       36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105       8  8       FALSE      25  25       FALSE Basin.Trough       37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106       1  1       FALSE     &lt;10  10        TRUE Basin.Trough       38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107      15 15       FALSE      10  10       FALSE Basin.Trough       39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108       3  3       FALSE      40  40       FALSE Basin.Trough       40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109       3  3       FALSE      20  20       FALSE Basin.Trough       41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110       1  1       FALSE      10  10       FALSE Basin.Trough       42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111       6  6       FALSE      20  20       FALSE Basin.Trough       43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112       3  3       FALSE      20  20       FALSE Basin.Trough       44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113       6  6       FALSE      30  30       FALSE Basin.Trough       45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114       3  3       FALSE      20  20       FALSE Basin.Trough       46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115       4  4       FALSE      30  30       FALSE Basin.Trough       47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116       5  5       FALSE      50  50       FALSE Basin.Trough       48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117      14 14       FALSE      90  90       FALSE Basin.Trough       49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118       4  4       FALSE      20  20       FALSE Basin.Trough       50</span>
<span class="r-in">  <span class="co">#    Cu.orig Cu Cu.censored Zn.orig  Zn Zn.censored         Zone Location</span></span>
<span class="r-in">  <span class="co">#1       &lt; 1  1        TRUE     &lt;10  10        TRUE Alluvial.Fan        1</span></span>
<span class="r-in">  <span class="co">#2       &lt; 1  1        TRUE       9   9       FALSE Alluvial.Fan        2</span></span>
<span class="r-in">  <span class="co">#3         3  3       FALSE      NA  NA       FALSE Alluvial.Fan        3</span></span>
<span class="r-in">  <span class="co">#.</span></span>
<span class="r-in">  <span class="co">#.</span></span>
<span class="r-in">  <span class="co">#.</span></span>
<span class="r-in">  <span class="co">#116       5  5       FALSE      50  50       FALSE Basin.Trough       48</span></span>
<span class="r-in">  <span class="co">#117      14 14       FALSE      90  90       FALSE Basin.Trough       49</span></span>
<span class="r-in">  <span class="co">#118       4  4       FALSE      20  20       FALSE Basin.Trough       50</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#------------------------------</span></span>
<span class="r-in">  <span class="co"># First look at the copper data </span></span>
<span class="r-in">  <span class="co">#------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Cu.AF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Cu</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Cu.AF.cen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Cu.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Cu.BT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Cu</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Cu.BT.cen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Cu.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Note the large number of tied observations in the copper data</span></span>
<span class="r-in">  <span class="co">#-------------------------------------------------------------- </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Cu.AF</span><span class="op">[</span><span class="op">!</span><span class="va">Cu.AF.cen</span><span class="op">]</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3  4  5  7  8  9 10 11 12 16 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5 21  6  3  3  3  1  1  1  1  1  1  1 </span>
<span class="r-in">  <span class="co"># 1  2  3  4  5  7  8  9 10 11 12 16 20 </span></span>
<span class="r-in">  <span class="co"># 5 21  6  3  3  3  1  1  1  1  1  1  1</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Cu.BT</span><span class="op">[</span><span class="op">!</span><span class="va">Cu.BT.cen</span><span class="op">]</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1  2  3  4  5  6  8  9 12 14 15 17 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7  4  8  5  1  2  1  2  1  1  1  1  1 </span>
<span class="r-in">  <span class="co"># 1  2  3  4  5  6  8  9 12 14 15 17 23 </span></span>
<span class="r-in">  <span class="co"># 7  4  8  5  1  2  1  2  1  1  1  1  1</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Logrank test with hypergeometric variance:</span></span>
<span class="r-in">  <span class="co">#-------------------------------------------</span></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cu.AF</span>, x.censored <span class="op">=</span> <span class="va">Cu.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Cu.BT</span>, y.censored <span class="op">=</span> <span class="va">Cu.BT.cen</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         nu     var.nu          z </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.8791355 13.6533490 -0.5085557 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6110637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Fy(t) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Fx(t)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fy(t) != Fx(t) for at least one t"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Two-Sample Linear Rank Test:\n                                 Logrank Test\n                                 with Hypergeometric Variance"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nx ny </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65 49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x       y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Cu.AF" "Cu.BT" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           x           y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Cu.AF.cen" "Cu.BT.cen" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels$x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  5 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels$y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  2  5 10 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        x        y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26.15385 28.57143 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "htestCensored"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Hypothesis Test</span></span>
<span class="r-in">  <span class="co">#Based on Censored Data</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Null Hypothesis:                 Fy(t) = Fx(t)</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          Fy(t) != Fx(t) for at least one t</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Name:                       Two-Sample Linear Rank Test:</span></span>
<span class="r-in">  <span class="co">#                                 Logrank Test</span></span>
<span class="r-in">  <span class="co">#                                 with Hypergeometric Variance</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Side:                  left</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Level(s):              x =  1  5 10 20 </span></span>
<span class="r-in">  <span class="co">#                                 y =  1  2  5 10 15 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x = Cu.AF</span></span>
<span class="r-in">  <span class="co">#                                 y = Cu.BT</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Variable:              x = Cu.AF.cen</span></span>
<span class="r-in">  <span class="co">#                                 y = Cu.BT.cen</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number NA/NaN/Inf's Removed:     x = 3</span></span>
<span class="r-in">  <span class="co">#                                 y = 1</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Sizes:                    nx = 65</span></span>
<span class="r-in">  <span class="co">#                                 ny = 49</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Percent Censored:                x = 26.2%</span></span>
<span class="r-in">  <span class="co">#                                 y = 28.6%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistics:                 nu     = -1.8791355</span></span>
<span class="r-in">  <span class="co">#                                 var.nu = 13.6533490</span></span>
<span class="r-in">  <span class="co">#                                 z      = -0.5085557</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0.6110637</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the p-values produced by the Normal Scores 2 test</span></span>
<span class="r-in">  <span class="co"># using the hypergeomtric vs. permutation variance estimates.</span></span>
<span class="r-in">  <span class="co"># Note how much larger the estimated variance is based on</span></span>
<span class="r-in">  <span class="co"># the permuation variance estimate:</span></span>
<span class="r-in">  <span class="co">#-----------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cu.AF</span>, x.censored <span class="op">=</span> <span class="va">Cu.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Cu.BT</span>, y.censored <span class="op">=</span> <span class="va">Cu.BT.cen</span>, </span>
<span class="r-in">    test <span class="op">=</span> <span class="st">"normal.scores.2"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2008913</span>
<span class="r-in">  <span class="co">#[1] 0.2008913</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cu.AF</span>, x.censored <span class="op">=</span> <span class="va">Cu.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Cu.BT</span>, y.censored <span class="op">=</span> <span class="va">Cu.BT.cen</span>, </span>
<span class="r-in">    test <span class="op">=</span> <span class="st">"normal.scores.2"</span>, variance <span class="op">=</span> <span class="st">"permutation"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.657001</span>
<span class="r-in">  <span class="co">#[1] [1] 0.657001</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co"># Now look at the zinc data</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Zn.AF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Zn</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Zn.AF.cen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Zn.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Zn.BT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Zn</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Zn.BT.cen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">    <span class="va">Zn.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Note the moderate number of tied observations in the zinc data, </span></span>
<span class="r-in">  <span class="co"># and the "outlier" of 620 in the Alluvial Fan data.</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------------------------- </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Zn.AF</span><span class="op">[</span><span class="op">!</span><span class="va">Zn.AF.cen</span><span class="op">]</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5   7   8   9  10  11  12  17  18  19  20  23  29  30  33  40  50 620 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   1   1   1  20   2   1   1   1   1  14   1   1   1   1   1   1   1 </span>
<span class="r-in">  <span class="co">#  5   7   8   9  10  11  12  17  18  19  20  23  29  30  33  40  50 620 </span></span>
<span class="r-in">  <span class="co">#  1   1   1   1  20   2   1   1   1   1  14   1   1   1   1   1   1   1 </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Zn.BT</span><span class="op">[</span><span class="op">!</span><span class="va">Zn.BT.cen</span><span class="op">]</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3  4  5  6  8 10 11 12 13 14 15 17 20 25 30 40 50 60 70 90 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2  2  2  1  1  5  1  2  1  1  1  2 11  1  4  3  2  2  1  1 </span>
<span class="r-in">  <span class="co"># 3  4  5  6  8 10 11 12 13 14 15 17 20 25 30 40 50 60 70 90 </span></span>
<span class="r-in">  <span class="co"># 2  2  2  1  1  5  1  2  1  1  1  2 11  1  4  3  2  2  1  1</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Logrank test with hypergeometric variance:</span></span>
<span class="r-in">  <span class="co">#-------------------------------------------</span></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Zn.AF</span>, x.censored <span class="op">=</span> <span class="va">Zn.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Zn.BT</span>, y.censored <span class="op">=</span> <span class="va">Zn.BT.cen</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        nu    var.nu         z </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -6.992999 17.203227 -1.686004 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09179512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Fy(t) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Fx(t)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fy(t) != Fx(t) for at least one t"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Two-Sample Linear Rank Test:\n                                 Logrank Test\n                                 with Hypergeometric Variance"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nx ny </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x       y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Zn.AF" "Zn.BT" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           x           y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Zn.AF.cen" "Zn.BT.cen" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels$x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  3 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels$y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  3 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x       y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23.8806  8.0000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "htestCensored"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Hypothesis Test</span></span>
<span class="r-in">  <span class="co">#Based on Censored Data</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Null Hypothesis:                 Fy(t) = Fx(t)</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          Fy(t) != Fx(t) for at least one t</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Name:                       Two-Sample Linear Rank Test:</span></span>
<span class="r-in">  <span class="co">#                                 Logrank Test</span></span>
<span class="r-in">  <span class="co">#                                 with Hypergeometric Variance</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Side:                  left</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Level(s):              x =  3 10 </span></span>
<span class="r-in">  <span class="co">#                                 y =  3 10 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x = Zn.AF</span></span>
<span class="r-in">  <span class="co">#                                 y = Zn.BT</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Variable:              x = Zn.AF.cen</span></span>
<span class="r-in">  <span class="co">#                                 y = Zn.BT.cen</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number NA/NaN/Inf's Removed:     x = 1</span></span>
<span class="r-in">  <span class="co">#                                 y = 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Sizes:                    nx = 67</span></span>
<span class="r-in">  <span class="co">#                                 ny = 50</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Percent Censored:                x = 23.9%</span></span>
<span class="r-in">  <span class="co">#                                 y =  8.0%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistics:                 nu     = -6.992999</span></span>
<span class="r-in">  <span class="co">#                                 var.nu = 17.203227</span></span>
<span class="r-in">  <span class="co">#                                 z      = -1.686004</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0.09179512</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the p-values produced by the Logrank, Gehan, Peto-Peto, </span></span>
<span class="r-in">  <span class="co"># and Tarone-Ware tests using the hypergeometric variance.</span></span>
<span class="r-in">  <span class="co">#-----------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Zn.AF</span>, x.censored <span class="op">=</span> <span class="va">Zn.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Zn.BT</span>, y.censored <span class="op">=</span> <span class="va">Zn.BT.cen</span>, </span>
<span class="r-in">    test <span class="op">=</span> <span class="st">"logrank"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09179512</span>
<span class="r-in">  <span class="co">#[1] 0.09179512</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Zn.AF</span>, x.censored <span class="op">=</span> <span class="va">Zn.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Zn.BT</span>, y.censored <span class="op">=</span> <span class="va">Zn.BT.cen</span>, </span>
<span class="r-in">    test <span class="op">=</span> <span class="st">"gehan"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0185445</span>
<span class="r-in">  <span class="co">#[1] 0.0185445</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Zn.AF</span>, x.censored <span class="op">=</span> <span class="va">Zn.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Zn.BT</span>, y.censored <span class="op">=</span> <span class="va">Zn.BT.cen</span>, </span>
<span class="r-in">    test <span class="op">=</span> <span class="st">"peto-peto"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.009704529</span>
<span class="r-in">  <span class="co">#[1] 0.009704529</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Zn.AF</span>, x.censored <span class="op">=</span> <span class="va">Zn.AF.cen</span>, </span>
<span class="r-in">    y <span class="op">=</span> <span class="va">Zn.BT</span>, y.censored <span class="op">=</span> <span class="va">Zn.BT.cen</span>, </span>
<span class="r-in">    test <span class="op">=</span> <span class="st">"tarone-ware"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03457803</span>
<span class="r-in">  <span class="co">#[1] 0.03457803</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="co">#---------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">Cu.AF</span>, <span class="va">Cu.AF.cen</span>, <span class="va">Cu.BT</span>, <span class="va">Cu.BT.cen</span>, </span>
<span class="r-in">     <span class="va">Zn.AF</span>, <span class="va">Zn.AF.cen</span>, <span class="va">Zn.BT</span>, <span class="va">Zn.BT.cen</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Example 16.5 on pages 16-22 to 16.23 of USEPA (2009) shows how to perform </span></span>
<span class="r-in">  <span class="co"># the Tarone-Ware two sample linear rank test based on censored data using </span></span>
<span class="r-in">  <span class="co"># observations on tetrachloroethylene (PCE) (ppb) collected at one background </span></span>
<span class="r-in">  <span class="co"># and one compliance well.  The data for this example are stored in </span></span>
<span class="r-in">  <span class="co"># EPA.09.Ex.16.5.PCE.df.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">EPA.09.Ex.16.5.PCE.df</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Well.type PCE.Orig.ppb PCE.ppb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Background           &lt;4     4.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Background          1.5     1.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Background           &lt;2     2.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Background          8.7     8.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Background          5.1     5.1    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  Compliance          6.4     6.4    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  Compliance         10.9    10.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  Compliance            7     7.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Compliance         14.3    14.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Compliance          1.9     1.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Compliance           10    10.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Compliance          6.8     6.8    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Compliance           &lt;5     5.0     TRUE</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#    Well.type PCE.Orig.ppb PCE.ppb Censored</span></span>
<span class="r-in">  <span class="co">#1  Background           &lt;4     4.0     TRUE</span></span>
<span class="r-in">  <span class="co">#2  Background          1.5     1.5    FALSE</span></span>
<span class="r-in">  <span class="co">#3  Background           &lt;2     2.0     TRUE</span></span>
<span class="r-in">  <span class="co">#4  Background          8.7     8.7    FALSE</span></span>
<span class="r-in">  <span class="co">#5  Background          5.1     5.1    FALSE</span></span>
<span class="r-in">  <span class="co">#6  Background           &lt;5     5.0     TRUE</span></span>
<span class="r-in">  <span class="co">#7  Compliance          6.4     6.4    FALSE</span></span>
<span class="r-in">  <span class="co">#8  Compliance         10.9    10.9    FALSE</span></span>
<span class="r-in">  <span class="co">#9  Compliance            7     7.0    FALSE</span></span>
<span class="r-in">  <span class="co">#10 Compliance         14.3    14.3    FALSE</span></span>
<span class="r-in">  <span class="co">#11 Compliance          1.9     1.9    FALSE</span></span>
<span class="r-in">  <span class="co">#12 Compliance           10    10.0    FALSE</span></span>
<span class="r-in">  <span class="co">#13 Compliance          6.8     6.8    FALSE</span></span>
<span class="r-in">  <span class="co">#14 Compliance           &lt;5     5.0     TRUE</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.16.5.PCE.df</span>, </span>
<span class="r-in">    <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span></span>
<span class="r-in">      x <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      x.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      y <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      y.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      test <span class="op">=</span> <span class="st">"tarone-ware"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        nu    var.nu         z </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8.458912 20.912407  1.849748 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03217495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Fy(t) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Fx(t)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fy(t) &gt; Fx(t) for at least one t"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Two-Sample Linear Rank Test:\n                                 Tarone-Ware Test\n                                 with Hypergeometric Variance"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nx ny </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8  6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                      x                                      y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "PCE.ppb[Well.type == \"Compliance\"]" "PCE.ppb[Well.type == \"Background\"]" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       x                                       y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Censored[Well.type == \"Compliance\"]" "Censored[Well.type == \"Background\"]" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels$x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels$y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    x    y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.5 50.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "htestCensored"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Hypothesis Test</span></span>
<span class="r-in">  <span class="co">#Based on Censored Data</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Null Hypothesis:                 Fy(t) = Fx(t)</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          Fy(t) &gt; Fx(t) for at least one t</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Name:                       Two-Sample Linear Rank Test:</span></span>
<span class="r-in">  <span class="co">#                                 Tarone-Ware Test</span></span>
<span class="r-in">  <span class="co">#                                 with Hypergeometric Variance</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Side:                  left</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Level(s):              x = 5 </span></span>
<span class="r-in">  <span class="co">#                                 y = 2 4 5 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x = PCE.ppb[Well.type == "Compliance"]</span></span>
<span class="r-in">  <span class="co">#                                 y = PCE.ppb[Well.type == "Background"]</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Variable:              x = Censored[Well.type == "Compliance"]</span></span>
<span class="r-in">  <span class="co">#                                 y = Censored[Well.type == "Background"]</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Sizes:                    nx = 8</span></span>
<span class="r-in">  <span class="co">#                                 ny = 6</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Percent Censored:                x = 12.5%</span></span>
<span class="r-in">  <span class="co">#                                 y = 50.0%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistics:                 nu     =  8.458912</span></span>
<span class="r-in">  <span class="co">#                                 var.nu = 20.912407</span></span>
<span class="r-in">  <span class="co">#                                 z      =  1.849748</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0.03217495</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the p-value for the Tarone-Ware test with p-values from </span></span>
<span class="r-in">  <span class="co"># the logrank, Gehan, and Peto-Peto tests</span></span>
<span class="r-in">  <span class="co">#-----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.16.5.PCE.df</span>, </span>
<span class="r-in">    <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span></span>
<span class="r-in">      x <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      x.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      y <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      y.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      test <span class="op">=</span> <span class="st">"tarone-ware"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03217495</span>
<span class="r-in">  <span class="co">#[1] 0.03217495</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.16.5.PCE.df</span>, </span>
<span class="r-in">    <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span></span>
<span class="r-in">      x <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      x.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      y <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      y.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      test <span class="op">=</span> <span class="st">"logrank"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02752793</span>
<span class="r-in">  <span class="co">#[1] 0.02752793</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.16.5.PCE.df</span>, </span>
<span class="r-in">    <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span></span>
<span class="r-in">      x <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      x.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      y <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      y.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      test <span class="op">=</span> <span class="st">"gehan"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03656224</span>
<span class="r-in">  <span class="co">#[1] 0.03656224</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.16.5.PCE.df</span>, </span>
<span class="r-in">    <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span></span>
<span class="r-in">      x <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      x.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span>, </span>
<span class="r-in">      y <span class="op">=</span> <span class="va">PCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      y.censored <span class="op">=</span> <span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      test <span class="op">=</span> <span class="st">"peto-peto"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03127296</span>
<span class="r-in">  <span class="co">#[1] 0.03127296</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The results shown in Table 9 of Millard and Deverel (1988, p.2097) are correct </span></span>
<span class="r-in">  <span class="co"># only for the hypergeometric variance and the modified MWW tests; the other </span></span>
<span class="r-in">  <span class="co"># results were computed as if there were no ties.  Re-compute the correct </span></span>
<span class="r-in">  <span class="co"># z-statistics and p-values for the copper and zinc data. </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gehan"</span>, <span class="st">"logrank"</span>, <span class="st">"peto-peto"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"peto-peto"</span>, </span>
<span class="r-in">    <span class="st">"normal.scores.1"</span>, <span class="st">"normal.scores.2"</span>, <span class="st">"normal.scores.2"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"permutation"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"hypergeometric"</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span class="r-in">    <span class="st">"asymptotic"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"permutation"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"hypergeometric"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">stats.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">4</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">dum.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">        <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span></span>
<span class="r-in">          x <span class="op">=</span> <span class="va">Cu</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span>, </span>
<span class="r-in">          x.censored <span class="op">=</span> <span class="va">Cu.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span>,</span>
<span class="r-in">          y <span class="op">=</span> <span class="va">Cu</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span>, </span>
<span class="r-in">          y.censored <span class="op">=</span> <span class="va">Cu.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span>, </span>
<span class="r-in">          test <span class="op">=</span> <span class="va">test</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, variance <span class="op">=</span> <span class="va">variance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">stats.mat</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dum.list</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="st">"z"</span><span class="op">]</span>, <span class="va">dum.list</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">    <span class="va">dum.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Millard.Deverel.88.df</span>, </span>
<span class="r-in">        <span class="fu">twoSampleLinearRankTestCensored</span><span class="op">(</span></span>
<span class="r-in">          x <span class="op">=</span> <span class="va">Zn</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span>, </span>
<span class="r-in">          x.censored <span class="op">=</span> <span class="va">Zn.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Basin.Trough"</span><span class="op">]</span>,</span>
<span class="r-in">          y <span class="op">=</span> <span class="va">Zn</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span>, </span>
<span class="r-in">          y.censored <span class="op">=</span> <span class="va">Zn.censored</span><span class="op">[</span><span class="va">Zone</span> <span class="op">==</span> <span class="st">"Alluvial.Fan"</span><span class="op">]</span>, </span>
<span class="r-in">          test <span class="op">=</span> <span class="va">test</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, variance <span class="op">=</span> <span class="va">variance</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">stats.mat</span><span class="op">[</span><span class="va">i</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dum.list</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="st">"z"</span><span class="op">]</span>, <span class="va">dum.list</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'x' and/or 'x.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>3 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 observations with NA/NaN/Inf in 'y' and/or 'y.censored' removed.</span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">stats.mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">test</span>, <span class="va">variance</span>, sep <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>, </span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cu.Z"</span>, <span class="st">"Cu.p.value"</span>, <span class="st">"Zn.Z"</span>, <span class="st">"Zn.p.value"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">stats.mat</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                Cu.Z Cu.p.value Zn.Z Zn.p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gehan.permutation              0.87       0.38 2.49       0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logrank.permutation            0.79       0.43 1.75       0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> peto-peto.permutation          0.92       0.36 2.42       0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gehan.hypergeometric           0.71       0.48 2.35       0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logrank.hypergeometric         0.51       0.61 1.69       0.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> peto-peto.hypergeometric       1.03       0.30 2.59       0.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> peto-peto.asymptotic           0.90       0.37 2.37       0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal.scores.1.permutation    0.94       0.34 2.37       0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal.scores.2.permutation    0.98       0.33 2.39       0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> normal.scores.2.hypergeometric 1.28       0.20 2.48       0.01</span>
<span class="r-in">  <span class="co">#                               Cu.Z Cu.p.value Zn.Z Zn.p.value</span></span>
<span class="r-in">  <span class="co">#gehan.permutation              0.87       0.38 2.49       0.01</span></span>
<span class="r-in">  <span class="co">#logrank.permutation            0.79       0.43 1.75       0.08</span></span>
<span class="r-in">  <span class="co">#peto-peto.permutation          0.92       0.36 2.42       0.02</span></span>
<span class="r-in">  <span class="co">#gehan.hypergeometric           0.71       0.48 2.35       0.02</span></span>
<span class="r-in">  <span class="co">#logrank.hypergeometric         0.51       0.61 1.69       0.09</span></span>
<span class="r-in">  <span class="co">#peto-peto.hypergeometric       1.03       0.30 2.59       0.01</span></span>
<span class="r-in">  <span class="co">#peto-peto.asymptotic           0.90       0.37 2.37       0.02</span></span>
<span class="r-in">  <span class="co">#normal.scores.1.permutation    0.94       0.34 2.37       0.02</span></span>
<span class="r-in">  <span class="co">#normal.scores.2.permutation    0.98       0.33 2.39       0.02</span></span>
<span class="r-in">  <span class="co">#normal.scores.2.hypergeometric 1.28       0.20 2.48       0.01</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="co">#---------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">test</span>, <span class="va">variance</span>, <span class="va">stats.mat</span>, <span class="va">i</span>, <span class="va">dum.list</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

