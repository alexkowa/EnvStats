<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prediction Interval for a Lognormal Distribution — predIntLnorm • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction Interval for a Lognormal Distribution — predIntLnorm"><meta property="og:description" content="Estimate the mean and standard deviation on the log-scale for a 
  lognormal distribution, or estimate the mean 
  and coefficient of variation for a 
  lognormal distribution (alternative parameterization), 
  and construct a prediction interval for the next \(k\) observations or 
  next set of \(k\) geometric means."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prediction Interval for a Lognormal Distribution</h1>
    
    <div class="hidden name"><code>predIntLnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the mean and standard deviation on the log-scale for a 
  <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">lognormal distribution</a>, or estimate the mean 
  and coefficient of variation for a 
  <a href="LognormalAlt.html">lognormal distribution (alternative parameterization)</a>, 
  and construct a prediction interval for the next \(k\) observations or 
  next set of \(k\) geometric means.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">predIntLnorm</span><span class="op">(</span><span class="va">x</span>, n.geomean <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"Bonferroni"</span>, 
    pi.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>

  <span class="fu">predIntLnormAlt</span><span class="op">(</span><span class="va">x</span>, n.geomean <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"Bonferroni"</span>, 
    pi.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, est.arg.list <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>For <code>predIntLnorm</code>, <code>x</code> can be a numeric vector of positive observations, 
  or an object resulting from a call to an estimating function that assumes a 
  lognormal distribution (i.e., <code><a href="elnorm.html">elnorm</a></code> or <code><a href="elnormCensored.html">elnormCensored</a></code>).  
  You <em>cannot</em> supply objects resulting from a call to estimating functions that 
  use the alternative parameterization such as <code><a href="elnormAlt.html">elnormAlt</a></code> or 
  <code><a href="elnormAltCensored.html">elnormAltCensored</a></code>.</p>
<p>For <code>predIntLnormAlt</code>, a numeric vector of positive observations.</p>
<p>If <code>x</code> is a numeric vector, 
  missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
  values are allowed but will be removed.</p></dd>
<dt>n.geomean</dt>
<dd><p>positive integer specifying the sample size associated with the \(k\) future 
  geometric means.  The default value is <code>n.geomean=1</code> (i.e., individual 
  observations).  Note that all future geometric means must be based on the same 
  sample size.</p></dd>
<dt>k</dt>
<dd><p>positive integer specifying the number of future observations or geometric means the 
  prediction interval should contain with confidence level <code>conf.level</code>.  
  The default value is <code>k=1</code>.</p></dd>
<dt>method</dt>
<dd><p>character string specifying the method to use if the number of future observations 
  (<code>k</code>) is greater than 1.  The possible values are <code>method="Bonferroni"</code> 
  (approximate method based on Bonferonni inequality; the default), and <br><code>method="exact"</code> (exact method due to Dunnett, 1955).  See the DETAILS section 
  of <code><a href="predIntNormK.html">predIntNormK</a></code> for more information.  
  This argument is ignored if <code>k=1</code>.</p></dd>
<dt>pi.type</dt>
<dd><p>character string indicating what kind of prediction interval to compute.  
  The possible values are <code>pi.type="two-sided"</code> (the default), 
  <code>pi.type="lower"</code>, and <code>pi.type="upper"</code>.</p></dd>
<dt>conf.level</dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the prediction interval.  
  The default value is <code>conf.level=0.95</code>.</p></dd>
<dt>est.arg.list</dt>
<dd><p>for <code>predIntLnormAlt</code>, a list containing arguments to pass to the function <br><code><a href="elnormAlt.html">elnormAlt</a></code> for estimating the mean and coefficient of variation.  
  The default value is <code>est.arg.list=NULL</code>, which implies the default values 
  will be used in the call to <code><a href="elnormAlt.html">elnormAlt</a></code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>predIntLnorm</code> returns a prediction interval as well as 
  estimates of the meanlog and sdlog parameters.  
  The function <code>predIntLnormAlt</code> returns a prediction interval as well as 
  estimates of the mean and coefficient of variation.</p>
<p>A prediction interval for a lognormal distribution is constructed by taking the 
  natural logarithm of the observations and constructing a prediction interval 
  based on the normal (Gaussian) distribution by calling <code><a href="predIntNorm.html">predIntNorm</a></code>.  
  These prediction limits are then exponentiated to produce a prediction interval on 
  the original scale of the data.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>x</code> is a numeric vector, a list of class 
<code>"estimate"</code> containing the estimated parameters, the prediction interval, 
  and other information.  See the help file for <br><code><a href="estimate.object.html">estimate.object</a></code> for details.
  If <code>x</code> is the result of calling an estimation function, 
<code>predIntLnorm</code> returns a list whose class is the same as <code>x</code>.  
  The list contains the same components as <code>x</code>, as well as a component called 
<code>interval</code> containing the prediction interval information.  
  If <code>x</code> already has a component called <code>interval</code>, this component is 
  replaced with the prediction interval information.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002). <em>Statistics for Environmental Engineers</em>. 
  Lewis Publishers, Boca Raton.</p>
<p>Dunnett, C.W. (1955). A Multiple Comparisons Procedure for Comparing Several Treatments 
  with a Control. <em>Journal of the American Statistical Association</em> <b>50</b>, 1096-1121.</p>
<p>Dunnett, C.W. (1964). New Tables for Multiple Comparisons with a Control. 
  <em>Biometrics</em> <b>20</b>, 482-491.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009). 
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.  
  John Wiley &amp; Sons, Hoboken.</p> 
<p>Hahn, G.J. (1969). Factors for Calculating Two-Sided Prediction Intervals for 
  Samples from a Lognormal Distribution. 
  <em>Journal of the American Statistical Association</em> <b>64</b>(327), 878-898.</p>
<p>Hahn, G.J. (1970a). Additional Factors for Calculating Prediction Intervals for 
  Samples from a Lognormal Distribution. 
  <em>Journal of the American Statistical Association</em> <b>65</b>(332), 1668-1676.</p>
<p>Hahn, G.J. (1970b). Statistical Intervals for a Lognormal Population, Part I: Tables, 
  Examples and Applications. <em>Journal of Quality Technology</em> <b>2</b>(3), 115-125.</p>
<p>Hahn, G.J. (1970c). Statistical Intervals for a Lognormal Population, Part II: 
  Formulas, Assumptions, Some Derivations. <em>Journal of Quality Technology</em> 
  <b>2</b>(4), 195-206.</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991). <em>Statistical Intervals: A Guide for Practitioners</em>. 
  John Wiley and Sons, New York.</p>
<p>Hahn, G., and W. Nelson. (1973). A Survey of Prediction Intervals and Their Applications. 
  <em>Journal of Quality Technology</em> <b>5</b>, 178-188.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>. 
  Elsevier, New York.</p>
<p>Helsel, D.R., and R.M. Hirsch. (2002). <em>Statistical Methods in Water Resources</em>. 
  Techniques of Water Resources Investigations, Book 4, chapter A3. U.S. Geological Survey. 
  (available on-line at:  <a href="http://pubs.usgs.gov/twri/twri4a3/" class="external-link">http://pubs.usgs.gov/twri/twri4a3/</a>).</p>
<p>Krishnamoorthy K., and T. Mathew. (2009). 
  <em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>. 
  John Wiley and Sons, Hoboken.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>. 
  CRC Press, Boca Raton, Florida.</p>
<p>Miller, R.G. (1981a). <em>Simultaneous Statistical Inference</em>. McGraw-Hill, New York.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Prediction and tolerance intervals have long been applied to quality control and 
  life testing problems (Hahn, 1970b,c; Hahn and Nelson, 1973; Krishnamoorthy and Mathew, 2009).  
  In the context of environmental statistics, prediction intervals are useful for 
  analyzing data from groundwater detection monitoring programs at hazardous and 
  solid waste facilities (e.g., Gibbons et al., 2009; Millard and Neerchal, 2001; 
  USEPA, 2009).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="elnorm.html">elnorm</a></code>, <code><a href="elnormAlt.html">elnormAlt</a></code>, 
  <code><a href="predIntNorm.html">predIntNorm</a></code>, <code><a href="predIntNormK.html">predIntNormK</a></code>, 
  <code><a href="predIntLnormSimultaneous.html">predIntLnormSimultaneous</a></code>, <br><code><a href="predIntLnormSimultaneous.html">predIntLnormAltSimultaneous</a></code>, 
  <code><a href="tolIntLnorm.html">tolIntLnorm</a></code>,  <code><a href="tolIntLnorm.html">tolIntLnormAlt</a></code>, 
  <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">Lognormal</a>, <code><a href="estimate.object.html">estimate.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Generate 20 observations from a lognormal distribution with parameters </span></span>
<span class="r-in">  <span class="co"># meanlog=0 and sdlog=1.  The exact two-sided 90% prediction interval for </span></span>
<span class="r-in">  <span class="co"># k=1 future observation is given by: [exp(-1.645), exp(1.645)] = [0.1930, 5.181]. </span></span>
<span class="r-in">  <span class="co"># Use predIntLnorm to estimate the distribution parameters, and construct a </span></span>
<span class="r-in">  <span class="co"># two-sided 90% prediction interval.</span></span>
<span class="r-in">  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>, meanlog <span class="op">=</span> <span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span class="r-in">  <span class="fu">predIntLnorm</span><span class="op">(</span><span class="va">dat</span>, conf <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    meanlog      sdlog </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1035722  0.9106429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LPL       UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1795898 4.5264399 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.geomean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Lognormal</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          meanlog = -0.1035722</span></span>
<span class="r-in">  <span class="co">#                                 sdlog   =  0.9106429</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mvue</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                90%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number of Future Observations:   1</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL = 0.1795898</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 4.5264399</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Repeat the above example, but do it in two steps.  </span></span>
<span class="r-in">  <span class="co"># First create a list called est.list containing information about the </span></span>
<span class="r-in">  <span class="co"># estimated parameters, then create the prediction interval.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">est.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="elnorm.html">elnorm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">est.list</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    meanlog      sdlog </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1035722  0.9106429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Lognormal</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          meanlog = -0.1035722</span></span>
<span class="r-in">  <span class="co">#                                 sdlog   =  0.9106429</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mvue</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntLnorm</span><span class="op">(</span><span class="va">est.list</span>, conf <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    meanlog      sdlog </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1035722  0.9106429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LPL       UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1795898 4.5264399 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.geomean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Lognormal</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          meanlog = -0.1035722</span></span>
<span class="r-in">  <span class="co">#                                 sdlog   =  0.9106429</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mvue</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                90%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number of Future Observations:   1</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL = 0.1795898</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 4.5264399</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Using the same data from the first example, create a one-sided </span></span>
<span class="r-in">  <span class="co"># upper 99% prediction limit for the next 3 geometric means of order 2 </span></span>
<span class="r-in">  <span class="co"># (i.e., each of the 3 future geometric means is based on a sample size </span></span>
<span class="r-in">  <span class="co"># of 2 future observations).</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntLnorm</span><span class="op">(</span><span class="va">dat</span>, n.geomean <span class="op">=</span> <span class="fl">2</span>, k <span class="op">=</span> <span class="fl">3</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span>, </span>
<span class="r-in">    pi.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    meanlog      sdlog </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1035722  0.9106429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LPL      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.000000 7.047571 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Bonferroni"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.geomean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Lognormal</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          meanlog = -0.1035722</span></span>
<span class="r-in">  <span class="co">#                                 sdlog   =  0.9106429</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mvue</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      Bonferroni</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                99%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number of Future</span></span>
<span class="r-in">  <span class="co">#Geometric Means:                 3</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size for</span></span>
<span class="r-in">  <span class="co">#Geometric Means:                 2</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL = 0.000000</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 7.047571</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the result above that is based on the Bonferroni method </span></span>
<span class="r-in">  <span class="co"># with the exact method</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntLnorm</span><span class="op">(</span><span class="va">dat</span>, n.geomean <span class="op">=</span> <span class="fl">2</span>, k <span class="op">=</span> <span class="fl">3</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span>, </span>
<span class="r-in">    pi.type <span class="op">=</span> <span class="st">"upper"</span>, method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7.00316 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#    UPL </span></span>
<span class="r-in">  <span class="co">#7.00316</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">est.list</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co">#--------------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Example 18-2 of USEPA (2009, p.18-15) shows how to construct a 99% </span></span>
<span class="r-in">  <span class="co"># upper prediction interval for the log-scale mean of 4 future observations </span></span>
<span class="r-in">  <span class="co"># (future mean of order 4) assuming a lognormal distribution based on </span></span>
<span class="r-in">  <span class="co"># chrysene concentrations (ppb) in groundwater at 2 background wells.  </span></span>
<span class="r-in">  <span class="co"># Data were collected once per month over 4 months at the 2 background </span></span>
<span class="r-in">  <span class="co"># wells, and also at a compliance well.  </span></span>
<span class="r-in">  <span class="co"># The question to be answered is whether there is evidence of </span></span>
<span class="r-in">  <span class="co"># contamination at the compliance well.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Here we will follow the example, but look at the geometric mean </span></span>
<span class="r-in">  <span class="co"># instead of the log-scale mean.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The data for this example are stored in EPA.09.Ex.18.2.chrysene.df.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">EPA.09.Ex.18.2.chrysene.df</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Month   Well  Well.type Chrysene.ppb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 Well.1 Background          6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2 Well.1 Background         27.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      3 Well.1 Background         10.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4 Well.1 Background          8.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1 Well.2 Background         15.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      2 Well.2 Background          7.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3 Well.2 Background         48.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      4 Well.2 Background          7.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1 Well.3 Compliance         68.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2 Well.3 Compliance         48.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     3 Well.3 Compliance         30.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     4 Well.3 Compliance         38.1</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#   Month   Well  Well.type Chrysene.ppb</span></span>
<span class="r-in">  <span class="co">#1      1 Well.1 Background          6.9</span></span>
<span class="r-in">  <span class="co">#2      2 Well.1 Background         27.3</span></span>
<span class="r-in">  <span class="co">#3      3 Well.1 Background         10.8</span></span>
<span class="r-in">  <span class="co">#4      4 Well.1 Background          8.9</span></span>
<span class="r-in">  <span class="co">#5      1 Well.2 Background         15.1</span></span>
<span class="r-in">  <span class="co">#6      2 Well.2 Background          7.2</span></span>
<span class="r-in">  <span class="co">#7      3 Well.2 Background         48.4</span></span>
<span class="r-in">  <span class="co">#8      4 Well.2 Background          7.8</span></span>
<span class="r-in">  <span class="co">#9      1 Well.3 Compliance         68.0</span></span>
<span class="r-in">  <span class="co">#10     2 Well.3 Compliance         48.9</span></span>
<span class="r-in">  <span class="co">#11     3 Well.3 Compliance         30.1</span></span>
<span class="r-in">  <span class="co">#12     4 Well.3 Compliance         38.1 </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Chrysene.bkgd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.18.2.chrysene.df</span>, </span>
<span class="r-in">    <span class="va">Chrysene.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">Chrysene.cmpl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.18.2.chrysene.df</span>, </span>
<span class="r-in">    <span class="va">Chrysene.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># A Shapiro-Wilks goodness-of-fit test for normality indicates  </span></span>
<span class="r-in">  <span class="co"># we should reject the assumption of normality and assume a </span></span>
<span class="r-in">  <span class="co"># lognormal distribution for the background well data:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">Chrysene.bkgd</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist.abb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "norm"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution.parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mean       sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16.55000 14.54441 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         W </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7289006 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $z.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.592803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.004759859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "True cdf does not equal the\n                                 Normal Distribution."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Shapiro-Wilk GOF"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  6.9 27.3 10.8  8.9 15.1  7.2 48.4  7.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Chrysene.bkgd"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gof"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Goodness-of-Fit Test</span></span>
<span class="r-in">  <span class="co">#-------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Method:                     Shapiro-Wilk GOF</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Hypothesized Distribution:       Normal</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          mean = 16.55000</span></span>
<span class="r-in">  <span class="co">#                                 sd   = 14.54441</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mvue</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            Chrysene.bkgd</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic:                  W = 0.7289006</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic Parameter:        n = 8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0.004759859</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          True cdf does not equal the</span></span>
<span class="r-in">  <span class="co">#                                 Normal Distribution.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">Chrysene.bkgd</span>, dist <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist.abb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lnorm"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution.parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.5533006 0.7060038 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         W </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8546352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $z.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.247508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1061057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "True cdf does not equal the\n                                 Lognormal Distribution."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Shapiro-Wilk GOF"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  6.9 27.3 10.8  8.9 15.1  7.2 48.4  7.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Chrysene.bkgd"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gof"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Goodness-of-Fit Test</span></span>
<span class="r-in">  <span class="co">#-------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Method:                     Shapiro-Wilk GOF</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Hypothesized Distribution:       Lognormal</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          meanlog = 2.5533006</span></span>
<span class="r-in">  <span class="co">#                                 sdlog   = 0.7060038</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mvue</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            Chrysene.bkgd</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic:                  W = 0.8546352</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic Parameter:        n = 8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0.1061057</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          True cdf does not equal the</span></span>
<span class="r-in">  <span class="co">#                                 Lognormal Distribution.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Here is the one-sided 99% upper prediction limit for </span></span>
<span class="r-in">  <span class="co"># a geometric mean based on 4 future observations:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntLnorm</span><span class="op">(</span><span class="va">Chrysene.bkgd</span>, n.geomean <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">1</span>, </span>
<span class="r-in">    conf.level <span class="op">=</span> <span class="fl">0.99</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.5533006 0.7060038 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Chrysene.bkgd"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LPL      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.00000 46.96613 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.geomean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Lognormal</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          meanlog = 2.5533006</span></span>
<span class="r-in">  <span class="co">#                                 sdlog   = 0.7060038</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mvue</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            Chrysene.bkgd</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                99%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number of Future</span></span>
<span class="r-in">  <span class="co">#Geometric Means:                 1</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size for</span></span>
<span class="r-in">  <span class="co">#Geometric Means:                 4</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL =  0.00000</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 46.96613</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">UPL</span> <span class="op">&lt;-</span> <span class="fu">predIntLnorm</span><span class="op">(</span><span class="va">Chrysene.bkgd</span>, n.geomean <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">1</span>, </span>
<span class="r-in">    conf.level <span class="op">=</span> <span class="fl">0.99</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">UPL</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46.96613 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#46.96613</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># Is there evidence of contamination at the compliance well?</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="geoMean.html">geoMean</a></span><span class="op">(</span><span class="va">Chrysene.cmpl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 44.19034</span>
<span class="r-in">  <span class="co">#[1] 44.19034</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Since the geometric mean at the compliance well is less than </span></span>
<span class="r-in">  <span class="co"># the upper prediction limit, there is no evidence of contamination.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Cleanup</span></span>
<span class="r-in">  <span class="co">#--------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">Chrysene.bkgd</span>, <span class="va">Chrysene.cmpl</span>, <span class="va">UPL</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

