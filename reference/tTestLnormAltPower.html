<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Power of a One- or Two-Sample t-Test Assuming Lognormal Data — tTestLnormAltPower • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Power of a One- or Two-Sample t-Test Assuming Lognormal Data — tTestLnormAltPower"><meta property="og:description" content="Compute the power of a one- or two-sample t-test, given the sample size,
  ratio of means, coefficient of variation, and significance level, assuming
  lognormal data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power of a One- or Two-Sample t-Test Assuming Lognormal Data</h1>

    <div class="hidden name"><code>tTestLnormAltPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the power of a one- or two-sample t-test, given the sample size,
  ratio of means, coefficient of variation, and significance level, assuming
  lognormal data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tTestLnormAltPower</span><span class="op">(</span><span class="va">n.or.n1</span>, n2 <span class="op">=</span> <span class="va">n.or.n1</span>, ratio.of.means <span class="op">=</span> <span class="fl">1</span>, cv <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>    sample.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span>, <span class="st">"two.sample"</span>, <span class="st">"one.sample"</span><span class="op">)</span>, </span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, approx <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n-or-n-">n.or.n1<a class="anchor" aria-label="anchor" href="#arg-n-or-n-"></a></dt>
<dd><p>numeric vector of sample sizes.  When <code>sample.type="one.sample"</code>,
  <code>n.or.n1</code> denotes \(n\), the number of observations in the single sample.  When <br><code>sample.type="two.sample"</code>, <code>n.or.n1</code> denotes \(n_1\), the number
  of observations from group 1.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are <b><em>not</em></b> allowed.</p></dd>

  <dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>numeric vector of sample sizes for group 2.  The default value is the value of
  <code>n.or.n1</code>. This argument is ignored when <code>sample.type="one.sample"</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are <b><em>not</em></b> allowed.</p></dd>

  <dt id="arg-ratio-of-means">ratio.of.means<a class="anchor" aria-label="anchor" href="#arg-ratio-of-means"></a></dt>
<dd><p>numeric vector specifying the ratio of the first mean to the second mean.
  When <code>sample.type="one.sample"</code>, this is the ratio of the population mean to the
  hypothesized mean.  When <code>sample.type="two.sample"</code>, this is the ratio of the
  mean of the first population to the mean of the second population.  The default
  value is <code>ratio.of.means=1</code>.</p></dd>

  <dt id="arg-cv">cv<a class="anchor" aria-label="anchor" href="#arg-cv"></a></dt>
<dd><p>numeric vector of positive value(s) specifying the coefficient of
  variation.  When <code>sample.type="one.sample"</code>, this is the population coefficient
  of variation.  When <code>sample.type="two.sample"</code>, this is the coefficient of
  variation for both the first and second population.  The default value is <code>cv=1</code>.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>numeric vector of numbers between 0 and 1 indicating the Type I error level
  associated with the hypothesis test.  The default value is <code>alpha=0.05</code>.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string indicating whether to compute power based on a one-sample or
  two-sample hypothesis test.  When <code>sample.type="one.sample"</code>, the computed
  power is based on a hypothesis test for a single mean.  When <br><code>sample.type="two.sample"</code>, the computed power is based on a hypothesis test
  for the difference between two means.  The default value is <br><code>sample.type="one.sample"</code> unless the argument <code>n2</code> is supplied.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values
  are <code>"two.sided"</code> (the default), <code>"greater"</code>, and <code>"less"</code>.</p></dd>

  <dt id="arg-approx">approx<a class="anchor" aria-label="anchor" href="#arg-approx"></a></dt>
<dd><p>logical scalar indicating whether to compute the power based on an approximation to
  the non-central t-distribution.  The default value is <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the arguments <code>n.or.n1</code>, <code>n2</code>, <code>ratio.of.means</code>, <code>cv</code>, and
  <code>alpha</code> are not all the same length, they are replicated to be the same length
  as the length of the longest argument.</p>
<p><em>One-Sample Case</em> (<code>sample.type="one.sample"</code>) <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a vector of \(n\)
  observations from a <a href="LognormalAlt.html">lognormal distribution</a> with mean
  \(\theta\) and coefficient of variation \(\tau\), and consider the null hypothesis:
  $$H_0: \theta = \theta_0 \;\;\;\;\;\; (1)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>):
  $$H_a: \theta &gt; \theta_0 \;\;\;\;\;\; (2)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: \theta &lt; \theta_0 \;\;\;\;\;\; (3)$$
  and the two-sided alternative (<code>alternative="two.sided"</code>)
  $$H_a: \theta \ne \theta_0 \;\;\;\;\;\; (4)$$
  To test the null hypothesis (1) versus any of the three alternatives (2)-(4), one
  might be tempted to use <a href="https://rdrr.io/r/stats/t.test.html" class="external-link">Student's t-test</a> based on the
  log-transformed observations.  Unlike the two-sample case with equal coefficients of
  variation (see below), in the one-sample case Student's t-test applied to the
  log-transformed observations will not test the correct hypothesis, as now explained.</p>
<p>Let
  $$y_i = log(x_i), \;\; i = 1, 2, \ldots, n \;\;\;\;\;\; (5)$$
  Then \(\underline{y} = y_1, y_2, \ldots, y_n\) denote \(n\) observations from a
  normal distribution with mean \(\mu\) and standard deviation \(\sigma\), where
  $$\mu = log(\frac{\theta}{\sqrt{\tau^2 + 1}}) \;\;\;\;\;\; (6)$$
  $$\sigma = [log(\tau^2 + 1)]^{1/2} \;\;\;\;\;\; (7)$$
  $$\theta = exp[\mu + (\sigma^2/2)] \;\;\;\;\;\; (8)$$
  $$\tau = [exp(\sigma^2) - 1]^{1/2} \;\;\;\;\;\; (9)$$
  (see the help file for <a href="LognormalAlt.html">LognormalAlt</a>).  Hence, by Equations (6) and (8) above,
  the Student's t-test on the log-transformed data would involve a test of hypothesis
  on both the parameters \(\theta\) and \(\tau\), not just on \(\theta\).</p>
<p>To test the null hypothesis (1) above versus any of the alternatives (2)-(4), you
  can use the function <code><a href="elnormAlt.html">elnormAlt</a></code> to compute a confidence interval for
  \(\theta\), and use the relationship between confidence intervals and hypothesis
  tests.  To test the null hypothesis (1) above versus the upper one-sided alternative
  (2), you can also use
  <a href="chenTTest.html">Chen's modified t-test for skewed distributions</a>.</p>
<p>Although you can't use Student's t-test based on the log-transformed observations to
  test a hypothesis about \(\theta\), you can use the t-distribution to estimate the
  power of a test about \(\theta\) that is based on confidence intervals or
  Chen's modified t-test, if you are willing to assume the population coefficient of
  variation \(\tau\) stays constant for all possible values of \(\theta\) you are
  interested in, and you are willing to postulate possible values for \(\tau\).</p>
<p>First, let's re-write the hypotheses (1)-(4) as follows.  The null hypothesis (1)
  is equivalent to:
  $$H_0: \frac{\theta}{\theta_0} = 1 \;\;\;\;\;\; (10)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>)
  $$H_a: \frac{\theta}{\theta_0} &gt; 1 \;\;\;\;\;\; (11)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: \frac{\theta}{\theta_0} &lt; 1 \;\;\;\;\;\; (12)$$
  and the two-sided alternative (<code>alternative="two.sided"</code>)
  $$H_a: \frac{\theta}{\theta_0} \ne 1 \;\;\;\;\;\; (13)$$
  For a constant coefficient of variation \(\tau\), the standard deviation of the
  log-transformed observations \(\sigma\) is also constant (see Equation (7) above).
  Hence, by Equation (8), the ratio of the true mean to the hypothesized mean can be
  written as:
  $$R = \frac{\theta}{\theta_0} = \frac{exp[\mu + (\sigma^2/2)]}{exp[\mu_0 + (\sigma^2/2)]} = \frac{e^\mu}{e^\mu_0} = e^{\mu - \mu_0} \;\;\;\;\;\; (14)$$
  which only involves the difference
  $$\mu - \mu_0 \;\;\;\;\;\; (15)$$
  Thus, for given values of \(R\) and \(\tau\), the power of the test of the null
  hypothesis (10) against any of the alternatives (11)-(13) can be computed based on
  the power of a one-sample t-test with
  $$\frac{\delta}{\sigma} = \frac{log(R)}{\sqrt{log(\tau^2 + 1)}} \;\;\;\;\;\; (16)$$
  (see the help file for <code><a href="tTestPower.html">tTestPower</a></code>).  Note that for the function
  <code>tTestLnormAltPower</code>, \(R\) corresponds to the argument <code>ratio.of.means</code>,
  and \(\tau\) corresponds to the argument <code>cv</code>.
  <br></p>
<p><em>Two-Sample Case</em> (<code>sample.type="two.sample"</code>) <br>
  Let \(\underline{x}_1 = x_{11}, x_{12}, \ldots, x_{1n_1}\) denote a vector of
  \(n_1\) observations from a <a href="LognormalAlt.html">lognormal distribution</a> with mean
  \(\theta_1\) and coefficient of variaiton \(\tau\), and let
  \(\underline{x}_2 = x_{21}, x_{22}, \ldots, x_{2n_2}\) denote a vector of
  \(n_2\) observations from a lognormal distribution with mean \(\theta_2\) and
  coefficient of variation \(\tau\), and consider the null hypothesis:
  $$H_0: \theta_1 = \theta_2 \;\;\;\;\;\; (17)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>):
  $$H_a: \theta_1 &gt; \theta_2 \;\;\;\;\;\; (18)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: \theta_1 &lt; \theta_2 \;\;\;\;\;\; (19)$$
  and the two-sided alternative (<code>alternative="two.sided"</code>)
  $$H_a: \theta_1 \ne \theta_2 \;\;\;\;\;\; (20)$$
  Because we are assuming the coefficient of variation \(\tau\) is the same for
  both populations, the test of the null hypothesis (17) versus any of the three
  alternatives (18)-(20) can be based on the Student t-statistic using the
  log-transformed observations.</p>
<p>To show this, first, let's re-write the hypotheses (17)-(20) as follows.  The
  null hypothesis (17) is equivalent to:
  $$H_0: \frac{\theta_1}{\theta_2} = 1 \;\;\;\;\;\; (21)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>)
  $$H_a: \frac{\theta_1}{\theta_2} &gt; 1 \;\;\;\;\;\; (22)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: \frac{\theta_1}{\theta_2} &lt; 1 \;\;\;\;\;\; (23)$$
  and the two-sided alternative (<code>alternative="two.sided"</code>)
  $$H_a: \frac{\theta_1}{\theta_2} \ne 1 \;\;\;\;\;\; (24)$$
  If coefficient of variation \(\tau\) is the same for both populations, then the
  standard deviation of the log-transformed observations \(\sigma\) is also the
  same for both populations (see Equation (7) above).  Hence, by Equation (8), the
  ratio of the means can be written as:
  $$R = \frac{\theta_1}{\theta_2} = \frac{exp[\mu_1 + (\sigma^2/2)]}{exp[\mu_2 + (\sigma^2/2)]} = \frac{e^\mu_1}{e^\mu_2} = e^{\mu_1 - \mu_2} \;\;\;\;\;\; (25)$$
  which only involves the difference
  $$\mu_1 - \mu_2 \;\;\;\;\;\; (26)$$
  Thus, for given values of \(R\) and \(\tau\), the power of the test of the null
  hypothesis (21) against any of the alternatives (22)-(24) can be computed based on
  the power of a two-sample t-test with
  $$\frac{\delta}{\sigma} = \frac{log(R)}{\sqrt{log(\tau^2 + 1)}} \;\;\;\;\;\; (27)$$
  (see the help file for <code><a href="tTestPower.html">tTestPower</a></code>).  Note that for the function
  <code>tTestLnormAltPower</code>, \(R\) corresponds to the argument <code>ratio.of.means</code>,
  and \(\tau\) corresponds to the argument <code>cv</code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a numeric vector powers.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>van Belle, G., and D.C. Martin. (1993).  Sample Size as a Function of Coefficient
  of Variation and Ratio of Means.  <em>The American Statistician</em> <b>47</b>(3),
  165–167.</p>
<p>Also see the list of references in the help file for <code><a href="tTestPower.html">tTestPower</a></code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> and
  <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">lognormal distribution</a> are probably the two most
  frequently used distributions to model environmental data.  Often, you need to
  determine whether a population mean is significantly different from a specified
  standard (e.g., an MCL or ACL, USEPA, 1989b, Section 6), or whether two different
  means are significantly different from each other (e.g., USEPA 2009, Chapter 16).
  When you have lognormally-distributed data, you have to be careful about making
  statements regarding inference for the mean.  For the two-sample case with
  assumed equal coefficients of variation, you can perform the
  <a href="https://rdrr.io/r/stats/t.test.html" class="external-link">Student's t-test</a> on the log-transformed observations.
  For the one-sample case, you can perform a hypothesis test by constructing a
  confidence interval for the mean using <code><a href="elnormAlt.html">elnormAlt</a></code>, or use
  <a href="chenTTest.html">Chen's t-test modified for skewed data</a>.</p>
<p>In the course of designing a sampling program, an environmental scientist may wish
  to determine the relationship between sample size, significance level, power, and
  scaled difference if one of the objectives of the sampling program is to determine
  whether a mean differs from a specified level or two means differ from each other.
  The functions <code>tTestLnormAltPower</code>, <code><a href="tTestLnormAltN.html">tTestLnormAltN</a></code>,
  <code><a href="tTestLnormAltRatioOfMeans.html">tTestLnormAltRatioOfMeans</a></code>, and <code><a href="plotTTestLnormAltDesign.html">plotTTestLnormAltDesign</a></code>
  can be used to investigate these relationships for the case of
  lognormally-distributed observations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="tTestLnormAltN.html">tTestLnormAltN</a></code>, <code><a href="tTestLnormAltRatioOfMeans.html">tTestLnormAltRatioOfMeans</a></code>,
  <code><a href="plotTTestLnormAltDesign.html">plotTTestLnormAltDesign</a></code>, <a href="LognormalAlt.html">LognormalAlt</a>,
  <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>, <a href="FcnsByCatHypothTests.html">Hypothesis Tests</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at how the power of the one-sample test increases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># sample size:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5 10 15 20 25 30</span>
<span class="r-in"><span>  <span class="co">#[1]  5 10 15 20 25 30 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestLnormAltPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    ratio.of.means <span class="op">=</span> <span class="fl">1.5</span>, cv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.14 0.28 0.42 0.54 0.65 0.73</span>
<span class="r-in"><span>  <span class="co">#[1] 0.14 0.28 0.42 0.54 0.65 0.73</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the last example, but use the approximation to the power instead of the </span></span></span>
<span class="r-in"><span>  <span class="co"># exact power.  Note how the approximation underestimates the true power for </span></span></span>
<span class="r-in"><span>  <span class="co"># the smaller sample sizes:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestLnormAltPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    ratio.of.means <span class="op">=</span> <span class="fl">1.5</span>, cv <span class="op">=</span> <span class="fl">1</span>, approx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09 0.25 0.40 0.53 0.64 0.73</span>
<span class="r-in"><span>  <span class="co">#[1] 0.09 0.25 0.40 0.53 0.64 0.73</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of the two-sample t-test increases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># ratio of means:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestLnormAltPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">20</span>, sample.type <span class="op">=</span> <span class="st">"two"</span>, </span></span>
<span class="r-in"><span>    ratio.of.means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span>, cv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06 0.32 0.73</span>
<span class="r-in"><span>  <span class="co">#[1] 0.06 0.32 0.73</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of the two-sample t-test increases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># values of Type I error:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestLnormAltPower</span><span class="op">(</span><span class="fl">30</span>, sample.type <span class="op">=</span> <span class="st">"two"</span>, ratio.of.means <span class="op">=</span> <span class="fl">1.5</span>, </span></span>
<span class="r-in"><span>    cv <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.07 0.23 0.46 0.59</span>
<span class="r-in"><span>  <span class="co">#[1] 0.07 0.23 0.46 0.59</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The guidance document Soil Screening Guidance: Technical Background Document </span></span></span>
<span class="r-in"><span>  <span class="co"># (USEPA, 1996c, Part 4) discusses sampling design and sample size calculations </span></span></span>
<span class="r-in"><span>  <span class="co"># for studies to determine whether the soil at a potentially contaminated site </span></span></span>
<span class="r-in"><span>  <span class="co"># needs to be investigated for possible remedial action. Let 'theta' denote the </span></span></span>
<span class="r-in"><span>  <span class="co"># average concentration of the chemical of concern.  The guidance document </span></span></span>
<span class="r-in"><span>  <span class="co"># establishes the following goals for the decision rule (USEPA, 1996c, p.87):</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#     Pr[Decide Don't Investigate | theta &gt; 2 * SSL] = 0.05</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#     Pr[Decide to Investigate | theta &lt;= (SSL/2)] = 0.2</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># where SSL denotes the pre-established soil screening level.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># These goals translate into a Type I error of 0.2 for the null hypothesis</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#     H0: [theta / (SSL/2)] &lt;= 1</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># and a power of 95% for the specific alternative hypothesis</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#     Ha: [theta / (SSL/2)] = 4</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># Assuming a lognormal distribution with a coefficient of variation of 2, </span></span></span>
<span class="r-in"><span>  <span class="co"># determine the power associated with various sample sizes for this one-sample test. </span></span></span>
<span class="r-in"><span>  <span class="co"># Based on these calculations, you need to take at least 6 soil samples to </span></span></span>
<span class="r-in"><span>  <span class="co"># satisfy the requirements for the Type I and Type II errors.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestLnormAltPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>, ratio.of.means <span class="op">=</span> <span class="fl">4</span>, cv <span class="op">=</span> <span class="fl">2</span>, </span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">0.2</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"N="</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  N=2  N=3  N=4  N=5  N=6  N=7  N=8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.65 0.80 0.88 0.93 0.96 0.97 0.98 </span>
<span class="r-in"><span>  <span class="co"># N=2  N=3  N=4  N=5  N=6  N=7  N=8 </span></span></span>
<span class="r-in"><span>  <span class="co">#0.65 0.80 0.88 0.93 0.96 0.97 0.98</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the last example, but use the approximate power calculation instead of </span></span></span>
<span class="r-in"><span>  <span class="co"># the exact one.  Using the approximate power calculation, you need at least </span></span></span>
<span class="r-in"><span>  <span class="co"># 7 soil samples instead of 6 (because the approximation underestimates the power).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestLnormAltPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>, ratio.of.means <span class="op">=</span> <span class="fl">4</span>, cv <span class="op">=</span> <span class="fl">2</span>, </span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">0.2</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, approx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"N="</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">8</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  N=2  N=3  N=4  N=5  N=6  N=7  N=8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.55 0.75 0.84 0.90 0.93 0.95 0.97 </span>
<span class="r-in"><span>  <span class="co"># N=2  N=3  N=4  N=5  N=6  N=7  N=8 </span></span></span>
<span class="r-in"><span>  <span class="co">#0.55 0.75 0.84 0.90 0.93 0.95 0.97</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

