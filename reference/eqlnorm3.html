<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Quantiles of a Three-Parameter Lognormal Distribution — eqlnorm3 • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Quantiles of a Three-Parameter Lognormal Distribution — eqlnorm3"><meta property="og:description" content="Estimate quantiles of a three-parameter lognormal distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Quantiles of a Three-Parameter Lognormal Distribution</h1>

    <div class="hidden name"><code>eqlnorm3.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate quantiles of a <a href="Lognormal3.html">three-parameter lognormal distribution</a>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eqlnorm3</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">0.5</span>, method <span class="op">=</span> <span class="st">"lmle"</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector of observations, or an object resulting from a call to an
  estimating function that assumes a three-parameter lognormal distribution
  (e.g., <code><a href="elnorm3.html">elnorm3</a></code>). If <code>x</code> is a numeric vector,
  missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are allowed but will be removed.</p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>numeric vector of probabilities for which quantiles will be estimated.
  All values of <code>p</code> must be between 0 and 1.  When <code>ci=TRUE</code>, <code>p</code>
  must be a scalar. The default value is <code>p=0.5</code>.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string specifying the method of estimating the distribution parameters.
  Possible values are
  <code>"lmle"</code> (local maximum likelihood; the default), <code>"mme"</code>
  (method of moments), <code>"mmue"</code> (method of moments using an unbaised
  estimate of variance), <code>"mmme"</code> (modified method of moments due to Cohen
  and Whitten (1980)), <code>"zero.skew"</code> (zero-skewness estimator due to
  Griffiths (1980)), and <code>"royston.skew"</code> (estimator based on
  Royston's (1992b) index of skewness).  See the DETAILS section of the help file
  for <code><a href="elnorm3.html">elnorm3</a></code> for more information on these estimation methods.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>an integer indicating the number of decimal places to round to when printing out
  the value of <code>100*p</code>. The default value is <code>digits=0</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or
  infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to
  performing the estimation.</p>
<p>Quantiles are estimated by 1) estimating the distribution parameters by
  calling <code><a href="elnorm3.html">elnorm3</a></code>, and then 2) calling the function
  <code><a href="Lognormal3.html">qlnorm3</a></code> and using the estimated distribution
  parameters.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>x</code> is a numeric vector, <code>eqlnorm3</code> returns a
  list of class <code>"estimate"</code> containing the estimated quantile(s) and other
  information. See <code><a href="estimate.object.html">estimate.object</a></code> for details.</p>
<p>If <code>x</code> is the result of calling an estimation function, <code>eqlnorm3</code>
  returns a list whose class is the same as <code>x</code>.  The list
  contains the same components as <code>x</code>, as well as components called
  <code>quantiles</code> and <code>quantile.method</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Aitchison, J., and J.A.C. Brown (1957).  <em>The Lognormal Distribution
  (with special references to its uses in economics)</em>.  Cambridge University Press,
  London, Chapter 5.</p>
<p>Calitz, F. (1973).  Maximum Likelihood Estimation of the Parameters of the
  Three-Parameter Lognormal Distribution–a Reconsideration.  <em>Australian
  Journal of Statistics</em> <b>15</b>(3), 185–190.</p>
<p>Cohen, A.C. (1951).  Estimating Parameters of Logarithmic-Normal Distributions by
  Maximum Likelihood.  <em>Journal of the American Statistical Association</em>
  <b>46</b>, 206–212.</p>
<p>Cohen, A.C. (1988).  Three-Parameter Estimation.  In Crow, E.L., and K. Shimizu, eds.
  <em>Lognormal Distributions: Theory and Applications</em>.  Marcel Dekker, New York,
  Chapter 4.</p>
<p>Cohen, A.C., and B.J. Whitten. (1980).  Estimation in the Three-Parameter Lognormal
  Distribution.  <em>Journal of the American Statistical Association</em> <b>75</b>,
  399–404.</p>
<p>Cohen, A.C., B.J. Whitten, and Y. Ding. (1985).  Modified Moment Estimation for the
  Three-Parameter Lognormal Distribution.  <em>Journal of Quality Technology</em>
  <b>17</b>, 92–99.</p>
<p>Crow, E.L., and K. Shimizu. (1988).  <em>Lognormal Distributions: Theory and
  Applications</em>.  Marcel Dekker, New York, Chapter 2.</p>
<p>Griffiths, D.A. (1980).  Interval Estimation for the Three-Parameter Lognormal
  Distribution via the Likelihood Function.  <em>Applied Statistics</em> <b>29</b>,
  58–68.</p>
<p>Harter, H.L., and A.H. Moore. (1966).  Local-Maximum-Likelihood Estimation of the
  Parameters of Three-Parameter Lognormal Populations from Complete and Censored
  Samples.  <em>Journal of the American Statistical Association</em> <b>61</b>, 842–851.</p>
<p>Heyde, C.C. (1963).  On a Property of the Lognormal Distribution.  <em>Journal of
  the Royal Statistical Society, Series B</em> <b>25</b>, 392–393.</p>
<p>Hill, .B.M. (1963).  The Three-Parameter Lognormal Distribution and Bayesian
  Analysis of a Point-Source Epidemic.  <em>Journal of the American Statistical
  Association</em> <b>58</b>, 72–84.</p>
<p>Hoshi, K., J.R. Stedinger, and J. Burges. (1984).  Estimation of Log-Normal
  Quantiles: Monte Carlo Results and First-Order Approximations.  <em>Journal of
  Hydrology</em> <b>71</b>, 1–30.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1994).
  <em>Continuous Univariate Distributions, Volume 1</em>.
  Second Edition. John Wiley and Sons, New York.</p>
<p>Royston, J.P. (1992b).  Estimation, Reference Ranges and Goodness of Fit for the
  Three-Parameter Log-Normal Distribution.  <em>Statistics in Medicine</em> <b>11</b>,
  897–912.</p>
<p>Stedinger, J.R. (1980).  Fitting Lognormal Distributions to Hydrologic Data.
  <em>Water Resources Research</em> <b>16</b>(3), 481–490.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The problem of estimating the parameters of a three-parameter lognormal distribution
  has been extensively discussed by Aitchison and Brown (1957, Chapter 6),
  Calitz (1973), Cohen (1951), Cohen (1988), Cohen and Whitten (1980),
  Cohen et al. (1985), Griffiths (1980), Harter and Moore (1966), Hill (1963), and
  Royston (1992b).  Stedinger (1980) and Hoshi et al. (1984) discuss fitting the
  three-parameter lognormal distribution to hydrologic data.</p>
<p>The global maximum likelihood estimates are inadmissible.  In the past, several
  researchers have found that the local maximum likelihood estimates (lmle's)
  occasionally fail because of convergence problems, but they were not using the
  likelihood profile and reparameterization of Griffiths (1980).  Cohen (1988)
  recommends the modified methods of moments estimators over lmle's because they are
  easy to compute, they are unbiased with respect to \(\mu\) and \(\sigma^2\) (the
  mean and standard deviation on the log-scale), their variances are minimal or near
  minimal, and they do not suffer from regularity problems.</p>
<p>Because the distribution of the lmle of the threshold parameter \(\gamma\) is far
  from normal for moderate sample sizes (Griffiths, 1980), it is questionable whether
  confidence intervals for \(\gamma\) or the median based on asymptotic variances
  and covariances will perform well.  Cohen and Whitten (1980) and Cohen et al. (1985),
  however, found that the asymptotic variances and covariances are reasonably close to
  corresponding simulated variances and covariances for the modified method of moments
  estimators (<code>method="mmme"</code>).  In a simulation study (5000 monte carlo trials),
  Royston (1992b) found that the coverage of confidence intervals for \(\gamma\)
  based on the likelihood profile (<code>ci.method="likelihood.profile"</code>) was very
  close the nominal level (94.1% for a nominal level of 95%), although not
  symmetric.  Royston (1992b) also found that the coverage of confidence intervals
  for \(\gamma\) based on the skewness method (<code>ci.method="skewness"</code>) was also
  very close (95.4%) and symmetric.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="elnorm3.html">elnorm3</a></code>, <a href="Lognormal3.html">Lognormal3</a>, <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">Lognormal</a>,
  <a href="LognormalAlt.html">LognormalAlt</a>, <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a 3-parameter lognormal distribution </span></span></span>
<span class="r-in"><span>  <span class="co"># with parameters meanlog=1.5, sdlog=1, and threshold=10, then use </span></span></span>
<span class="r-in"><span>  <span class="co"># Cohen and Whitten's (1980) modified moments estimators to estimate </span></span></span>
<span class="r-in"><span>  <span class="co"># the parameters, and estimate the 90th percentile. </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="Lognormal3.html">rlnorm3</a></span><span class="op">(</span><span class="fl">20</span>, meanlog <span class="op">=</span> <span class="fl">1.5</span>, sdlog <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu">eqlnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"mmme"</span>, p <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "3-Parameter Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.5206664 0.5330974 9.6620403 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mmme"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   18.72194 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Quantile(s) Based on\n                                 mmme Estimators"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            3-Parameter Lognormal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          meanlog   = 1.5206664</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sdlog     = 0.5330974</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 threshold = 9.6620403</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mmme</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           90'th %ile = 18.72194</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Quantile(s) Based on</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 mmme Estimators</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

