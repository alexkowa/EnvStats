<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Chen's Modified One-Sided t-test for Skewed Distributions — chenTTest • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Chen's Modified One-Sided t-test for Skewed Distributions — chenTTest"><meta property="og:description" content="For a skewed distribution, estimate the mean, standard deviation, and skew;
  test the null hypothesis that the mean is equal to a user-specified value vs.
  a one-sided alternative; and create a one-sided confidence interval for the mean."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Chen's Modified One-Sided t-test for Skewed Distributions</h1>

    <div class="hidden name"><code>chenTTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For a skewed distribution, estimate the mean, standard deviation, and skew;
  test the null hypothesis that the mean is equal to a user-specified value vs.
  a one-sided alternative; and create a one-sided confidence interval for the mean.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">chenTTest</span><span class="op">(</span><span class="va">x</span>, y <span class="op">=</span> <span class="cn">NULL</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, mu <span class="op">=</span> <span class="fl">0</span>, paired <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, </span>
<span>    conf.level <span class="op">=</span> <span class="fl">0.95</span>, ci.method <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>optional numeric vector of observations that are paired with the observations in
  <code>x</code>.  The length of <code>y</code> must be the same as the length of <code>x</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are allowed but will be removed.  This argument is ignored if
  <code>paired=FALSE</code>, and must be supplied if <code>paired=TRUE</code>.  The default value
  is <code>y=NULL</code>.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values
  are <code>"greater"</code> (the default) and <code>"less"</code>. The value <code>"greater"</code>
  should be used for positively-skewed distributions, and the value <code>"less"</code>
  should be used for negatively-skewed distributions.</p></dd>

  <dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>numeric scalar indicating the hypothesized value of the mean.  The default value is
  <code>mu=0</code>.</p></dd>

  <dt id="arg-paired">paired<a class="anchor" aria-label="anchor" href="#arg-paired"></a></dt>
<dd><p>character string indicating whether to perform a paired or one-sample t-test.  The
  possible values are <code>paired=FALSE</code> (the default; indicates a one-sample t-test)
  and <code>paired=TRUE</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>numeric scalar between 0 and 1 indicating the confidence level associated with the
  confidence interval for the population mean.  The default value is <br><code>conf.level=0.95</code>.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating which critical value to use to construct the confidence
  interval for the mean.  The possible values are <code>"z"</code> (the default),
  <code>"t"</code>, and <code>"Avg. of z and t"</code>.  See the DETAILS section below for more
  information.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><b>One-Sample Case</b> (<code>paired=FALSE</code>) <br>
  Let \(\underline{x} = (x_1, x_2, \ldots, x_n)\) be a vector of \(n\) independent
  and identically distributed (i.i.d.) observations from some distribution with mean
  \(\mu\) and standard deviation \(\sigma\).
  <br></p>
<p><em>Background: The Conventional Student's t-Test</em> <br>
  Assume that the \(n\) observations come from a normal (Gaussian) distribution, and
  consider the test of the null hypothesis:
  $$H_0: \mu = \mu_0 \;\;\;\;\;\; (1)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>):
  $$H_a: \mu &gt; \mu_0 \;\;\;\;\;\; (2)$$
  the lower one-sided alternative (<code>alternative="less"</code>):
  $$H_a: \mu &lt; \mu_0 \;\;\;\;\;\; (3)$$
  and the two-sided alternative:
  $$H_a: \mu \ne \mu_0 \;\;\;\;\;\; (4)$$
  The test of the null hypothesis (1) versus any of the three alternatives (2)-(4)
  is usually based on the Student t-statistic:
  $$t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}} \;\;\;\;\;\; (5)$$
  where
  $$\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i \;\;\;\;\;\; (6)$$
  $$s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (7)$$
  (see the <span style="R">R</span> help file for <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>).  Under the null hypothesis (1),
  the t-statistic in (5) follows a <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with
  \(n-1\) degrees of freedom (Zar, 2010, p.99; Johnson et al., 1995, pp.362-363).
  The t-statistic is fairly robust to departures from normality in terms of
  maintaining Type I error and power, provided that the sample size is sufficiently
  large.
  <br></p>
<p><em>Chen's Modified t-Test for Skewed Distributions</em> <br>
  In the case when the underlying distribution of the \(n\) observations is
  positively skewed and the sample size is small, the sampling distribution of the
  t-statistic under the null hypothesis (1) does not follow a Student's t-distribution,
  but is instead negatively skewed.  For the test against the upper alternative in (2)
  above, this leads to a Type I error smaller than the one assumed and a loss of power
  (Chen, 1995b, p.767).</p>
<p>Similarly, in the case when the underlying distribution of the \(n\) observations
  is negatively skewed and the sample size is small, the sampling distribution of the
  t-statistic is positively skewed.  For the test against the lower alternative in (3)
  above, this also leads to a Type I error smaller than the one assumed and a loss of
  power.</p>
<p>In order to overcome these problems, Chen (1995b) proposed the following modified
  t-statistic that takes into account the skew of the underlying distribution:
  $$t_2 = t + a(1 + 2t^2) + 4a^2(t + 2t^3) \;\;\;\;\;\; (8)$$
  where
  $$a = \frac{\sqrt{\hat{\beta}_1}}{6n} \;\;\;\;\;\; (9)$$
  $$\hat{\beta}_1 = \frac{\hat{\mu}_3}{\hat{\sigma}^3} \;\;\;\;\;\; (10)$$
  $$\hat{\mu}_3 = \frac{n}{(n-1)(n-2)} \sum_{i=1}^n (x_i - \bar{x})^3 \;\;\;\;\;\; (11)$$
  $$\hat{\sigma}^3 = s^3 = [\frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2]^{3/2} \;\;\;\;\;\; (12)$$
  Note that the quantity \(\sqrt{\hat{\beta}_1}\) in (9) is an estimate of
  the skew of the underlying distribution and is based on unbiased estimators of
  central moments (see the help file for <code><a href="skewness.html">skewness</a></code>).</p>
<p>For a positively-skewed distribution, Chen's modified t-test rejects the null
  hypothesis (1) in favor of the upper one-sided alternative (2) if the t-statistic in
  (8) is too large.  For a negatively-skewed distribution, Chen's modified t-test
  rejects the null hypothesis (1) in favor of the lower one-sided alternative (3) if
  the t-statistic in (8) is too small.</p>
<p>Chen's modified t-test is <b>not</b> applicable to testing the two-sided alternative
  (4).  It should also <b>not</b> be used to test the upper one-sided alternative (2)
  based on negatively-skewed data, nor should it be used to test the lower one-sided
  alternative (3) based on positively-skewed data.
  <br></p>
<p><em>Determination of Critical Values and p-Values</em> <br>
  Chen (1995b) performed a simulation study in which the modified t-statistic in (8)
  was compared to a critical value based on the normal distribution (z-value),
  a critical value based on Student's t-distribution (t-value), and the average of the
  critical z-value and t-value.  Based on the simulation study, Chen (1995b) suggests
  using either the z-value or average of the z-value and t-value when \(n\)
  (the sample size) is small (e.g., \(n \le 10\)) or \(\alpha\) (the Type I error)
  is small (e.g. \(\alpha \le 0.01\)), and using either the t-value or the average
  of the z-value and t-value when \(n \ge 20\) or \(\alpha \ge 0.05\).</p>
<p>The function <code>chenTTest</code> returns three different p-values:  one based on the
  normal distribution, one based on Student's t-distribution, and one based on the
  average of these two p-values.  This last p-value should roughly correspond to a
  p-value based on the distribution of the average of a normal and Student's t
  random variable.
  <br></p>
<p><em>Computing Confidence Intervals</em> <br>
  The function <code>chenTTest</code> computes a one-sided confidence interval for the true
  mean \(\mu\) based on finding all possible values of \(\mu\) for which the null
  hypothesis (1) will not be rejected, with the confidence level determined by the
  argument <code>conf.level</code>.  The argument <code>ci.method</code> determines which p-value
  is used in the algorithm to determine the bounds on \(\mu\).  When
  <code>ci.method="z"</code>, the p-value is based on the normal distribution, when
  <code>ci.method="t"</code>, the p-value is based on Student's t-distribution, and when
  <code>ci.method="Avg. of z and t"</code> the p-value is based on the average of the
  p-values based on the normal and Student's t-distribution.
  <br></p>
<p><b>Paired-Sample Case</b> (<code>paired=TRUE</code>) <br>
  When the argument <code>paired=TRUE</code>, the arguments <code>x</code> and <code>y</code> are assumed
  to have the same length, and the \(n\) differences
  $$d_i = x_i - y_i, \;\; i = 1, 2, \ldots, n$$
  are assumed to be i.i.d. observations from some distribution with mean \(\mu\)
  and standard deviation \(\sigma\).  Chen's modified t-test can then be applied
  to the differences.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"htest"</code> containing the results of the hypothesis test.  See
  the help file for <code><a href="htest.object.html">htest.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chen, L. (1995b).  Testing the Mean of Skewed Distributions.
  <em>Journal of the American Statistical Association</em> <b>90</b>(430), 767–772.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1995).  <em>Continuous Univariate
  Distributions, Volume 2</em>.  Second Edition.  John Wiley and Sons, New York,
  Chapters 28, 31.</p>
<p>Land, C.E. (1971).  Confidence Intervals for Linear Functions of the Normal Mean and
  Variance.  <em>The Annals of Mathematical Statistics</em> <b>42</b>(4), 1187–1205.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001).
  <em>Environmental Statistics with S-PLUS</em>.  CRC Press, Boca Raton, FL, pp.402–404.</p>
<p>Singh, A., N. Armbya, and A. Singh. (2010b).
  <em>ProUCL Version 4.1.00 Technical Guide (Draft)</em>. EPA/600/R-07/041, May 2010.
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (1996c).  <em>Soil Screening Guidance: Technical Background Document</em>.
  EPA/540/R-95/128, PB96963502. Office of Emergency and Remedial Response, U.S.
  Environmental Protection Agency, Washington, D.C., May, 1996.</p>
<p>USEPA. (2002d).  <em>Estimation of the Exposure Point Concentration Term Using a
  Gamma Distribution</em>.
  EPA/600/R-02/084. October 2002. Technology Support Center for Monitoring and
  Site Characterization, Office of Research and Development, Office of Solid Waste and
  Emergency Response, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zar, J.H. (2010).  <em>Biostatistical Analysis</em>.  Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The presentation of Chen's (1995b) method in USEPA (2002d) and Singh et
  al. (2010b, p. 52) is incorrect for two reasons: it is based on an intermediate
  formula instead of the actual statistic that Chen proposes, and it uses the
  intermediate formula to compute an <em>upper</em> confidence limit for the mean when
  the sample data are positively skewed.  As explained above, for the case of
  positively skewed data, Chen's method is appropriate to test the upper one-sided
  alternative hypothesis that the population mean is greater than some specified
  value, and a one-sided upper alternative corresponds to creating a one-sided
  <em>lower</em> confidence limit, not an upper confidence limit (see, for example,
  Millard and Neerchal, 2001, p. 371).</p>
<p>A frequent question in environmental statistics is “Is the concentration of
  chemical X greater than Y units?”  For example, in groundwater assessment
  (compliance) monitoring at hazardous and solid waste sites, the concentration of
  a chemical in the groundwater at a downgradient may be compared to a
  groundwater protection standard (GWPS).  If the concentration is “above”
  the GWPS, then the site enters corrective action monitoring.  As another example,
  soil screening at a Superfund site involves comparing the concentration of a
  chemical in the soil with a pre-determined soil screening level (SSL).  If the
  concentration is “above” the SSL, then further investigation and possible
  remedial action is required.  Determining what it means for the chemical
  concentration to be “above” a GWPS or an SSL is a policy decision:  the
  average of the distribution of the chemical concentration must be above the GWPS or
  SSL, or the median must be above the GWPS or SSL, or the 95'th percentile must be
  above the GWPS or SSL, or something else.  Often, the first interpretation is used.</p>
<p>The regulatory guidance document <em>Soil Screening Guidance:  Technical
  Background Document</em> (USEPA, 1996c, Part 4) recommends using Chen's t-test as one
  possible method to compare chemical concentrations in soil samples to a soil
  screening level (SSL).  The document notes that the distribution of chemical
  concentrations will almost always be positively-skewed, but not necessarily fit a
  lognormal distribution well (USEPA, 1996c, pp.107, 117-119).  It also notes that
  using a confidence interval based on Land's (1971) method is extremely sensitive
  to the assumption of a lognormal distribution, while Chen's test is robust with
  respect to maintaining Type I and Type II errors for a variety of positively-skewed
  distributions (USEPA, 1996c, pp.99, 117-119, 123-125).</p>
<p>Hypothesis tests you can use to perform tests of location include:
  <a href="https://rdrr.io/r/stats/t.test.html" class="external-link">Student's t-test</a>,
  <a href="oneSamplePermutationTest.html">Fisher's randomization test</a>,
  <a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">the Wilcoxon signed rank test</a>,
  Chen's modified t-test,
  <a href="signTest.html">the sign test</a>, and a test based on a
  bootstrap confidence interval.
  For a discussion comparing the performance of these tests, see
  Millard and Neerchal (2001, pp.408–409).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>, <code><a href="elnorm.html">elnorm</a></code>, <code><a href="elnormAlt.html">elnormAlt</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># The guidance document "Calculating Upper Confidence Limits for </span></span></span>
<span class="r-in"><span>  <span class="co"># Exposure Point Concentrations at Hazardous Waste Sites" </span></span></span>
<span class="r-in"><span>  <span class="co"># (USEPA, 2002d, Exhibit 9, p. 16) contains an example of 60 observations </span></span></span>
<span class="r-in"><span>  <span class="co"># from an exposure unit.  Here we will use Chen's modified t-test to test </span></span></span>
<span class="r-in"><span>  <span class="co"># the null hypothesis that the average concentration is less than 30 mg/L </span></span></span>
<span class="r-in"><span>  <span class="co"># versus the alternative that it is greater than 30 mg/L.</span></span></span>
<span class="r-in"><span>  <span class="co"># In EnvStats these data are stored in the vector EPA.02d.Ex.9.mg.per.L.vec.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">EPA.02d.Ex.9.mg.per.L.vec</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  16  17  17  17  18  18  20  20  20  21  21  21  21  21  21  22  22  22  23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20]  23  23  23  24  24  24  25  25  25  25  25  25  26  26  26  26  27  27  28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39]  28  28  28  29  29  30  30  31  32  32  32  33  33  35  35  97  98 105 107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58] 111 117 119</span>
<span class="r-in"><span>  <span class="co"># [1]  16  17  17  17  18  18  20  20  20  21  21  21  21  21  21  22</span></span></span>
<span class="r-in"><span>  <span class="co">#[17]  22  22  23  23  23  23  24  24  24  25  25  25  25  25  25  26</span></span></span>
<span class="r-in"><span>  <span class="co">#[33]  26  26  26  27  27  28  28  28  28  29  29  30  30  31  32  32</span></span></span>
<span class="r-in"><span>  <span class="co">#[49]  32  33  33  35  35  97  98 105 107 111 117 119</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">EPA.02d.Ex.9.mg.per.L.vec</span>, col <span class="op">=</span> <span class="st">"cyan"</span>, xlab <span class="op">=</span> <span class="st">"Concentration (mg/L)"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The Shapiro-Wilk goodness-of-fit test rejects the null hypothesis of a </span></span></span>
<span class="r-in"><span>  <span class="co"># normal, lognormal, and gamma distribution:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">EPA.02d.Ex.9.mg.per.L.vec</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.496781e-12</span>
<span class="r-in"><span>  <span class="co">#[1] 2.496781e-12</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">EPA.02d.Ex.9.mg.per.L.vec</span>, dist <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.349035e-09</span>
<span class="r-in"><span>  <span class="co">#[1] 3.349035e-09</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">EPA.02d.Ex.9.mg.per.L.vec</span>, dist <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.564341e-10</span>
<span class="r-in"><span>  <span class="co">#[1] 1.564341e-10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Use Chen's modified t-test to test the null hypothesis that</span></span></span>
<span class="r-in"><span>  <span class="co"># the average concentration is less than 30 mg/L versus the </span></span></span>
<span class="r-in"><span>  <span class="co"># alternative that it is greater than 30 mg/L.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">chenTTest</span><span class="op">(</span><span class="va">EPA.02d.Ex.9.mg.per.L.vec</span>, mu <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        t </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.574075 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               z               t Avg. of z and t </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0.05773508      0.06040889      0.05907199 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd      skew </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34.566667 27.330598  2.365778 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "greater"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "One-sample t-Test\n                                 Modified for\n                                 Positively-Skewed Distributions\n                                 (Chen, 1995)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "EPA.02d.Ex.9.mg.per.L.vec"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   LCL   UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29.82   Inf </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lower"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Based on z"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "htestEnvStats"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 mean = 30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True mean is greater than 30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       One-sample t-Test</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Modified for</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Positively-Skewed Distributions</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (Chen, 1995)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 34.566667</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   = 27.330598</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 skew =  2.365778</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            EPA.02d.Ex.9.mg.per.L.vec</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     60</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  t = 1.574075</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic Parameter:        df = 59</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-values:                        z               = 0.05773508</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 t               = 0.06040889</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Avg. of z and t = 0.05907199</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Based on z</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        Lower</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 29.82</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL =   Inf</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The estimated mean, standard deviation, and skew are 35, 27, and 2.4, </span></span></span>
<span class="r-in"><span>  <span class="co"># respectively.  The p-value is 0.06, and the lower 95% confidence interval </span></span></span>
<span class="r-in"><span>  <span class="co"># is [29.8, Inf).  Depending on what you use for your Type I error rate, you </span></span></span>
<span class="r-in"><span>  <span class="co"># may or may not want to reject the null hypothesis.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

