<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Mean, Standard Deviation, and Standard Error Nonparametrically Based on Censored Data — enparCensored • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Mean, Standard Deviation, and Standard Error Nonparametrically Based on Censored Data — enparCensored"><meta property="og:description" content="Estimate the mean, standard deviation, and standard error of the mean
  nonparametrically given a sample of data from a positive-valued distribution
  that has been subjected to left- or right-censoring, and optionally construct
  a confidence interval for the mean."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Mean, Standard Deviation, and Standard Error Nonparametrically Based on Censored Data</h1>

    <div class="hidden name"><code>enparCensored.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the mean, standard deviation, and standard error of the mean
  nonparametrically given a sample of data from a positive-valued distribution
  that has been subjected to left- or right-censoring, and optionally construct
  a confidence interval for the mean.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">enparCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, censoring.side <span class="op">=</span> <span class="st">"left"</span>, correct.se <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    restricted <span class="op">=</span> <span class="cn">FALSE</span>, left.censored.min <span class="op">=</span> <span class="st">"Censoring Level"</span>, </span>
<span>    right.censored.max <span class="op">=</span> <span class="st">"Censoring Level"</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    ci.method <span class="op">=</span> <span class="st">"normal.approx"</span>, ci.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    pivot.statistic <span class="op">=</span> <span class="st">"t"</span>, ci.sample.size <span class="op">=</span> <span class="st">"Total"</span>, n.bootstraps <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>    seed <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of positive-valued observations.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-censored">censored<a class="anchor" aria-label="anchor" href="#arg-censored"></a></dt>
<dd><p>numeric or logical vector indicating which values of <code>x</code> are censored.
  This must be the same length as <code>x</code>.  If the mode of <code>censored</code> is
  <code>"logical"</code>, <code>TRUE</code> values correspond to elements of <code>x</code> that
  are censored, and <code>FALSE</code> values correspond to elements of <code>x</code> that
  are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>,
  it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to
  <code>TRUE</code> and <code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>)
  values are allowed but will be removed.</p></dd>

  <dt id="arg-censoring-side">censoring.side<a class="anchor" aria-label="anchor" href="#arg-censoring-side"></a></dt>
<dd><p>character string indicating on which side the censoring occurs.  The possible
  values are <code>"left"</code> (the default) and <code>"right"</code>.</p></dd>

  <dt id="arg-correct-se">correct.se<a class="anchor" aria-label="anchor" href="#arg-correct-se"></a></dt>
<dd><p>logical scalar indicating whether to multiply the estimated standard error
  by a factor to correct for bias.  The default value is <code>correct.se=TRUE</code>.
  See the DETAILS section below.</p></dd>

  <dt id="arg-restricted">restricted<a class="anchor" aria-label="anchor" href="#arg-restricted"></a></dt>
<dd><p>logical scalar indicating whether to compute the restricted mean in the case when
  the smallest censored value is less than or equal to the smallest uncensored value
  (left-censored data) or the largest censored value is greater than or equal to the
  largest uncensored value (right-censored data).  The default value is
  <code>restricted=FALSE</code>.  See the DETAILS section for more information.</p></dd>

  <dt id="arg-left-censored-min">left.censored.min<a class="anchor" aria-label="anchor" href="#arg-left-censored-min"></a></dt>
<dd><p>Only relevant for the case when <code>censoring.side="left"</code>, the smallest
  censored value is less than or equal to the smallest uncensored value, and <br><code>restricted=TRUE</code>.  In this case, <code>left.censored.min</code> must be the
  character string <code>"Censoring Level"</code>, or else a numeric scalar between
  0 and the smallest censored value.  The default value is
  <code>left.censored.min="Censoring Level"</code>.
  See the DETAILS section for more information.</p></dd>

  <dt id="arg-right-censored-max">right.censored.max<a class="anchor" aria-label="anchor" href="#arg-right-censored-max"></a></dt>
<dd><p>Only relevant for the case when <code>censoring.side="right"</code>, the largest
  censored value is greater than or equal to the largest uncensored value, and <br><code>restricted=TRUE</code>.  In this case, <code>right.censored.max</code> must be the
  character string <code>"Censoring Level"</code>, or else a numeric scalar greater
  than or equal to the largest censored value. The default value is
  <code>right.censored.max="Censoring Level"</code>.
  See the DETAILS section for more information.</p></dd>

  <dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for the
  mean or variance.  The default value is <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating what method to use to construct the confidence interval
  for the mean.  The possible values are
  <code>"normal.approx"</code> (normal approximation; the default), and
  <code>"bootstrap"</code> (based on bootstrapping).
  See the <b>DETAILS</b> section for more information.
  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>character string indicating what kind of confidence interval to compute.  The
  possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
  The default value is <code>conf.level=0.95</code>. This argument is ignored if
  <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-pivot-statistic">pivot.statistic<a class="anchor" aria-label="anchor" href="#arg-pivot-statistic"></a></dt>
<dd><p>character string indicating which statistic to use for the confidence interval
  for the mean when <code>ci.method="normal.approx"</code>.  Possible values are
  <code>"t"</code> (confidence interval based on the t-statistic; the default), and
  <code>"z"</code> (confidence interval based on the z-statistic).  When
  <code>pivot.statistic="t"</code> you may supply the argument <code>ci.sample size</code>
  (see below).  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-sample-size">ci.sample.size<a class="anchor" aria-label="anchor" href="#arg-ci-sample-size"></a></dt>
<dd><p>character string indicating what sample size to assume when
  computing the confidence interval for the mean when <code>ci.method="normal.approx"</code> <br>
  and <code>pivot.statistic="t"</code>.  Possible values are <code>ci.sample.size="Total"</code>
  (the total number of observations; the default), and <br><code>ci.sample.size="Uncensored"</code> (the number of uncensored observations).
  This argument is ignored if <code>ci=FALSE</code>, <code>ci.method="bootstrap"</code>,
  or <code>pivot.statistic="z"</code>.</p></dd>

  <dt id="arg-n-bootstraps">n.bootstraps<a class="anchor" aria-label="anchor" href="#arg-n-bootstraps"></a></dt>
<dd><p>numeric scalar indicating how many bootstraps to use to construct the
  confidence interval for the mean when <code>ci.type="bootstrap"</code>.  This
  argument is ignored if <code>ci=FALSE</code> or <code>ci.method="normal.approx"</code>.</p></dd>

  <dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer supplied to the function <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code> and used when
  <code>ci=TRUE</code> and <br><code>ci.method="bootstrap"</code>.  The default value is
  <code>seed=NULL</code>, in which case the current value of <code>.Random.seed</code> is used.
  This argument is ignored if <code>ci=FALSE</code> or <code>ci.method="normal.approx"</code>.
  The <code>seed</code> argument is necessary in order to create reproducible results for
  the bootstrapped confidence intervals (see the <b>EXAMPLES</b> section).</p></dd>

  <dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical scalar indicating whether to issue a notification in the case when a
  restricted mean will be estimated, but setting the smallest censored value(s)
  to an uncensored value (left-censored data) or setting the largest censored
  value(s) to an uncensored value (right-censored data) results in no censored
  values in the data.  In this case, the function <code><a href="enpar.html">enpar</a></code>
  is called.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Let \(\underline{x} = (x_1, x_2, \ldots, x_N)\) denote a vector of \(N\)
  observations from some positive-valued distribution with mean
  \(\mu\) and standard deviation \(\sigma\).
  Assume \(n\) (\(0 &lt; n &lt; N\)) of these
  observations are known and \(c\) (\(c=N-n\)) of these observations are
  all censored below (left-censored) or all censored above (right-censored) at
  \(k\) censoring levels
  $$T_1, T_2, \ldots, T_k; \; k \ge 1 \;\;\;\;\;\; (1)$$
  Let \(y_1, y_2, \ldots, y_n\) denote the \(n\) ordered uncensored
  observations, and let \(r_1, r_2, \ldots, r_n\) denote the order of these
  uncensored observations within the context of all the observations (censored and
  uncensored).  For example, if the left-censored data are {&lt;10, 14, 14, &lt;15, 20}, then
  \(y_1 = 14, y_2 = 14, y_3 = 20\), and \(r_1 = 2, r_2 = 3, r_3 = 5\).</p>
<p>Let \(y_1', y_2', \ldots, y_p'\) denote the \(p\) ordered <em>distinct</em>
  uncensored observations, let \(m_j\) denote the number of detects at
  \(y_j'\) (\(j = 1, 2, \ldots, p\)), and let \(r_j'\) denote the number of
  \(x_i \le y_j'\), i.e., the number of observations (censored and uncensored)
  less than or equal to \(y_j'\) (\(j = 1, 2, \ldots, p\)).  For example,
  if the left-censored data are {&lt;10, 14, 14, &lt;15, 20}, then
  \(y_1' = 14, y_2' = 20\), \(m_1 = 2, m_2 = 1\), and \(r_1' = 3, r_2' = 5\).
  <br></p>
<p><b>Estimation</b> <br>
  This section explains how the mean \(\mu\), standard deviation \(\sigma\),
  and standard error of the mean \(\hat{\sigma}_{\hat{\mu}}\) are estimated, as well as
  the restricted mean.
  <br></p>
<p><em>Estimating the Mean</em> <br>
  It can be shown that the mean of a positive-valued distribution is equal to the
  area under the survival curve (Klein and Moeschberger, 2003, p.33):
  $$\mu = \int_0^\infty [1 - F(t)] dt = \int_0^\infty S(t) dt \;\;\;\;\;\; (2)$$
  where \(F(t)\) denotes the cumulative distribution function evaluated at \(t\)
  and \(S(t) = 1 - F(t)\) denotes the survival function evaluated at \(t\).
  When the Kaplan-Meier estimator is used to construct the survival function,
  you can use the area under this curve to estimate the mean of the distribution,
  and the estimator can be as efficient or more efficient than
  parametric estimators of the mean (Meier, 2004; Helsel, 2012; Lee and Wang, 2003).
  Let \(\hat{F}(t)\) denote the Kaplan-Meier estimator of the empirical
  cumulative distribution function (ecdf) evaluated at \(t\), and let
  \(\hat{S}(t) = 1 - \hat{F}(t)\) denote the estimated survival function evaluated
  at \(t\).  (See the help files for <code><a href="ecdfPlotCensored.html">ecdfPlotCensored</a></code> and
  <code><a href="qqPlotCensored.html">qqPlotCensored</a></code> for an explanation of how the Kaplan-Meier
  estimator of the ecdf is computed.)</p>
<p>The formula for the estimated mean is given by (Lee and Wang, 2003, p. 74):
  $$\hat{\mu} = \sum_{i=1}^{n} \hat{S}(y_{i-1}) (y_{i} - y_{i-1}) \;\;\;\;\;\; (3)$$
  where \(y_{0} = 0\) and \(\hat{S}(y_{0}) = 1\) by definition.  It can be
  shown that this formula is eqivalent to:
  $$\hat{\mu} = \sum_{i=1}^n y_{i} [\hat{F}(y_{i}) - \hat{F}(y_{i-1})] \;\;\;\;\;\; (4)$$
  where \(\hat{F}(y_{0}) = \hat{F}(0) = 0\) by definition, and this is equivalent to:
  $$\hat{\mu} = \sum_{i=1}^p y_i' [\hat{F}(y_i') - \hat{F}(y_{i-1}')] \;\;\;\;\;\; (5)$$
  (USEPA, 2009, pp. 15–7 to 15–12; Beal, 2010; USEPA, 2022, pp. 128–129).
  <br></p>
<p><em>Estimating the Standard Deviation</em> <br>
  The formula for the estimated standard deviation is:
  $$\hat{\sigma} = \{\sum_{i=1}^n (y_{i} - \hat{\mu})^2 [\hat{F}(y_{i}) - \hat{F}(y_{i-1})]\}^{1/2} \;\;\;\;\; (6)$$
  which is equivalent to:
  $$\hat{\sigma} = \{\sum_{i=1}^p (y_i' - \hat{\mu})^2 [\hat{F}(y_i') - \hat{F}(y_{i-1}')]\}^{1/2} \;\;\;\;\; (7)$$
  (USEPA, 2009, p. 15-10; Beal, 2010).
  <br></p>
<p><em>Estimating the Standard Error of the Mean</em> <br>
  For left-censored data, the formula for the estimated standard error of the
  mean is:
  $$\hat{\sigma}_{\hat{\mu}} = [\sum_{i=j}^{p-1} A_j^2 \frac{m_{j+1}}{r_{j+1}'(r_{j+1}' - m_{j+1})}]^{1/2} \;\;\;\;\;\; (8)$$
  where
  $$A_j = \sum_{i=1}^{j} (y_{i+1}' - y_i') \hat{F}(y_i') \;\;\;\;\;\; (9)$$
  (Beal, 2010; USEPA, 2022, pp. 128–129).</p>
<p>For rigth-censored data, the formula for the estimated standard error of the
  mean is:
  $$\hat{\sigma}_{\hat{\mu}} = [\sum_{r=1}^{n-1} \frac{A_r^2}{(N-r)(N-r+1)}]^{1/2} \;\;\;\;\;\; (10)$$
  where
  $$A_r = \sum_{i=r}^{n-1} (y_{i+1} - y_{i}) \hat{S}(y_{i}) \;\;\;\;\;\; (11)$$
  (Lee and Wang, 2003, p. 74).</p>
<p>Kaplan and Meier suggest using a bias correction of
  \(n/(n-1)\) for the estimated variance of the mean (Lee and Wang, 2003, p.75):
  $$\hat{\sigma}_{\hat{\mu}, BC} = \sqrt{\frac{n}{n-1}} \;\; \hat{\sigma}_{\hat{\mu}} \;\;\;\;\;\; (12)$$
  When <code>correct.se=TRUE</code> (the default), Equation (12) is used.  Beal (2010),
  ProUCL 5.2.0 (USEPA, 2022), and the <code>kmms</code> function in the <b>STAND</b> package
  (Frome and Frome, 2015) all compute the bias-corrected estimate of the standard
  error of the mean as well.
  <br></p>
<p><em>Estimating the Restricted Mean</em> <br>
  If the smallest value for left-censored data is censored and less than or equal to
  the smallest uncensored value, then the estimated mean will be biased high, and
  if the largest value for right-censored data is censored and greater than or equal to
  the largest uncensored value, then the estimated mean will be biased low.  One solution
  to this problem is to instead estimate what is called the <b><em>restricted mean</em></b>
  (Miller, 1981; Lee and Wang, 2003, p. 74; Meier, 2004; Barker, 2009).</p>
<p>To compute the restricted mean (<code>restricted=TRUE</code>), for left-censored data,
  the smallest censored observation(s) are treated as observed, and set to the
  smallest censoring level <br>
  (<code>left.censored.min="Censoring Level"</code>) or some other
  value less than the smallest censoring level and greater than 0, and then applying
  the above formulas.  To compute the restricted mean for right-censored data,
  the largest censored observation(s) are treated as observed and set to the
  censoring level (<code>right.censored.max="Censoring Level"</code>) or some value
  greater than the largest censoring level.</p>
<p>ProUCL 5.2.0 (USEPA, 2022, pp. 128–129) and Beal (2010) do not compute the restricted
  mean in cases where it could be applied, whereas USEPA (2009, pp. 15–7 to 15–12) and
  the <code>kmms</code> function in Version 2.0 of the R package <b>STAND</b>
  (Frome and Frome, 2015) do compute the restricted mean and set the smallest
  censored observation(s) equal to the censoring level (i.e., what
  <code>enparCensored</code> does when <code>restricted=TRUE</code> and
  <code>left.censored.min="Censoring Level"</code>).</p>
<p>To be consistent with ProUCL 5.2.0, by default the function <code>enparCensored</code>
  does not compute the restricted mean (i.e., <code>restricted=FALSE</code>).  Note that there
  are instances where ProUCL 5.2.0 does not agree with <code>enparCensored</code>, and it is
  not clear why. It should
  be noted that when the restricted mean is computed, the number of uncensored
  observations increases because the smallest (left-censored) or largest
  (right-censored) censored observation(s) is/are set to a specified value and
  treated as uncensored.  The <code>kmms</code> function in Version 2.0 of the
  <b>STAND</b> package (Frome and Frome, 2015) is inconsistent in how it treats the
  number of uncensored observations when computing estimates associated with the
  restricted mean.  Although <code>kmms</code> sets the smallest censored observations to the
  observed censoring level and treats them as not censored, when it computes
  the bias correction factor for the standard error of the mean, it assumes those
  observations are still censored (see the EXAMPLES section below).</p>
<p>In the unusual case when a restricted mean will be estimated and setting the
  smallest censored value(s) to an uncensored value (left-censored data), or
  setting the largest censored value(s) to an uncensored value
  (right-censored data), results in no censored values in the data, the Kaplan-Meier
  estimate of the mean reduces to the sample mean, so the function
  <code><a href="enpar.html">enpar</a></code> is called and, if <code>warn=TRUE</code>, a warning is returned.
  <br></p>
<p><b>Confidence Intervals</b> <br>
  This section explains how confidence intervals for the mean \(\mu\) are
  computed.
  <br></p>
<p><em>Normal Approximation</em> (<code>ci.method="normal.approx"</code>) <br>
  This method constructs approximate \((1-\alpha)100\%\) confidence intervals for
  \(\mu\) based on the assumption that the estimator of \(\mu\) is
  approximately normally distributed.  That is, a two-sided \((1-\alpha)100\%\)
  confidence interval for \(\mu\) is constructed as:
  $$[\hat{\mu} - t_{1-\alpha/2, v-1}\hat{\sigma}_{\hat{\mu}}, \; \hat{\mu} + t_{1-\alpha/2, v-1}\hat{\sigma}_{\hat{\mu}}] \;\;\;\; (13)$$
  where \(\hat{\mu}\) denotes the estimate of \(\mu\),
  \(\hat{\sigma}_{\hat{\mu}}\) denotes the estimated asymptotic standard
  deviation of the estimator of \(\mu\), \(v\) denotes the assumed sample
  size for the confidence interval, and \(t_{p,\nu}\) denotes the \(p\)'th
  quantile of <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribuiton</a> with \(\nu\)
  degrees of freedom.  One-sided confidence intervals are computed in a
  similar fashion.</p>
<p>The argument <code>ci.sample.size</code> determines the value of \(v\).
  The possible values are the total number of observations, \(N\)
  (<code>ci.sample.size="Total"</code>), or the number of uncensored observations,
  \(n\) (<code>ci.sample.size="Uncensored"</code>).  To be consistent with ProUCL 5.2.0,
  in <code>enparCensored</code> the default value is the total number of observations.
  The <code>kmms</code> function in the <b>STAND</b> package, on the other hand,
  uses the number of uncensored observations.</p>
<p>When <code>pivot.statistic="z"</code>, the \(p\)'th quantile from the
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">standard normal distribution</a> is used in place of the
  \(p\)'th quantile from Student's t-distribution.
  <br></p>
<p><em>Bootstrap and Bias-Corrected Bootstrap Approximation</em> (<code>ci.method="bootstrap"</code>) <br>
  The bootstrap is a nonparametric method of estimating the distribution
  (and associated distribution parameters and quantiles) of a sample statistic,
  regardless of the distribution of the population from which the sample was drawn.
  The bootstrap was introduced by Efron (1979) and a general reference is
  Efron and Tibshirani (1993).</p>
<p>In the context of deriving an approximate \((1-\alpha)100\%\) confidence interval
  for the population mean \(\mu\), the bootstrap can be broken down into the
  following steps:</p><ol><li><p>Create a bootstrap sample by taking a random sample of size \(N\) from
      the observations in \(\underline{x}\), where sampling is done with
      replacement.  Note that because sampling is done with replacement, the same
      element of \(\underline{x}\) can appear more than once in the bootstrap
      sample.  Thus, the bootstrap sample will usually not look exactly like the
      original sample (e.g., the number of censored observations in the bootstrap
      sample will often differ from the number of censored observations in the
      original sample).</p></li>
<li><p>Estimate \(\mu\) based on the bootstrap sample created in Step 1, using
      the same method that was used to estimate \(\mu\) using the original
      observations in \(\underline{x}\). Because the bootstrap sample usually
      does not match the original sample, the estimate of \(\mu\) based on the
      bootstrap sample will usually differ from the original estimate based on
      \(\underline{x}\).  For the bootstrap-t method (see below), this step also
      involves estimating the standard error of the estimate of the mean and
      computing the statistic \(T = (\hat{\mu}_B - \hat{\mu}) / \hat{\sigma}_{\hat{\mu}_B}\)
      where \(\hat{\mu}\) denotes the estimate of the mean based on the original sample,
      and \(\hat{\mu}_B\) and \(\hat{\sigma}_{\hat{\mu}_B}\) denote the estimate of
      the mean and estimate of the standard error of the estimate of the mean based on
      the bootstrap sample.</p></li>
<li><p>Repeat Steps 1 and 2 \(B\) times, where \(B\) is some large number.
      For the function <code>enparCensored</code>, the number of bootstraps \(B\) is
      determined by the argument <code>n.bootstraps</code> (see the section <b>ARGUMENTS</b>
      above).
      The default value of <code>n.bootstraps</code> is <code>1000</code>.</p></li>
<li><p>Use the \(B\) estimated values of \(\mu\) to compute the empirical
      cumulative distribution function of the estimator of \(\mu\) or to compute
      the empirical cumulative distribution function of the statistic \(T\)
      (see <code><a href="ecdfPlot.html">ecdfPlot</a></code>), and then create a confidence interval for \(\mu\)
      based on this estimated cdf.</p></li>
</ol><p>The two-sided percentile interval (Efron and Tibshirani, 1993, p.170) is computed as:
  $$[\hat{G}^{-1}(\frac{\alpha}{2}), \; \hat{G}^{-1}(1-\frac{\alpha}{2})] \;\;\;\;\;\; (14)$$
  where \(\hat{G}(t)\) denotes the empirical cdf of \(\hat{\mu}_B\) evaluated at \(t\)
  and thus \(\hat{G}^{-1}(p)\) denotes the \(p\)'th empirical quantile of the
  distribution of \(\hat{\mu}_B\), that is, the \(p\)'th quantile associated with the
  empirical cdf.  Similarly, a one-sided lower
  confidence interval is computed as:
  $$[\hat{G}^{-1}(\alpha), \; \infty] \;\;\;\;\;\; (15)$$
  and a one-sided upper confidence interval is computed as:
  $$[-\infty, \; \hat{G}^{-1}(1-\alpha)] \;\;\;\;\;\; (16)$$
  The function <code>enparCensored</code> calls the <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>
  to compute the empirical quantiles used in Equations (14)-(16).</p>
<p>The percentile method bootstrap confidence interval is only first-order
  accurate (Efron and Tibshirani, 1993, pp.187-188), meaning that the probability
  that the confidence interval will contain the true value of \(\mu\) can be
  off by \(k/\sqrt{N}\), where \(k\) is some constant.  Efron and Tibshirani
  (1993, pp.184–188) proposed a bias-corrected and accelerated interval that is
  second-order accurate, meaning that the probability that the confidence interval
  will contain the true value of \(\mu\) may be off by \(k/N\) instead of
  \(k/\sqrt{N}\).  The two-sided bias-corrected and accelerated confidence interval is
  computed as:
  $$[\hat{G}^{-1}(\alpha_1), \; \hat{G}^{-1}(\alpha_2)] \;\;\;\;\;\; (17)$$
  where
  $$\alpha_1 = \Phi[\hat{z}_0 + \frac{\hat{z}_0 + z_{\alpha/2}}{1 - \hat{a}(z_0 + z_{\alpha/2})}] \;\;\;\;\;\; (18)$$
  $$\alpha_2 = \Phi[\hat{z}_0 + \frac{\hat{z}_0 + z_{1-\alpha/2}}{1 - \hat{a}(z_0 + z_{1-\alpha/2})}] \;\;\;\;\;\; (19)$$
  $$\hat{z}_0 = \Phi^{-1}[\hat{G}(\hat{\mu})] \;\;\;\;\;\; (20)$$
  $$\hat{a} = \frac{\sum_{i=1}^N (\hat{\mu}_{(\cdot)} - \hat{\mu}_{(i)})^3}{6[\sum_{i=1}^N (\hat{\mu}_{(\cdot)} - \hat{\mu}_{(i)})^2]^{3/2}} \;\;\;\;\;\; (21)$$
  where the quantity \(\hat{\mu}_{(i)}\) denotes the estimate of \(\mu\) using
  all the values in \(\underline{x}\) except the \(i\)'th one, and
  $$\hat{\mu}{(\cdot)} = \frac{1}{N} \sum_{i=1}^N \hat{\mu_{(i)}} \;\;\;\;\;\; (22)$$
  A one-sided lower confidence interval is given by:
  $$[\hat{G}^{-1}(\alpha_1), \; \infty] \;\;\;\;\;\; (23)$$
  and a one-sided upper confidence interval is given by:
  $$[-\infty, \; \hat{G}^{-1}(\alpha_2)] \;\;\;\;\;\; (24)$$
  where \(\alpha_1\) and \(\alpha_2\) are computed as for a two-sided confidence
  interval, except \(\alpha/2\) is replaced with \(\alpha\) in Equations (18) and (19).</p>
<p>The constant \(\hat{z}_0\) incorporates the bias correction, and the constant
  \(\hat{a}\) is the acceleration constant.  The term “acceleration” refers
  to the rate of change of the standard error of the estimate of \(\mu\) with
  respect to the true value of \(\mu\) (Efron and Tibshirani, 1993, p.186).  For a
  normal (Gaussian) distribution, the standard error of the estimate of \(\mu\)
  does not depend on the value of \(\mu\), hence the acceleration constant is not
  really necessary.</p>
<p>For the bootstrap-t method, the two-sided confidence interval
  (Efron and Tibshirani, 1993, p.160) is computed as:
  $$[\hat{\mu} - t_{1-\alpha/2}\hat{\sigma}_{\hat{\mu}}, \; \hat{\mu} - t_{\alpha/2}\hat{\sigma}_{\hat{\mu}}] \;\;\;\;\;\; (25)$$
  where \(\hat{\mu}\) and \(\hat{\sigma}_{\hat{\mu}}\) denote the estimate of the mean
  and standard error of the estimate of the mean based on the original sample, and
  \(t_p\) denotes the \(p\)'th empirical quantile of the bootstrap distribution of
  the statistic \(T\).  Similarly, a one-sided lower confidence interval is computed as:
  $$[\hat{\mu} - t_{1-\alpha}\hat{\sigma}_{\hat{\mu}}, \; \infty] \;\;\;\;\;\; (26)$$
  and a one-sided upper confidence interval is computed as:
  $$[-\infty, \; \hat{\mu} - t_{\alpha}\hat{\sigma}_{\hat{\mu}}] \;\;\;\;\;\; (27)$$</p>
<p>When <code>ci.method="bootstrap"</code>, the function <code>enparCensored</code> computes
  the percentile method, bias-corrected and accelerated method, and bootstrap-t
  bootstrap confidence intervals.  The percentile method is transformation respecting,
  but not second-order accurate.  The bootstrap-t method is second-order accurate, but not
  transformation respecting.  The bias-corrected and accelerated method is both
  transformation respecting and second-order accurate (Efron and Tibshirani, 1993, p.188).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"estimateCensored"</code> containing the estimated parameters
  and other information.  See <code><a href="estimateCensored.object.html">estimateCensored.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Barker, C. (2009).  The Mean, Median, and Confidence Intervals of the
  Kaplan-Meier Survival Estimate – Computations and Applications.
  <em>The American Statistician</em> <b>63</b>(1), 78–80.</p>
<p>Beal, D. (2010).  <em>A Macro for Calculating Summary Statistics on
  Left Censored Environmental Data Using the Kaplan-Meier Method</em>.
  Paper SDA-09, presented at Southeast SAS Users Group 2010, September 26-28,
  Savannah, GA.  <a href="https://analytics.ncsu.edu/sesug/2010/SDA09.Beal.pdf" class="external-link">https://analytics.ncsu.edu/sesug/2010/SDA09.Beal.pdf</a>.</p>
<p>Efron, B. (1979).  Bootstrap Methods: Another Look at the Jackknife.
  <em>The Annals of Statistics</em> <b>7</b>, 1–26.</p>
<p>Efron, B., and R.J. Tibshirani. (1993).  <em>An Introduction to the Bootstrap</em>.
  Chapman and Hall, New York, 436pp.</p>
<p>El-Shaarawi, A.H., and D.M. Dolan. (1989).  Maximum Likelihood Estimation of
  Water Quality Concentrations from Censored Data.
  <em>Canadian Journal of Fisheries and Aquatic Sciences</em> <b>46</b>, 1033–1039.</p>
<p>Frome E.L., and D.P. Frome (2015). <em>STAND: Statistical Analysis of
  Non-Detects</em>. R package version 2.0, <a href="https://CRAN.R-project.org/package=STAND" class="external-link">https://CRAN.R-project.org/package=STAND</a>.</p>
<p>Gillespie, B.W., Q. Chen, H. Reichert, A. Franzblau, E. Hedgeman, J. Lepkowski,
  P. Adriaens, A. Demond, W. Luksemburg, and D.H. Garabrant. (2010).  Estimating Population
  Distributions When Some Data Are Below a Limit of Detection by Using a Reverse
  Kaplan-Meier Estimator.  <em>Epidemiology</em> <b>21</b>(4), S64–S70.</p>
<p>Helsel, D.R. (2012). <em>Statistics for Censored Environmental Data Using Minitab and R,
  Second Edition</em>.  John Wiley &amp; Sons, Hoboken, New Jersey.</p>
<p>Irwin, J.O. (1949).  The Standard Error of an Estimate of Expectation of Life,
  with Special Reference to Expectation of Tumourless Life in Experiments with Mice.
  <em>Journal of Hygiene</em> <b>47</b>, 188–189.</p>
<p>Kaplan, E.L., and P. Meier. (1958). Nonparametric Estimation From Incomplete Observations.
  <em>Journal of the American Statistical Association</em> <b>53</b>, 457-481.</p>
<p>Klein, J.P., and M.L. Moeschberger. (2003).  <em>Survival Analysis:
  Techniques for Censored and Truncated Data, Second Edition</em>.  Springer, New York,
  537pp.</p>
<p>Lee, E.T., and J.W. Wang. (2003).
  <em>Statistical Methods for Survival Data Analysis, Third Edition</em>.
  John Wiley &amp; Sons, Hoboken, New Jersey, 513pp.</p>
<p>Meier, P., T. Karrison, R. Chappell, and H. Xie. (2004).  The Price of Kaplan-Meier.
  <em>Journal of the American Statistical Association</em> <b>99</b>(467), 890–896.</p>
<p>Miller, R.G. (1981).  <em>Survival Analysis</em>. John Wiley and Sons, New York.</p>
<p>Nelson, W. (1982).  <em>Applied Life Data Analysis</em>.
  John Wiley and Sons, New York, 634pp.</p>
<p>Singh, A., R. Maichle, and S. Lee. (2006).  <em>On the Computation of a 95%
  Upper Confidence Limit of the Unknown Population Mean Based Upon Data Sets
  with Below Detection Limit Observations</em>.  EPA/600/R-06/022, March 2006.
  Office of Research and Development, U.S. Environmental Protection Agency,
  Washington, D.C.</p>
<p>Singh, A., N. Armbya, and A. Singh. (2010).
  <em>ProUCL Version 4.1.00 Technical Guide (Draft)</em>. EPA/600/R-07/041, May 2010.
  Office of Research and Development, U.S. Environmental Protection Agency,
  Washington, D.C.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at
  RCRA Facilities, Unified Guidance</em>.  EPA 530/R-09-007, March 2009.  Office of
  Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery,
  Program Information and Implementation Division.  U.S. Environmental
  Protection Agency, Washington, D.C.</p>
<p>USEPA. (2022).  <em>ProUCL Version 5.2.0 Technical Guide:
  Statistical Software for Environmental Applications for Data Sets with and
  without Nondetect Observations</em>.  Prepared by:  Neptune and Company, Inc.,
  1435 Garrison Street, Suite 201, Lakewood, CO 80215.  pp. 128–129, 143.
  <a href="https://www.epa.gov/land-research/proucl-software" class="external-link">https://www.epa.gov/land-research/proucl-software</a>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>A sample of data contains censored observations if some of the observations are
  reported only as being below or above some censoring level.  In environmental
  data analysis, Type I left-censored data sets are common, with values being
  reported as “less than the detection limit” (e.g., Helsel, 2012).  Data
  sets with only one censoring level are called <em>singly censored</em>; data sets with
  multiple censoring levels are called <em>multiply</em> or <em>progressively censored</em>.</p>
<p>Statistical methods for dealing with censored data sets have a long history in the
  field of survival analysis and life testing.  More recently, researchers in the
  environmental field have proposed alternative methods of computing estimates and
  confidence intervals in addition to the classical ones such as maximum likelihood
  estimation.</p>
<p>Helsel (2012, Chapter 6) gives an excellent review of past studies of the
  properties of various estimators based on censored environmental data.</p>
<p>In practice, it is better to use a confidence interval for the mean or a
  joint confidence region for the mean and standard deviation, rather than rely on a
  single point-estimate of the mean.  Since confidence intervals and regions depend
  on the properties of the estimators for both the mean and standard deviation, the
  results of studies that simply evaluated the performance of the mean and standard
  deviation separately cannot be readily extrapolated to predict the performance of
  various methods of constructing confidence intervals and regions.  Furthermore,
  for several of the methods that have been proposed to estimate the mean based on
  type I left-censored data, standard errors of the estimates are not available,
  hence it is not possible to construct confidence intervals
  (El-Shaarawi and Dolan, 1989).</p>
<p>Few studies have been done to evaluate the performance of methods for constructing
  confidence intervals for the mean or joint confidence regions for the mean and
  standard deviation when data are subjected to single or multiple censoring.
  See, for example, Singh et al. (2006).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ppointsCensored.html">ppointsCensored</a></code>, <code><a href="ecdfPlotCensored.html">ecdfPlotCensored</a></code>,
  <code><a href="qqPlotCensored.html">qqPlotCensored</a></code>,<code><a href="estimateCensored.object.html">estimateCensored.object</a></code>,
  <code><a href="enpar.html">enpar</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Using the lead concentration data from soil samples shown in </span></span></span>
<span class="r-in"><span>  <span class="co"># Beal (2010), compute the Kaplan-Meier estimators of the mean, </span></span></span>
<span class="r-in"><span>  <span class="co"># standard deviation, and standard error of the mean, as well as </span></span></span>
<span class="r-in"><span>  <span class="co"># a 95% upper confidence limit for the mean.  Compare these </span></span></span>
<span class="r-in"><span>  <span class="co"># results to those given in Beal (2010), and also to the results </span></span></span>
<span class="r-in"><span>  <span class="co"># produced by ProUCL 5.2.0.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># First look at the data:</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Beal.2010.Pb.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pb.char  Pb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      &lt;1 1.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      &lt;1 1.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       2 2.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2.5 2.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2.8 2.8    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      &lt;3 3.0     TRUE</span>
<span class="r-in"><span>  <span class="co">#  Pb.char  Pb Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#1      &lt;1 1.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#2      &lt;1 1.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#3       2 2.0    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#4     2.5 2.5    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#5     2.8 2.8    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#6      &lt;3 3.0     TRUE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">Beal.2010.Pb.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Pb.char   Pb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     &lt;10   10     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      10   10    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26      15   15    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27      49   49    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     200  200    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29    9060 9060    FALSE</span>
<span class="r-in"><span>  <span class="co">#   Pb.char   Pb Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#24     &lt;10   10     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#25      10   10    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#26      15   15    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#27      49   49    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#28     200  200    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#29    9060 9060    FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># enparCensored Results:</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------</span></span></span>
<span class="r-in"><span>  <span class="va">Beal.unrestricted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Beal.2010.Pb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu">enparCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pb</span>, censored <span class="op">=</span> <span class="va">Censored</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>      ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Beal.unrestricted</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  3  4  6  9 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34.48276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd   se.mean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  325.3396 1651.0950  315.0023 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Kaplan-Meier\n                                 (Bias-corrected se.mean)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Pb"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 861.1996 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Approximation\n                                 (t Distribution)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimateCensored"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#Based on Type I Censored Data</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Side:                  left</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Level(s):               1  3  4  6  9 10 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean    =  325.3396</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd      = 1651.0950</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 se.mean =  315.0023</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               Kaplan-Meier</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (Bias-corrected se.mean)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Pb</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Variable:              Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     29</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Percent Censored:                34.48276%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Sample Size:             29</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (t Distribution)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =   0.0000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 861.1996</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Beal.unrestricted</span><span class="op">$</span><span class="va">parameters</span>, <span class="va">Beal.unrestricted</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd   se.mean       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  325.3396 1651.0950  315.0023    0.0000  861.1996 </span>
<span class="r-in"><span>  <span class="co">#     mean        sd   se.mean       LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co"># 325.3396 1651.0950  315.0023    0.0000  861.1996</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Beal (2010) published results:</span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#   Mean   Std. Dev.  SE of Mean</span></span></span>
<span class="r-in"><span>  <span class="co"># 325.34     1651.09      315.00</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># ProUCL 5.2.0 results:</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#   Mean   Std. Dev.  SE of Mean  95% UCL</span></span></span>
<span class="r-in"><span>  <span class="co"># 325.2      1651         315       861.1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now compute the restricted mean and associated quantities, </span></span></span>
<span class="r-in"><span>  <span class="co"># and compare these results with those produced by the </span></span></span>
<span class="r-in"><span>  <span class="co"># kmms() function in the STAND package.</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------- </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Beal.restricted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Beal.2010.Pb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu">enparCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pb</span>, censored <span class="op">=</span> <span class="va">Censored</span>, restricted <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>      ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Beal.restricted</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  3  4  6  9 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34.48276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd   se.mean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  325.2011 1651.1221  314.1774 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Kaplan-Meier (Restricted Mean)\n                                 Smallest censored value(s)\n                                   set to Censoring Level\n                                 (Bias-corrected se.mean)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Pb"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LCL     UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.000 859.658 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Approximation\n                                 (t Distribution)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimateCensored"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#Based on Type I Censored Data</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Side:                  left</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Level(s):               1  3  4  6  9 10 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean    =  325.2011</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd      = 1651.1221</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 se.mean =  314.1774</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               Kaplan-Meier (Restricted Mean)</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Smallest censored value(s)</span></span></span>
<span class="r-in"><span>  <span class="co">#                                   set to Censoring Level</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (Bias-corrected se.mean)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Pb</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Variable:              Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     29</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Percent Censored:                34.48276%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Sample Size:             29</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (t Distribution)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =   0.000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 859.658</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Beal.restricted</span><span class="op">$</span><span class="va">parameters</span>, <span class="va">Beal.restricted</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd   se.mean       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  325.2011 1651.1221  314.1774    0.0000  859.6580 </span>
<span class="r-in"><span>  <span class="co">#     mean        sd   se.mean       LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co"># 325.2011 1651.1221  314.1774    0.0000  859.6580</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># kmms() results:</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------</span></span></span>
<span class="r-in"><span>  <span class="co">#  KM.mean    KM.LCL    KM.UCL     KM.se     gamma </span></span></span>
<span class="r-in"><span>  <span class="co"># 325.2011 -221.0419  871.4440  315.0075    0.9500 </span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># NOTE: as pointed out above, the kmms() function treats the </span></span></span>
<span class="r-in"><span>  <span class="co">#       smallest censored observations (&lt;1 and &lt;1) as NOT </span></span></span>
<span class="r-in"><span>  <span class="co">#       censored when computing the mean and uncorrected </span></span></span>
<span class="r-in"><span>  <span class="co">#       standard error of the mean, but assumes these </span></span></span>
<span class="r-in"><span>  <span class="co">#       observations ARE censored when computing the corrected </span></span></span>
<span class="r-in"><span>  <span class="co">#       standard error of the mean.</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Beal.restricted</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span><span class="st">"se.mean"</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">20</span><span class="op">/</span><span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">19</span><span class="op">/</span><span class="fl">18</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  se.mean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 315.0075 </span>
<span class="r-in"><span>  <span class="co">#  se.mean </span></span></span>
<span class="r-in"><span>  <span class="co"># 315.0075</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the above example, estimating the unrestricted mean and </span></span></span>
<span class="r-in"><span>  <span class="co"># computing an upper confidence limit based on the bootstrap </span></span></span>
<span class="r-in"><span>  <span class="co"># instead of on the normal approximation with a t pivot statistic.</span></span></span>
<span class="r-in"><span>  <span class="co"># Compare results to those from ProUCL 5.2.0.</span></span></span>
<span class="r-in"><span>  <span class="co"># Note:  Setting the seed argument lets you reproduce this example.</span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Beal.unrestricted.boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Beal.2010.Pb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu">enparCensored</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pb</span>, censored <span class="op">=</span> <span class="va">Censored</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>      ci.type <span class="op">=</span> <span class="st">"upper"</span>, ci.method <span class="op">=</span> <span class="st">"bootstrap"</span>, seed <span class="op">=</span> <span class="fl">923</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Beal.unrestricted.boot</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1  3  4  6  9 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34.48276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd   se.mean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  325.3396 1651.0950  315.0023 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Kaplan-Meier\n                                 (Bias-corrected se.mean)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Pb"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Pct.LCL    Pct.UCL    BCa.LCL    BCa.UCL      t.LCL      t.UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.0000   948.7342     0.0000   942.6596     0.0000 62121.8909 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Bootstrap"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.bootstraps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $too.few.obs.count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $no.cen.obs.count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimateCensored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimateCensored"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#Based on Type I Censored Data</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Side:                  left</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Level(s):               1  3  4  6  9 10 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean    =  325.3396</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd      = 1651.0950</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 se.mean =  315.0023</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               Kaplan-Meier</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (Bias-corrected se.mean)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Pb</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Variable:              Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     29</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Percent Censored:                34.48276%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Sample Size:             29</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Bootstrap</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number of Bootstraps:            1000</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number of Bootstrap Samples</span></span></span>
<span class="r-in"><span>  <span class="co">#With No Censored Values:         0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number of Times Bootstrap</span></span></span>
<span class="r-in"><span>  <span class="co">#Repeated Because Too Few</span></span></span>
<span class="r-in"><span>  <span class="co">#Uncensored Observations:         0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             Pct.LCL =     0.0000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Pct.UCL =   948.7342</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 BCa.LCL =     0.0000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 BCa.UCL =   942.6596</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 t.LCL   =     0.0000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 t.UCL   = 62121.8909</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Beal.unrestricted.boot</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Pct.LCL    Pct.UCL    BCa.LCL    BCa.UCL      t.LCL      t.UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.0000   948.7342     0.0000   942.6596     0.0000 62121.8909 </span>
<span class="r-in"><span>  <span class="co">#   Pct.LCL    Pct.UCL    BCa.LCL    BCa.UCL      t.LCL      t.UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#    0.0000   948.7342     0.0000   942.6596     0.0000 62121.8909</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># ProUCL 5.2.0 results:</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#   Pct.LCL    Pct.UCL    BCa.LCL    BCa.UCL      t.LCL      t.UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#    0.0000   944.3        0.0000   947.8        0.0000 62169</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">Beal.unrestricted</span>, <span class="va">Beal.restricted</span>, <span class="va">Beal.unrestricted.boot</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

