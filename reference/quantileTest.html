<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Two-Sample Rank Test to Detect a Shift in a Proportion of the "Treated" Population — quantileTest • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Two-Sample Rank Test to Detect a Shift in a Proportion of the " treated population quantiletest><meta property="og:description" content="Two-sample rank test to detect a positive shift in a proportion of one population
  (here called the &amp;#8220;treated&amp;#8221; population) compared to another (here called the
  &amp;#8220;reference&amp;#8221; population).  This test is usually called the quantile test
  (Johnson et al., 1987)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Two-Sample Rank Test to Detect a Shift in a Proportion of the "Treated" Population</h1>

    <div class="hidden name"><code>quantileTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Two-sample rank test to detect a positive shift in a proportion of one population
  (here called the “treated” population) compared to another (here called the
  “reference” population).  This test is usually called the quantile test
  (Johnson et al., 1987).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">quantileTest</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, target.quantile <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    target.r <span class="op">=</span> <span class="cn">NULL</span>, exact.p <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of observations from the “treatment” group.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are allowed but will be removed.</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>numeric vector of observations from the “reference” group.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are allowed but will be removed.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values
  are <code>"greater"</code> (right tail of treatment group shifted to the right of the
  right tail of the reference group) and <code>"less"</code> (left tail of treatment group
  shifted to the left of the left tail of the reference group).  The default value is <br><code>alternative="greater"</code>.</p></dd>

  <dt id="arg-target-quantile">target.quantile<a class="anchor" aria-label="anchor" href="#arg-target-quantile"></a></dt>
<dd><p>numeric scalar between 0 and 1 indicating the desired quantile to use as the
  lower cut off point for the test.  Because of the discrete nature of empirical
  quantiles, the upper bound for the possible empirical quantiles will often differ
  from the value of <code>target.quantile</code>.  The default value is
  <code>target.quantile=0.5</code> (i.e., the median).  This argument is ignored if the
  argument <code>target.r</code> is supplied.</p></dd>

  <dt id="arg-target-r">target.r<a class="anchor" aria-label="anchor" href="#arg-target-r"></a></dt>
<dd><p>integer indicating the rank of the observation to use as the lower cut off point
  for the test.  The value of <code>target.r</code> must be greater than or equal to
  2 and less than or equal to \(N\) (the total number of valid observations
  contained in the arguments <code>x</code> and <code>y</code>).  The actual rank of the cut off
  point may differ from <code>target.r</code> in the case of tied observations in
  <code>x</code> and/or <code>y</code>.  The default value of this argument is <code>NULL</code>, in
  which case the argument <code>target.quantile</code> is used to determine the lower cut
  off for the test.</p></dd>

  <dt id="arg-exact-p">exact.p<a class="anchor" aria-label="anchor" href="#arg-exact-p"></a></dt>
<dd><p>logical scalar indicating whether to compute the p-value based on the exact
  distribution of the test statistic (<code>exact.p=TRUE</code>; the default) or based
  on the normal approximation (<code>exact.p=FALSE</code>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Let \(X\) denote a random variable representing measurements from a
  “treatment” group with cumulative distribution function (cdf)
  $$F_X(t) = Pr(X \le t) \;\;\;\;\;\; (1)$$
  and let \(x_1, x_2, \ldots, x_m\) denote \(m\) observations from this
  treatment group.  Let \(Y\) denote a random variable from a “reference”
  group with cdf
  $$F_Y(t) = Pr(Y \le t) \;\;\;\;\;\; (2)$$
  and let \(y_1, y_2, \ldots, y_n\) denote \(n\) observations from this
  reference group.  Consider the null hypothesis:
  $$H_0: F_X(t) = F_Y(t), \;\; -\infty &lt; t &lt; \infty \;\;\;\;\;\; (3)$$
  versus the alternative hypothesis
  $$H_a: F_X(t) = (1 - \epsilon) F_Y(t) + \epsilon F_Z(t) \;\;\;\;\;\; (4)$$
  where \(Z\) denotes some random variable with cdf
  $$F_Z(t) = Pr(Z \le t) \;\;\;\;\;\; (5)$$
  and \(0 &lt; \epsilon \le 1\), \(F_Z(t) \le F_Y(t)\) for all values of \(t\),
  and \(F_Z(t) \ne F_Y(t)\) for at least one value of \(t\).</p>
<p>In English, the alternative hypothesis (4) says that a portion \(\epsilon\) of the
  distribution for the treatment group (the distribution of \(X\)) is shifted to the
  right of the distribution for the reference group (the distribution of \(Y\)).
  The alternative hypothesis (4) with \(\epsilon = 1\) is the alternative hypothesis
  associated with testing a location shift, for which the the
  <a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">Wilcoxon rank sum test</a> can be used.</p>
<p>Johnson et al. (1987) investigated locally most powerful rank tests for the test of
  the null hypothesis (3) against the alternative hypothesis (4).  They considered the
  case when \(Y\) and \(Z\) were normal random variables and the case when the
  densities of \(Y\) and \(Z\) assumed only two positive values.  For the latter
  case, the locally most powerful rank test reduces to the following procedure, which
  Johnson et al. (1987) call the quantile test.</p>
<p></p><ol><li><p>Combine the \(n\) observations from the reference group and the \(m\)
  observations from the treatment group and rank them from smallest to largest.
  Tied observations receive the average rank of all observations tied at that value.</p></li>
<li><p>Choose a quantile \(q\) and determine the smallest rank \(r\) such that
  $$\frac{r}{m+n+1} &gt; q \;\;\;\;\;\; (6)$$
  Note that because of the discrete nature of ranks, any quantile \(q'\) such
  that
  $$\frac{r}{m+n+1} &gt; q' \ge \frac{r-1}{m+n+1} \;\;\;\;\;\; (7)$$
  will yield the same value for \(r\) as the quantile \(q\) does.
  Alternatively, choose a value of \(r\).  The bounds on an associated quantile
  are then given in Equation (7).  Note: the component called <code>parameters</code> in
  the list returned by <code>quantileTest</code> contains an element named
  <code>quantile.ub</code>.  The value of this element is the left-hand side of Equation (7).</p></li>
<li><p>Set \(k\) equal to the number of observations from the treatment group
  (the number of \(X\) observations) with ranks bigger than or equal to \(r\).</p></li>
<li><p>Under the null hypothesis (3), the probability that at least \(k\) out of
  the \(r\) largest observations come from the treatment group is given by:
  $$p = \sum_{i=k}^r \frac{{m+n-r \choose m-i} {r \choose i}}{{m+n \choose n}} \;\;\;\;\;\; (8)$$
  This probability may be approximated by:
  $$p = 1 - \Phi(\frac{k - \mu_k - 1/2}{\sigma_k}) \;\;\;\;\;\; (9)$$
  where
  $$\mu_k = \frac{mr}{m+n} \;\;\;\;\;\; (10)$$
  $$\sigma_k^2 = \frac{mnr(m+n-r)}{(m+n)^2 (m+n-1)} \;\;\;\;\;\; (11)$$
  and \(\Phi\) denotes the cumulative distribution function of the standard
  normal distribution (USEPA, 1994, pp.7.16-7.17).
  (See <code><a href="quantileTestPValue.html">quantileTestPValue</a></code>.)</p></li>
<li><p>Reject the null hypothesis (3) in favor of the alternative hypothesis (4) at
  significance level \(\alpha\) if \(p \le \alpha\).</p></li>
</ol><p>Johnson et al. (1987) note that their quantile test is asymptotically equivalent
  to one proposed by Carrano and Moore (1982) in the context of a two-sided test.
  Also, when \(q=0.5\), the quantile test reduces to Mood's median test for two
  groups (see Zar, 2010, p.172; Conover, 1980, pp.171-178).</p>
<p>The optimal choice of \(q\) or \(r\) in Step 2 above (i.e., the choice that
  yields the largest power) depends on the true underlying distributions of
  \(Y\) and \(Z\) and the mixing proportion \(\epsilon\).
  Johnson et al. (1987) performed a simulation study and showed that the quantile
  test performs better than the Wilcoxon rank sum test and the normal scores test
  under the alternative of a mixed normal distribution with a shift of at least
  2 standard deviations in the \(Z\) distribution.  USEPA (1994, pp.7.17-7.21)
  shows that when the mixing proportion \(\epsilon\) is small and the shift is
  large, the quantile test is more powerful than the Wilcoxon rank sum test, and
  when \(\epsilon\) is large and the shift is small the Wilcoxon rank sum test
  is more powerful than the quantile test.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>"htest"</code> containing the results of the hypothesis test.
  See the help file for <br><code><a href="htest.object.html">htest.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Carrano, A., and D. Moore. (1982).  The Rationale and Methodology for Quantifying
  Sister Chromatid Exchange in Humans.  In Heddle, J.A., ed.,
  <em>Mutagenicity: New Horizons in Genetic Toxocology</em>.  Academic Press, New York,
  pp.268-304.</p>
<p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>.  Second Edition.
  John Wiley and Sons, New York, Chapter 4.</p>
<p>Johnson, R.A., S. Verrill, and D.H. Moore. (1987).  Two-Sample Rank Tests for
  Detecting Changes That Occur in a Small Proportion of the Treated Population.
  <em>Biometrics</em> <b>43</b>, 641-655.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001).  <em>Environmental Statistics with
  S-PLUS</em>. CRC Press, Boca Raton, FL, pp.435-439.</p>
<p>USEPA. (1994).  <em>Statistical Methods for Evaluating the Attainment of Cleanup
  Standards, Volume 3: Reference-Based Standards for Soils and Solid Media</em>.
  EPA/230-R-94-004.  Office of Policy, Planning, and Evaluation,
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zar, J.H. (2010).  <em>Biostatistical Analysis</em>.  Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The EPA guidance document <em>Statistical Methods for Evaluating the Attainment of
  Cleanup Standards, Volume 3: Reference-Based Standards for Soils and Solid Media</em>
  (USEPA, 1994, pp.4.7-4.9) recommends three different statistical tests for
  determining whether a remediated Superfund site has attained compliance:
  the Wilcoxon rank sum test, the quantile test, and the “hot measurement”
  comparison test.  The Wilcoxon rank sum test and quantile test are nonparametric
  tests that compare chemical concentrations in the cleanup area with those in the
  reference area.  The hot-measurement comparison test compares concentrations in the
  cleanup area with a pre-specified upper limit value <em>Hm</em> (the value of
  <em>Hm</em> must be negotiated between the EPA and the Superfund-site owner or
  operator).  The Wilcoxon rank sum test is appropriate for detecting uniform failure
  of remedial action throughout the cleanup area.  The quantile test is appropriate
  for detecting failure in only a few areas within the cleanup area.  The
  hot-measurement comparison test is appropriate for detecting hot spots that need to
  be remediated regardless of the outcomes of the other two tests.</p>
<p>USEPA (1994, pp.4.7-4.9) recommends applying all three tests to all cleanup units
  within a cleanup area.  This leads to the usual multiple comparisons problem:  the
  probability of at least one of the tests indicating non-compliance, when in fact the
  cleanup area is in compliance, is greater than the pre-set Type I error level for
  any of the individual tests.  USEPA (1994, p.3.3) recommends against using
  multiple comparison procedures to control the overall Type I error and suggests
  instead a re-sampling scheme where additional samples are taken in cases where
  non-compliance is indicated.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="quantileTestPValue.html">quantileTestPValue</a></code>, <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code>,
  <code><a href="htest.object.html">htest.object</a></code>, <a href="FcnsByCatHypothTests.html">Hypothesis Tests</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Following Example 7.5 on pages 7.23-7.24 of USEPA (1994b), perform the </span></span></span>
<span class="r-in"><span>  <span class="co"># quantile test for the TcCB data (the data are stored in EPA.94b.tccb.df).  </span></span></span>
<span class="r-in"><span>  <span class="co"># There are n=47 observations from the reference area and m=77 observations </span></span></span>
<span class="r-in"><span>  <span class="co"># from the cleanup unit.  The target rank is set to 9, resulting in a value </span></span></span>
<span class="r-in"><span>  <span class="co"># of quantile.ub=0.928.  Note that the p-value is 0.0114, not 0.0117.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.94b.tccb.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     TcCB.orig   TcCB Censored      Area</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        0.22   0.22    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        0.23   0.23    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        0.26   0.26    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        0.27   0.27    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        0.28   0.28    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        0.28   0.28    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        0.29   0.29    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        0.33   0.33    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        0.34   0.34    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       0.35   0.35    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       0.38   0.38    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       0.39   0.39    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13       0.39   0.39    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14       0.42   0.42    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15       0.42   0.42    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16       0.43   0.43    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17       0.45   0.45    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18       0.46   0.46    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19       0.48   0.48    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20       0.50   0.50    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21       0.50   0.50    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22       0.51   0.51    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23       0.52   0.52    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24       0.54   0.54    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25       0.56   0.56    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26       0.56   0.56    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27       0.57   0.57    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28       0.57   0.57    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29       0.60   0.60    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30       0.62   0.62    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31       0.63   0.63    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32       0.67   0.67    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33       0.69   0.69    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34       0.72   0.72    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35       0.74   0.74    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36       0.76   0.76    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37       0.79   0.79    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38       0.81   0.81    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39       0.82   0.82    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40       0.84   0.84    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41       0.89   0.89    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42       1.11   1.11    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43       1.13   1.13    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44       1.14   1.14    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45       1.14   1.14    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46       1.20   1.20    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47       1.33   1.33    FALSE Reference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48      &lt;0.09   0.09     TRUE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49       0.09   0.09    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50       0.09   0.09    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51       0.12   0.12    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52       0.12   0.12    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53       0.14   0.14    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54       0.16   0.16    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55       0.17   0.17    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56       0.17   0.17    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57       0.17   0.17    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58       0.18   0.18    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59       0.19   0.19    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60       0.20   0.20    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61       0.20   0.20    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62       0.21   0.21    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63       0.21   0.21    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64       0.22   0.22    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65       0.22   0.22    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66       0.22   0.22    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67       0.23   0.23    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68       0.24   0.24    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69       0.25   0.25    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70       0.25   0.25    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71       0.25   0.25    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72       0.25   0.25    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73       0.26   0.26    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74       0.28   0.28    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75       0.28   0.28    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76       0.29   0.29    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77       0.31   0.31    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78       0.33   0.33    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79       0.33   0.33    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80       0.33   0.33    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81       0.34   0.34    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82       0.37   0.37    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83       0.38   0.38    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84       0.39   0.39    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85       0.40   0.40    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86       0.43   0.43    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87       0.43   0.43    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88       0.47   0.47    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89       0.48   0.48    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90       0.48   0.48    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91       0.49   0.49    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92       0.51   0.51    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93       0.51   0.51    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94       0.54   0.54    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95       0.60   0.60    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96       0.61   0.61    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97       0.62   0.62    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98       0.75   0.75    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99       0.82   0.82    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100      0.85   0.85    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101      0.92   0.92    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102      0.94   0.94    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103      1.05   1.05    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104      1.10   1.10    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105      1.10   1.10    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106      1.19   1.19    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107      1.22   1.22    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108      1.33   1.33    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109      1.39   1.39    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110      1.39   1.39    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111      1.52   1.52    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112      1.53   1.53    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113      1.73   1.73    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114      2.35   2.35    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115      2.46   2.46    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116      2.59   2.59    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117      2.61   2.61    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118      3.06   3.06    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119      3.29   3.29    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120      5.56   5.56    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121      6.61   6.61    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122     18.40  18.40    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123     51.97  51.97    FALSE   Cleanup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124    168.64 168.64    FALSE   Cleanup</span>
<span class="r-in"><span>  <span class="co">#    TcCB.orig   TcCB Censored      Area</span></span></span>
<span class="r-in"><span>  <span class="co">#1        0.22   0.22    FALSE Reference</span></span></span>
<span class="r-in"><span>  <span class="co">#2        0.23   0.23    FALSE Reference</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#46       1.20   1.20    FALSE Reference</span></span></span>
<span class="r-in"><span>  <span class="co">#47       1.33   1.33    FALSE Reference</span></span></span>
<span class="r-in"><span>  <span class="co">#48      &lt;0.09   0.09     TRUE   Cleanup</span></span></span>
<span class="r-in"><span>  <span class="co">#49       0.09   0.09    FALSE   Cleanup</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#123     51.97  51.97    FALSE   Cleanup</span></span></span>
<span class="r-in"><span>  <span class="co">#124    168.64 168.64    FALSE   Cleanup</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Determine the values to use for r and k for </span></span></span>
<span class="r-in"><span>  <span class="co"># a desired significance level of 0.01 </span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="quantileTestPValue.html">quantileTestPValue</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">77</span>, n <span class="op">=</span> <span class="fl">47</span>, </span></span>
<span class="r-in"><span>    r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p.vals</span>, <span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.355 0.122 0.019 0.264 0.081 0.011 0.193 0.053 0.007</span>
<span class="r-in"><span>  <span class="co">#[1] 0.355 0.122 0.019 0.264 0.081 0.011 0.193 0.053 0.007 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Choose r=9, k=9 to get a significance level of 0.011</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu">quantileTest</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Cleanup"</span><span class="op">]</span>, <span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Reference"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>    target.r <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Quantile Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  TcCB[Area == "Cleanup"]TcCB[Area == "Reference"]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k (# x obs of r largest) = 9, r = 9, m = 77.000, n = 47.000,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> quantile.ub = 0.928, p-value = 0.01137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true e is  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 e = 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          Tail of Fx Shifted to Right of</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Tail of Fy.</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 0 &lt; e &lt;= 1, where</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Fx(t) = (1-e)*Fy(t) + e*Fz(t),</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Fz(t) &lt;= Fy(t) for all t,</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 and Fy != Fz</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Quantile Test</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x = TcCB[Area == "Cleanup"]  </span></span></span>
<span class="r-in"><span>  <span class="co">#                                 y = TcCB[Area == "Reference"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Sizes:                    nx = 77</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 ny = 47</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistics:                 k (# x obs of r largest) = 9</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 r                        = 9</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic Parameters:       m           = 77.000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 n           = 47.000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 quantile.ub =  0.928</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.01136926</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">p.vals</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

