<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sample Size for Simultaneous Nonparametric Prediction Interval for Continuous Distribution — predIntNparSimultaneousN • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size for Simultaneous Nonparametric Prediction Interval for Continuous Distribution — predIntNparSimultaneousN"><meta property="og:description" content="Compute the sample size necessary for a nonparametric simultaneous prediction
  interval to achieve a specified confidence level based on one of three possible
  rules: k-of-m, California, or Modified California.  Observations are assumed to
  come from from a continuous distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample Size for Simultaneous Nonparametric Prediction Interval for Continuous Distribution</h1>

    <div class="hidden name"><code>predIntNparSimultaneousN.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the sample size necessary for a nonparametric simultaneous prediction
  interval to achieve a specified confidence level based on one of three possible
  rules: k-of-m, California, or Modified California.  Observations are assumed to
  come from from a continuous distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>n.median <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">1</span>, rule <span class="op">=</span> <span class="st">"k.of.m"</span>, </span>
<span>    lpl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"upper"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"lower"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, </span>
<span>    conf.level <span class="op">=</span> <span class="fl">0.95</span>, n.max <span class="op">=</span> <span class="fl">5000</span>, integrate.args.list <span class="op">=</span> <span class="cn">NULL</span>, maxiter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n-median">n.median<a class="anchor" aria-label="anchor" href="#arg-n-median"></a></dt>
<dd><p>vector of positive odd integers specifying the sample size associated with the
  future medians.  The default value is <code>n.median=1</code> (i.e., individual
  observations).  Note that all future medians must be based on the same
  sample size.</p></dd>

  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>for the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), a vector of positive integers
  specifying the minimum number of observations (or medians) out of \(m\)
  observations (or medians) (all obtained on one future sampling “occassion”)
  the prediction interval should contain.
  The default value is <code>k=1</code>.  This argument is ignored when the argument
  <code>rule</code> is not equal to <code>"k.of.m"</code>.</p></dd>

  <dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>vector of positive integers specifying the maximum number of future observations (or
  medians) on one future sampling “occasion”.
  The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which
  case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.</p></dd>

  <dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>vector of positive integers specifying the number of future sampling
  “occasions”.  The default value is <code>r=1</code>.</p></dd>

  <dt id="arg-rule">rule<a class="anchor" aria-label="anchor" href="#arg-rule"></a></dt>
<dd><p>character string specifying which rule to use.  The possible values are
  <code>"k.of.m"</code> (\(k\)-of-\(m\) rule; the default), <code>"CA"</code> (California rule),
  and <code>"Modified.CA"</code> (modified California rule).</p></dd>

  <dt id="arg-lpl-rank">lpl.rank<a class="anchor" aria-label="anchor" href="#arg-lpl-rank"></a></dt>
<dd><p>vector of positive integers indicating the rank of the order statistic to use for
  the lower bound of the prediction interval.  When <code>pi.type="lower"</code>, the
  default value is <code>lpl.rank=1</code> (implying the minimum value of <code>x</code> is used
  as the lower bound of the prediction interval).  When <code>pi.type="upper"</code>,
  the argument <code>lpl.rank</code> is set equal to <code>0</code>.</p></dd>

  <dt id="arg-n-plus-one-minus-upl-rank">n.plus.one.minus.upl.rank<a class="anchor" aria-label="anchor" href="#arg-n-plus-one-minus-upl-rank"></a></dt>
<dd><p>vector of positive integers related to the rank of the order statistic to use for
  the upper bound of the prediction interval.  A value of <code>n.plus.one.minus.upl.rank=1</code>
  (the default) means use the first largest value, and in general a value of <br><code>n.plus.one.minus.upl.rank=</code>\(i\) means use the \(i\)'th largest value. If <br><code>pi.type="lower"</code>, this argument is set equal to <code>0</code>.</p></dd>

  <dt id="arg-pi-type">pi.type<a class="anchor" aria-label="anchor" href="#arg-pi-type"></a></dt>
<dd><p>character string indicating what kind of prediction interval to compute.
  The possible values are <code>"two.sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>numeric vector of values between 0 and 1 indicating the confidence level
  associated with the prediction interval.  The default value is <code>conf=0.95</code>.</p></dd>

  <dt id="arg-n-max">n.max<a class="anchor" aria-label="anchor" href="#arg-n-max"></a></dt>
<dd><p>numeric scalar indicating the maximum sample size to consider.  This argument
  is used in the search algorithm to determine the required sample size.  The
  default value is <code>n.max=5000</code>.</p></dd>

  <dt id="arg-integrate-args-list">integrate.args.list<a class="anchor" aria-label="anchor" href="#arg-integrate-args-list"></a></dt>
<dd><p>list of arguments to supply to the <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code> function.  The default
  value is <code>NULL</code>.</p></dd>

  <dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>positive integer indicating the maximum number of iterations to use in the
  <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> search algorithm.  The default value is
  <code>maxiter=1000</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the arguments <code>k</code>, <code>m</code>, <code>r</code>, <code>lpl.rank</code>, and
  <code>n.plus.one.minus.upl.rank</code> are not all the same length, they are replicated
  to be the same length as the length of the longest argument.</p>
<p>The function <code>predIntNparSimultaneousN</code> computes the required sample size
  \(n\) by solving Equation (8), (9), or (10) in the help file for
  <code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code> for \(n\), depending on the value of the
  argument <code>rule</code>.</p>
<p>Note that when <code>rule="k.of.m"</code> and <code>r=1</code>, this is equivalent to a
  standard nonparametric prediction interval and you can use the function
  <code><a href="predIntNparN.html">predIntNparN</a></code> instead.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>vector of positive integers indicating the required sample size(s) for the
  specified nonparametric simultaneous prediction interval(s).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>See the help file for <code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>See the help file for <code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code>,
  <code><a href="predIntNparSimultaneousConfLevel.html">predIntNparSimultaneousConfLevel</a></code>, <br><code><a href="plotPredIntNparSimultaneousDesign.html">plotPredIntNparSimultaneousDesign</a></code>,
  <code><a href="predIntNparSimultaneousTestPower.html">predIntNparSimultaneousTestPower</a></code>,
  <code><a href="predIntNpar.html">predIntNpar</a></code>, <code><a href="tolIntNpar.html">tolIntNpar</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># For the 1-of-2 rule, look at how the required sample size for a one-sided </span></span></span>
<span class="r-in"><span>  <span class="co"># upper simultaneous nonparametric prediction interval for r=20 future </span></span></span>
<span class="r-in"><span>  <span class="co"># sampling occasions increases with increasing confidence level:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.6 0.7 0.8 0.9</span>
<span class="r-in"><span>  <span class="co">#[1] 0.5 0.6 0.7 0.8 0.9 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>r <span class="op">=</span> <span class="fl">20</span>, conf.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  4  5  7 10 17</span>
<span class="r-in"><span>  <span class="co">#[1]  4  5  7 10 17</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># For the 1-of-m rule, look at how the required sample size for a one-sided </span></span></span>
<span class="r-in"><span>  <span class="co"># upper simultaneous nonparametric prediction interval decreases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># number of future observations (m), given r=20 future sampling occasions:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, r <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 380  26  11   7   5</span>
<span class="r-in"><span>  <span class="co">#[1] 380  26  11   7   5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># For the 1-of-3 rule, look at how the required sample size for a one-sided </span></span></span>
<span class="r-in"><span>  <span class="co"># upper simultaneous nonparametric prediction interval increases with number </span></span></span>
<span class="r-in"><span>  <span class="co"># of future sampling occasions (r):</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  7  8 10 11</span>
<span class="r-in"><span>  <span class="co">#[1]  7  8 10 11</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># For the 1-of-3 rule, look at how the required sample size for a one-sided </span></span></span>
<span class="r-in"><span>  <span class="co"># upper simultaneous nonparametric prediction interval increases as the rank </span></span></span>
<span class="r-in"><span>  <span class="co"># of the upper prediction limit decreases, given r=20 future sampling occasions:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">20</span>, n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11 19 26 34 41</span>
<span class="r-in"><span>  <span class="co">#[1] 11 19 26 34 41</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare the required sample size for r=20 future sampling occasions based </span></span></span>
<span class="r-in"><span>  <span class="co"># on the 1-of-3 rule, the CA rule with m=3, and the Modified CA rule.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">20</span>, rule <span class="op">=</span> <span class="st">"k.of.m"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11</span>
<span class="r-in"><span>  <span class="co">#[1] 11 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">20</span>, rule <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 36</span>
<span class="r-in"><span>  <span class="co">#[1] 36 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>r <span class="op">=</span> <span class="fl">20</span>, rule <span class="op">=</span> <span class="st">"Modified.CA"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-in"><span>  <span class="co">#[1] 15</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example 19-5 of USEPA (2009, p. 19-33) shows how to compute nonparametric upper </span></span></span>
<span class="r-in"><span>  <span class="co"># simultaneous prediction limits for various rules based on trace mercury data (ppb) </span></span></span>
<span class="r-in"><span>  <span class="co"># collected in the past year from a site with four background wells and 10 compliance </span></span></span>
<span class="r-in"><span>  <span class="co"># wells (data for two of the compliance wells  are shown in the guidance document).  </span></span></span>
<span class="r-in"><span>  <span class="co"># The facility must monitor the 10 compliance wells for five constituents </span></span></span>
<span class="r-in"><span>  <span class="co"># (including mercury) annually.</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Here we will modify the example to compute the required number of background </span></span></span>
<span class="r-in"><span>  <span class="co"># observations for two different sampling plans: </span></span></span>
<span class="r-in"><span>  <span class="co"># 1) the 1-of-2 retesting plan for a median of order 3 using the background maximum and </span></span></span>
<span class="r-in"><span>  <span class="co"># 2) the 1-of-4 plan on individual observations using the 3rd highest background value.</span></span></span>
<span class="r-in"><span>  <span class="co"># The data for this example are stored in EPA.09.Ex.19.5.mercury.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># There are 10 compliance wells and we will monitor 5 different </span></span></span>
<span class="r-in"><span>  <span class="co"># constituents at each well annually.  For this example, USEPA (2009) </span></span></span>
<span class="r-in"><span>  <span class="co"># recommends setting r to the product of the number of compliance wells and </span></span></span>
<span class="r-in"><span>  <span class="co"># the number of evaluations per year.  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># To determine the minimum confidence level we require for </span></span></span>
<span class="r-in"><span>  <span class="co"># the simultaneous prediction interval, USEPA (2009) recommends </span></span></span>
<span class="r-in"><span>  <span class="co"># setting the maximum allowed individual Type I Error level per constituent to:</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="co"># 1 - (1 - SWFPR)^(1 / Number of Constituents)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># which translates to setting the confidence limit to </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># (1 - SWFPR)^(1 / Number of Constituents)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># where SWFPR = site-wide false positive rate.  For this example, we </span></span></span>
<span class="r-in"><span>  <span class="co"># will set SWFPR = 0.1.  Thus, the required individual Type I Error level </span></span></span>
<span class="r-in"><span>  <span class="co"># and confidence level per constituent are given as follows:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># nw = 10 Compliance Wells</span></span></span>
<span class="r-in"><span>  <span class="co"># nc =  5 Constituents</span></span></span>
<span class="r-in"><span>  <span class="co"># ne =  1 Evaluation per year</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">nw</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>  <span class="va">nc</span> <span class="op">&lt;-</span>  <span class="fl">5</span></span></span>
<span class="r-in"><span>  <span class="va">ne</span> <span class="op">&lt;-</span>  <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Set number of future sampling occasions r to </span></span></span>
<span class="r-in"><span>  <span class="co"># Number Compliance Wells x Number Evaluations per Year</span></span></span>
<span class="r-in"><span>  <span class="va">r</span>  <span class="op">&lt;-</span>  <span class="va">nw</span> <span class="op">*</span> <span class="va">ne</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">nc</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9791484</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9791484</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># So the required confidence level is 0.98, or 98%.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now determine the required number of background observations for  each plan.</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="co"># 1) the 1-of-2 retesting plan for a median of order 3 using the </span></span></span>
<span class="r-in"><span>  <span class="co">#    background maximum</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>n.median <span class="op">=</span> <span class="fl">3</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="va">r</span>, </span></span>
<span class="r-in"><span>    conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14</span>
<span class="r-in"><span>  <span class="co">#[1] 14</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># 2) the 1-of-4 plan on individual observations using the 3rd highest </span></span></span>
<span class="r-in"><span>  <span class="co">#    background value.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousN</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">4</span>, r <span class="op">=</span> <span class="va">r</span>, </span></span>
<span class="r-in"><span>    n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fl">3</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-in"><span>  <span class="co">#[1] 18</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Cleanup</span></span></span>
<span class="r-in"><span>  <span class="co">#--------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">nw</span>, <span class="va">nc</span>, <span class="va">ne</span>, <span class="va">r</span>, <span class="va">conf.level</span><span class="op">)</span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

