<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Power of a One- or Two-Sample t-Test — tTestPower • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Power of a One- or Two-Sample t-Test — tTestPower"><meta property="og:description" content="Compute the power of a one- or two-sample t-test, given the sample size, scaled
  difference, and significance level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power of a One- or Two-Sample t-Test</h1>

    <div class="hidden name"><code>tTestPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the power of a one- or two-sample t-test, given the sample size, scaled
  difference, and significance level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tTestPower</span><span class="op">(</span><span class="va">n.or.n1</span>, n2 <span class="op">=</span> <span class="va">n.or.n1</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>    sample.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span>, <span class="st">"two.sample"</span>, <span class="st">"one.sample"</span><span class="op">)</span>, </span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, approx <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n-or-n-">n.or.n1<a class="anchor" aria-label="anchor" href="#arg-n-or-n-"></a></dt>
<dd><p>numeric vector of sample sizes.  When <code>sample.type="one.sample"</code>,
  <code>n.or.n1</code> denotes \(n\), the number of observations in the single sample.  When <br><code>sample.type="two.sample"</code>, <code>n.or.n1</code> denotes \(n_1\), the number
  of observations from group 1.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are <b><em>not</em></b> allowed.</p></dd>

  <dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>numeric vector of sample sizes for group 2.  The default value is the value of
  <code>n.or.n1</code>. This argument is ignored when <code>sample.type="one.sample"</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are <b><em>not</em></b> allowed.</p></dd>

  <dt id="arg-delta-over-sigma">delta.over.sigma<a class="anchor" aria-label="anchor" href="#arg-delta-over-sigma"></a></dt>
<dd><p>numeric vector specifying the ratio of the true difference \(\delta\)
  (\(\delta = \mu - \mu_0\) for the one-sample case and
  \(\delta = \mu_1 - \mu_2\) for the two-sample case)
  to the population standard deviation (\(\sigma\)).  This is also called the
  “scaled difference”.</p>
<p>The default value is <code>delta.over.sigma=0</code>.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>numeric vector of numbers between 0 and 1 indicating the Type I error level
  associated with the hypothesis test.  The default value is <code>alpha=0.05</code>.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string indicating whether to compute power based on a one-sample or
  two-sample hypothesis test.  When <code>sample.type="one.sample"</code>, the computed
  power is based on a hypothesis test for a single mean.  When <br><code>sample.type="two.sample"</code>, the computed power is based on a hypothesis test
  for the difference between two means.  The default value is
  <code>sample.type="one.sample"</code> unless the argument <code>n2</code> is supplied.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values
  are:</p>
<p></p><ul><li><p><code>"two.sided"</code> (the default).  \(H_a: \mu \ne \mu_0\) for the one-sample case and
    \(H_a: \mu_1 \ne \mu_2\) for the two-sample case.</p></li>
<li><p><code>"greater"</code>.  \(H_a: \mu &gt; \mu_0\) for the one-sample case and
    \(H_a: \mu_1 &gt; \mu_2\) for the two-sample case.</p></li>
<li><p><code>"less"</code>.  \(H_a: \mu &lt; \mu_0\) for the one-sample case and
    \(H_a: \mu_1 &lt; \mu_2\) for the two-sample case.</p></li>
</ul></dd>

  <dt id="arg-approx">approx<a class="anchor" aria-label="anchor" href="#arg-approx"></a></dt>
<dd><p>logical scalar indicating whether to compute the power based on an approximation to
  the non-central t-distribution.  The default value is <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the arguments <code>n.or.n1</code>, <code>n2</code>, <code>delta.over.sigma</code>, and
  <code>alpha</code> are not all the same length, they are replicated to be the same
  length as the length of the longest argument.</p>
<p><b>One-Sample Case</b> (<code>sample.type="one.sample"</code>) <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a vector of \(n\)
  observations from a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> with mean \(\mu\)
  and standard deviation \(\sigma\), and consider the null hypothesis:
  $$H_0: \mu = \mu_0 \;\;\;\;\;\; (1)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>):
  $$H_a: \mu &gt; \mu_0 \;\;\;\;\;\; (2)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: \mu &lt; \mu_0 \;\;\;\;\;\; (3)$$
  and the two-sided alternative (<code>alternative="two.sided"</code>)
  $$H_a: \mu \ne \mu_0 \;\;\;\;\;\; (4)$$
  The test of the null hypothesis (1) versus any of the three alternatives (2)-(4) is
  based on the <a href="https://rdrr.io/r/stats/t.test.html" class="external-link">Student t-statistic</a>:
  $$t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}} \;\;\;\;\;\; (5)$$
  where
  $$\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (6)$$
  $$s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (7)$$
  Under the null hypothesis (1), the t-statistic in (5) follows a
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(n-1\) degrees of freedom
  (Zar, 2010, Chapter 7; Johnson et al., 1995, pp.362-363).</p>
<p>The formula for the power of the test depends on which alternative is being tested.
  The two subsections below describe exact and approximate formulas for the power of
  the one-sample t-test.  Note that none of the equations for the power of the t-test
  requires knowledge of the values \(\delta\) (Equation (12) below) or \(\sigma\)
  (the population standard deviation), only the ratio \(\delta/\sigma\).  The
  argument <code>delta.over.sigma</code> is this ratio, and it is referred to as the
  “scaled difference”.
  <br></p>
<p><b><em>Exact Power Calculations</em></b> (<code>approx=FALSE</code>) <br>
  This subsection describes the exact formulas for the power of the one-sample
  t-test.
  <br></p>
<p><em>Upper one-sided alternative</em> (<code>alternative="greater"</code>) <br>
  The standard Student's t-test rejects the null hypothesis (1) in favor of the
  upper alternative hypothesis (2) at level-\(\alpha\) if
  $$t \ge t_{\nu}(1 - \alpha) \;\;\;\;\;\; (8)$$
  where
  $$\nu = n - 1 \;\;\;\;\;\; (9)$$
  and \(t_{\nu}(p)\) denotes the \(p\)'th quantile of Student's t-distribution
  with \(\nu\) degrees of freedom (Zar, 2010; Berthouex and Brown, 2002).
  The power of this test, denoted by \(1-\beta\), where \(\beta\) denotes the
  probability of a Type II error, is given by:
  $$1 - \beta = Pr[t_{\nu, \Delta} \ge t_{\nu}(1 - \alpha)] = 1 - G[t_{\nu}(1 - \alpha), \nu, \Delta] \;\;\;\;\;\; (10)$$
  where
  $$\Delta = \sqrt{n} (\frac{\delta}{\sigma}) \;\;\;\;\;\; (11)$$
  $$\delta = \mu - \mu_0 \;\;\;\;\;\ (12)$$
  and \(t_{\nu, \Delta}\) denotes a
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">non-central Student's t-random variable</a> with
  \(\nu\) degrees of freedom and non-centrality parameter \(\Delta\), and
  \(G(x, \nu, \Delta)\) denotes the cumulative distribution function of this
  random variable evaluated at \(x\) (Johnson et al., 1995, pp.508-510).
  <br></p>
<p><em>Lower one-sided alternative</em> (<code>alternative="less"</code>) <br>
  The standard Student's t-test rejects the null hypothesis (1) in favor of the
  lower alternative hypothesis (3) at level-\(\alpha\) if
  $$t \le t_{\nu}(\alpha) \;\;\;\;\;\; (13)$$
  and the power of this test is given by:
  $$1 - \beta = Pr[t_{\nu, \Delta} \le t_{\nu}(\alpha)] = G[t_{\nu}(\alpha), \nu, \Delta] \;\;\;\;\;\; (14)$$
  <br></p>
<p><em>Two-sided alternative</em> (<code>alternative="two.sided"</code>) <br>
  The standard Student's t-test rejects the null hypothesis (1) in favor of the
  two-sided alternative hypothesis (4) at level-\(\alpha\) if
  $$|t| \ge t_{\nu}(1 - \alpha/2) \;\;\;\;\;\; (15)$$
  and the power of this test is given by:
  $$1 - \beta = Pr[t_{\nu, \Delta} \le t_{\nu}(\alpha/2)] + Pr[t_{\nu, \Delta} \ge t_{\nu}(1 - \alpha/2)]$$
  $$= G[t_{\nu}(\alpha/2), \nu, \Delta] + 1 - G[t_{\nu}(1 - \alpha/2), \nu, \Delta] \;\;\;\;\;\; (16)$$
  The power of the t-test given in Equation (16) can also be expressed in terms of the
  cumulative distribution function of the <a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">non-central F-distribution</a>
  as follows. Let \(F_{\nu_1, \nu_2, \Delta}\) denote a
  <a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">non-central F random variable</a> with \(\nu_1\) and
  \(\nu_2\) degrees of freedom and non-centrality parameter \(\Delta\), and let
  \(H(x, \nu_1, \nu_2, \Delta)\) denote the cumulative distribution function of this
  random variable evaluated at \(x\). Also, let \(F_{\nu_1, \nu_2}(p)\) denote
  the \(p\)'th quantile of the central F-distribution with \(\nu_1\) and
  \(\nu_2\) degrees of freedom.  It can be shown that
  $$(t_{\nu, \Delta})^2 \cong F_{1, \nu, \Delta^2} \;\;\;\;\;\; (17)$$
  where \(\cong\) denotes “equal in distribution”.  Thus, it follows that
  $$[t_{\nu}(1 - \alpha/2)]^2 = F_{1, \nu}(1 - \alpha) \;\;\;\;\;\; (18)$$
  so the formula for the power of the t-test given in Equation (16) can also be
  written as:
  $$1 - \beta = Pr\{(t_{\nu, \Delta})^2  \ge [t_{\nu}(1 - \alpha/2)]^2\}$$
  $$= Pr[F_{1, \nu, \Delta^2} \ge F_{1, \nu}(1 - \alpha)] = 1 - H[F_{1, \nu}(1-\alpha), 1, \nu, \Delta^2] \;\;\;\;\;\; (19)$$
  <br></p>
<p><b><em>Approximate Power Calculations</em></b> (<code>approx=TRUE</code>) <br>
  Zar (2010, pp.115–118) presents an approximation to the power for the t-test
  given in Equations (10), (14), and (16) above.  His approximation to the power
  can be derived by using the approximation
  $$\sqrt{n} (\frac{\delta}{s}) \approx \sqrt{n} (\frac{\delta}{\sigma}) = \Delta \;\;\;\;\;\; (20)$$
  where \(\approx\) denotes “approximately equal to”.  Zar's approximation
  can be summarized in terms of the cumulative distribution function of the
  non-central t-distribution as follows:
  $$G(x, \nu, \Delta) \approx G(x - \Delta, \nu, 0) = G(x - \Delta, \nu) \;\;\;\;\;\; (21)$$
  where \(G(x, \nu)\) denotes the cumulative distribution function of the
  central Student's t-distribution with \(\nu\) degrees of freedom evaluated at
  \(x\).</p>
<p>The following three subsections explicitly derive the approximation to the power of
  the t-test for each of the three alternative hypotheses.
  <br></p>
<p><em>Upper one-sided alternative</em> (<code>alternative="greater"</code>) <br>
  The power for the upper one-sided alternative (2) given in Equation (10) can be
  approximated as:
  $$1 - \beta = Pr[t \ge t_{\nu}(1 - \alpha)]$$
  $$= Pr[\frac{\bar{x} - \mu}{s/\sqrt{n}} \ge t_{\nu}(1 - \alpha) - \sqrt{n}\frac{\delta}{s}]$$
  $$\approx Pr[t_{\nu} \ge t_{\nu}(1 - \alpha) - \Delta]$$
  $$= 1 - Pr[t_{\nu} \le t_{\nu}(1 - \alpha) - \Delta]$$
  $$ = 1 - G[t_{\nu}(1-\alpha) - \Delta, \nu] \;\;\;\;\;\; (22)$$
  where \(t_{\nu}\) denotes a central Student's t-random variable with \(\nu\)
  degrees of freedom.
  <br></p>
<p><em>Lower one-sided alternative</em> (<code>alternative="less"</code>) <br>
  The power for the lower one-sided alternative (3) given in Equation (14) can be
  approximated as:
  $$1 - \beta = Pr[t \le t_{\nu}(\alpha)]$$
  $$= Pr[\frac{\bar{x} - \mu}{s/\sqrt{n}} \le t_{\nu}(\alpha) - \sqrt{n}\frac{\delta}{s}]$$
  $$\approx Pr[t_{\nu} \le t_{\nu}(\alpha) - \Delta]$$
  $$ = G[t_{\nu}(\alpha) - \Delta, \nu] \;\;\;\;\;\; (23)$$
  <br></p>
<p><em>Two-sided alternative</em> (<code>alternative="two.sided"</code>) <br>
  The power for the two-sided alternative (4) given in Equation (16) can be
  approximated as:
  $$1 - \beta = Pr[t \le t_{\nu}(\alpha/2)] + Pr[t \ge t_{\nu}(1 - \alpha/2)]$$
  $$= Pr[\frac{\bar{x} - \mu}{s/\sqrt{n}} \le t_{\nu}(\alpha/2) - \sqrt{n}\frac{\delta}{s}] + Pr[\frac{\bar{x} - \mu}{s/\sqrt{n}} \ge t_{\nu}(1 - \alpha) - \sqrt{n}\frac{\delta}{s}]$$
  $$\approx Pr[t_{\nu} \le t_{\nu}(\alpha/2) - \Delta] + Pr[t_{\nu} \ge t_{\nu}(1 - \alpha/2) - \Delta]$$
  $$= G[t_{\nu}(\alpha/2) - \Delta, \nu] + 1 - G[t_{\nu}(1-\alpha/2) - \Delta, \nu] \;\;\;\;\;\; (24)$$
  <br></p>
<p><b>Two-Sample Case</b> (<code>sample.type="two.sample"</code>) <br>
  Let \(\underline{x}_1 = x_{11}, x_{12}, \ldots, x_{1n_1}\) denote a vector of
  \(n_1\) observations from a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> with mean
  \(\mu_1\) and standard deviation \(\sigma\), and let
  \(\underline{x}_2 = x_{21}, x_{22}, \ldots, x_{2n_2}\) denote a vector of
  \(n_2\) observations from a normal distribution with mean \(\mu_2\) and
  standard deviation \(\sigma\), and consider the null hypothesis:
  $$H_0: \mu_1 = \mu_2 \;\;\;\;\;\; (25)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>):
  $$H_a: \mu_1 &gt; \mu_2 \;\;\;\;\;\; (26)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: \mu_1 &lt; \mu_2 \;\;\;\;\;\; (27)$$
  and the two-sided alternative (<code>alternative="two.sided"</code>)
  $$H_a: \mu_1 \ne \mu_2 \;\;\;\;\;\; (28)$$
  The test of the null hypothesis (25) versus any of the three alternatives (26)-(28)
  is based on the <a href="https://rdrr.io/r/stats/t.test.html" class="external-link">Student t-statistic</a>:
  $$t = \frac{\bar{x}_1 - \bar{x}_2}{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} \;\;\;\;\;\; (29)$$
  where
  $$\bar{x}_1 = \frac{1}{n_1} \sum_{i=1}^{n_1} x_{1i} \;\;\;\;\;\; (30)$$
  $$\bar{x}_2 = \frac{1}{n_2} \sum_{i=1}^{n_2} x_{2i} \;\;\;\;\;\; (31)$$
  $$s_p^2 = \frac{(n_1 - 1) s_1^2 + (n_2 - 1) s_2^2}{n_1 + n_2 - 2} \;\;\;\;\;\; (32)$$
  $$s_1^2 = \frac{1}{n_1 - 1} \sum_{i=1}^{n_1} (x_{1i} - \bar{x}_1)^2 \;\;\;\;\;\; (33)$$
  $$s_2^2 = \frac{1}{n_2 - 1} \sum_{i=1}^{n_2} (x_{2i} - \bar{x}_2)^2 \;\;\;\;\;\; (34)$$
  Under the null hypothesis (25), the t-statistic in (29) follows a
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(n_1 + n_2 - 2\) degrees of
  freedom (Zar, 2010, Chapter 8; Johnson et al., 1995, pp.508–510,
  Helsel and Hirsch, 1992, pp.124–128).</p>
<p>The formulas for the power of the two-sample t-test are precisely the same as those
  for the one-sample case, with the following modifications:
  $$\nu = n_1 + n_2 - 2 \;\;\;\;\;\; (35)$$
  $$\Delta = \sqrt{\frac{n_1 n_2}{n_1 + n_2}} (\frac{\delta}{\sigma}) \;\;\;\;\;\; (36)$$
  $$\delta = \mu_1 - \mu_2 \;\;\;\;\;\; (37)$$</p>
<p>Note that none of the equations for the power of the t-test requires knowledge of
  the values \(\delta\) or \(\sigma\) (the population standard deviation for
  both populations), only the ratio \(\delta/\sigma\).  The argument
  <code>delta.over.sigma</code> is this ratio, and it is referred to as the
  “scaled difference”.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a numeric vector powers.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers</em>.  Second Edition.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, Chapter 7.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1995).  <em>Continuous Univariate
  Distributions, Volume 2</em>.  Second Edition.  John Wiley and Sons, New York,
  Chapters 28, 31</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, FL.</p>
<p>USEPA. (1989b). <em>Statistical Analysis of Ground-Water Monitoring Data at RCRA Facilities, Interim Final Guidance</em>.
  EPA/530-SW-89-026. Office of Solid Waste, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> and
  <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">lognormal distribution</a> are probably the two most
  frequently used distributions to model environmental data.  Often, you need to
  determine whether a population mean is significantly different from a specified
  standard (e.g., an MCL or ACL, USEPA, 1989b, Section 6), or whether two different
  means are significantly different from each other (e.g., USEPA 2009, Chapter 16).
  In this case, assuming normally distributed data, you can perform the
  Student's t-test.</p>
<p>In the course of designing a sampling program, an environmental scientist may wish
  to determine the relationship between sample size, significance level, power, and
  scaled difference if one of the objectives of the sampling program is to determine
  whether a mean differs from a specified level or two means differ from each other.
  The functions <code>tTestPower</code>, <code><a href="tTestN.html">tTestN</a></code>,
  <code><a href="tTestScaledMdd.html">tTestScaledMdd</a></code>, and <code><a href="plotTTestDesign.html">plotTTestDesign</a></code> can be used to
  investigate these relationships for the case of normally-distributed observations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="tTestN.html">tTestN</a></code>, <code><a href="tTestScaledMdd.html">tTestScaledMdd</a></code>, <code><a href="tTestAlpha.html">tTestAlpha</a></code>,
  <code><a href="plotTTestDesign.html">plotTTestDesign</a></code>, <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>,
  <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>, <a href="FcnsByCatHypothTests.html">Hypothesis Tests</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at how the power of the one-sample t-test increases with </span></span></span>
<span class="r-in"><span>  <span class="co"># increasing sample size:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5 10 15 20 25 30</span>
<span class="r-in"><span>  <span class="co">#[1] 5 10 15 20 25 30 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.14 0.29 0.44 0.56 0.67 0.75</span>
<span class="r-in"><span>  <span class="co">#[1] 0.14 0.29 0.44 0.56 0.67 0.75</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the last example, but use the approximation.</span></span></span>
<span class="r-in"><span>  <span class="co"># Note how the approximation underestimates the power </span></span></span>
<span class="r-in"><span>  <span class="co"># for the smaller sample sizes.</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    approx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.10 0.26 0.42 0.56 0.67 0.75</span>
<span class="r-in"><span>  <span class="co">#[1] 0.10 0.26 0.42 0.56 0.67 0.75</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of the two-sample t-test increases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># scaled difference:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 1.0 1.5 2.0</span>
<span class="r-in"><span>  <span class="co">#[1] 0.5 1.0 1.5 2.0 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestPower</span><span class="op">(</span><span class="fl">10</span>, sample.type <span class="op">=</span> <span class="st">"two.sample"</span>, </span></span>
<span class="r-in"><span>    delta.over.sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.19 0.56 0.89 0.99</span>
<span class="r-in"><span>  <span class="co">#[1] 0.19 0.56 0.89 0.99</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of the two-sample t-test increases with increasing values </span></span></span>
<span class="r-in"><span>  <span class="co"># of Type I error:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">tTestPower</span><span class="op">(</span><span class="fl">20</span>, sample.type <span class="op">=</span> <span class="st">"two.sample"</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03 0.14 0.34 0.46</span>
<span class="r-in"><span>  <span class="co">#[1] 0.03 0.14 0.34 0.46</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Modifying the example on pages 21-4 to 21-5 of USEPA (2009), determine how </span></span></span>
<span class="r-in"><span>  <span class="co"># adding another four months of observations to increase the sample size from </span></span></span>
<span class="r-in"><span>  <span class="co"># 4 to 8 for any one particular compliance well will affect the power of a </span></span></span>
<span class="r-in"><span>  <span class="co"># one-sample t-test that compares the mean for the well with the MCL of </span></span></span>
<span class="r-in"><span>  <span class="co"># 7 ppb.  Use alpha = 0.01, assume an upper one-sided alternative </span></span></span>
<span class="r-in"><span>  <span class="co"># (i.e., compliance well mean larger than 7 ppb), and assume a scaled </span></span></span>
<span class="r-in"><span>  <span class="co"># difference of 2.  (The data are stored in EPA.09.Ex.21.1.aldicarb.df.) </span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the power changes from 49% to 98% by increasing the sample size </span></span></span>
<span class="r-in"><span>  <span class="co"># from 4 to 8.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">tTestPower</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span>, delta.over.sigma <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.01</span>, </span></span>
<span class="r-in"><span>    sample.type <span class="op">=</span> <span class="st">"one.sample"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4865800 0.9835401</span>
<span class="r-in"><span>  <span class="co">#[1] 0.4865800 0.9835401</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

