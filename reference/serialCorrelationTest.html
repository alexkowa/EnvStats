<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Test for the Presence of Serial Correlation — serialCorrelationTest • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Test for the Presence of Serial Correlation — serialCorrelationTest"><meta property="og:description" content='serialCorrelationTest is a generic function used to test for the 
  presence of lag-one serial correlation using either the rank 
  von Neumann ratio test, the normal approximation based on the Yule-Walker 
  estimate of lag-one correlation, or the normal approximation based on the 
  MLE of lag-one correlation.  The function invokes particular 
  methods which depend on the class of the first 
  argument.
Currently, there is a default method and a method for objects of class "lm".'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Test for the Presence of Serial Correlation</h1>
    
    <div class="hidden name"><code>serialCorrelationTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>serialCorrelationTest</code> is a generic function used to test for the 
  presence of lag-one serial correlation using either the rank 
  von Neumann ratio test, the normal approximation based on the Yule-Walker 
  estimate of lag-one correlation, or the normal approximation based on the 
  MLE of lag-one correlation.  The function invokes particular 
  <code><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></code> which depend on the <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code> of the first 
  argument.</p>
<p>Currently, there is a default method and a method for objects of class <code>"lm"</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">serialCorrelationTest</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

  <span class="co"># S3 method for default</span>
<span class="fu">serialCorrelationTest</span><span class="op">(</span><span class="va">x</span>, test <span class="op">=</span> <span class="st">"rank.von.Neumann"</span>, 
    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span> 

  <span class="co"># S3 method for lm</span>
<span class="fu">serialCorrelationTest</span><span class="op">(</span><span class="va">x</span>, test <span class="op">=</span> <span class="st">"rank.von.Neumann"</span>, 
    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>numeric vector of observations, a numeric univariate time series of 
  class <code>"ts"</code>, or an object of class <code>"lm"</code>.  Undefined (<code>NaN</code>) and 
  infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed for <code>x</code> 
  when <code>x</code> is a numeric vector or time series, nor for the residuals 
  associated with <code>x</code> when <code>x</code> is an object of class <code>"lm"</code>.</p>
<p>When <code>test="AR1.mle"</code>, missing (<code>NA</code>) values are allowed, otherwise 
  they are not allowed.  When <code>x</code> is a numeric vector of observations 
  or a numeric univariate time series of class <code>"ts"</code>, it must contain at least 
  3 non-missing values.  When <code>x</code> is an object of class <code>"lm"</code>, the 
  residuals must contain at least 3 non-missing values.</p>
<p>Note:  when <code>x</code> is an object of class <code>"lm"</code>, the linear model 
  should have been fit using the argument <code>na.action=na.exclude</code> in the 
  call to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> in order to correctly deal with missing values.</p></dd>
<dt>test</dt>
<dd><p>character string indicating which test to use.  The possible values are: <br><code>"rank.von.Neumann"</code> (rank von Neumann ratio test; the default), <br><code>"AR1.yw"</code> (z-test based on Yule-Walker lag-one estimate of correlation), and <br><code>"AR1.mle"</code> (z-test based on MLE of lag-one correlation).</p></dd>
<dt>alternative</dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible 
  values are <code>"two.sided"</code> (the default), <code>"greater"</code>, and <code>"less"</code>.</p></dd>
<dt>conf.level</dt>
<dd><p>numeric scalar between 0 and 1 indicating the confidence level associated with 
  the confidence interval for the population lag-one autocorrelation.  The default 
  value is <code>conf.level=0.95</code>.</p></dd>
<dt>...</dt>
<dd><p>optional arguments for possible future methods.  Currently not used.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote \(n\) observations from a 
  stationary time series sampled at equispaced points in time with normal (Gaussian) 
  errors.  The function <code>serialCorrelationTest</code> tests the null hypothesis:
  $$H_0: \rho_1 = 0 \;\;\;\;\;\; (1)$$
  where \(\rho_1\) denotes the true lag-1 autocorrelation (also called the lag-1 
  serial correlation coefficient).  Actually, the null hypothesis is that the 
  lag-\(k\) autocorrelation is 0 for all values of \(k\) greater than 0 (i.e., 
  the time series is purely random).</p>
<p>In the case when the argument <code>x</code> is a linear model, the function 
  <code>serialCorrelationTest</code> tests the null hypothesis (1) for the 
  residuals.</p>
<p>The three possible alternative hypotheses are the upper one-sided alternative 
  (<code>alternative="greater"</code>):
  $$H_a: \rho_1 &gt; 0 \;\;\;\;\;\; (2)$$
  the lower one-sided alternative (<code>alternative="less"</code>):
  $$H_a: \rho_1 &lt; 0 \;\;\;\;\;\; (3)$$
  and the two-sided alternative: 
  $$H_a: \rho_1 \ne 0 \;\;\;\;\;\; (4)$$</p>
<p><b>Testing the Null Hypothesis of No Lag-1 Autocorrelation</b> <br>
  There are several possible methods for testing the null hypothesis (1) versus any 
  of the three alternatives (2)-(4). The function <code>serialCorrelationTest</code> allows 
  you to use one of three possible tests:</p><ul><li><p>The rank von Neuman ratio test.</p></li>
<li><p>The test based on the normal approximation for the distribution of the 
    Yule-Walker estimate of lag-one correlation.</p></li>
<li><p>The test based on the normal approximation for the distribution of the 
    maximum likelihood estimate (MLE) of lag-one correlation.</p></li>
</ul><p>Each of these tests is described below.
  <br></p>
<p><em>Test Based on Yule-Walker Estimate</em> (<code>test="AR1.yw"</code>) <br>
  The Yule-Walker estimate of the lag-1 autocorrelation is given by:
  $$\hat{\rho}_1 = \frac{\hat{\gamma}_1}{\hat{\gamma}_0} \;\;\;\;\;\; (5)$$
  where
  $$\hat{\gamma}_k = \frac{1}{n} \sum_{t=1}^{n-k} (x_t - \bar{x})(x_{t+k} - \bar{x}) \;\;\;\;\;\; (6)$$
  is the estimate of the lag-\(k\) autocovariance.  
  (This estimator does not allow for missing values.)</p>
<p>Under the null hypothesis (1), the estimator of lag-1 correlation in Equation (5) is 
  approximately distributed as a normal (Gaussian) random variable with mean 0 and 
  variance given by:
  $$Var(\hat{\rho}_1) \approx \frac{1}{n} \;\;\;\;\;\; (7)$$
  (Box and Jenkins, 1976, pp.34-35). Thus, the null hypothesis (1) can be tested 
  with the statistic
  $$z = \sqrt{n} \hat{\rho_1} \;\;\;\;\;\; (8)$$
  which is distributed approximately as a standard normal random variable under the 
  null hypothesis that the lag-1 autocorrelation is 0.
  <br></p>
<p><em>Test Based on the MLE</em> (<code>test="AR1.mle"</code>) <br>
  The function <code>serialCorrelationTest</code> the <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code> to 
  compute the MLE of the lag-one autocorrelation and the estimated variance of this 
  estimator.  As for the test based on the Yule-Walker estimate, the z-statistic is 
  computed as the estimated lag-one autocorrelation divided by the square root of the 
  estimated variance.
  <br></p> 
<p><em>Test Based on Rank von Neumann Ratio</em> (<code>test="rank.von.Neumann"</code>) <br>
  The null distribution of the serial correlation coefficient may be badly affected 
  by departures from normality in the underlying process (Cox, 1966; Bartels, 1977).  
  It is therefore a good idea to consider using a nonparametric test for randomness if 
  the normality of the underlying process is in doubt (Bartels, 1982).</p>
<p>Wald and Wolfowitz (1943) introduced the rank serial correlation coefficient, which 
  for lag-1 autocorrelation is simply the Yule-Walker estimate (Equation (5) above) 
  with the actual observations replaced with their ranks.</p>  
<p>von Neumann et al. (1941) introduced a test for randomness in the context of 
  testing for trend in the mean of a process. Their statistic is given by:
  $$V = \frac{\sum_{i=1}^{n-1}(x_i - x_{i+1})^2}{\sum_{i=1}^n (x_i - \bar{x})^2} \;\;\;\;\;\; (9)$$
  which is the ratio of the square of successive differences to the usual sums of 
  squared deviations from the mean.  This statistic is bounded between 0 and 4, and 
  for a purely random process is symmetric about 2.  Small values of this statistic 
  indicate possible positive autocorrelation, and large values of this statistics 
  indicate possible negative autocorrelation.  Durbin and Watson (1950, 1951, 1971) 
  proposed using this statistic in the context of checking the independence of 
  residuals from a linear regression model and provided tables for the distribution 
  of this statistic.  This statistic is therefore often called the 
  “Durbin-Watson statistic” (Draper and Smith, 1998, p.181).</p>
<p>The rank version of the von Neumann ratio statistic is given by:
  $$V_{rank} = \frac{\sum_{i=1}^{n-1}(R_i - R_{i+1})^2}{\sum_{i=1}^n (R_i - \bar{R})^2} \;\;\;\;\;\; (10)$$
  where \(R_i\) denotes the rank of the \(i\)'th observation (Bartels, 1982).  
  (This test statistic does not allow for missing values.)  In the absence of ties, 
  the denominator of this test statistic is equal to
  $$\sum_{i=1}^n (R_i - \bar{R})^2 = \frac{n(n^2 - 1)}{12} \;\;\;\;\;\; (11)$$
  The range of the \(V_{rank}\) test statistic is given by:
  $$[\frac{12}{(n)(n+1)} , 4 - \frac{12}{(n)(n+1)}] \;\;\;\;\;\; (12)$$
  if n is even, with a negligible adjustment if n is odd (Bartels, 1982), so 
  asymptotically the range is from 0 to 4, just as for the \(V\) test statistic in 
  Equation (9) above.</p>
<p>Bartels (1982) shows that asymptotically, the rank von Neumann ratio statistic is a 
  linear transformation of the rank serial correlation coefficient, so any asymptotic 
  results apply to both statistics.</p>
<p>For any fixed sample size \(n\), the exact distribution of the \(V_{rank}\) 
  statistic in Equation (10) above can be computed by simply computing the value of 
  \(V_{rank}\) for all possible permutations of the serial order of the ranks.  
  Based on this exact distribution, Bartels (1982) presents a table of critical 
  values for the numerator of the RVN statistic for sample sizes between 4 and 10.</p>
<p>Determining the exact distribution of \(V_{rank}\) becomes impractical as the 
  sample size increases.  For values of n between 10 and 100, Bartels (1982) 
  approximated the distribution of \(V_{rank}\) by a 
  <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta distribution</a> over the range 0 to 4 with shape parameters 
  <code>shape1=</code>\(\nu\) and <code>shape2=</code>\(\omega\) and:
  $$\nu = \omega = \frac{5n(n+1)(n-1)^2}{2(n-2)(5n^2 - 2n - 9)} - \frac{1}{2} \;\;\;\;\;\; (13)$$
  Bartels (1982) checked this approximation by simulating the distribution of 
  \(V_{rank}\) for \(n=25\) and \(n=50\) and comparing the empirical quantiles 
  at \(0.005\), \(0.01\), \(0.025\), \(0.05\), and \(0.1\) with the 
  approximated quantiles based on the beta distribution.  He found that the quantiles 
  agreed to 2 decimal places for eight of the 10 values, and differed by \(0.01\) 
  for the other two values.</p>
<p><b>Note</b>: The definition of the <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta distribution</a> assumes the 
  random variable ranges from 0 to 1.  This definition can be generalized as follows.  
  Suppose the random variable \(Y\) has a beta distribution over the range 
  \(a \le y \le b\), with shape parameters \(\nu\) and \(\omega\).  Then the 
  random variable \(X\) defined as:
  $$X = \frac{Y-a}{b-a} \;\;\;\;\;\; (14)$$
  has the “standard beta distribution” as described in the help file for Beta 
  (Johnson et al., 1995, p.210).</p>
<p>Bartels (1982) shows that asymptotically, \(V_{rank}\) has normal distribution 
  with mean 2 and variance \(4/n\), but notes that a slightly better approximation 
  is given by using a variance of \(20/(5n + 7)\).</p>
<p>To test the null hypothesis (1) when <code>test="rank.von.Neumann"</code>, the function <br><code>serialCorrelationTest</code> does the following:</p><ul><li><p>When the sample size is between 3 and 10, the exact distribution of \(V_{rank}\) 
  is used to compute the p-value.</p></li>
<li><p>When the sample size is between 11 and 100, the beta approximation to the 
  distribution of \(V_{rank}\) is used to compute the p-value.</p></li>
<li><p>When the sample size is larger than 100, the normal approximation to the 
  distribution of \(V_{rank}\) is used to compute the p-value.  
  (This uses the variance \(20/(5n + 7)\).)</p></li>
</ul><p>When ties are present in the observations and midranks are used for the tied 
  observations, the distribution of the \(V_{rank}\) statistic based on the 
  assumption of no ties is not applicable.  If the number of ties is small, however, 
  they may not grossly affect the assumed p-value.</p>
<p>When ties are present, the function <code>serialCorrelationTest</code> issues a warning.  
  When the sample size is between 3 and 10, the p-value is computed based on 
  rounding up the computed value of \(V_{rank}\) to the nearest possible value 
  that could be observed in the case of no ties.
  <br></p> 
<p><b>Computing a Confidence Interval for the Lag-1 Autocorrelation</b> <br>
  The function <code>serialCorrelationTest</code> computes an approximate 
  \(100(1-\alpha)\%\) confidence interval for the lag-1 autocorrelation as follows:
  $$[\hat{\rho}_1 - z_{1-\alpha/2}\hat{\sigma}_{\hat{\rho}_1},  \hat{\rho}_1 + z_{1-\alpha/2}\hat{\sigma}_{\hat{\rho}_1}] \;\;\;\;\;\; (15)$$
  where \(\hat{\sigma}_{\hat{\rho}_1}\) denotes the estimated standard deviation of 
  the estimated of lag-1 autocorrelation and \(z_p\) denotes the \(p\)'th quantile 
  of the standard <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a>.</p>
<p>When <code>test="AR1.yw"</code> or <code>test="rank.von.Neumann"</code>, the Yule-Walker 
  estimate of lag-1 autocorrelation is used and the variance of the estimated 
  lag-1 autocorrelation is approximately:
  $$Var(\hat{\rho}_1) \approx \frac{1}{n} (1 - \rho_1^2) \;\;\;\;\;\; (16)$$
  (Box and Jenkins, 1976, p.34), so
  $$\hat{\sigma}_{\hat{\rho}_1} = \sqrt{\frac{1 - \hat{\rho}_1^2}{n}} \;\;\;\;\;\; (17)$$
  When <code>test="AR1.mle"</code>, the MLE of the lag-1 autocorrelation is used, and its 
  standard deviation is estimated with the square root of the estimated variance 
  returned by <code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>"htest"</code> containing the results of the hypothesis test.  
  See the help file for <code><a href="htest.object.html">htest.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bartels, R. (1982).  The Rank Version of von Neumann's Ratio Test for Randomness.  
  <em>Journal of the American Statistical Association</em> <b>77</b>(377), 40--46.</p>
<p>Berthouex, P.M., and L.C. Brown. (2002).  
  <em>Statistics for Environmental Engineers</em>.  Second Edition.  
  Lewis Publishers, Boca Raton, FL.</p> 
<p>Box, G.E.P., and G.M. Jenkins. (1976).  
  <em>Time Series Analysis: Forecasting and Control</em>.  Prentice Hall, 
  Englewood Cliffs, NJ, Chapter 2.</p>
<p>Cox, D.R. (1966).  The Null Distribution of the First Serial Correlation Coefficient.  
  <em>Biometrika</em> <b>53</b>, 623--626.</p>
<p>Draper, N., and H. Smith. (1998).  <em>Applied Regression Analysis</em>.  
  Third Edition. John Wiley and Sons, New York, pp.69-70;181-192.</p>
<p>Durbin, J., and G.S. Watson. (1950).  Testing for Serial Correlation in Least 
  Squares Regression I.  <em>Biometrika</em> <b>37</b>, 409--428.</p>
<p>Durbin, J., and G.S. Watson. (1951).  Testing for Serial Correlation in Least 
  Squares Regression II.  <em>Biometrika</em> <b>38</b>, 159--178.</p>
<p>Durbin, J., and G.S. Watson. (1971). Testing for Serial Correlation in Least Squares 
  Regression III.  <em>Biometrika</em> <b>58</b>, 1--19.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).  <em>Statistical Methods in Water 
  Resources Research</em>.  Elsevier, New York, NY, pp.250--253.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1995).  <em>Continuous Univariate 
  Distributions, Volume 2</em>.  Second Edition.  John Wiley and Sons, New York, 
  Chapter 25.</p>
<p>Knoke, J.D. (1975).  Testing for Randomness Against Autocorrelation Alternatives:  
  The Parametric Case.  <em>Biometrika</em> <b>62</b>, 571--575.</p>
<p>Knoke, J.D. (1977).  Testing for Randomness Against Autocorrelation Alternatives:  
  Alternative Tests.  <em>Biometrika</em> <b>64</b>, 523--529.</p>
<p>Lehmann, E.L. (1975).  <em>Nonparametrics:  Statistical Methods Based on Ranks</em>.  
  Holden-Day, Oakland, CA, 457pp.</p>
<p>von Neumann, J., R.H. Kent, H.R. Bellinson, and B.I. Hart. (1941).  The Mean Square 
  Successive Difference.  <em>Annals of Mathematical Statistics</em> <b>12</b>(2), 
  153--162.</p>
<p>Wald, A., and J. Wolfowitz. (1943).  An Exact Test for Randomness in the 
  Non-Parametric Case Based on Serial Correlation.  <em>Annals of Mathematical 
  Statistics</em> <b>14</b>, 378--388.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Data collected over time on the same phenomenon are called a time series.  
  A time series is usually modeled as a single realization of a stochastic process; 
  that is, if we could go back in time and repeat the experiment, we would get 
  different results that would vary according to some probabilistic law.  
  The simplest kind of time series is a stationary time series, in which the mean 
  value is constant over time, the variability of the observations is constant over 
  time, etc.  That is, the probability distribution associated with each future 
  observation is the same.</p>
<p>A common concern in applying standard statistical tests to time series data is 
  the assumption of independence.  Most conventional statistical hypothesis tests 
  assume the observations are independent, but data collected sequentially in time 
  may not satisfy this assumption.  For example, high observations may tend to 
  follow high observations (positive serial correlation), or low observations may 
  tend to follow high observations (negative serial correlation).  One way to 
  investigate the assumption of independence is to estimate the lag-one serial 
  correlation and test whether it is significantly different from 0.</p>
<p>The null distribution of the serial correlation coefficient may be badly affected 
  by departures from normality in the underlying process (Cox, 1966; Bartels, 1977).  
  It is therefore a good idea to consider using a nonparametric test for randomness 
  if the normality of the underlying process is in doubt (Bartels, 1982).  
  Knoke (1977) showed that under normality, the test based on the rank serial 
  correlation coefficient (and hence the test based on the rank von Neumann ratio 
  statistic) has asymptotic relative efficiency of 0.91 with respect to using the 
  test based on the ordinary serial correlation coefficient against the alternative 
  of first-order autocorrelation.</p>
<p>Bartels (1982) performed an extensive simulation study of the power of the 
  rank von Neumann ratio test relative to the standard von Neumann ratio test 
  (based on the statistic in Equation (9) above) and the runs test 
  (Lehmann, 1975, 313-315).  He generated a first-order autoregressive process for 
  sample sizes of 10, 25, and 50, using 6 different parent distributions: normal, 
  Cauchy, contaminated normal, Johnson, Stable, and exponential.  Values of 
  lag-1 autocorrelation ranged from -0.8 to 0.8.  Bartels (1982) found three 
  important results:</p><ul><li><p>The rank von Neumann ratio test is far more powerful than the runs test.</p></li>
<li><p>For the normal process, the power of the rank von Neumann ratio test was 
  never less than 89% of the power of the standard von Neumann ratio test.</p></li>
<li><p>For non-normal processes, the rank von Neumann ratio test was often much 
  more powerful than of the standard von Neumann ratio test.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="htest.object.html">htest.object</a></code>, <code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></code>, <code><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></code>, 
  <code><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></code>, <code><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></code>, 
  <code><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></code>, <code><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></code>,  
  <code><a href="https://rdrr.io/r/stats/lag.plot.html" class="external-link">lag.plot</a></code>, <a href="FcnsByCatHypothTests.html">Hypothesis Tests</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Generate a purely random normal process, then use serialCorrelationTest </span></span>
<span class="r-in">  <span class="co"># to test for the presence of correlation. </span></span>
<span class="r-in">  <span class="co"># (Note: the call to set.seed allows you to reproduce this example.) </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">345</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at the data</span></span>
<span class="r-in">  <span class="co">#-----------------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Test for serial correlation</span></span>
<span class="r-in">  <span class="co">#----------------------------</span></span>
<span class="r-in">  <span class="fu">serialCorrelationTest</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rank von Neumann Test for Lag-1 Autocorrelation (Beta Approximation)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RVN = 1.9297, p-value = 0.7253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true rho is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.02773737 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Hypothesis Test</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Null Hypothesis:                 rho = 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          True rho is not equal to 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Name:                       Rank von Neumann Test for</span></span>
<span class="r-in">  <span class="co">#                                 Lag-1 Autocorrelation</span></span>
<span class="r-in">  <span class="co">#                                 (Beta Approximation)</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          rho = 0.02773737</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               Yule-Walker</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     100</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic:                  RVN = 1.929733</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0.7253405</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval for:         rho</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval:             LCL = -0.1681836</span></span>
<span class="r-in">  <span class="co">#                                 UCL =  0.2236584</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="co">#---------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Now use the R function arima.sim to generate an AR(1) process with a </span></span>
<span class="r-in">  <span class="co"># lag-1 autocorrelation of 0.8, then test for autocorrelation.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">432</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at the data</span></span>
<span class="r-in">  <span class="co">#-----------------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html" class="external-link">ts.plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Test for serial correlation</span></span>
<span class="r-in">  <span class="co">#----------------------------</span></span>
<span class="r-in">  <span class="fu">serialCorrelationTest</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Rank von Neumann Test for Lag-1 Autocorrelation (Beta Approximation)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RVN = 0.37432, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true rho is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.835214 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Hypothesis Test</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Null Hypothesis:                 rho = 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          True rho is not equal to 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Name:                       Rank von Neumann Test for</span></span>
<span class="r-in">  <span class="co">#                                 Lag-1 Autocorrelation</span></span>
<span class="r-in">  <span class="co">#                                 (Beta Approximation)</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          rho = 0.835214</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               Yule-Walker</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            y</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     100</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic:                  RVN = 0.3743174</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval for:         rho</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval:             LCL = 0.7274307</span></span>
<span class="r-in">  <span class="co">#                                 UCL = 0.9429973</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="co">#---------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The data frame Air.df contains information on ozone (ppb^1/3), </span></span>
<span class="r-in">  <span class="co"># radiation (langleys), temperature (degrees F), and wind speed (mph) </span></span>
<span class="r-in">  <span class="co"># for 153 consecutive days between May 1 and September 30, 1973.  </span></span>
<span class="r-in">  <span class="co"># First test for serial correlation in (the cube root of) ozone.  </span></span>
<span class="r-in">  <span class="co"># Note that we must use the test based on the MLE because the time series </span></span>
<span class="r-in">  <span class="co"># contains missing values.  Serial correlation appears to be present.  </span></span>
<span class="r-in">  <span class="co"># Next fit a linear model that includes the predictor variables temperature, </span></span>
<span class="r-in">  <span class="co"># radiation, and wind speed, and test for the presence of serial correlation </span></span>
<span class="r-in">  <span class="co"># in the residuals.  There is no evidence of serial correlation.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at the data</span></span>
<span class="r-in">  <span class="co">#-----------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Air.df</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               ozone radiation temperature wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/01/1973 3.448217       190          67  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/02/1973 3.301927       118          72  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/03/1973 2.289428       149          74 12.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/04/1973 2.620741       313          62 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/05/1973       NA        NA          56 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/06/1973 3.036589        NA          66 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/07/1973 2.843867       299          65  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/08/1973 2.668402        99          59 13.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/09/1973 2.000000        19          61 20.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/10/1973       NA       194          69  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/11/1973 1.912931        NA          74  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/12/1973 2.519842       256          69  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/13/1973 2.223980       290          66  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/14/1973 2.410142       274          68 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/15/1973 2.620741        65          58 13.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/16/1973 2.410142       334          64 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/17/1973 3.239612       307          66 12.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/18/1973 1.817121        78          57 18.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/19/1973 3.107233       322          68 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/20/1973 2.223980        44          62  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/21/1973 1.000000         8          59  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/22/1973 2.223980       320          73 16.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/23/1973 1.587401        25          61  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/24/1973 3.174802        92          61 12.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/25/1973       NA        66          57 16.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/26/1973       NA       266          58 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/27/1973       NA        NA          57  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/28/1973 2.843867        13          67 12.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/29/1973 3.556893       252          81 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/30/1973 4.862944       223          79  5.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/31/1973 3.332222       279          76  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/01/1973       NA       286          78  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/02/1973       NA       287          74  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/03/1973       NA       242          67 16.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/04/1973       NA       186          84  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/05/1973       NA       220          85  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/06/1973       NA       264          79 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/07/1973 3.072317       127          82  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/08/1973       NA       273          87  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/09/1973 4.140818       291          90 13.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/10/1973 3.391211       323          87 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/11/1973       NA       259          93 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/12/1973       NA       250          92  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/13/1973 2.843867       148          82  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/14/1973       NA       332          80 13.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/15/1973       NA       322          79 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/16/1973 2.758924       191          77 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/17/1973 3.332222       284          72 20.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/18/1973 2.714418        37          65  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/19/1973 2.289428       120          73 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/20/1973 2.351335       137          76 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/21/1973       NA       150          77  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/22/1973       NA        59          76  1.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/23/1973       NA        91          76  4.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/24/1973       NA       250          76  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/25/1973       NA       135          75  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/26/1973       NA       127          78  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/27/1973       NA        47          73 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/28/1973       NA        98          80 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/29/1973       NA        31          77 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 06/30/1973       NA       138          83  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/01/1973 5.129928       269          84  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/02/1973 3.659306       248          85  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/03/1973 3.174802       236          81  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/04/1973       NA       101          84 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/05/1973 4.000000       175          83  4.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/06/1973 3.419952       314          83 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/07/1973 4.254321       276          88  5.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/08/1973 4.594701       267          92  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/09/1973 4.594701       272          92  5.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/10/1973 4.396830       175          89  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/11/1973       NA       139          82  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/12/1973 2.154435       264          73 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/13/1973 3.000000       175          81 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/14/1973       NA       291          91 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/15/1973 1.912931        48          80 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/16/1973 3.634241       260          81  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/17/1973 3.271066       274          82 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/18/1973 3.936497       285          84  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/19/1973 4.290840       187          87  5.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/20/1973 3.979057       220          85 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/21/1973 2.519842         7          74  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/22/1973       NA       258          81  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/23/1973       NA       295          82 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/24/1973 4.308869       294          86  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/25/1973 4.762203       223          85  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/26/1973 2.714418        81          82  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/27/1973 3.732511        82          86 12.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/28/1973 4.344481       213          88  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/29/1973 3.684031       275          86  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/30/1973 4.000000       253          83  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 07/31/1973 3.892996       254          81  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/01/1973 3.391211        83          81  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/02/1973 2.080084        24          81 13.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/03/1973 2.519842        77          82  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/04/1973 4.272659        NA          86  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/05/1973 3.271066        NA          85  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/06/1973 4.041240        NA          87  4.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/07/1973 4.959676       255          89  4.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/08/1973 4.464745       229          90 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/09/1973 4.791420       207          90  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/10/1973       NA       222          92  8.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/11/1973       NA       137          86 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/12/1973 3.530348       192          86 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/13/1973 3.036589       273          82 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/14/1973 4.020726       157          80  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/15/1973       NA        64          79 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/16/1973 2.802039        71          77 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/17/1973 3.892996        51          79  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/18/1973 2.843867       115          76  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/19/1973 3.141381       244          78 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/20/1973 3.530348       190          78 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/21/1973 2.758924       259          77 15.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/22/1973 2.080084        36          72 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/23/1973       NA       255          75 12.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/24/1973 3.556893       212          79  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/25/1973 5.517848       238          81  3.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/26/1973 4.179339       215          86  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/27/1973       NA       153          88  5.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/28/1973 4.235824       203          97  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/29/1973 4.904868       225          94  2.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/30/1973 4.379519       237          96  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 08/31/1973 4.396830       188          94  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/01/1973 4.578857       167          91  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/02/1973 4.272659       197          92  5.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/03/1973 4.179339       183          93  2.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/04/1973 4.497941       189          93  4.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/05/1973 3.608826        95          87  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/06/1973 3.174802        92          84 15.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/07/1973 2.714418       252          80 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/08/1973 2.843867       220          78 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/09/1973 2.758924       230          75 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/10/1973 2.884499       259          73  9.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/11/1973 3.530348       236          81 14.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/12/1973 2.758924       259          76 15.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/13/1973 3.036589       238          77  6.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/14/1973 2.080084        24          71 10.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/15/1973 2.351335       112          71 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/16/1973 3.583048       237          78  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/17/1973 2.620741       224          67 13.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/18/1973 2.351335        27          76 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/19/1973 2.884499       238          68 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/20/1973 2.519842       201          82  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/21/1973 2.351335       238          64 12.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/22/1973 2.843867        14          71  9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/23/1973 3.301927       139          81 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/24/1973 1.912931        49          69 10.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/25/1973 2.410142        20          63 16.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/26/1973 3.107233       193          70  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/27/1973       NA       145          77 13.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/28/1973 2.410142       191          75 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/29/1973 2.620741       131          76  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/30/1973 2.714418       223          68 11.5</span>
<span class="r-in">  <span class="co">#              ozone radiation temperature wind</span></span>
<span class="r-in">  <span class="co">#05/01/1973 3.448217       190          67  7.4</span></span>
<span class="r-in">  <span class="co">#05/02/1973 3.301927       118          72  8.0</span></span>
<span class="r-in">  <span class="co">#05/03/1973 2.289428       149          74 12.6</span></span>
<span class="r-in">  <span class="co">#05/04/1973 2.620741       313          62 11.5</span></span>
<span class="r-in">  <span class="co">#05/05/1973       NA        NA          56 14.3</span></span>
<span class="r-in">  <span class="co">#...</span></span>
<span class="r-in">  <span class="co">#09/27/1973       NA       145          77 13.2</span></span>
<span class="r-in">  <span class="co">#09/28/1973 2.410142       191          75 14.3</span></span>
<span class="r-in">  <span class="co">#09/29/1973 2.620741       131          76  8.0</span></span>
<span class="r-in">  <span class="co">#09/30/1973 2.714418       223          68 11.5</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Test for serial correlation</span></span>
<span class="r-in">  <span class="co">#----------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Air.df</span>, </span>
<span class="r-in">    <span class="fu">serialCorrelationTest</span><span class="op">(</span><span class="va">ozone</span>, test <span class="op">=</span> <span class="st">"AR1.mle"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	z-Test for Lag-1 Autocorrelation (Wald Test Based on MLE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  ozone</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z = 7.587, p-value = 3.286e-14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true rho is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5641616 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Hypothesis Test</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Null Hypothesis:                 rho = 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          True rho is not equal to 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Name:                       z-Test for</span></span>
<span class="r-in">  <span class="co">#                                 Lag-1 Autocorrelation</span></span>
<span class="r-in">  <span class="co">#                                 (Wald Test Based on MLE)</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          rho = 0.5641616</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               Maximum Likelihood</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            ozone</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     153</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number NA/NaN/Inf's:             37</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic:                  z = 7.586952</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         3.28626e-14</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval for:         rho</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval:             LCL = 0.4184197</span></span>
<span class="r-in">  <span class="co">#                                 UCL = 0.7099034</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Next fit a linear model that includes the predictor variables temperature, </span></span>
<span class="r-in">  <span class="co"># radiation, and wind speed, and test for the presence of serial correlation </span></span>
<span class="r-in">  <span class="co"># in the residuals.  Note setting the argument na.action = na.exclude in the </span></span>
<span class="r-in">  <span class="co"># call to lm to correctly deal with missing values.</span></span>
<span class="r-in">  <span class="co">#----------------------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">lm.ozone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ozone</span> <span class="op">~</span> <span class="va">radiation</span> <span class="op">+</span> <span class="va">temperature</span> <span class="op">+</span> <span class="va">wind</span> <span class="op">+</span> </span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">wind</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, </span>
<span class="r-in">    data <span class="op">=</span> <span class="va">Air.df</span>, na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Now test for serial correlation in the residuals.</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">serialCorrelationTest</span><span class="op">(</span><span class="va">lm.ozone</span>, test <span class="op">=</span> <span class="st">"AR1.mle"</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	z-Test for Lag-1 Autocorrelation (Wald Test Based on MLE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Residuals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z = 1.286, p-value = 0.1985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true rho is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1298024 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Hypothesis Test</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Null Hypothesis:                 rho = 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Alternative Hypothesis:          True rho is not equal to 0</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Name:                       z-Test for</span></span>
<span class="r-in">  <span class="co">#                                 Lag-1 Autocorrelation</span></span>
<span class="r-in">  <span class="co">#                                 (Wald Test Based on MLE)</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          rho = 0.1298024</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               Maximum Likelihood</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            Residuals</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data Source:                     lm.ozone</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     153</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number NA/NaN/Inf's:             42</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Test Statistic:                  z = 1.285963</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#P-value:                         0.1984559</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval for:         rho</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval:             LCL = -0.06803223</span></span>
<span class="r-in">  <span class="co">#                                 UCL =  0.32763704</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="co">#---------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">lm.ozone</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

