<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simultaneous Prediction Interval for a Gamma Distribution — predIntGammaSimultaneous • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simultaneous Prediction Interval for a Gamma Distribution — predIntGammaSimultaneous"><meta property="og:description" content="Estimate the shape and scale parameters for a 
  gamma distribution, 
  or estimate the mean and coefficient of variation for a 
  gamma distribution (alternative parameterization), 
  and construct a simultaneous prediction interval for the next \(r\) sampling 
  occasions, based on one of three possible rules: k-of-m, California, or 
  Modified California."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simultaneous Prediction Interval for a Gamma Distribution</h1>
    
    <div class="hidden name"><code>predIntGammaSimultaneous.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the shape and scale parameters for a 
  <a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">gamma distribution</a>, 
  or estimate the mean and coefficient of variation for a 
  <a href="GammaAlt.html">gamma distribution (alternative parameterization)</a>, 
  and construct a simultaneous prediction interval for the next \(r\) sampling 
  occasions, based on one of three possible rules: k-of-m, California, or 
  Modified California.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">predIntGammaSimultaneous</span><span class="op">(</span><span class="va">x</span>, n.transmean <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">1</span>, 
    rule <span class="op">=</span> <span class="st">"k.of.m"</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, 
    K.tol <span class="op">=</span> <span class="fl">1e-07</span>, est.method <span class="op">=</span> <span class="st">"mle"</span>, normal.approx.transform <span class="op">=</span> <span class="st">"kulkarni.powar"</span><span class="op">)</span>

  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">x</span>, n.transmean <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">1</span>, 
    rule <span class="op">=</span> <span class="st">"k.of.m"</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, 
    K.tol <span class="op">=</span> <span class="fl">1e-07</span>, est.method <span class="op">=</span> <span class="st">"mle"</span>, normal.approx.transform <span class="op">=</span> <span class="st">"kulkarni.powar"</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>numeric vector of non-negative observations. Missing (<code>NA</code>), undefined (<code>NaN</code>), and 
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>
<dt>n.transmean</dt>
<dd><p>positive integer specifying the sample size associated with future transformed 
  means (see the DETAILS section for an explanation of what the transformation is).  
  The default value is <code>n.transmean=1</code> (i.e., individual observations).  
  Note that all future transformed means must be based on the same sample size.</p></dd>
<dt>k</dt>
<dd><p>for the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), a positive integer 
  specifying the minimum number of observations (or transformed means) out of \(m\) 
  observations (or transformed means) (all obtained on one future sampling “occassion”) 
  the prediction interval should contain with confidence level <code>conf.level</code>.  
  The default value is <code>k=1</code>.  This argument is ignored when the argument 
  <code>rule</code> is not equal to <code>"k.of.m"</code>.</p></dd>
<dt>m</dt>
<dd><p>positive integer specifying the maximum number of future observations (or 
  transformed means) on one future sampling “occasion”.  
  The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which 
  case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.</p></dd>
<dt>r</dt>
<dd><p>positive integer specifying the number of future sampling “occasions”.  
  The default value is <code>r=1</code>.</p></dd>
<dt>rule</dt>
<dd><p>character string specifying which rule to use.  The possible values are 
  <code>"k.of.m"</code> (\(k\)-of-\(m\) rule; the default), <code>"CA"</code> (California rule), 
  and <code>"Modified.CA"</code> (modified California rule).  
  See the DETAILS section below for more information.</p></dd>
<dt>delta.over.sigma</dt>
<dd><p>numeric scalar indicating the ratio \(\Delta/\sigma\).  The quantity 
  \(\Delta\) (delta) denotes the difference between the mean of the population 
  (on the transformed scale) that was sampled to construct the prediction interval, 
  and the mean of the population (on the transformed scale) that will be sampled to 
  produce the future observations.  The quantity \(\sigma\) (sigma) denotes the 
  population standard deviation (on the transformed scale) for both populations.  
  See the DETAILS section below for more information.  The default value is 
  <code>delta.over.sigma=0</code>.</p></dd>
<dt>pi.type</dt>
<dd><p>character string indicating what kind of prediction interval to compute.  
  The possible values are <code>pi.type="upper"</code> (the default), and 
  <code>pi.type="lower"</code>.</p></dd>
<dt>conf.level</dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the prediction interval.  
  The default value is <code>conf.level=0.95</code>.</p></dd>
<dt>K.tol</dt>
<dd><p>numeric scalar indicating the tolerance to use in the nonlinear search algorithm to 
  compute \(K\).  The default value is <code>K.tol=.Machine$double.eps^(1/2)</code>.  
  For many applications, the value of \(K\) needs to be known only to the second 
  decimal place, in which case setting <code>K.tol=1e-4</code> will speed up computation a 
  bit.</p></dd>
<dt>est.method</dt>
<dd><p>character string specifying the method of estimation for the shape and scale 
  distribution parameters.  The possible values are 
  <code>"mle"</code> (maximum likelihood; the default), 
  <code>"bcmle"</code> (bias-corrected mle), <code>"mme"</code> (method of moments), and 
  <code>"mmue"</code> (method of moments based on the unbiased estimator of variance). 
  See the DETAILS section of the help file for <code><a href="egamma.html">egamma</a></code> for more 
  information.</p></dd>
<dt>normal.approx.transform</dt>
<dd><p>character string indicating which power transformation to use.  
  Possible values are <code>"kulkarni.powar"</code> (the default), <code>"cube.root"</code>, and <br><code>"fourth.root"</code>.  See the DETAILS section for more informaiton.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>predIntGammaSimultaneous</code> returns a simultaneous prediction 
  interval as well as estimates of the shape and scale parameters.  
  The function <code>predIntGammaAltSimultaneous</code> returns a simultaneous prediction 
  interval as well as estimates of the mean and coefficient of variation.</p>
<p>Following Krishnamoorthy et al. (2008), the simultaneous prediction interval is 
  computed by:</p><ol><li><p>using a power transformation on the original data to induce approximate 
    normality,</p></li>
<li><p>calling <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code> with the transformed data to 
    compute the simultaneous prediction interval, and then</p></li>
<li><p>back-transforming the interval to create a simultaneous prediction interval 
    on the original scale.</p></li>
</ol><p>The argument <code>normal.approx.transform</code> determines which transformation is used.  
  The value <code>normal.approx.transform="cube.root"</code> uses 
  the cube root transformation suggested by Wilson and Hilferty (1931) and used by 
  Krishnamoorthy et al. (2008) and Singh et al. (2010b), and the value 
  <code>normal.approx.transform="fourth.root"</code> uses the fourth root transformation 
  suggested by Hawkins and Wixley (1986) and used by Singh et al. (2010b).  
  The default value <code>normal.approx.transform="kulkarni.powar"</code> 
  uses the "Optimum Power Normal Approximation Method" of Kulkarni and Powar (2010).  
  The "optimum" power \(p\) is determined by:</p><table class="table table"><tr><td>\(p = -0.0705 - 0.178 \, shape + 0.475 \, \sqrt{shape}\)</td><td>if \(shape \le 1.5\)</td></tr><tr><td>\(p = 0.246\)</td><td>if \(shape &gt; 1.5\)</td></tr></table><p>where \(shape\) denotes the estimate of the shape parameter.  Although 
  Kulkarni and Powar (2010) use the maximum likelihood estimate of shape to 
  determine the power \(p\), for the functions <br><code>predIntGammaSimultaneous</code> and <code>predIntGammaAltSimultaneous</code> the power 
  \(p\) is based on whatever estimate of shape is used 
  (e.g., <code>est.method="mle"</code>, <code>est.method="bcmle"</code>, etc.).</p>
<p>When the argument <code>n.transmean</code> is larger than 1 (i.e., you are 
  constructing a prediction interval for future means, not just single 
  observations), in order to properly compare a future mean with the 
  prediction limits, you must follow these steps:</p><ol><li><p>Take the observations that will be used to compute the mean and 
          transform them by raising them to the power given by the value in the 
          component <code>interval$normal.transform.power</code> (see the section VALUE below).</p></li>
<li><p>Compute the mean of the transformed observations.</p></li>
<li><p>Take the mean computed in step 2 above and raise it to the inverse of the power 
          originally used to transform the observations.</p></li>
</ol></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>"estimate"</code> containing the estimated parameters, 
  the simultaneous prediction interval, and other information.  
  See <code><a href="estimate.object.html">estimate.object</a></code> for details.  
  In addition to the usual components contained in an object of class 
<code>"estimate"</code>, the returned value also includes two additional 
  components within the <code>"interval"</code> component:</p>
<dl><dt>n.transmean</dt>
<dd><p>the value of <code>n.transmean</code> supplied in the 
    call to <code>predIntGammaSimultaneous</code> or <code>predIntGammaAltSimultaneous</code>.</p></dd>
<dt>normal.transform.power</dt>
<dd><p>the value of the power used to 
    transform the original data to approximate normality.</p></dd>
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p><b>Barclay's California Code of Regulations</b>. (1991). Title 22, 
  Section 66264.97 [concerning hazardous waste facilities] and Title 23, 
  Section 2550.7(e)(8) [concerning solid waste facilities].  
  Barclay's Law Publishers, San Francisco, CA.</p>
<p>Davis, C.B. (1998a).  <em>Ground-Water Statistics \&amp; Regulations:  Principles, 
  Progress and Problems</em>.  Second Edition.  Environmetrics \&amp; Statistics Limited, 
  Henderson, NV.</p>
<p>Davis, C.B. (1998b). Personal Communication, September 3, 1998.</p>
<p>Davis, C.B., and R.J. McNichols. (1987).  One-sided Intervals for at Least \(p\) 
  of \(m\) Observations from a Lognormal Population on Each of \(r\) Future Occasions.  
  <em>Technometrics</em> <b>29</b>, 359--370.</p>
<p>Evans, M., N. Hastings, and B. Peacock. (1993). <em>Statistical Distributions</em>. 
  Second Edition. John Wiley and Sons, New York, Chapter 18.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009). 
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.  
  John Wiley &amp; Sons, Hoboken.</p>
<p>Fertig, K.W., and N.R. Mann. (1977).  One-Sided Prediction Intervals for at Least 
  \(p\) Out of \(m\) Future Observations From a Lognormal Population.  
  <em>Technometrics</em> <b>19</b>, 167--177.</p>
<p>Hahn, G.J. (1969). Factors for Calculating Two-Sided Prediction Intervals for 
  Samples from a Lognormal Distribution. 
  <em>Journal of the American Statistical Association</em> <b>64</b>(327), 878-898.</p>
<p>Hahn, G.J. (1970a). Additional Factors for Calculating Prediction Intervals for 
  Samples from a Lognormal Distribution. 
  <em>Journal of the American Statistical Association</em> <b>65</b>(332), 1668-1676.</p>
<p>Hahn, G.J. (1970b). Statistical Intervals for a Lognormal Population, Part I: Tables, 
  Examples and Applications. <em>Journal of Quality Technology</em> <b>2</b>(3), 115-125.</p>
<p>Hahn, G.J. (1970c). Statistical Intervals for a Lognormal Population, Part II: 
  Formulas, Assumptions, Some Derivations. <em>Journal of Quality Technology</em> 
  <b>2</b>(4), 195-206.</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991). <em>Statistical Intervals: A Guide for 
  Practitioners</em>.  John Wiley and Sons, New York.</p>
<p>Hahn, G., and W. Nelson. (1973). A Survey of Prediction Intervals and Their 
  Applications.  <em>Journal of Quality Technology</em> <b>5</b>, 178-188.</p>
<p>Hall, I.J., and R.R. Prairie. (1973).  One-Sided Prediction Intervals to Contain at 
  Least \(m\) Out of \(k\) Future Observations.  
  <em>Technometrics</em> <b>15</b>, 897--914.</p>
<p>Hawkins, D. M., and R.A.J. Wixley. (1986). A Note on the Transformation of 
  Chi-Squared Variables to Normality. <em>The American Statistician</em>, <b>40</b>, 
  296--298.</p>
<p>Johnson, N.L., S. Kotz, and N. Balakrishnan. (1994). 
  <em>Continuous Univariate Distributions, Volume 1</em>. Second Edition. 
  John Wiley and Sons, New York, Chapter 17.</p>
<p>Krishnamoorthy K., T. Mathew, and S. Mukherjee. (2008). Normal-Based Methods for a 
  Gamma Distribution: Prediction and Tolerance Intervals and Stress-Strength Reliability. 
  <em>Technometrics</em>, <b>50</b>(1), 69--78.</p>
<p>Krishnamoorthy K., and T. Mathew. (2009). 
  <em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>. 
  John Wiley and Sons, Hoboken.</p>
<p>Kulkarni, H.V., and S.K. Powar. (2010). A New Method for Interval Estimation of the Mean 
  of the Gamma Distribution. <em>Lifetime Data Analysis</em>, <b>16</b>, 431--447.</p>
<p>Millard, S.P. (1987).  Environmental Monitoring, Statistics, and the Law:  Room for 
  Improvement (with Comment).  <em>The American Statistician</em> <b>41</b>(4), 249--259.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>. 
  CRC Press, Boca Raton.</p>
<p>Singh, A., A.K. Singh, and R.J. Iaci. (2002). 
  <em>Estimation of the Exposure Point Concentration Term Using a Gamma Distribution</em>.  
  EPA/600/R-02/084. October 2002. Technology Support Center for Monitoring and 
  Site Characterization, Office of Research and Development, Office of Solid Waste and 
  Emergency Response, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Singh, A., R. Maichle, and N. Armbya. (2010a). 
  <em>ProUCL Version 4.1.00 User Guide (Draft)</em>. EPA/600/R-07/041, May 2010. 
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Singh, A., N. Armbya, and A. Singh. (2010b). 
  <em>ProUCL Version 4.1.00 Technical Guide (Draft)</em>. EPA/600/R-07/041, May 2010.  
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Wilson, E.B., and M.M. Hilferty. (1931). The Distribution of Chi-Squares. 
  <em>Proceedings of the National Academy of Sciences</em>, <b>17</b>, 684--688.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p><em>The Gamma Distribution</em> <br>
  The <a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">gamma distribution</a> takes values on the positive real line. 
  Special cases of the gamma are the <a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">exponential</a> distribution and 
  the <a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">chi-square</a> distributions.  Applications of the gamma include 
  life testing, statistical ecology, queuing theory, inventory control, and precipitation 
  processes. A gamma distribution starts to resemble a normal distribution as the 
  shape parameter a tends to infinity.</p>
<p>Some EPA guidance documents (e.g., Singh et al., 2002; Singh et al., 2010a,b) strongly 
  recommend against using a lognormal model for environmental data and recommend trying a 
  gamma distribuiton instead.
  <br></p>
<p><em>Motivation</em> <br>
  Prediction and tolerance intervals have long been applied to quality control and 
  life testing problems (Hahn, 1970b,c; Hahn and Nelson, 1973).  In the context of 
  environmental statistics, prediction intervals are useful for analyzing data from 
  groundwater detection monitoring programs at hazardous and solid waste facilities.</p>
<p>One of the main statistical problems that plague groundwater monitoring programs at 
  hazardous and solid waste facilities is the requirement of testing several wells and 
  several constituents at each well on each sampling occasion.  This is an obvious 
  multiple comparisons problem, and the naive approach of using a standard t-test at 
  a conventional \(\alpha\)-level (e.g., 0.05 or 0.01) for each test leads to a 
  very high probability of at least one significant result on each sampling occasion, 
  when in fact no contamination has occurred.  This problem was pointed out years ago 
  by Millard (1987) and others.</p>
<p>Davis and McNichols (1987) proposed simultaneous prediction intervals as a way of 
  controlling the facility-wide false positive rate (FWFPR) while maintaining adequate 
  power to detect contamination in the groundwater.  Because of the ubiquitous presence 
  of spatial variability, it is usually best to use simultaneous prediction intervals 
  at each well (Davis, 1998a).  That is, by constructing prediction intervals based on 
  background (pre-landfill) data on each well, and comparing future observations at a 
  well to the prediction interval for that particular well.  In each of these cases, 
  the individual \(\alpha\)-level at each well is equal to the FWFRP divided by the 
  product of the number of wells and constituents.</p>
<p>Often, observations at downgradient wells are not available prior to the 
  construction and operation of the landfill.  In this case, upgradient well data can 
  be combined to create a background prediction interval, and observations at each 
  downgradient well can be compared to this prediction interval.  If spatial 
  variability is present and a major source of variation, however, this method is not 
  really valid (Davis, 1994; Davis, 1998a).</p>
<p>Chapter 19 of USEPA (2009) contains an extensive discussion of using the 
  \(1\)-of-\(m\) rule and the Modified California rule.</p>
<p>Chapters 1 and 3 of Gibbons et al. (2009) discuss simultaneous prediction intervals 
  for the normal and lognormal distributions, respectively.
  <br></p> 
<p><em>The k-of-m Rule</em> <br>
  For the \(k\)-of-\(m\) rule, Davis and McNichols (1987) give tables with 
  “optimal” choices of \(k\) (in terms of best power for a given overall 
  confidence level) for selected values of \(m\), \(r\), and \(n\).  They found 
  that the optimal ratios of \(k\) to \(m\) (i.e., \(k/m\)) are generally small, 
  in the range of 15-50%.
  <br></p>
<p><em>The California Rule</em> <br>
  The California rule was mandated in that state for groundwater monitoring at waste 
  disposal facilities when resampling verification is part of the statistical program 
  (Barclay's Code of California Regulations, 1991).  The California code mandates a 
  “California” rule with \(m \ge 3\).  The motivation for this rule may have 
  been a desire to have a majority of the observations in bounds (Davis, 1998a).  For 
  example, for a \(k\)-of-\(m\) rule with \(k=1\) and \(m=3\), a monitoring 
  location will pass if the first observation is out of bounds, the second resample 
  is out of bounds, but the last resample is in bounds, so that 2 out of 3 observations 
  are out of bounds.  For the California rule with \(m=3\), either the first 
  observation must be in bounds, or the next 2 observations must be in bounds in order 
  for the monitoring location to pass.</p>
<p>Davis (1998a) states that if the FWFPR is kept constant, then the California rule 
  offers little increased power compared to the \(k\)-of-\(m\) rule, and can 
  actually decrease the power of detecting contamination.
  <br></p> 
<p><em>The Modified California Rule</em> <br>
  The Modified California Rule was proposed as a compromise between a 1-of-\(m\) 
  rule and the California rule.  For a given FWFPR, the Modified California rule 
  achieves better power than the California rule, and still requires at least as many 
  observations in bounds as out of bounds, unlike a 1-of-\(m\) rule.
  <br></p> 
<p><em>Different Notations Between Different References</em> <br>
  For the \(k\)-of-\(m\) rule described in this help file, both 
  Davis and McNichols (1987) and USEPA (2009, Chapter 19) use the variable 
  \(p\) instead of \(k\) to represent the minimum number 
  of future observations the interval should contain on each of the \(r\) sampling 
  occasions.</p>
<p>Gibbons et al. (2009, Chapter 1) presents extensive lists of the value of 
  \(K\) for both \(k\)-of-\(m\) rules and California rules.  Gibbons et al.'s 
  notation reverses the meaning of \(k\) and \(r\) compared to the notation used 
  in this help file.  That is, in Gibbons et al.'s notation, \(k\) represents the 
  number of future sampling occasions or monitoring wells, and \(r\) represents the 
  minimum number of observations the interval should contain on each sampling occasion.</p>
    </div>
    <div id="warning">
    <h2>Warning</h2>
    <p>It is possible for the lower prediction limit based on the transformed data to be 
  less than 0.  In this case, the lower prediction limit on the original scale is 
  set to 0 and a warning is issued stating that the normal approximation is not 
  accurate in this case.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">GammaDist</a></code>, <code><a href="GammaAlt.html">GammaAlt</a></code>, 
  <code><a href="predIntNorm.html">predIntNorm</a></code>, <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>, <br><code><a href="predIntNormSimultaneousTestPower.html">predIntNormSimultaneousTestPower</a></code>, <code><a href="tolIntGamma.html">tolIntGamma</a></code>, 
  <code><a href="egamma.html">egamma</a></code>, <code><a href="egamma.html">egammaAlt</a></code>, <code><a href="estimate.object.html">estimate.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Generate 8 observations from a gamma distribution with parameters </span></span>
<span class="r-in">  <span class="co"># mean=10 and cv=1, then use predIntGammaAltSimultaneous to estimate the </span></span>
<span class="r-in">  <span class="co"># mean and coefficient of variation of the true distribution and construct an </span></span>
<span class="r-in">  <span class="co"># upper 95% prediction interval to contain at least 1 out of the next </span></span>
<span class="r-in">  <span class="co"># 3 observations. </span></span>
<span class="r-in">  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">479</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="GammaAlt.html">rgammaAlt</a></span><span class="op">(</span><span class="fl">8</span>, mean <span class="op">=</span> <span class="fl">10</span>, cv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Gamma"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13.875825  1.049504 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MLE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rule</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "k.of.m"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LPL      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.00000 15.87101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact using\n                                 Kulkarni &amp; Powar (2010)\n                                 transformation to Normality\n                                 based on MLE of 'shape'"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $delta.over.sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.transmean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $normal.transform.power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2204908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Gamma</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          mean = 13.875825</span></span>
<span class="r-in">  <span class="co">#                                 cv   =  1.049504</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               MLE</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      exact using</span></span>
<span class="r-in">  <span class="co">#                                 Kulkarni &amp; Powar (2010)</span></span>
<span class="r-in">  <span class="co">#                                 transformation to Normality</span></span>
<span class="r-in">  <span class="co">#                                 based on MLE of 'shape'</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Normal Transform Power:          0.2204908</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Minimum Number of</span></span>
<span class="r-in">  <span class="co">#Future Observations</span></span>
<span class="r-in">  <span class="co">#Interval Should Contain:         1</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Total Number of</span></span>
<span class="r-in">  <span class="co">#Future Observations:             3</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL =  0.00000</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 15.87101</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the 95% 1-of-3 upper prediction limit to the California and </span></span>
<span class="r-in">  <span class="co"># Modified California upper prediction limits.  Note that the upper </span></span>
<span class="r-in">  <span class="co"># prediction limit for the Modified California rule is between the limit </span></span>
<span class="r-in">  <span class="co"># for the 1-of-3 rule and the limit for the California rule. </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15.87101 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#15.87101</span></span>
<span class="r-in"> </span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, m <span class="op">=</span> <span class="fl">3</span>, rule <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34.11499 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#34.11499</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, rule <span class="op">=</span> <span class="st">"Modified.CA"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22.58809 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#22.58809 </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Show how the upper 95% simultaneous prediction limit increases </span></span>
<span class="r-in">  <span class="co"># as the number of future sampling occasions r increases.  </span></span>
<span class="r-in">  <span class="co"># Here, we'll use the 1-of-3 rule.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15.87101 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#15.87101</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37.86825 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#37.86825</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the upper simultaneous prediction limit for the 1-of-3 rule </span></span>
<span class="r-in">  <span class="co"># based on individual observations versus based on transformed means of </span></span>
<span class="r-in">  <span class="co"># order 4.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15.87101 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#15.87101</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntGammaAltSimultaneous</span><span class="op">(</span><span class="va">dat</span>, n.transmean <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">1</span>, </span>
<span class="r-in">    m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14.76528 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#14.76528 </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Example 19-1 of USEPA (2009, p. 19-17) shows how to compute an </span></span>
<span class="r-in">  <span class="co"># upper simultaneous prediction limit for the 1-of-3 rule for </span></span>
<span class="r-in">  <span class="co"># r = 2 future sampling occasions.  The data for this example are </span></span>
<span class="r-in">  <span class="co"># stored in EPA.09.Ex.19.1.sulfate.df.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># We will pool data from 4 background wells that were sampled on </span></span>
<span class="r-in">  <span class="co"># a number of different occasions, giving us a sample size of </span></span>
<span class="r-in">  <span class="co"># n = 25 to use to construct the prediction limit.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># There are 50 compliance wells and we will monitor 10 different </span></span>
<span class="r-in">  <span class="co"># constituents at each well at each of the r=2 future sampling </span></span>
<span class="r-in">  <span class="co"># occasions.  To determine the confidence level we require for </span></span>
<span class="r-in">  <span class="co"># the simultaneous prediction interval, USEPA (2009) recommends </span></span>
<span class="r-in">  <span class="co"># setting the individual Type I Error level at each well to </span></span>
<span class="r-in"> </span>
<span class="r-in">  <span class="co"># 1 - (1 - SWFPR)^(1 / (Number of Constituents * Number of Wells))</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co"># which translates to setting the confidence limit to </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># (1 - SWFPR)^(1 / (Number of Constituents * Number of Wells))</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># where SWFPR = site-wide false positive rate.  For this example, we </span></span>
<span class="r-in">  <span class="co"># will set SWFPR = 0.1.  Thus, the confidence level is given by:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span class="r-in">  <span class="va">nw</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span class="r-in">  <span class="va">SWFPR</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span class="r-in">  <span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">SWFPR</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">nc</span> <span class="op">*</span> <span class="va">nw</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">conf.level</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9997893</span>
<span class="r-in">  <span class="co">#[1] 0.9997893</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at the data:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.1.sulfate.df</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Well"                 "Month"                "Day"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "Year"                 "Date"                 "Sulfate.mg.per.l"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "log.Sulfate.mg.per.l"</span>
<span class="r-in">  <span class="co">#[1] "Well"                 "Month"                "Day"                 </span></span>
<span class="r-in">  <span class="co">#[4] "Year"                 "Date"                 "Sulfate.mg.per.l"    </span></span>
<span class="r-in">  <span class="co">#[7] "log.Sulfate.mg.per.l"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">EPA.09.Ex.19.1.sulfate.df</span><span class="op">[</span>, </span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Well"</span>, <span class="st">"Date"</span>, <span class="st">"Sulfate.mg.per.l"</span>, <span class="st">"log.Sulfate.mg.per.l"</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Well       Date Sulfate.mg.per.l log.Sulfate.mg.per.l</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  GW-01 1999-07-08             63.0             4.143135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  GW-01 1999-09-12             51.0             3.931826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  GW-01 1999-10-16             60.0             4.094345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  GW-01 1999-11-02             86.0             4.454347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  GW-04 1999-07-09            104.0             4.644391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  GW-04 1999-09-14            102.0             4.624973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  GW-04 1999-10-12             84.0             4.430817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  GW-04 1999-11-15             72.0             4.276666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  GW-08 1997-10-12             31.0             3.433987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 GW-08 1997-11-16             84.0             4.430817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 GW-08 1998-01-28             65.0             4.174387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 GW-08 1999-04-20             41.0             3.713572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 GW-08 2002-06-04             51.8             3.947390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 GW-08 2002-09-16             57.5             4.051785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 GW-08 2002-12-02             66.8             4.201703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 GW-08 2003-03-24             87.1             4.467057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 GW-09 1997-10-16             59.0             4.077537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 GW-09 1998-01-28             85.0             4.442651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 GW-09 1998-04-12             75.0             4.317488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 GW-09 1998-07-12             99.0             4.595120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 GW-09 2000-01-30             75.8             4.328098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 GW-09 2000-04-24             82.5             4.412798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 GW-09 2000-10-24             85.5             4.448516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 GW-09 2002-12-01            188.0             5.236442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 GW-09 2003-03-24            150.0             5.010635</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#    Well       Date Sulfate.mg.per.l log.Sulfate.mg.per.l</span></span>
<span class="r-in">  <span class="co">#1  GW-01 1999-07-08             63.0             4.143135</span></span>
<span class="r-in">  <span class="co">#2  GW-01 1999-09-12             51.0             3.931826</span></span>
<span class="r-in">  <span class="co">#3  GW-01 1999-10-16             60.0             4.094345</span></span>
<span class="r-in">  <span class="co">#4  GW-01 1999-11-02             86.0             4.454347</span></span>
<span class="r-in">  <span class="co">#5  GW-04 1999-07-09            104.0             4.644391</span></span>
<span class="r-in">  <span class="co">#6  GW-04 1999-09-14            102.0             4.624973</span></span>
<span class="r-in">  <span class="co">#7  GW-04 1999-10-12             84.0             4.430817</span></span>
<span class="r-in">  <span class="co">#8  GW-04 1999-11-15             72.0             4.276666</span></span>
<span class="r-in">  <span class="co">#9  GW-08 1997-10-12             31.0             3.433987</span></span>
<span class="r-in">  <span class="co">#10 GW-08 1997-11-16             84.0             4.430817</span></span>
<span class="r-in">  <span class="co">#11 GW-08 1998-01-28             65.0             4.174387</span></span>
<span class="r-in">  <span class="co">#12 GW-08 1999-04-20             41.0             3.713572</span></span>
<span class="r-in">  <span class="co">#13 GW-08 2002-06-04             51.8             3.947390</span></span>
<span class="r-in">  <span class="co">#14 GW-08 2002-09-16             57.5             4.051785</span></span>
<span class="r-in">  <span class="co">#15 GW-08 2002-12-02             66.8             4.201703</span></span>
<span class="r-in">  <span class="co">#16 GW-08 2003-03-24             87.1             4.467057</span></span>
<span class="r-in">  <span class="co">#17 GW-09 1997-10-16             59.0             4.077537</span></span>
<span class="r-in">  <span class="co">#18 GW-09 1998-01-28             85.0             4.442651</span></span>
<span class="r-in">  <span class="co">#19 GW-09 1998-04-12             75.0             4.317488</span></span>
<span class="r-in">  <span class="co">#20 GW-09 1998-07-12             99.0             4.595120</span></span>
<span class="r-in">  <span class="co">#21 GW-09 2000-01-30             75.8             4.328098</span></span>
<span class="r-in">  <span class="co">#22 GW-09 2000-04-24             82.5             4.412798</span></span>
<span class="r-in">  <span class="co">#23 GW-09 2000-10-24             85.5             4.448516</span></span>
<span class="r-in">  <span class="co">#24 GW-09 2002-12-01            188.0             5.236442</span></span>
<span class="r-in">  <span class="co">#25 GW-09 2003-03-24            150.0             5.010635</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The EPA guidance document constructs the upper simultaneous </span></span>
<span class="r-in">  <span class="co"># prediction limit for the 1-of-3 plan assuming a lognormal </span></span>
<span class="r-in">  <span class="co"># distribution for the sulfate data.  Here we will compare </span></span>
<span class="r-in">  <span class="co"># the value of the limit based on assuming a lognormal distribution </span></span>
<span class="r-in">  <span class="co"># versus assuming a gamma distribution.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">Sulfate</span> <span class="op">&lt;-</span> <span class="va">EPA.09.Ex.19.1.sulfate.df</span><span class="op">$</span><span class="va">Sulfate.mg.per.l</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">pred.int.list.lnorm</span> <span class="op">&lt;-</span> </span>
<span class="r-in">    <span class="fu"><a href="predIntLnormSimultaneous.html">predIntLnormSimultaneous</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sulfate</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">2</span>, </span>
<span class="r-in">      rule <span class="op">=</span> <span class="st">"k.of.m"</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">pred.int.list.gamma</span> <span class="op">&lt;-</span> </span>
<span class="r-in">    <span class="fu">predIntGammaSimultaneous</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sulfate</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">2</span>, </span>
<span class="r-in">      rule <span class="op">=</span> <span class="st">"k.of.m"</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">pred.int.list.lnorm</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159.5497 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#159.5497</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">pred.int.list.gamma</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153.3232 </span>
<span class="r-in">  <span class="co">#     UPL </span></span>
<span class="r-in">  <span class="co">#153.3232</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Cleanup</span></span>
<span class="r-in">  <span class="co">#--------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">nc</span>, <span class="va">nw</span>, <span class="va">SWFPR</span>, <span class="va">conf.level</span>, <span class="va">Sulfate</span>, <span class="va">pred.int.list.lnorm</span>, </span>
<span class="r-in">    <span class="va">pred.int.list.gamma</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

