<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Table of Confidence Intervals for Mean or Difference Between Two Means — ciTableMean • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Table of Confidence Intervals for Mean or Difference Between Two Means — ciTableMean"><meta property="og:description" content="Create a table of confidence intervals for the mean of a normal distribution
  or the difference between two means following Bacchetti (2010), by varying
  the estimated standard deviation and the estimated mean or differene between
  the two estimated means given the sample size(s)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Table of Confidence Intervals for Mean or Difference Between Two Means</h1>

    <div class="hidden name"><code>ciTableMean.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a table of confidence intervals for the mean of a normal distribution
  or the difference between two means following Bacchetti (2010), by varying
  the estimated standard deviation and the estimated mean or differene between
  the two estimated means given the sample size(s).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ciTableMean</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">10</span>, n2 <span class="op">=</span> <span class="va">n1</span>, diff.or.mean <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">0</span>, SD <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, </span>
<span>    sample.type <span class="op">=</span> <span class="st">"two.sample"</span>, ci.type <span class="op">=</span> <span class="st">"two.sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n-">n1<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>positive integer greater than 1 specifying the sample size when <br><code>sample.type="one.sample"</code> or the sample size for group 1 when <br><code>sample.type="two.sample"</code>.  The default value is <code>n1=10</code>.</p></dd>

  <dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>positive integer greater than 1 specifying the sample size for group 2 when
  <code>sample.type="two.sample"</code>.  The default value is <code>n2=n1</code>, i.e.,
  equal sample sizes.  This argument is ignored when <code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-diff-or-mean">diff.or.mean<a class="anchor" aria-label="anchor" href="#arg-diff-or-mean"></a></dt>
<dd><p>numeric vector indicating either the assumed difference between the two sample means
  when <code>sample.type="two.sample"</code> or the value of the sample mean when
  <code>sample.type="one.sample"</code>.  The default value is <code>diff.or.mean=2:0</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), an infinite
  (<code>-Inf</code>, <code>Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-sd">SD<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>numeric vector of positive values specifying the assumed estimated standard
  deviation.  The default value is <code>SD=1:3</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), an infinite
  (<code>-Inf</code>, <code>Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string specifying whether to create confidence intervals for the difference
  between two means (<code>sample.type="two.sample"</code>; the default) or confidence
  intervals for a single mean (<code>sample.type="one.sample"</code>).</p></dd>

  <dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>character string indicating what kind of confidence interval to compute.  The
  possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
  The default value is <code>conf.level=0.95</code>.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>positive integer indicating how many decimal places to display in the table.  The
  default value is <code>digits=1</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Following Bacchetti (2010) (see NOTE below), the function <code>ciTableMean</code>
  allows you to perform sensitivity analyses while planning future studies by
  producing a table of confidence intervals for the mean or the difference
  between two means by varying the estimated standard deviation and the
  estimated mean or differene between the two estimated means given the
  sample size(s).</p>
<p><em>One Sample Case</em> (<code>sample.type="one.sample"</code>) <br>
  Let \(\underline{x} = (x_1, x_2, \ldots, x_n)\) be a vector of
  \(n\) observations from an <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal (Gaussian) distribution</a> with
  parameters <code>mean=</code>\(\mu\) and <code>sd=</code>\(\sigma\).</p>
<p>The usual confidence interval for \(\mu\) is constructed as follows.
  If <code>ci.type="two-sided"</code>, the \((1-\alpha)\)100% confidence interval for
  \(\mu\) is given by:
  $$[\hat{\mu} - t(n-1, 1-\alpha/2) \frac{\hat{\sigma}}{\sqrt{n}}, \, \hat{\mu} + t(n-1, 1-\alpha/2) \frac{\hat{\sigma}}{\sqrt{n}}] \;\;\;\;\;\; (1)$$
  where
  $$\hat{\mu} = \bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)$$
  $$\hat{\sigma}^2 = s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)$$
  and \(t(\nu, p)\) is the \(p\)'th quantile of
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(\nu\) degrees of freedom
  (Zar, 2010; Gilbert, 1987; Ott, 1995; Helsel and Hirsch, 1992).</p>
<p>If <code>ci.type="lower"</code>, the \((1-\alpha)\)100% confidence interval for
  \(\mu\) is given by:
  $$[\hat{\mu} - t(n-1, 1-\alpha) \frac{\hat{\sigma}}{\sqrt{n}}, \, \infty] \;\;\;\; (4)$$
  and if <code>ci.type="upper"</code>, the confidence interval is given by:
  $$[-\infty, \, \hat{\mu} + t(n-1, 1-\alpha/2) \frac{\hat{\sigma}}{\sqrt{n}}] \;\;\;\; (5)$$</p>
<p>For the one-sample case, the argument <code>n1</code> corresponds to \(n\) in
  Equation (1), the argument <br><code>diff.or.mean</code> corresponds to
  \(\hat{\mu} = \bar{x}\) in Equation (2), and the argument <code>SD</code> corresponds to
  \(\hat{\sigma} = s\) in Equation (3).
  <br></p>
<p><em>Two Sample Case</em> (<code>sample.type="two.sample"</code>) <br>
  Let \(\underline{x}_1 = (x_{11}, x_{21}, \ldots, x_{n_11})\) be a vector of
  \(n_1\) observations from an <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal (Gaussian) distribution</a>
  with parameters <code>mean=</code>\(\mu_1\) and <code>sd=</code>\(\sigma\), and let
  \(\underline{x}_2 = (x_{12}, x_{22}, \ldots, x_{n_22})\) be a vector of
  \(n_2\) observations from an <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal (Gaussian) distribution</a>
  with parameters <code>mean=</code>\(\mu_2\) and <code>sd=</code>\(\sigma\).</p>
<p>The usual confidence interval for the difference between the two population means
  \(\mu_1 - \mu_2\) is constructed as follows.
  If <code>ci.type="two-sided"</code>, the \((1-\alpha)\)100% confidence interval for
  \(\mu_1 - \mu_2\) is given by:
  $$[(\hat{\mu}_1 - \hat{\mu}_2) - t(n_1 + n_2 -2, 1-\alpha/2) \hat{\sigma}\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}, \; (\hat{\mu}_1 - \hat{\mu}_2) + t(n_1 + n_2 -2, 1-\alpha/2) \hat{\sigma}\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}] \;\;\;\;\;\; (6)$$
  where
  $$\hat{\mu}_1 = \bar{x}_1 = \frac{1}{n_1} \sum_{i=1}^{n_1} x_{i1} \;\;\;\;\;\; (7)$$
  $$\hat{\mu}_2 = \bar{x}_2 = \frac{1}{n_2} \sum_{i=1}^{n_2} x_{i2} \;\;\;\;\;\; (8)$$
  $$\hat{\sigma}^2 = s_p^2 = \frac{(n_1-1) s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2} \;\;\;\;\;\; (9)$$
  $$s_1^2 = \frac{1}{n_1-1} \sum_{i=1}^{n_1} (x_{i1} - \bar{x}_1)^2 \;\;\;\;\;\; (10)$$
  $$s_2^2 = \frac{1}{n_2-1} \sum_{i=1}^{n_2} (x_{i2} - \bar{x}_2)^2 \;\;\;\;\;\; (11)$$
  and \(t(\nu, p)\) is the \(p\)'th quantile of
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(\nu\) degrees of freedom
  (Zar, 2010; Gilbert, 1987; Ott, 1995; Helsel and Hirsch, 1992).</p>
<p>If <code>ci.type="lower"</code>, the \((1-\alpha)\)100% confidence interval for
  \(\mu_1 - \mu_2\) is given by:
  $$[(\hat{\mu}_1 - \hat{\mu}_2) - t(n_1 + n_2 -2, 1-\alpha) \hat{\sigma}\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}, \; \infty] \;\;\;\;\;\; (12)$$
  and if <code>ci.type="upper"</code>, the confidence interval is given by:
  $$[-\infty, \; (\hat{\mu}_1 - \hat{\mu}_2) - t(n_1 + n_2 -2, 1-\alpha) \hat{\sigma}\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}] \;\;\;\;\;\; (13)$$</p>
<p>For the two-sample case, the arguments <code>n1</code> and <code>n2</code> correspond to
  \(n_1\) and \(n_2\) in Equation (6), the argument <code>diff.or.mean</code> corresponds
  to \(\hat{\mu_1} - \hat{\mu_2} = \bar{x}_1 - \bar{x}_2\) in Equations (7) and (8),
  and the argument <code>SD</code> corresponds to \(\hat{\sigma} = s_p\) in Equation (9).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a data frame with the rows varying the standard deviation and the columns
  varying the estimated mean or difference between the means.  Elements of the
  data frame are character strings indicating the confidence intervals.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bacchetti, P. (2010).  Current sample size conventions: Flaws, Harms, and
    Alternatives.  <em>BMC Medicine</em> <b>8</b>, 17–23.</p>
<p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers</em>.  Second Edition.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, FL.</p>
<p>Ott, W.R. (1995). <em>Environmental Statistics and Data Analysis</em>.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Bacchetti (2010) presents strong arguments against the current convention in
  scientific research for computing sample size that is based on formulas that
  use a fixed Type I error (usually 5%) and a fixed minimal power (often 80%)
  without regard to costs.  He notes that a key input to these formulas is a
  measure of variability (usually a standard deviation) that is difficult to
  measure accurately "unless there is so much preliminary data that the study
  isn't really needed."  Also, study designers often avoid defining what a
  scientifically meaningful difference is by presenting sample size results in
  terms of the effect size (i.e., the difference of interest divided by the
  elusive standard deviation).  Bacchetti (2010) encourages study designers to use
  simple tables in a sensitivity analysis to see what results of a study may look
  like for low, moderate, and high rates of variability and large, intermediate,
  and no underlying differences in the populations or processes being studied.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="enorm.html">enorm</a></code>, <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>, <code><a href="ciTableProp.html">ciTableProp</a></code>,
  <code><a href="ciNormHalfWidth.html">ciNormHalfWidth</a></code>, <code><a href="ciNormN.html">ciNormN</a></code>,
  <code><a href="plotCiNormDesign.html">plotCiNormDesign</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Show how potential confidence intervals for the difference between two means </span></span></span>
<span class="r-in"><span>  <span class="co"># will look assuming standard deviations of 1, 2, or 3, differences between </span></span></span>
<span class="r-in"><span>  <span class="co"># the two means of 2, 1, or 0, and a sample size of 10 in each group.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciTableMean</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Diff=2      Diff=1      Diff=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=1 [ 1.1, 2.9] [ 0.1, 1.9] [-0.9, 0.9]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=2 [ 0.1, 3.9] [-0.9, 2.9] [-1.9, 1.9]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=3 [-0.8, 4.8] [-1.8, 3.8] [-2.8, 2.8]</span>
<span class="r-in"><span>  <span class="co">#          Diff=2      Diff=1      Diff=0</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=1 [ 1.1, 2.9] [ 0.1, 1.9] [-0.9, 0.9]</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=2 [ 0.1, 3.9] [-0.9, 2.9] [-1.9, 1.9]</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=3 [-0.8, 4.8] [-1.8, 3.8] [-2.8, 2.8]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Show how a potential confidence interval for a mean will look assuming </span></span></span>
<span class="r-in"><span>  <span class="co"># standard deviations of 1, 2, or 5, a sample mean of 5, 3, or 1, and </span></span></span>
<span class="r-in"><span>  <span class="co"># a sample size of 15.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciTableMean</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">15</span>, diff.or.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, sample.type <span class="op">=</span> <span class="st">"one"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Mean=5      Mean=3      Mean=1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=1 [ 4.4, 5.6] [ 2.4, 3.6] [ 0.4, 1.6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=2 [ 3.9, 6.1] [ 1.9, 4.1] [-0.1, 2.1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=5 [ 2.2, 7.8] [ 0.2, 5.8] [-1.8, 3.8]</span>
<span class="r-in"><span>  <span class="co">#          Mean=5      Mean=3      Mean=1</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=1 [ 4.4, 5.6] [ 2.4, 3.6] [ 0.4, 1.6]</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=2 [ 3.9, 6.1] [ 1.9, 4.1] [-0.1, 2.1]</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=5 [ 2.2, 7.8] [ 0.2, 5.8] [-1.8, 3.8]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The data frame EPA.09.Ex.16.1.sulfate.df contains sulfate concentrations</span></span></span>
<span class="r-in"><span>  <span class="co"># (ppm) at one background and one downgradient well. The estimated</span></span></span>
<span class="r-in"><span>  <span class="co"># mean and standard deviation for the background well are 536 and 27 ppm,</span></span></span>
<span class="r-in"><span>  <span class="co"># respectively, based on a sample size of n = 8 quarterly samples taken over </span></span></span>
<span class="r-in"><span>  <span class="co"># 2 years.  A two-sided 95% confidence interval for this mean is [514, 559], </span></span></span>
<span class="r-in"><span>  <span class="co"># which has a  half-width of 23 ppm.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># The estimated mean and standard deviation for the downgradient well are </span></span></span>
<span class="r-in"><span>  <span class="co"># 608 and 18 ppm, respectively, based on a sample size of n = 6 quarterly </span></span></span>
<span class="r-in"><span>  <span class="co"># samples.  A two-sided 95% confidence interval for the difference between </span></span></span>
<span class="r-in"><span>  <span class="co"># this mean and the background mean is [44, 100] ppm.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># Suppose we want to design a future sampling program and are interested in </span></span></span>
<span class="r-in"><span>  <span class="co"># the size of the confidence interval for the difference between the two means.  </span></span></span>
<span class="r-in"><span>  <span class="co"># We will use ciTableMean to generate a table of possible confidence intervals </span></span></span>
<span class="r-in"><span>  <span class="co"># by varying the assumed standard deviation and assumed differences between </span></span></span>
<span class="r-in"><span>  <span class="co"># the means.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at the data</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.09.Ex.16.1.sulfate.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Month Year    Well.type Sulfate.ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Jan 1995   Background         560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    Apr 1995   Background         530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    Jul 1995   Background         570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    Oct 1995   Background         490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    Jan 1996   Background         510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    Apr 1996   Background         550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Jul 1996   Background         550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    Oct 1996   Background         530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    Jan 1995 Downgradient          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   Apr 1995 Downgradient          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   Jul 1995 Downgradient         600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   Oct 1995 Downgradient         590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   Jan 1996 Downgradient         590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   Apr 1996 Downgradient         630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   Jul 1996 Downgradient         610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   Oct 1996 Downgradient         630</span>
<span class="r-in"><span>  <span class="co">#   Month Year    Well.type Sulfate.ppm</span></span></span>
<span class="r-in"><span>  <span class="co">#1    Jan 1995   Background         560</span></span></span>
<span class="r-in"><span>  <span class="co">#2    Apr 1995   Background         530</span></span></span>
<span class="r-in"><span>  <span class="co">#3    Jul 1995   Background         570</span></span></span>
<span class="r-in"><span>  <span class="co">#4    Oct 1995   Background         490</span></span></span>
<span class="r-in"><span>  <span class="co">#5    Jan 1996   Background         510</span></span></span>
<span class="r-in"><span>  <span class="co">#6    Apr 1996   Background         550</span></span></span>
<span class="r-in"><span>  <span class="co">#7    Jul 1996   Background         550</span></span></span>
<span class="r-in"><span>  <span class="co">#8    Oct 1996   Background         530</span></span></span>
<span class="r-in"><span>  <span class="co">#9    Jan 1995 Downgradient          NA</span></span></span>
<span class="r-in"><span>  <span class="co">#10   Apr 1995 Downgradient          NA</span></span></span>
<span class="r-in"><span>  <span class="co">#11   Jul 1995 Downgradient         600</span></span></span>
<span class="r-in"><span>  <span class="co">#12   Oct 1995 Downgradient         590</span></span></span>
<span class="r-in"><span>  <span class="co">#13   Jan 1996 Downgradient         590</span></span></span>
<span class="r-in"><span>  <span class="co">#14   Apr 1996 Downgradient         630</span></span></span>
<span class="r-in"><span>  <span class="co">#15   Jul 1996 Downgradient         610</span></span></span>
<span class="r-in"><span>  <span class="co">#16   Oct 1996 Downgradient         630</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the estimated mean and standard deviation for the </span></span></span>
<span class="r-in"><span>  <span class="co"># background well.</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Sulfate.back</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.16.1.sulfate.df</span>,</span></span>
<span class="r-in"><span>    <span class="va">Sulfate.ppm</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="enorm.html">enorm</a></span><span class="op">(</span><span class="va">Sulfate.back</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mean       sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 536.2500  26.6927 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Sulfate.back"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 513.9343 558.5657 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 536.2500</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   =  26.6927</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Sulfate.back</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     8</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 513.9343</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 558.5657</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the estimated mean and standard deviation for the </span></span></span>
<span class="r-in"><span>  <span class="co"># downgradient well.</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Sulfate.down</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.16.1.sulfate.df</span>,</span></span>
<span class="r-in"><span>    <span class="va">Sulfate.ppm</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Downgradient"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="enorm.html">enorm</a></span><span class="op">(</span><span class="va">Sulfate.down</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 2 nonfinite values in x : 2 NA's</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>2 observations with NA/NaN/Inf in 'x' removed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 608.33333  18.34848 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Sulfate.down"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 589.0778 627.5889 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 608.33333</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   =  18.34848</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Sulfate.down</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     6</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number NA/NaN/Inf's:             2</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 589.0778</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 627.5889</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the estimated difference between the means and the confidence </span></span></span>
<span class="r-in"><span>  <span class="co"># interval for the difference:</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Sulfate.down</span>, <span class="va">Sulfate.back</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Two Sample t-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Sulfate.down and Sulfate.back</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = 5.661, df = 12, p-value = 0.0001054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true difference in means is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  44.33974 99.82693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean of x mean of y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  608.3333  536.2500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 difference in means = 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True difference in means is not equal to 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                        Two Sample t-test</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean of x = 608.3333</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 mean of y = 536.2500</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Sulfate.down and Sulfate.back</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  t = 5.660985</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic Parameter:        df = 12</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.0001054306</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#95% Confidence Interval:         LCL = 44.33974</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 99.82693</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Use ciTableMean to look how the confidence interval for the difference</span></span></span>
<span class="r-in"><span>  <span class="co"># between the background and downgradient means in a future study using eight</span></span></span>
<span class="r-in"><span>  <span class="co"># quarterly samples at each well varies with assumed value of the pooled standard</span></span></span>
<span class="r-in"><span>  <span class="co"># deviation and the observed difference between the sample means. </span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Our current estimate of the pooled standard deviation is 24 ppm:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sulfate.ppm</span> <span class="op">~</span> <span class="va">Well.type</span>, data <span class="op">=</span> <span class="va">EPA.09.Ex.16.1.sulfate.df</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 23.57759</span>
<span class="r-in"><span>  <span class="co">#[1] 23.57759</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can see that if this is overly optimistic and in our next study the </span></span></span>
<span class="r-in"><span>  <span class="co"># pooled standard deviation is around 50 ppm, then if the observed difference </span></span></span>
<span class="r-in"><span>  <span class="co"># between the means is 50 ppm, the lower end of the confidence interval for </span></span></span>
<span class="r-in"><span>  <span class="co"># the difference between the two means will include 0, so we may want to </span></span></span>
<span class="r-in"><span>  <span class="co"># increase our sample size.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciTableMean</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">8</span>, n2 <span class="op">=</span> <span class="fl">8</span>, diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">0</span><span class="op">)</span>, SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">25</span>, <span class="fl">50</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Diff=100    Diff=50     Diff=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=15 [ 84, 116] [ 34,  66] [-16,  16]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=25 [ 73, 127] [ 23,  77] [-27,  27]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SD=50 [ 46, 154] [ -4, 104] [-54,  54]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#        Diff=100    Diff=50     Diff=0</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=15 [ 84, 116] [ 34,  66] [-16,  16]</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=25 [ 73, 127] [ 23,  77] [-27,  27]</span></span></span>
<span class="r-in"><span>  <span class="co">#SD=50 [ 46, 154] [ -4, 104] [-54,  54]</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">Sulfate.back</span>, <span class="va">Sulfate.down</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

