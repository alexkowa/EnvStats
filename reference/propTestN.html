<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute Sample Size Necessary to Achieve a Specified Power for a One- or Two-Sample Proportion Test — propTestN • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Sample Size Necessary to Achieve a Specified Power for a One- or Two-Sample Proportion Test — propTestN"><meta property="og:description" content="Compute the sample size necessary to achieve a specified power for a one- or
  two-sample proportion test, given the true proportion(s) and significance level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Sample Size Necessary to Achieve a Specified Power for a One- or Two-Sample Proportion Test</h1>

    <div class="hidden name"><code>propTestN.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the sample size necessary to achieve a specified power for a one- or
  two-sample proportion test, given the true proportion(s) and significance level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">propTestN</span><span class="op">(</span><span class="va">p.or.p1</span>, <span class="va">p0.or.p2</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    sample.type <span class="op">=</span> <span class="st">"one.sample"</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, </span>
<span>    ratio <span class="op">=</span> <span class="fl">1</span>, approx <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    correct <span class="op">=</span> <span class="va">sample.type</span> <span class="op">==</span> <span class="st">"two.sample"</span>, </span>
<span>    round.up <span class="op">=</span> <span class="cn">TRUE</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, return.exact.list <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    n.min <span class="op">=</span> <span class="fl">2</span>, n.max <span class="op">=</span> <span class="fl">10000</span>, tol.alpha <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">alpha</span>, </span>
<span>    tol <span class="op">=</span> <span class="fl">1e-7</span>, maxiter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-p-or-p-">p.or.p1<a class="anchor" aria-label="anchor" href="#arg-p-or-p-"></a></dt>
<dd><p>numeric vector of proportions.  When <code>sample.type="one.sample"</code>, this argument denotes the
  true value of \(p\), the probability of “success”.  <br>
  When <code>sample.type="two.sample"</code>, this argument denotes the value of \(p_1\),
  the probability of “success” in group 1.  The default value is <br><code>p.or.p1=0.5</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite
  (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-p-or-p-">p0.or.p2<a class="anchor" aria-label="anchor" href="#arg-p-or-p-"></a></dt>
<dd><p>numeric vector of proportions.  When <code>sample.type="one.sample"</code>,
  this argument denotes the hypothesized value of \(p\), the probability of “success”.
  When <code>sample.type="two.sample"</code>, this argument denotes the value of \(p_2\),
  the probability of “success” in group 2.  The default value is <br><code>p0.or.p2=0.5</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite
  (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>numeric vector of numbers between 0 and 1 indicating the Type I error level
  associated with the hypothesis test.  The default value is <code>alpha=0.05</code>.</p></dd>

  <dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>numeric vector of numbers between 0 and 1 indicating the power associated with
  the hypothesis test. The default value is <code>power=0.95</code>.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string indicating whether to compute sample size based on a one-sample or
  two-sample hypothesis test.  <br>
  When <code>sample.type="one.sample"</code>, the computed sample size is based
  on a hypothesis test for a single proportion.  <br>
  When <code>sample.type="two.sample"</code>, the computed sample size is based
  on a hypothesis test for the difference between two proportions. <br>
  The default value is <code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.
  The possible values are <code>"two.sided"</code> (the default), <code>"less"</code>, and
  <code>"greater"</code>.</p></dd>

  <dt id="arg-ratio">ratio<a class="anchor" aria-label="anchor" href="#arg-ratio"></a></dt>
<dd><p>numeric vector indicating the ratio of sample size in group 2 to sample size
  in group 1 (\(n_2/n_1\)).  The default value is <code>ratio=1</code>.
  All values of <code>ratio</code> must be greater than or equal to 1.
  This argument is ignored if <br><code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-approx">approx<a class="anchor" aria-label="anchor" href="#arg-approx"></a></dt>
<dd><p>logical scalar indicating whether to compute the sample size based on the normal
  approximation to the binomial distribution.  The default value is <code>approx=TRUE</code>.
  Currently, the exact method (<code>approx=FALSE</code>) is only available for the
  one-sample case (i.e., <code>sample.type="one.sample"</code>).</p></dd>

  <dt id="arg-correct">correct<a class="anchor" aria-label="anchor" href="#arg-correct"></a></dt>
<dd><p>logical scalar indicating whether to use the continuity correction when <br><code>approx=TRUE</code>.  The default value is <code>approx=TRUE</code> when <br><code>sample.type="two.sample"</code> and <code>approx=FALSE</code> when <br><code>sample.type="one.sample"</code>.  This argument is ignored when <br><code>approx=FALSE</code>.</p></dd>

  <dt id="arg-round-up">round.up<a class="anchor" aria-label="anchor" href="#arg-round-up"></a></dt>
<dd><p>logical scalar indicating whether to round up the values of the computed sample size(s)
  to the next smallest integer.  The default value is <code>round.up=TRUE</code>.</p></dd>

  <dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical scalar indicating whether to issue a warning.  The default value is <br><code>warn=TRUE</code>.  When <code>approx=TRUE</code> (sample size based on the normal approximation)
  and <code>warn=T</code>, a warning is issued for cases when the normal approximation to the
  binomial distribution probably is not accurate.  <br>
  When <code>approx=FALSE</code> (sample size based on the exact test) and <code>warn=TRUE</code>, a warning is issued when
  the user-supplied sample size is too small to yield a significance level less than or
  equal to the user-supplied value of <code>alpha</code>.</p></dd>

  <dt id="arg-return-exact-list">return.exact.list<a class="anchor" aria-label="anchor" href="#arg-return-exact-list"></a></dt>
<dd><p>logical scalar relevant to the case when <code>approx=FALSE</code>
  (i.e., when the power is based on the exact test).  This argument indicates whether
  to return a list containing extra information about the exact test in addition to
  the power of the exact test.  By default, <code>propTestN</code> returns only a vector
  containing the computed sample size(s) (see the VALUE section below). When <br><code>return.exact.list=TRUE</code> (the default) and <code>approx=FALSE</code>, <br><code>propTestN</code> returns a list with components indicating the required sample size,
  power of the exact test, the true significance level associated with the exact test, and the
  critical values associated with the exact test (see the DETAILS section for more information).</p></dd>

  <dt id="arg-n-min">n.min<a class="anchor" aria-label="anchor" href="#arg-n-min"></a></dt>
<dd><p>integer relevant to the case when <code>approx=FALSE</code>
  (i.e., when the power is based on the exact test).  This argument indicates the minimum
  allowed value for n to use in the search algorithm.  The default value is <code>n.min=2</code>.</p></dd>

  <dt id="arg-n-max">n.max<a class="anchor" aria-label="anchor" href="#arg-n-max"></a></dt>
<dd><p>integer relevant to the case when <code>approx=FALSE</code>
  (i.e., when the power is based on the exact test).  This argument indicates the maximum
  allowed value for n to use in the search algorithm.  The default value is <code>n.max=10000</code>.</p></dd>

  <dt id="arg-tol-alpha">tol.alpha<a class="anchor" aria-label="anchor" href="#arg-tol-alpha"></a></dt>
<dd><p>numeric vector relevant to the case when <code>approx=FALSE</code>
  (i.e., when the power is based on the exact test).  This argument indicates the tolerance
  on <code>alpha</code> to use in the search algorithm (i.e., how close the actual Type
  I error level is to the value prescribed by <code>alpha</code>).  The default value is <code>tol.alpha=0.1*alpha</code>.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numeric scalar relevant to the case when <code>approx=FALSE</code>
  (i.e., when the power is based on the exact test).  This argument is passed to the
  <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> function and indicates the tolerance to use in the search algorithm.
  The default value is <code>tol=1e-7</code>.</p></dd>
  <dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>integer relevant to the case when <code>approx=FALSE</code>
  (i.e., when the power is based on the exact test).  This argument is passed to the
  <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> function and indicates the maximum number of iterations to use
  in the search algorithm.  The default value is <code>maxiter=1000</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the arguments <code>p.or.p1</code>, <code>p0.or.p2</code>, <code>alpha</code>, <code>power</code>, <code>ratio</code>,
  and <code>tol.alpha</code> are not all the same length, they are replicated to be the same length
  as the length of the longest argument.</p>
<p>The computed sample size is based on the difference <code>p.or.p1 - p0.or.p2</code>.</p>
<p><strong>One-Sample Case (<code>sample.type="one.sample"</code>)</strong>.</p><dl><dt><code>approx=TRUE</code>.</dt>
<dd><p>When <code>sample.type="one.sample"</code> and <code>approx=TRUE</code>,
  sample size is computed based on the test that uses the normal approximation to the
  binomial distribution; see the help file for <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>.
  The formula for this test and the associated power is presented in
  standard statistics texts, including Zar (2010, pp. 534-537, 539-541).
  These equations can be inverted to solve for the sample size, given a specified power,
  significance level, hypothesized proportion, and true proportion.</p></dd>


  <dt><code>approx=FALSE</code>.</dt>
<dd><p>When <code>sample.type="one.sample"</code> and <code>approx=FALSE</code>,
  sample size is computed based on the exact binomial test; see the help file for <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>.
  The formula for this test and its associated power is presented in standard statistics texts,
  including Zar (2010, pp. 532-534, 539) and
  Millard and Neerchal (2001, pp. 385-386, 504-506).  The formula for the power involves
  five quantities: the hypothesized proportion (\(p_0\)), the true proportion (\(p\)),
  the significance level (\(alpha\)), the power, and the sample size (\(n\)).
  In this case the function <code>propTestN</code> uses a search algorithm to determine the
  required sample size to attain a specified power, given the values of the
  hypothesized and true proportions and the significance level.</p></dd>



</dl><p><strong>Two-Sample Case (<code>sample.type="two.sample"</code>)</strong>.</p>
<p>When <code>sample.type="two.sample"</code>, sample size is computed based on the test that uses the
  normal approximation to the binomial distribution;
  see the help file for <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>.
  The formula for this test and its associated power is presented in standard statistics texts,
  including Zar (2010, pp. 549-550, 552-553) and
  Millard and Neerchal (2001, pp. 443-445, 508-510).
  These equations can be inverted to solve for the sample size, given a specified power,
  significance level, true proportions, and ratio of sample size in group 2 to sample size in
  group 1.</p>
    </div>
    <div id="value">
    <h2>Value</h2>


<p><strong>Approximate Test (<code>approx=TRUE</code>)</strong>.</p>
<p>When <code>sample.type="one.sample"</code>, or <code>sample.type="two.sample"</code>
  and <code>ratio=1</code> (i.e., equal sample sizes for each group), <code>propTestN</code>
  returns a numeric vector of sample sizes.  When <br><code>sample.type="two.sample"</code> and at least one element of <code>ratio</code> is
  greater than 1, <code>propTestN</code> returns a list with two components called
  <code>n1</code> and <code>n2</code>, specifying the sample sizes for each group.</p>

<p><strong>Exact Test (<code>approx=FALSE</code>)</strong>.</p>
<p>If <code>return.exact.list=FALSE</code>, <code>propTestN</code> returns a numeric vector of sample sizes.</p>
<p>If <code>return.exact.list=TRUE</code>, <code>propTestN</code> returns a list with the following components:</p>
<p></p>
<dl><dt>n</dt>
<dd><p>numeric vector of sample sizes.</p></dd>

  <dt>power</dt>
<dd><p>numeric vector of powers.</p></dd>

  <dt>alpha</dt>
<dd><p>numeric vector containing the true significance levels.
    Because of the discrete nature of the binomial distribution, the true significance
    levels usually do not equal the significance level supplied by the user in the
    argument <code>alpha</code>.</p></dd>

  <dt>q.critical.lower</dt>
<dd><p>numeric vector of lower critical values for rejecting the null
    hypothesis.  If the observed number of "successes" is <em>less than or equal to</em> these values,
    the null hypothesis is rejected. (Not present if <code>alternative="greater"</code>.)</p></dd>

  <dt>q.critical.upper</dt>
<dd><p>numeric vector of upper critical values for rejecting the null
    hypothesis.  If the observed number of "successes" is <em>greater than</em> these values,
    the null hypothesis is rejected. (Not present if <code>alternative="less"</code>.)</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (1994). <em>Statistics for Environmental Engineers</em>.
  Lewis Publishers, Boca Raton, FL, Chapter 15.</p>
<p>Casagrande, J.T., M.C. Pike, and P.G. Smith. (1978).
  An Improved Approximation Formula for Calculating Sample Sizes for Comparing Two Binomial Distributions.
  <em>Biometrics</em> <b>34</b>, 483-486.</p>
<p>Fleiss, J. L. (1981). <em>Statistical Methods for Rates and Proportions</em>. Second Edition.
  John Wiley and Sons, New York, Chapters 1-2.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY.</p>
<p>Haseman, J.K. (1978). Exact Sample Sizes for Use with the Fisher-Irwin Test for 2x2 Tables.
  <em>Biometrics</em> <b>34</b>, 106-109.</p>
<p>Millard, S.P., and N. Neerchal. (2001). <em>Environmental Statistics with S-Plus</em>.
  CRC Press, Boca Raton, FL.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The binomial distribution is used to model processes with binary (Yes-No, Success-Failure,
  Heads-Tails, etc.) outcomes.  It is assumed that the outcome of any one trial is independent
  of any other trial, and that the probability of “success”, \(p\), is the same on each trial.
  A binomial discrete random variable \(X\) is the number of "successes" in \(n\) independent
  trials.  A special case of the binomial distribution occurs when \(n=1\), in which case \(X\)
  is also called a Bernoulli random variable.</p>
<p>In the context of environmental statistics, the binomial distribution is sometimes used to model the
  proportion of times a chemical concentration exceeds a set standard in a given period of time
  (e.g., Gilbert, 1987, p.143), or to compare the proportion of detects in a compliance well vs.
  a background well (e.g., USEPA, 1989b, Chapter 8, p.3-7).</p>
<p>In the course of designing a sampling program, an environmental scientist may wish to determine the
  relationship between sample size, power, significance level, and the difference between the
  hypothesized and true proportions if one of the objectives of the sampling program is to
  determine whether a proprtion differs from a specified level or two proportions differ from each other.
  The functions <code><a href="propTestPower.html">propTestPower</a></code>, <code>propTestN</code>, <code><a href="propTestMdd.html">propTestMdd</a></code>, and
  <code><a href="plotPropTestDesign.html">plotPropTestDesign</a></code> can be used to investigate these relationships for the case of
  binomial proportions.</p>
<p>Studying the two-sample proportion test, Haseman (1978) found that the formulas used to estimate the
  power that do not incorporate the continuity correction tend to underestimate the power.
  Casagrande, Pike, and Smith (1978) found that the formulas that do incorporate the continuity
  correction provide an excellent approximation.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="propTestPower.html">propTestPower</a></code>, <code><a href="propTestMdd.html">propTestMdd</a></code>, <code><a href="plotPropTestDesign.html">plotPropTestDesign</a></code>,
  <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>, <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at how the required sample size of the one-sample </span></span></span>
<span class="r-in"><span>  <span class="co"># proportion test with a two-sided alternative and Type I error</span></span></span>
<span class="r-in"><span>  <span class="co"># set to 5% increases with increasing power:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.6 0.7 0.8 0.9</span>
<span class="r-in"><span>  <span class="co">#[1] 0.5 0.6 0.7 0.8 0.9 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">propTestN</span><span class="op">(</span>p.or.p1 <span class="op">=</span> <span class="fl">0.7</span>, p0.or.p2 <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25 31 38 47 62</span>
<span class="r-in"><span>  <span class="co">#[1] 25 31 38 47 62</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the last example, but compute the sample size based on </span></span></span>
<span class="r-in"><span>  <span class="co"># the exact test instead of the approximation.  Note that because</span></span></span>
<span class="r-in"><span>  <span class="co"># we require the actual Type I error (alpha) to be within </span></span></span>
<span class="r-in"><span>  <span class="co"># 10% of the supplied value of alpha (which is 0.05 by default),</span></span></span>
<span class="r-in"><span>  <span class="co"># due to the discrete nature of the exact binomial test </span></span></span>
<span class="r-in"><span>  <span class="co"># we end up with more power then we specified.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n.list</span> <span class="op">&lt;-</span> <span class="fu">propTestN</span><span class="op">(</span>p.or.p1 <span class="op">=</span> <span class="fl">0.7</span>,  p0.or.p2 <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, approx <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">n.list</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 37 37 44 51 65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.698 0.698 0.778 0.836 0.910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.047 0.047 0.049 0.049 0.046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q.critical.lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12 12 15 18 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q.critical.upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24 24 28 32 40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$n</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 37 37 44 51 65</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$power</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.698 0.698 0.778 0.836 0.910</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$alpha</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.047 0.047 0.049 0.049 0.046</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$q.critical.lower</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 12 12 15 18 24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$q.critical.upper</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 24 24 28 32 40</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Using the example above, see how the sample size changes </span></span></span>
<span class="r-in"><span>  <span class="co"># if we allow the Type I error to deviate by more than 10 percent </span></span></span>
<span class="r-in"><span>  <span class="co"># of the value of alpha (i.e., by more than 0.005).  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n.list</span> <span class="op">&lt;-</span> <span class="fu">propTestN</span><span class="op">(</span>p.or.p1 <span class="op">=</span> <span class="fl">0.7</span>,  p0.or.p2 <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, approx <span class="op">=</span> <span class="cn">FALSE</span>, tol.alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">n.list</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25 35 42 49 65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.512 0.652 0.743 0.810 0.910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.043 0.041 0.044 0.044 0.046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q.critical.lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  7 11 14 17 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q.critical.upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 17 23 27 31 40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$n</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 25 35 42 49 65</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$power</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.512 0.652 0.743 0.810 0.910</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$alpha</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.043 0.041 0.044 0.044 0.046</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$q.critical.lower</span></span></span>
<span class="r-in"><span>  <span class="co">#[1]  7 11 14 17 24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$q.critical.upper</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 17 23 27 31 40</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">n.list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the required sample size for the two-sample </span></span></span>
<span class="r-in"><span>  <span class="co"># proportion test decreases with increasing difference between </span></span></span>
<span class="r-in"><span>  <span class="co"># the two population proportions:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4 0.3 0.2 0.1</span>
<span class="r-in"><span>  <span class="co">#[1] 0.4 0.3 0.2 0.1 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">propTestN</span><span class="op">(</span>p.or.p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    p0.or.p2 <span class="op">=</span> <span class="fl">0.5</span>, sample.type <span class="op">=</span> <span class="st">"two"</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The computed sample sizes 'n1' and 'n2' are too small, relative to the given values of 'p1' and 'p2', for the normal approximation to work well for the following element indices:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 	 4 </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 	</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 661 163  70  36</span>
<span class="r-in"><span>  <span class="co">#[1] 661 163 70 36 </span></span></span>
<span class="r-in"><span>  <span class="co">#Warning message:</span></span></span>
<span class="r-in"><span>  <span class="co">#In propTestN(p.or.p1 = seq(0.4, 0.1, by = -0.1), p0.or.p2 = 0.5,  :</span></span></span>
<span class="r-in"><span>  <span class="co">#  The computed sample sizes 'n1' and 'n2' are too small, </span></span></span>
<span class="r-in"><span>  <span class="co">#  relative to the given values of 'p1' and 'p2', for the normal </span></span></span>
<span class="r-in"><span>  <span class="co">#  approximation to work well for the following element indices:</span></span></span>
<span class="r-in"><span>  <span class="co">#         4 </span></span></span>
<span class="r-in"><span>   </span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the required sample size for the two-sample </span></span></span>
<span class="r-in"><span>  <span class="co"># proportion test decreases with increasing values of Type I error:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">propTestN</span><span class="op">(</span>p.or.p1 <span class="op">=</span> <span class="fl">0.7</span>, p0.or.p2 <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    sample.type <span class="op">=</span> <span class="st">"two"</span>, </span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 299 221 163 137</span>
<span class="r-in"><span>  <span class="co">#[1] 299 221 163 137</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Modifying the example on pages 8-5 to 8-7 of USEPA (1989b), </span></span></span>
<span class="r-in"><span>  <span class="co"># determine the required sample size to detect a difference in the </span></span></span>
<span class="r-in"><span>  <span class="co"># proportion of detects of cadmium between the background and </span></span></span>
<span class="r-in"><span>  <span class="co"># compliance wells. Set the complicance well to "group 1" and </span></span></span>
<span class="r-in"><span>  <span class="co"># the backgound well to "group 2".  Assume the true probability </span></span></span>
<span class="r-in"><span>  <span class="co"># of a "detect" at the background well is 1/3, set the probability </span></span></span>
<span class="r-in"><span>  <span class="co"># of a "detect" at the compliance well to 0.4 and 0.5, use a 5% </span></span></span>
<span class="r-in"><span>  <span class="co"># significance level and 95% power, and use the upper </span></span></span>
<span class="r-in"><span>  <span class="co"># one-sided alternative (probability of a "detect" at the compliance </span></span></span>
<span class="r-in"><span>  <span class="co"># well is greater than the probability of a "detect" at the background </span></span></span>
<span class="r-in"><span>  <span class="co"># well).  (The original data are stored in EPA.89b.cadmium.df.) </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the required sample size decreases from about </span></span></span>
<span class="r-in"><span>  <span class="co"># 1160 at each well to about 200 at each well as the difference in </span></span></span>
<span class="r-in"><span>  <span class="co"># proportions changes from (0.4 - 1/3) to (0.5 - 1/3), but both of </span></span></span>
<span class="r-in"><span>  <span class="co"># these sample sizes are enormous compared to the number of samples </span></span></span>
<span class="r-in"><span>  <span class="co"># usually collected in the field.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.89b.cadmium.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Cadmium.orig Cadmium Censored  Well.type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           0.1   0.100    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          0.12   0.120    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          0.26   0.260    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           0.1   0.100    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8         0.014   0.014    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         0.12   0.120    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         0.21   0.210    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         0.12   0.120    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         0.12   0.120    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         0.08   0.080    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28          0.2   0.200    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32        0.012   0.012    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         0.12   0.120    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         0.07   0.070    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         0.19   0.190    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         0.01   0.010    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         0.11   0.110    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         0.06   0.060    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         0.23   0.230    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         0.11   0.110    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58        0.031   0.031    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         0.12   0.120    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         0.08   0.080    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         0.26   0.260    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         0.02   0.020    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71        0.024   0.024    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78         0.04   0.040    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83         0.01   0.010    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88          BDL   0.000     TRUE Compliance</span>
<span class="r-in"><span>  <span class="co">#   Cadmium.orig Cadmium Censored  Well.type</span></span></span>
<span class="r-in"><span>  <span class="co">#1           0.1   0.100    FALSE Background</span></span></span>
<span class="r-in"><span>  <span class="co">#2          0.12   0.120    FALSE Background</span></span></span>
<span class="r-in"><span>  <span class="co">#3           BDL   0.000     TRUE Background</span></span></span>
<span class="r-in"><span>  <span class="co"># ..........................................</span></span></span>
<span class="r-in"><span>  <span class="co">#86          BDL   0.000     TRUE Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#87          BDL   0.000     TRUE Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#88          BDL   0.000     TRUE Compliance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.back</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.89b.cadmium.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Background"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.back</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3333333</span>
<span class="r-in"><span>  <span class="co">#[1] 0.3333333 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.89b.cadmium.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Compliance"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.comp</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.375</span>
<span class="r-in"><span>  <span class="co">#[1] 0.375 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n.back</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.89b.cadmium.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n.back</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-in"><span>  <span class="co">#[1] 24 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.89b.cadmium.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Compliance"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n.comp</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 64</span>
<span class="r-in"><span>  <span class="co">#[1] 64 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">propTestN</span><span class="op">(</span>p.or.p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.50</span><span class="op">)</span>, p0.or.p2 <span class="op">=</span> <span class="va">p.hat.back</span>, </span></span>
<span class="r-in"><span>    alt<span class="op">=</span><span class="st">"greater"</span>, sample.type<span class="op">=</span><span class="st">"two"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1159  199</span>
<span class="r-in"><span>  <span class="co">#[1] 1159 199</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">p.hat.back</span>, <span class="va">p.hat.comp</span>, <span class="va">n.back</span>, <span class="va">n.comp</span><span class="op">)</span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

