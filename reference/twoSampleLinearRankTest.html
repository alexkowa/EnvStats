<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Two-Sample Linear Rank Test to Detect a Difference Between Two Distributions — twoSampleLinearRankTest • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Two-Sample Linear Rank Test to Detect a Difference Between Two Distributions — twoSampleLinearRankTest"><meta property="og:description" content="Two-sample linear rank test to detect a difference (usually a shift) between two
  distributions.  The Wilcoxon Rank Sum test is a special case of
  a linear rank test.  The function
  twoSampleLinearRankTest is part of
  EnvStats mainly because this help file gives the necessary background to
  explain two-sample linear rank tests for censored data (see
  twoSampleLinearRankTestCensored)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Two-Sample Linear Rank Test to Detect a Difference Between Two Distributions</h1>

    <div class="hidden name"><code>twoSampleLinearRankTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Two-sample linear rank test to detect a difference (usually a shift) between two
  distributions.  The <a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">Wilcoxon Rank Sum test</a> is a special case of
  a linear rank test.  The function <br><code>twoSampleLinearRankTest</code> is part of
  <span class="pkg">EnvStats</span> mainly because this help file gives the necessary background to
  explain two-sample linear rank tests for censored data (see <br><code><a href="twoSampleLinearRankTestCensored.html">twoSampleLinearRankTestCensored</a></code>).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">twoSampleLinearRankTest</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, location.shift.null <span class="op">=</span> <span class="fl">0</span>, scale.shift.null <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, test <span class="op">=</span> <span class="st">"wilcoxon"</span>, shift.type <span class="op">=</span> <span class="st">"location"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of values for the first sample.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>,
  <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>numeric vector of values for the second sample.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>,
  <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-location-shift-null">location.shift.null<a class="anchor" aria-label="anchor" href="#arg-location-shift-null"></a></dt>
<dd><p>numeric scalar indicating the hypothesized value of \(\Delta\), the location
  shift between the two distributions, under the null hypothesis.  The default value is
  <code>location.shift.null=0</code>.  This argument is ignored if <code>shift.type="scale"</code>.</p></dd>

  <dt id="arg-scale-shift-null">scale.shift.null<a class="anchor" aria-label="anchor" href="#arg-scale-shift-null"></a></dt>
<dd><p>numeric scalar indicating the hypothesized value of \(\tau\), the scale shift
  between the two distributions, under the null hypothesis.  The default value is <br><code>scale.shift.null=1</code>.  This argument is ignored if <code>shift.type="location"</code>.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values
  are <code>"two.sided"</code> (the default), <code>"less"</code>, and <code>"greater"</code>.  See the
  DETAILS section below for more information.</p></dd>

  <dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>character string indicating which linear rank test to use.  The possible values are:
  <code>"wilcoxon"</code> (the default), <code>"normal.scores"</code>, <code>"moods.median"</code>, and
  <code>"savage.scores"</code>.</p></dd>

  <dt id="arg-shift-type">shift.type<a class="anchor" aria-label="anchor" href="#arg-shift-type"></a></dt>
<dd><p>character string indicating which kind of shift is being tested.  The possible values
  are <code>"location"</code> (the default) and <code>"scale"</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>twoSampleLinearRankTest</code> allows you to compare two samples using
  a locally most powerful rank test (LMPRT) to determine whether the two samples come
  from the same distribution.  The sections below explain the concepts of location and
  scale shifts, linear rank tests, and LMPRT's.
  <br></p>
<p><b>Definitions of Location and Scale Shifts</b> <br>
  Let \(X\) denote a random variable representing measurements from group 1 with
  cumulative distribution function (cdf):
  $$F_1(t) = Pr(X \le t) \;\;\;\;\;\; (1)$$
  and let \(x_1, x_2, \ldots, x_m\) denote \(m\) independent observations from this
  distribution.  Let \(Y\) denote a random variable from group 2 with cdf:
  $$F_2(t) = Pr(Y \le t) \;\;\;\;\;\; (2)$$
  and let \(y_1, y_2, \ldots, y_n\) denote \(n\) independent observations from this
  distribution.  Set \(N = m + n\).
  <br></p>
<p><em>General Hypotheses to Test Differences Between Two Populations</em> <br>
  A very general hypothesis to test whether two distributions are the same is
  given by:
  $$H_0: F_1(t) = F_2(t), -\infty &lt; t &lt; \infty \;\;\;\;\;\; (3)$$
  versus the two-sided alternative hypothesis:
  $$H_a: F_1(t) \ne F_2(t) \;\;\;\;\;\; (4)$$
  with strict inequality for at least one value of \(t\).
  The two possible one-sided hypotheses would be:
  $$H_0: F_1(t) \ge F_2(t) \;\;\;\;\;\; (5)$$
  versus the alternative hypothesis:
  $$H_a: F_1(t) &lt; F_2(t) \;\;\;\;\;\; (6)$$
  and
  $$H_0: F_1(t) \le F_2(t) \;\;\;\;\;\; (7)$$
  versus the alternative hypothesis:
  $$H_a: F_1(t) &gt; F_2(t) \;\;\;\;\;\; (8)$$</p>
<p>A similar set of hypotheses to test whether the two distributions are the same are
  given by (Conover, 1980, p. 216):
  $$H_0: Pr(X &lt; Y) = 1/2 \;\;\;\;\;\; (9)$$
  versus the two-sided alternative hypothesis:
  $$H_a: Pr(X &lt; Y) \ne 1/2 \;\;\;\;\;\; (10)$$
  or
  $$H_0: Pr(X &lt; Y) \ge 1/2 \;\;\;\;\;\; (11)$$
  versus the alternative hypothesis:
  $$H_a: Pr(X &lt; Y) &lt; 1/2 \;\;\;\;\;\; (12)$$
  or
  $$H_0: Pr(X &lt; Y) \le 1/2 \;\;\;\;\;\; (13)$$
  versus the alternative hypothesis:
  $$H_a: Pr(X &lt; Y) &gt; 1/2 \;\;\;\;\;\; (14)$$</p>
<p>Note that this second set of hypotheses (9)–(14) is <b>not</b> equivalent to the
  set of hypotheses (3)–(8).  For example, if \(X\) takes on the values 1 and 4
  with probability 1/2 for each, and \(Y\) only takes on values in the interval
  (1, 4) with strict inequality at the enpoints (e.g., \(Y\) takes on the values
  2 and 3 with probability 1/2 for each), then the null hypothesis (9) is
  true but the null hypothesis (3) is not true.  However, the null hypothesis (3)
  implies the null hypothesis (9), (5) implies (11), and (7) implies (13).
  <br></p>
<p><em>Location Shift</em> <br>
  A special case of the alternative hypotheses (4), (6), and (8) above is the
  <b><em>location shift</em></b> alternative:
  $$H_a: F_1(t) = F_2(t - \Delta) \;\;\;\;\;\; (15)$$
  where \(\Delta\) denotes the shift between the two groups.  (Note: some references
  refer to (15) above as a shift in the median, but in fact this kind of shift
  represents a shift in every single quantile, not just the median.)
  If \(\Delta\) is positive, this means that observations in group 1 tend to be
  larger than observations in group 2, and if \(\Delta\) is negative, observations
  in group 1 tend to be smaller than observations in group 2.</p>
<p>The alternative hypothesis (15) is called a <b><em>location shift</em></b>: the only
  difference between the two distributions is a difference in location (e.g., the
  standard deviation is assumed to be the same for both distributions).  A location
  shift is not applicable to distributions that are bounded below or above by some
  constant, such as a lognormal distribution.  For lognormal distributions, the
  location shift could refer to a shift in location of the distribution of the
  log-transformed observations.</p>
<p>For a location shift, the null hypotheses (3) can be generalized as:
  $$H_0: F_1(t) = F_2(t - \Delta_0), -\infty &lt; t &lt; \infty \;\;\;\;\;\; (16)$$
  where \(\Delta_0\) denotes the null shift between the two groups.  Almost always,
  however, the null shift is taken to be 0 and we will assume this for the rest of this
  help file.</p>
<p>Alternatively, the null and alternative hypotheses can be written as
  $$H_0: \Delta = 0 \;\;\;\;\;\; (17)$$
  versus the alternative hypothesis
  $$H_a: \Delta &gt; 0 \;\;\;\;\;\; (18)$$
  The other one-sided alternative hypothesis (\(\Delta &lt; 0\)) and two-sided
  alternative hypothesis (\(\Delta \ne 0\)) could be considered as well.</p>
<p>The general hypotheses (3)-(14) are <em>not</em> location shift hypotheses
  (e.g., the standard deviation does not have to be the same for both distributions),
  but they do allow for distributions that are bounded below or above by a constant
  (e.g., lognormal distributions).
  <br></p>
<p><em>Scale Shift</em> <br>
  A special kind of scale shift replaces the alternative hypothesis (15) with the
  alternative hypothesis:
  $$H_a: F_1(t) = F_2(t/\tau) \;\;\;\;\;\; (19)$$
  where \(\tau\) denotes the shift in scale between the two groups.  Alternatively,
  the null and alternative hypotheses for this scale shift can be written as
  $$H_0: \tau = 1 \;\;\;\;\;\; (20)$$
  versus the alternative hypothesis
  $$H_a: \tau &gt; 1 \;\;\;\;\;\; (21)$$
  The other one-sided alternative hypothesis (\(t &lt; 1\)) and two-sided alternative
  hypothesis (\(t \ne 1\)) could be considered as well.</p>
<p>This kind of scale shift often involves a shift in both location and scale.  For
  example, suppose the underlying distribution for both groups is
  <a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">exponential</a>, with parameter <code>rate=</code>\(\lambda\).  Then
  the mean and standard deviation of the reference group is \(1/\lambda\), while
  the mean and standard deviation of the treatment group is \(\tau/\lambda\).  In
  this case, the alternative hypothesis (21) implies the more general alternative
  hypothesis (8).
  <br></p>
<p><b>Linear Rank Tests</b> <br>
  The usual nonparametric test to test the null hypothesis of the same distribution
  for both groups versus the location-shift alternative (18) is the
  <a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">Wilcoxon Rank Sum test</a>
  (Gilbert, 1987, pp.247-250; Helsel and Hirsch, 1992, pp.118-123;
  Hollander and Wolfe, 1999).  Note that the Mann-Whitney U test is equivalent to the
  Wilcoxon Rank Sum test (Hollander and Wolfe, 1999; Conover, 1980, p.215,
  Zar, 2010).  Hereafter, this test will be abbreviated as the MWW test.  The MWW test
  is performed by combining the \(m\) \(X\) observations with the \(n\) \(Y\)
  observations and ranking them from smallest to largest, and then computing the
  statistic
  $$W = \sum_{i=1}^m R_i \;\;\;\;\;\; (22)$$
  where \(R_1, R_2, \ldots, R_m\) denote the ranks of the \(X\) observations when
  the \(X\) and \(Y\) observations are combined ranked.  The null
  hypothesis (5), (11), or (17) is rejected in favor of the alternative hypothesis
  (6), (12)  or (18) if the value of \(W\) is too large.  For small sample sizes,
  the exact distribution of \(W\) under the null hypothesis is fairly easy to
  compute and may be found in tables (e.g., Hollander and Wolfe, 1999;
  Conover, 1980, pp.448-452).  For larger sample sizes, a normal approximation is
  usually used (Hollander and Wolfe, 1999; Conover, 1980, p.217).  For the
  <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code>, an exact p-value is computed if the
  samples contain less than 50 finite values and there are no ties.</p>
<p><b>It is important to note that the MWW test is actually testing the more general
  hypotheses (9)-(14) (Conover, 1980, p.216; Divine et al., 2013), even though it
  is often presented as only applying to location shifts.</b></p>
<p>The MWW W-statistic in Equation (22) is an example of a
  <b><em>linear rank statistic</em></b> (Hettmansperger, 1984, p.147; Prentice, 1985),
  which is any statistic that can be written in the form:
  $$L = \sum_{i=1}^m a(R_i) \;\;\;\;\;\; (23)$$
  where \(a()\) denotes a score function.  Statistics of this form are also called
  <b><em>general scores statistics</em></b> (Hettmansperger, 1984, p.147).  The MWW test
  uses the identity score function:
  $$a(R_i) = R_i \;\;\;\;\;\; (24)$$
  Any test based on a linear rank statistic is called a <b><em>linear rank test</em></b>.
  Under the null hypothesis (3), (9), (17), or (20), the distribution of the linear
  rank statistic \(L\) does not depend on the form of the underlying distribution of
  the \(X\) and \(Y\) observations.  Hence, tests based on \(L\) are
  nonparametric (also called distribution-free).  If the null hypothesis is not true,
  however, the distribution of \(L\) will depend not only on the distributions of the
  \(X\) and \(Y\) observations, but also upon the form the score function
  \(a()\).
  <br></p>
<p><b>Locally Most Powerful Linear Rank Tests</b> <br>
  The decision of what scores to use may be based on considering the power of the test.
  A locally most powerful rank test (LMPRT) of the null hypothesis (17) versus the
  alternative (18) maximizes the slope of the power (as a function of \(\Delta\)) in
  the neighborhood where \(\Delta=0\).  A LMPRT of the null hypothesis (20) versus
  the alternative (21) maximizes the slope of the power (as a function of \(\tau\))
  in the neighborhood where \(\tau=1\).  That is, LMPRT's are the best linear rank
  test you can use for detecting small shifts in location or scale.</p>
<p>Table 1 below shows the score functions associated with the LMPRT's for various
  assumed underlying distributions (Hettmansperger, 1984, Chapter 3;
  Millard and Deverel, 1988, p.2090).  A test based on the identity score function of
  Equation (24) is equivalent to a test based on the score shown in Table 1 associated
  with the logistic distribution, thus the MWW test is the LMPRT for detecting a
  location shift when the underlying observations follow the logistic distribution.
  When the underlying distribution is normal or lognormal, the LMPRT for a location
  shift uses the “Normal scores” shown in Table 1.  When the underlying
  distribution is exponential, the LMPRT for detecting a scale shift is based on the
  “Savage scores” shown in Table 1.</p>
<p><em>Table 1.  Scores of LMPRT's for Various Distributions</em><br></p><table class="table table"><tr><td><b>Distribution</b></td><td><b>Score</b> \(a(R_i)\)</td><td><b>Shift Type</b></td><td><b>Test Name</b></td></tr><tr><td>Logistic</td><td>\([2/(N+1)]R_i - 1\)</td><td>Location</td><td>Wilcoxon Rank Sum</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>Normal or</td><td>\(\Phi^{-1}[R_i/(N+1)]\)*</td><td>Location</td><td>Van der Waerden or</td></tr><tr><td>Lognormal (log-scale)</td><td></td><td></td><td>Normal scores</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>Double Exponential</td><td>\(sign[R_i - (N+1)/2]\)</td><td>Location</td><td>Mood's Median</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>Exponential or</td><td>\(\sum_{j=1}^{R_i} (N-j+1)^{-1}\)</td><td>Scale</td><td>Savage scores</td></tr><tr><td>Extreme Value</td><td></td><td></td><td></td></tr></table><p>* Denotes an approximation to the true score.  The symbol \(\Phi\) denotes the
  cumulative distribution function of the standard normal distribution, and \(sign\)
  denotes the <code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></code> function.</p>
<p>A large sample normal approximation to the distribution of the linear rank statistic
  \(L\) for arbitrary score functions is given by Hettmansperger (1984, p.148).
  Under the null hypothesis (17) or (20), the mean and variance of \(L\) are given by:
  $$E(L) = \mu_L = \frac{m}{N} \sum_{i=1}^N a_i = m \bar{a} \;\;\;\;\;\; (24)$$
  $$Var(L) = \sigma_L^2 = \frac{mn}{N(N-1)} \sum_{i=1}^N (a_i - \bar{a})^2 \;\;\;\;\;\; (25)$$
  Hettmansperger (1984, Chapter 3) shows that under the null hypothesis of no
  difference between the two groups, the statistic
  $$z = \frac{L - \mu_L}{\sigma_L} \;\;\;\;\;\; (26)$$
  is approximately distributed as a standard normal random variable for
  “large” sample sizes.  This statistic will tend to be large if the
  observations in group 1 tend to be larger than the observations in group 2.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"htest"</code> containing the results of the hypothesis test.
  See the help file for <code><a href="htest.object.html">htest.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Conover, W.J. (1980).  <em>Practical Nonparametric Statistics</em>.  Second Edition.
  John Wiley and Sons, New York, Chapter 4.</p>
<p>Divine, G., H.J. Norton, R. Hunt, and J. Dinemann. (2013).  A Review of Analysis
  and Sample Size Calculation Considerations for Wilcoxon Tests.  <em>Anesthesia
  &amp; Analgesia</em> <b>117</b>, 699–710.</p>
<p>Hettmansperger, T.P. (1984).  <em>Statistical Inference Based on Ranks</em>.
  John Wiley and Sons, New York, 323pp.</p>
<p>Hollander, M., and D.A. Wolfe. (1999). <em>Nonparametric Statistical Methods,
  Second Edition</em>.  John Wiley and Sons, New York.</p>
<p>Millard, S.P., and S.J. Deverel. (1988).  Nonparametric Statistical Methods for
  Comparing Two Sites Based on Data With Multiple Nondetect Limits.
  <em>Water Resources Research</em>, <b>24</b>(12), 2087–2098.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001).  <em>Environmental Statistics with
  S-PLUS</em>.  CRC Press, Boca Raton, FL, pp.432–435.</p>
<p>Prentice, R.L. (1985).  Linear Rank Tests.  In Kotz, S., and N.L. Johnson, eds.
  <em>Encyclopedia of Statistical Science</em>.  John Wiley and Sons, New York.
  Volume 5, pp.51–58.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The <a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">Wilcoxon Rank Sum test</a>, also known as the Mann-Whitney U
  test, is the standard nonparametric test used to test for differences between two
  groups (e.g., Zar, 2010; USEPA, 2009, pp.16-14 to 16-20).  Other possible
  nonparametric tests include linear rank tests based on scores other than the ranks,
  including the “normal scores” test and the “Savage scores” tests.
  The normal scores test is actually slightly more powerful than the Wilcoxon Rank Sum
  test for detecting small shifts in location if the underlying distribution is normal
  or lognormal.  In general, however, there will be little difference between these
  two tests.</p>
<p>The results of calling the function <code>twoSampleLinearRankTest</code> with the
  argument <code>test="wilcoxon"</code> will match those of calling the built-in
  <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code> with the arguments <code>exact=FALSE</code> and
  <code>correct=FALSE</code>.  In general, it is better to use the built-in function
  <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code> for performing the Wilcoxon Rank Sum test, since this
  function can compute exact (rather than approximate) p-values.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code>, <code><a href="twoSampleLinearRankTestCensored.html">twoSampleLinearRankTestCensored</a></code>,
  <code><a href="htest.object.html">htest.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 15 observations from a normal distribution with parameters</span></span></span>
<span class="r-in"><span>  <span class="co"># mean=3 and sd=1.  Call these the observations from the reference group.</span></span></span>
<span class="r-in"><span>  <span class="co"># Generate 10 observations from a normal distribution with parameters</span></span></span>
<span class="r-in"><span>  <span class="co"># mean=3.5 and sd=1.  Call these the observations from the treatment group.</span></span></span>
<span class="r-in"><span>  <span class="co"># Compare the results of calling wilcox.test to those of calling</span></span></span>
<span class="r-in"><span>  <span class="co"># twoSampleLinearRankTest with test="normal.scores".</span></span></span>
<span class="r-in"><span>  <span class="co"># (The call to set.seed allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">346</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Wilcoxon rank sum exact test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  x and y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> W = 32, p-value = 0.01628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true location shift is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 location shift = 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True location shift is not equal to 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Wilcoxon rank sum test</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x and y</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  W = 32</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.0162759</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">twoSampleLinearRankTest</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, test <span class="op">=</span> <span class="st">"normal.scores"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Hypothesis Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Hypothesis:                 Fy(t) = Fx(t)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative Hypothesis:          Fy(t) != Fx(t) for at least one t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Name:                       Two-Sample Linear Rank Test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  Normal Scores Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  Based on Normal Approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            x = x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  y = y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:                    nx = 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  ny = 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Statistic:                  z = -2.431099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-value:                         0.01505308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 Fy(t) = Fx(t)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          Fy(t) != Fx(t) for at least one t</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Two-Sample Linear Rank Test:</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Normal Scores Test</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Based on Normal Approximation</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x = x</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 y = y</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Sizes:                    nx = 15</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 ny = 10</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  z = -2.431099</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.01505308</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Following Example 6.6 on pages 6.22-6.26 of USEPA (1994b), perform the</span></span></span>
<span class="r-in"><span>  <span class="co"># Wilcoxon Rank Sum test for the TcCB data (stored in EPA.94b.tccb.df).</span></span></span>
<span class="r-in"><span>  <span class="co"># There are m=47 observations from the reference area and n=77 observations</span></span></span>
<span class="r-in"><span>  <span class="co"># from the cleanup unit.  Then compare the results using the other available</span></span></span>
<span class="r-in"><span>  <span class="co"># linear rank tests.  Note that Mood's median test yields a p-value less</span></span></span>
<span class="r-in"><span>  <span class="co"># than 0.10, while the other tests yield non-significant p-values.</span></span></span>
<span class="r-in"><span>  <span class="co"># In this case, Mood's median test is picking up the residual contamination</span></span></span>
<span class="r-in"><span>  <span class="co"># in the cleanup unit. (See the example in the help file for quantileTest.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TcCB.orig" "TcCB"      "Censored"  "Area"     </span>
<span class="r-in"><span>  <span class="co">#[1] "TcCB.orig" "TcCB"      "Censored"  "Area"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span><span class="op">$</span><span class="va">Area</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Cleanup Reference </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        77        47 </span>
<span class="r-in"><span>  <span class="co">#  Cleanup Reference</span></span></span>
<span class="r-in"><span>  <span class="co">#       77        47</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">twoSampleLinearRankTest</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Cleanup"</span><span class="op">]</span>, <span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Reference"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Hypothesis Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Hypothesis:                 Fy(t) = Fx(t)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative Hypothesis:          Fy(t) != Fx(t) for at least one t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Name:                       Two-Sample Linear Rank Test:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  Wilcoxon Rank Sum Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  Based on Normal Approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            x = TcCB[Area == "Cleanup"]  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  y = TcCB[Area == "Reference"]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:                    nx = 77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  ny = 47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Statistic:                  z = -1.171872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-value:                         0.2412485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 Fy(t) = Fx(t)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          Fy(t) != Fx(t) for at least one t</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Two-Sample Linear Rank Test:</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Wilcoxon Rank Sum Test</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Based on Normal Approximation</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x = TcCB[Area == "Cleanup"]</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 y = TcCB[Area == "Reference"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Sizes:                    nx = 77</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 ny = 47</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  z = -1.171872</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.2412485</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">twoSampleLinearRankTest</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Cleanup"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      <span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Reference"</span><span class="op">]</span>, test<span class="op">=</span><span class="st">"normal.scores"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3399484</span>
<span class="r-in"><span>  <span class="co">#[1] 0.3399484</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">twoSampleLinearRankTest</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Cleanup"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      <span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Reference"</span><span class="op">]</span>, test<span class="op">=</span><span class="st">"moods.median"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09707393</span>
<span class="r-in"><span>  <span class="co">#[1] 0.09707393</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">twoSampleLinearRankTest</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Cleanup"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      <span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span><span class="op">==</span><span class="st">"Reference"</span><span class="op">]</span>, test<span class="op">=</span><span class="st">"savage.scores"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2884351</span>
<span class="r-in"><span>  <span class="co">#[1] 0.2884351</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

