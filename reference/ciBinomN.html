<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sample Size for Specified Half-Width of Confidence Interval for Binomial Proportion or Difference Between Two Proportions — ciBinomN • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size for Specified Half-Width of Confidence Interval for Binomial Proportion or Difference Between Two Proportions — ciBinomN"><meta property="og:description" content="Compute the sample size necessary to achieve a specified half-width of a 
  confidence interval for a binomial proportion or the difference between 
  two proportions, given the estimated proportion(s), and confidence level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample Size for Specified Half-Width of Confidence Interval for Binomial Proportion or Difference Between Two Proportions</h1>
    
    <div class="hidden name"><code>ciBinomN.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the sample size necessary to achieve a specified half-width of a 
  confidence interval for a binomial proportion or the difference between 
  two proportions, given the estimated proportion(s), and confidence level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ciBinomN</span><span class="op">(</span><span class="va">half.width</span>, p.hat.or.p1.hat <span class="op">=</span> <span class="fl">0.5</span>, p2.hat <span class="op">=</span> <span class="fl">0.4</span>, 
    conf.level <span class="op">=</span> <span class="fl">0.95</span>, sample.type <span class="op">=</span> <span class="st">"one.sample"</span>, ratio <span class="op">=</span> <span class="fl">1</span>, 
    ci.method <span class="op">=</span> <span class="st">"score"</span>, correct <span class="op">=</span> <span class="cn">TRUE</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, 
    n.or.n1.min <span class="op">=</span> <span class="fl">2</span>, n.or.n1.max <span class="op">=</span> <span class="fl">10000</span>, 
    tol.half.width <span class="op">=</span> <span class="fl">5e-04</span>, tol.p.hat <span class="op">=</span> <span class="fl">5e-04</span>, 
    tol <span class="op">=</span> <span class="fl">1e-7</span>, maxiter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>half.width</dt>
<dd><p>numeric vector of (positive) half-widths.  
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>
<dt>p.hat.or.p1.hat</dt>
<dd><p>numeric vector of estimated proportions.  <br>
  When <code>sample.type="one.sample"</code>, <code>p.hat.or.p1.hat</code> denotes the 
  estimated value of \(p\), the probability of “success”. <br> 
  When <code>sample.type="two.sample"</code>, <code>p.hat.or.p1.hat</code> denotes the estimated value of 
  \(p_1\), the probability of “success” in group 1.  <br>
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>
<dt>p2.hat</dt>
<dd><p>numeric vector of estimated proportions for group 2. 
  This argument is ignored when <code>sample.type="one.sample"</code>.  
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>
<dt>conf.level</dt>
<dd><p>numeric vector of numbers between 0 and 1 indicating the confidence level associated with 
  the confidence interval(s).  The default value is <code>conf.level=0.95</code>.</p></dd>
<dt>sample.type</dt>
<dd><p>character string indicating whether this is a one-sample or two-sample confidence interval. <br>
  When <code>sample.type="one.sample"</code>, the computed half-width is based on a confidence interval 
  for a single proportion.  <br>
  When <code>sample.type="two.sample"</code>, the computed half-width is based 
  on a confidence interval for the difference between two proportions. <br>
  The default value is <code>sample.type="one.sample"</code> unless the 
  argument <code>p2.hat</code> or <code>ratio</code> is supplied.</p></dd>
<dt>ratio</dt>
<dd><p>numeric vector indicating the ratio of sample size in group 2 to 
  sample size in group 1 (\(n_2/n_1\)). The default value is <code>ratio=1</code>.  
  All values of <code>ratio</code> must be greater than or equal to 1.  
  This argument is ignored if <br><code>sample.type="one.sample"</code>.</p></dd>
<dt>ci.method</dt>
<dd><p>character string indicating which method to use to construct the 
  confidence interval.  Possible values are:</p><ul><li><p><code>"score"</code> (the default),</p></li>
<li><p><code>"exact"</code>,</p></li>
<li><p><code>"adjusted Wald"</code> and,</p></li>
<li><p><code>"Wald"</code> (the <code>"Wald"</code> method is <strong>never</strong> recommended but 
      is included for historical purposes).</p></li>
</ul><p>The exact method is only available for the one-sample case, i.e., when <br><code>sample.type="one.sample"</code>.</p></dd>
<dt>correct</dt>
<dd><p>logical scalar indicating whether to use the continuity correction when <br><code>ci.method="score"</code> or <code>ci.method="Wald"</code>.  
  The default value is <br><code>correct=TRUE</code>.</p></dd>
<dt>warn</dt>
<dd><p>logical scalar indicating whether to issue a warning when <code>ci.method="Wald"</code> 
  for cases when the normal approximation to the binomial distribution probably is not accurate.  
  The default value is <code>warn=TRUE</code>.</p></dd>
<dt>n.or.n1.min</dt>
<dd><p>integer indicating the minimum allowed value for <br> 
  \(n\) (<code>sample.type="one.sample"</code>) or <br> 
  \(n_1\) (<code>sample.type="two.sample"</code>).  <br>
  The default value is <code>n.or.n1.min=2</code>.</p></dd>
<dt>n.or.n1.max</dt>
<dd><p>integer indicating the maximum allowed value for <br>
  \(n\) (<code>sample.type="one.sample"</code>) or <br>
  \(n_1\) (<code>sample.type="two.sample"</code>).  <br>
  The default value is <code>n.or.n1.max=10000</code>.</p></dd>
<dt>tol.half.width</dt>
<dd><p>numeric scalar indicating the tolerance to use for the half width for
  the search algorithm.  The sample sizes are computed so that the actual 
  half width is less than or equal to <code>half.width + tol.half.width</code>.  
  The default value is <code>tol.half.width=5e-04</code>.</p></dd>
<dt>tol.p.hat</dt>
<dd><p>numeric scalar indicating the tolerance to use for the estimated 
  proportion(s) for the search algorithm.  
  For the one-sample case, the sample sizes are computed so that 
  the absolute value of the difference between the user supplied 
  value of <code>p.hat.or.p1.hat</code> and the actual estimated proportion is 
  less than or equal to <code>tol.p.hat</code>.  
  For the two-sample case, the sample sizes are computed so that 
  the absolute value of the difference between the user supplied 
  value of <code>p.hat.or.p1.hat</code> and the actual estimated proportion 
  for group 1 is less than or equal to <code>tol.p.hat</code>, and the 
  absolute value of the difference between the user supplied 
  value of <code>p2.hat</code> and the actual estimated proportion 
  for group 2 is less than or equal to <code>tol.p.hat</code>.  
  The default value is <code>tol.p.hat=0.005</code>.</p></dd>
<dt>tol</dt>
<dd><p>positive scalar indicating the tolerance to use for the search algorithm 
  (passed to <code>uniroot</code>).  The default value is <code>tol=1e-7</code>.</p></dd>
<dt>maxiter</dt>
<dd><p>integer indicating the maximum number of iterations to use for 
  the search algorithm (passed to <code>uniroot</code>).  
  The default value is <code>maxiter=1000</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the arguments <code>half.width</code>, <code>p.hat.or.p1.hat</code>, <code>p2.hat</code>, 
  <code>conf.level</code> and <code>ratio</code> are not all the same length, they are 
  replicated to be the same length as the length of the longest argument.</p>
<p>For the one-sample case, the arguments <code>p.hat.or.p1.hat</code>, <code>tol.p.hat</code>, 
  <code>half.width</code>, and <br><code>tol.half.width</code> must satisfy: <br><code>(p.hat.or.p1.hat + tol.p.hat + half.width + tol.half.width) &lt;= 1</code>, <br>
  and <br><code>(p.hat.or.p1.hat - tol.p.hat - half.width - tol.half.width) &gt;= 0</code>.</p>
<p>For the two-sample case, the arguments <code>p.hat.or.p1.hat</code>, <code>p2.hat</code>, 
  <code>tol.p.hat</code>, <br><code>half.width</code>, and <code>tol.half.width</code> must satisfy:  <br><code>((p.hat.or.p1.hat + tol.p.hat) - (p2.hat - tol.p.hat) + half.width + tol.half.width) &lt;= 1</code>, and <br><code>((p.hat.or.p1.hat - tol.p.hat) - (p2.hat + tol.p.hat) - half.width - tol.half.width) &gt;= -1</code>.</p>
<p>The function <code>ciBinomN</code> uses the search algorithm in the 
  function <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> to call the function 
  <code><a href="ciBinomHalfWidth.html">ciBinomHalfWidth</a></code> to find the values of 
  \(n\) (<code>sample.type="one.sample"</code>) or
  \(n_1\) and \(n_2\) <br>
  (<code>sample.type="two.sample"</code>) that satisfy the requirements for the half-width, 
  estimated proportions, and confidence level.  See the Details section of the help file for 
  <code><a href="ciBinomHalfWidth.html">ciBinomHalfWidth</a></code> for more information.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list with information about the sample sizes, estimated proportions, 
  and half-widths.  
<strong>One-Sample Case (<code>sample.type="one.sample"</code>)</strong>. <br>  When <code>sample.type="one.sample"</code>, the function <code>ciBinomN</code>  returns a list with these components:</p>
<dl><dt>n</dt>
<dd><p>the sample size(s) associated with the confidence interval(s)</p></dd>
<dt>p.hat</dt>
<dd><p>the estimated proportion(s)</p></dd>
<dt>half.width</dt>
<dd><p>the half-width(s) of the confidence interval(s)</p></dd>
<dt>method</dt>
<dd><p>the method used to construct the confidence interval(s)</p></dd>
</dl><p><strong>Two-Sample Case (<code>sample.type="two.sample"</code>)</strong>.  <br>  When <code>sample.type="two.sample"</code>, the function <code>ciBinomN</code>  returns a list with these components:</p>
<dl><dt>n1</dt>
<dd><p>the sample size(s) for group 1 associated with the confidence interval(s)</p></dd>
<dt>n2</dt>
<dd><p>the sample size(s) for group 2 associated with the confidence interval(s)</p></dd>
<dt>p1.hat</dt>
<dd><p>the estimated proportion(s) for group 1</p></dd>
<dt>p2.hat</dt>
<dd><p>the estimated proportion(s) for group 2</p></dd>
<dt>half.width</dt>
<dd><p>the half-width(s) of the confidence interval(s)</p></dd>
<dt>method</dt>
<dd><p>the method used to construct the confidence interval(s)</p></dd>
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Agresti, A., and B.A. Coull. (1998). Approximate is Better than "Exact" for Interval Estimation 
  of Binomial Proportions. <em>The American Statistician</em>, <b>52</b>(2), 119--126.</p>
<p>Agresti, A., and B. Caffo. (2000). Simple and Effective Confidence Intervals for Proportions 
  and Differences of Proportions Result from Adding Two Successes and Two Failures. <em>The 
  American Statistician</em>, <b>54</b>(4), 280--288.</p>
<p>Berthouex, P.M., and L.C. Brown. (1994). <em>Statistics for Environmental Engineers</em>. 
  Lewis Publishers, Boca Raton, FL, Chapters 2 and 15.</p>
<p>Cochran, W.G. (1977). <em>Sampling Techniques</em>. John Wiley and Sons, New York, Chapter 3.</p>
<p>Fisher, R.A., and F. Yates. (1963). 
  <em>Statistical Tables for Biological, Agricultural, and Medical Research</em>. 6th edition. 
  Hafner, New York, 146pp.</p>
<p>Fleiss, J. L. (1981). <em>Statistical Methods for Rates and Proportions</em>. Second Edition. 
  John Wiley and Sons, New York, Chapters 1-2.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>. 
  Van Nostrand Reinhold, New York, NY, Chapter 11.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>. 
  CRC Press, Boca Raton, Florida.</p>
<p>Newcombe, R.G. (1998a). Two-Sided Confidence Intervals for the Single Proportion:  Comparison of 
  Seven Methods. <em>Statistics in Medicine</em>, <b>17</b>, 857--872.</p>
<p>Newcombe, R.G. (1998b). Interval Estimation for the Difference Between Independent Proportions:  
  Comparison of Eleven Methods. <em>Statistics in Medicine</em>, <b>17</b>, 873--890.</p>
<p>Ott, W.R. (1995). <em>Environmental Statistics and Data Analysis</em>. 
  Lewis Publishers, Boca Raton, FL, Chapter 4.</p>
<p>USEPA. (1989b). <em>Statistical Analysis of Ground-Water Monitoring Data at RCRA Facilities, Interim Final Guidance</em>. 
  EPA/530-SW-89-026. Office of Solid Waste, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
  U.S. Environmental Protection Agency, Washington, D.C. p.6-38.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition. 
  Prentice-Hall, Upper Saddle River, NJ, Chapter 24.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The binomial distribution is used to model processes with binary 
  (Yes-No, Success-Failure, Heads-Tails, etc.) outcomes.  It is assumed that the outcome of any 
  one trial is independent of any other trial, and that the probability of “success”, \(p\), 
  is the same on each trial.  A binomial discrete random variable \(X\) is the number of 
  “successes” in \(n\) independent trials.  A special case of the binomial distribution 
  occurs when \(n=1\), in which case \(X\) is also called a Bernoulli random variable.</p>
<p>In the context of environmental statistics, the binomial distribution is sometimes used to model 
  the proportion of times a chemical concentration exceeds a set standard in a given period of time 
  (e.g., Gilbert, 1987, p.143), or to compare the proportion of detects in a compliance well vs. a 
  background well (e.g., USEPA, 1989b, Chapter 8, p.3-7).  (However, USEPA 2009, p.8-27 
  recommends using the Wilcoxon rank sum test (<code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code>) instead of 
  comparing proportions.)</p>
<p>In the course of designing a sampling program, an environmental scientist may wish to determine 
  the relationship between sample size, confidence level, and half-width if one of the objectives of 
  the sampling program is to produce confidence intervals.  The functions <code><a href="ciBinomHalfWidth.html">ciBinomHalfWidth</a></code>, 
  <code>ciBinomN</code>, and <code><a href="plotCiBinomDesign.html">plotCiBinomDesign</a></code> can be used to investigate these 
  relationships for the case of binomial proportions.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ciBinomHalfWidth.html">ciBinomHalfWidth</a></code>, <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code>, 
  <code><a href="plotCiBinomDesign.html">plotCiBinomDesign</a></code>, <code><a href="ebinom.html">ebinom</a></code>, <br><code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>, <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Look at how the required sample size of a one-sample </span></span>
<span class="r-in">  <span class="co"># confidence interval increases with decreasing </span></span>
<span class="r-in">  <span class="co"># required half-width:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]   92  374 1030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.10010168 0.05041541 0.03047833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1]   92  374 1030</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5 0.5 0.5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.10010168 0.05041541 0.03047833</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Note that the required sample size decreases if we are less </span></span>
<span class="r-in">  <span class="co"># stringent about how much the confidence interval width can </span></span>
<span class="r-in">  <span class="co"># deviate from the supplied value of the 'half.width' argument:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.03</span><span class="op">)</span>, tol.half.width <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  84 314 782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.10456066 0.05496837 0.03495833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1]  84 314 782</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5 0.5 0.5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.10456066 0.05496837 0.03495833</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#--------------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at how the required sample size for a one-sample </span></span>
<span class="r-in">  <span class="co"># confidence interval tends to decrease as the estimated </span></span>
<span class="r-in">  <span class="co"># value of p decreases below 0.5 or increases above 0.5:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8</span>
<span class="r-in">  <span class="co">#[1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8 </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fl">0.1</span>, p.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  70  90 100  92 100  90  70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09931015 0.09839843 0.09910818 0.10010168 0.09910818 0.09839843 0.09931015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1]  70  90 100  92 100  90  70</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.09931015 0.09839843 0.09910818 0.10010168 0.09910818 0.09839843</span></span>
<span class="r-in">  <span class="co">#[7] 0.09931015</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at how the required sample size for a one-sample </span></span>
<span class="r-in">  <span class="co"># confidence interval increases with increasing confidence level:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fl">0.05</span>, conf.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 160 264 374 644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.5 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05039976 0.05035948 0.05041541 0.05049152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1] 160 264 374 644</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5 0.5 0.5 0.5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.05039976 0.05035948 0.05041541 0.05049152</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare required sample size for a one-sample </span></span>
<span class="r-in">  <span class="co"># confidence interval based on the different methods:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fl">0.05</span>, ci.method <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05041541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1] 374</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.05041541</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fl">0.05</span>, ci.method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05047916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1] 394</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.05047916</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Exact"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fl">0.05</span>, ci.method <span class="op">=</span> <span class="st">"adjusted Wald"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05041541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Adjusted Wald normal approximation"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1] 374</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.05041541</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Adjusted Wald normal approximation"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fl">0.05</span>, ci.method <span class="op">=</span> <span class="st">"Wald"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05037834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Wald normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in">  <span class="co">#$n</span></span>
<span class="r-in">  <span class="co">#[1] 398</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.05037834</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Wald normal approximation, with continuity correction"</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="co"># Look at how the required sample size of a two-sample </span></span>
<span class="r-in">  <span class="co"># confidence interval increases with decreasing </span></span>
<span class="r-in">  <span class="co"># required half-width:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ciBinomN</span><span class="op">(</span>half.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.03</span><span class="op">)</span>, sample.type <span class="op">=</span> <span class="st">"two"</span><span class="op">)</span>  </span>
<span class="r-in">  <span class="co">#$n1</span></span>
<span class="r-in">  <span class="co">#[1]  210  778 2089</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$n2</span></span>
<span class="r-in">  <span class="co">#[1]  210  778 2089</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p1.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.5000000 0.5000000 0.4997607</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$p2.hat</span></span>
<span class="r-in">  <span class="co">#[1] 0.4000000 0.3997429 0.4001915</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$half.width</span></span>
<span class="r-in">  <span class="co">#[1] 0.09943716 0.05047044 0.03049753</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#$method</span></span>
<span class="r-in">  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span>
<span class="r-in">  <span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

