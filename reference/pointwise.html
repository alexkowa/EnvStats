<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pointwise Confidence Limits for Predictions — pointwise • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pointwise Confidence Limits for Predictions — pointwise"><meta property="og:description" content="Computes pointwise confidence limits for predictions computed by the function
  predict."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pointwise Confidence Limits for Predictions</h1>

    <div class="hidden name"><code>pointwise.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes pointwise confidence limits for predictions computed by the function
  <code><a href="predict.html">predict</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pointwise</span><span class="op">(</span><span class="va">results.predict</span>, coverage <span class="op">=</span> <span class="fl">0.99</span>, </span>
<span>    simultaneous <span class="op">=</span> <span class="cn">FALSE</span>, individual <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-results-predict">results.predict<a class="anchor" aria-label="anchor" href="#arg-results-predict"></a></dt>
<dd><p>output from a call to <code><a href="predict.html">predict</a></code> with <code>se.fit=TRUE</code>.</p></dd>

  <dt id="arg-coverage">coverage<a class="anchor" aria-label="anchor" href="#arg-coverage"></a></dt>
<dd><p>optional numeric scalar between 0 and 1 indicating the confidence level associated with the confidence limits.
  The default value is <code>coverage=0.99</code>.</p></dd>

  <dt id="arg-simultaneous">simultaneous<a class="anchor" aria-label="anchor" href="#arg-simultaneous"></a></dt>
<dd><p>optional logical scalar indicating whether to base the confidence limits for the
  predicted values on simultaneous or non-simultaneous prediction limits.
  The default value is <code>simultaneous=FALSE</code>.</p></dd>

  <dt id="arg-individual">individual<a class="anchor" aria-label="anchor" href="#arg-individual"></a></dt>
<dd><p>optional logical scalar indicating whether to base the confidence intervals for the
  predicted values on prediction limits for the mean (<code>individual=FALSE</code>) or
  prediction limits for an individual observation (<code>individual=TRUE</code>).
  The default value is <code>individual=FALSE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function computes pointwise confidence limits for predictions computed by the
  function <br><code><a href="predict.html">predict</a></code>. The limits are computed at those points specified by the argument
  <code>newdata</code> of <code><a href="predict.html">predict</a></code>.</p>
<p>The <code><a href="predict.html">predict</a></code> function is a generic function with methods for several
  different classes.  The funciton <code>pointwise</code> was part of the S language.
  The modifications to <code>pointwise</code> in the package <span class="pkg">EnvStats</span> involve confidence
  limits for predictions for a linear model (i.e., an object of class <code>"lm"</code>).</p>
<p><strong>Confidence Limits for a Predicted Mean Value (<code>individual=FALSE</code>)</strong>.
  Consider a standard linear model with \(p\) predictor variables.
  Often, one of the major goals of regression analysis is to predict a future
  value of the response variable given known values of the predictor variables.
  The equations for the predicted mean value of the response given
  fixed values of the predictor variables as well as the equation for a
  two-sided (1-\(\alpha\))100% confidence interval for the mean value of the
  response can be found in Draper and Smith (1998, p.80) and
  Millard and Neerchal (2001, p.547).</p>
<p>Technically, this formula is a confidence interval for the mean of
  the response for one set of fixed values of the predictor variables and
  corresponds to the case when <code>simultaneous=FALSE</code>. To create simultaneous
  confidence intervals over the range of of the predictor variables,
  the critical t-value in the equation has to be replaced with a critical
  F-value and the modified formula is given in Draper and Smith (1998, p. 83),
  Miller (1981a, p. 111), and Millard and Neerchal (2001, p. 547).
  This formula is used in the case when <code>simultaneous=TRUE</code>.</p>
<p><strong>Confidence Limits for a Predicted Individual Value (<code>individual=TRUE</code>)</strong>.
  In the above section we discussed how to create a confidence interval for
  the mean of the response given fixed values for the predictor variables.
  If instead we want to create a prediction interval for a single
  future observation of the response variable, the fomula is given in
  Miller (1981a, p. 115) and Millard and Neerchal (2001, p. 551).</p>
<p>Technically, this formula is a prediction interval for a single future
  observation for one set of fixed values of the predictor variables and
  corresponds to the case when <code>simultaneous=FALSE</code>.  Miller (1981a, p. 115)
  gives a formula for simultaneous prediction intervals for \(k\) future
  observations. If we are interested in creating an interval that will
  encompass <em>all</em> possible future observations over the range of the
  preictor variables with some specified probability however, we need to
  create simultaneous tolerance intervals.  A formula for such an interval
  was developed by Lieberman and Miller (1963) and is given in
  Miller (1981a, p. 124).  This formula is used in the case when
  <code>simultaneous=TRUE</code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list with the following components:</p>
<dl><dt>upper</dt>
<dd><p>upper limits of pointwise confidence intervals.</p></dd>

  <dt>fit</dt>
<dd><p>surface values.  This is the same as the component <code>fit</code> of the argument <br><code>results.predict</code>.</p></dd>

  <dt>lower</dt>
<dd><p>lower limits of pointwise confidence intervals.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Chambers, J.M., and Hastie, T.J., eds. (1992). <em>Statistical Models in S</em>.
  Chapman and Hall/CRC, Boca Raton, FL.</p>
<p>Draper, N., and H. Smith. (1998). <em>Applied Regression Analysis</em>.
  Third Edition. John Wiley and Sons, New York, Chapter 3.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, FL, pp.546-553.</p>
<p>Miller, R.G. (1981a). <em>Simultaneous Statistical Inference</em>.
  Springer-Verlag, New York, pp.111, 124.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Authors of S (for code for <code>pointwise</code> in S).</p>
<p>Steven P. Millard (for modification to allow the arguments <code>simultaneous</code> and <code>individual</code>); <br><a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The function <code>pointwise</code> is called by the functions
  <code><a href="detectionLimitCalibrate.html">detectionLimitCalibrate</a></code> and <br><code><a href="inversePredictCalibrate.html">inversePredictCalibrate</a></code>, which are used in <strong>calibration</strong>.</p>
<p>Almost always the process of determining the concentration of a chemical in
  a soil, water, or air sample involves using some kind of machine that
  produces a signal, and this signal is related to the concentration of the
  chemical in the physical sample. The process of relating the machine signal
  to the concentration of the chemical is called <strong>calibration</strong>
  (see <code><a href="calibrate.html">calibrate</a></code>). Once calibration has been performed,
  estimated concentrations in physical samples with unknown concentrations
  are computed using inverse regression.  The uncertainty in the process used
  to estimate the concentration may be quantified with decision, detection,
  and quantitation limits.</p>
<p>In practice, only the point estimate of concentration is reported (along
  with a possible qualifier), without confidence bounds for the true
  concentration \(C\). This is most unfortunate because it gives the
  impression that there is no error associated with the reported concentration.
  Indeed, both the International Organization for Standardization (ISO) and
  the International Union of Pure and Applied Chemistry (IUPAC) recommend
  always reporting both the estimated concentration and the uncertainty
  associated with this estimate (Currie, 1997).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="predict.html">predict</a></code>, <code><a href="predict.lm.html">predict.lm</a></code>,
  <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <code><a href="calibrate.html">calibrate</a></code>,
  <code><a href="inversePredictCalibrate.html">inversePredictCalibrate</a></code>, <code><a href="detectionLimitCalibrate.html">detectionLimitCalibrate</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Using the data in the built-in data frame Air.df, </span></span></span>
<span class="r-in"><span>  <span class="co"># fit the cube root of ozone as a function of temperature. </span></span></span>
<span class="r-in"><span>  <span class="co"># Then compute predicted values for ozone at 70 and 90 </span></span></span>
<span class="r-in"><span>  <span class="co"># degrees F, and compute 95% confidence intervals for the </span></span></span>
<span class="r-in"><span>  <span class="co"># mean value of ozone at these temperatures.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># First create the lm object </span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">ozone.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ozone</span> <span class="op">~</span> <span class="va">temperature</span>, data <span class="op">=</span> <span class="va">Air.df</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now get predicted values and CIs at 70 and 90 degrees </span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">predict.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">ozone.fit</span>, </span></span>
<span class="r-in"><span>    newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">pointwise</span><span class="op">(</span><span class="va">predict.list</span>, coverage <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.839145 4.278533 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.697810 4.101808 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1        2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.556475 3.925082 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co"># $upper</span></span></span>
<span class="r-in"><span>  <span class="co">#        1        2 </span></span></span>
<span class="r-in"><span>  <span class="co"># 2.839145 4.278533 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># $fit</span></span></span>
<span class="r-in"><span>  <span class="co">#        1        2 </span></span></span>
<span class="r-in"><span>  <span class="co"># 2.697810 4.101808 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># $lower</span></span></span>
<span class="r-in"><span>  <span class="co">#        1        2 </span></span></span>
<span class="r-in"><span>  <span class="co"># 2.556475 3.925082 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Continuing with the above example, create a scatterplot of ozone </span></span></span>
<span class="r-in"><span>  <span class="co"># vs. temperature, and add the fitted line along with simultaneous </span></span></span>
<span class="r-in"><span>  <span class="co"># 95% confidence bands.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">Air.df</span><span class="op">$</span><span class="va">temperature</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Air.df</span><span class="op">$</span><span class="va">ozone</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xlab<span class="op">=</span><span class="st">"Temperature (degrees F)"</span>,  </span></span>
<span class="r-in"><span>    ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="st">"Ozone (ppb)"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">ozone.fit</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">new.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, length<span class="op">=</span><span class="fl">100</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">predict.ozone</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">ozone.fit</span>, </span></span>
<span class="r-in"><span>    newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>temperature <span class="op">=</span> <span class="va">new.x</span><span class="op">)</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">ci.ozone</span> <span class="op">&lt;-</span> <span class="fu">pointwise</span><span class="op">(</span><span class="va">predict.ozone</span>, coverage<span class="op">=</span><span class="fl">0.95</span>, </span></span>
<span class="r-in"><span>    simultaneous<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">new.x</span>, <span class="va">ci.ozone</span><span class="op">$</span><span class="va">lower</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">new.x</span>, <span class="va">ci.ozone</span><span class="op">$</span><span class="va">upper</span>, lty<span class="op">=</span><span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cube Root Ozone vs. Temperature with Fitted Line"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"and Simultaneous 95% Confidence Bands"</span>, </span></span>
<span class="r-in"><span>    sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Redo the last example by creating non-simultaneous </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence bounds and prediction bounds as well.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"Temperature (degrees F)"</span>, </span></span>
<span class="r-in"><span>    ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="st">"Ozone (ppb)"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">ozone.fit</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">new.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, length<span class="op">=</span><span class="fl">100</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">predict.ozone</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.html">predict</a></span><span class="op">(</span><span class="va">ozone.fit</span>, </span></span>
<span class="r-in"><span>    newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>temperature <span class="op">=</span> <span class="va">new.x</span><span class="op">)</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">ci.ozone</span> <span class="op">&lt;-</span> <span class="fu">pointwise</span><span class="op">(</span><span class="va">predict.ozone</span>, coverage<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">new.x</span>, <span class="va">ci.ozone</span><span class="op">$</span><span class="va">lower</span>, lty<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">new.x</span>, <span class="va">ci.ozone</span><span class="op">$</span><span class="va">upper</span>, lty<span class="op">=</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pi.ozone</span> <span class="op">&lt;-</span> <span class="fu">pointwise</span><span class="op">(</span><span class="va">predict.ozone</span>, coverage <span class="op">=</span> <span class="fl">0.95</span>, </span></span>
<span class="r-in"><span>    individual <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">new.x</span>, <span class="va">pi.ozone</span><span class="op">$</span><span class="va">lower</span>, lty<span class="op">=</span><span class="fl">4</span>, col <span class="op">=</span> <span class="fl">4</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">new.x</span>, <span class="va">pi.ozone</span><span class="op">$</span><span class="va">upper</span>, lty<span class="op">=</span><span class="fl">4</span>, col <span class="op">=</span> <span class="fl">4</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Cube Root Ozone vs. Temperature with Fitted Line"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"and 95% Confidence and Prediction Bands"</span>, </span></span>
<span class="r-in"><span>    sep<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">predict.list</span>, <span class="va">ozone.fit</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">new.x</span>, <span class="va">predict.ozone</span>, <span class="va">ci.ozone</span>, </span></span>
<span class="r-in"><span>    <span class="va">pi.ozone</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

