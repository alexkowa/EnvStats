<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate a Multivariate Matrix Based on a Specified Rank Correlation Mat — simulateMvMatrix • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a Multivariate Matrix Based on a Specified Rank Correlation Mat — simulateMvMatrix"><meta property="og:description" content="Simulate a multivariate matrix of random numbers from specified theoretical
  probability distributions and/or empirical probability distributions based on
  a specified rank correlation matrix, using either Latin Hypercube sampling or
  simple random sampling."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a Multivariate Matrix Based on a Specified Rank Correlation Mat</h1>

    <div class="hidden name"><code>simulateMvMatrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate a multivariate matrix of random numbers from specified theoretical
  probability distributions and/or empirical probability distributions based on
  a specified rank correlation matrix, using either Latin Hypercube sampling or
  simple random sampling.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulateMvMatrix</span><span class="op">(</span><span class="va">n</span>, distributions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Var.1 <span class="op">=</span> <span class="st">"norm"</span>, Var.2 <span class="op">=</span> <span class="st">"norm"</span><span class="op">)</span>,</span>
<span>    param.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Var.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, Var.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    cor.mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">distributions</span><span class="op">)</span><span class="op">)</span>, sample.method <span class="op">=</span> <span class="st">"SRS"</span>, seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    left.tail.cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">supp.min</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>    right.tail.cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">supp.max</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>    tol.1 <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, tol.symmetry <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>,</span>
<span>    tol.recip.cond.num <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, max.iter <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>a positive integer indicating the number of random vectors (i.e., the number of
  rows of the matrix) to generate.</p></dd>

  <dt id="arg-distributions">distributions<a class="anchor" aria-label="anchor" href="#arg-distributions"></a></dt>
<dd><p>a character vector of length \(k\) denoting the distribution abbreviations for
  each of the \(k\) distributions.  If there is a <code>names</code> attribute associated
  with this character vector, these names will be the column names of the resulting
  matrix.  The default value of <code>distributions</code> is
  <code>c(Var.1="norm", Var.2="norm")</code>, indicating that \(k=2\), both
  distributions are the normal distribution, and the column names of the
  resulting \(n \times k\) matrix will be <code>"Var.1"</code> and <code>"Var.2"</code>.
  See the help file for <code><a href="Distribution.df.html">Distribution.df</a></code> for a list of possible
  distribution abbreviations.</p>
<p>Alternatively, the character string <code>"emp"</code> may be used to denote sampling
  from an empirical distribution based on a set of observations.  The vector
  containing the observations is specified in the argument <code>param.list</code>.</p></dd>

  <dt id="arg-param-list">param.list<a class="anchor" aria-label="anchor" href="#arg-param-list"></a></dt>
<dd><p>a list containing \(k\) lists that specify the values for the parameters of
  the \(k\) distributions.  If <code>param.list</code> has a <code>names</code> attribute
  (not necessary), the <code>names</code> attribute should be exactly the same as the
  <code>names</code> attribute of the argument <code>distributions</code>.  The default value
  of <code>param.list</code> is <br><code>list(Var.1=list(mean=0, sd=1), Var.2=list(mean=0, sd=1))</code>.
  See the help file for <code><a href="Distribution.df.html">Distribution.df</a></code> for the names and
  possible values of the parameters associated with each distribution.</p>
<p>Alternatively, if you specify an empirical distribution for the \(j\)'th
  distribution by setting the \(j\)'th element of <code>distribution</code> to
  <code>"emp"</code>, then the \(j\)'th component of <code>param.list</code> must be a
  list of the form <code>list(obs=</code><em>name</em><code>)</code>, where <em>name</em> denotes the
  name of the vector containing the observations to use for the empirical
  distribution.  In this case, you may also supply arguments to the
  <code><a href="Empirical.html">qemp</a></code> function through the \(j\)'th component of <code>param.list</code>.
  For example, you may set this component to
  <code>list(obs=</code><em>name</em><code>, discrete=T)</code> to
  specify an empirical distribution based on a discrete random variable.</p></dd>

  <dt id="arg-cor-mat">cor.mat<a class="anchor" aria-label="anchor" href="#arg-cor-mat"></a></dt>
<dd><p>a \(k \times k\) matrix specifying the rank correlations between the
  \(k\) distributions.  This argument must be a positive definite symmetric
  matrix, with all 1's on the diagonal.  All elements on the off-diagonal must be
  between -1 and 1. The default value is the \(k \times k\) identity matrix,
  specifying no rank correlation between any of the variables.</p></dd>

  <dt id="arg-sample-method">sample.method<a class="anchor" aria-label="anchor" href="#arg-sample-method"></a></dt>
<dd><p>a character vector of length 1 or \(k\) indicating, for each distribution,
  whether to use Latin Hypercube sampling or simple random sampling.  If
  <code>sample.method</code> is of length 1, it is replicated to length \(k\).
  Each element of <code>sample.method</code> must be the character string
  <code>"LHS"</code> (Latin Hypercube sampling) or <code>"SRS"</code> (simple random sampling),
  or an abbreviation of one of these strings. The default value is <code>"SRS"</code>,
  indicating simple random sampling for each distribution.  Note that by specifying
  <code>sample.method</code> as a vector of length \(k\), you may use different sampling
  methods for different distributions.</p></dd>

  <dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer to supply to the <span style="R">R</span> function <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>.
  The default value is <code>seed=NULL</code>, in which case the random seed is
  not set but instead based on the current value of <code>.Random.seed</code>.</p></dd>

  <dt id="arg-left-tail-cutoff">left.tail.cutoff<a class="anchor" aria-label="anchor" href="#arg-left-tail-cutoff"></a></dt>
<dd><p>a numeric vector of length \(k\) indicating, for each distribution,
  what proportion of the left-tail of the probability distribution to omit
  for Latin Hypercube sampling.  All elements of <code>left.tail.cutoff</code>
  must be between 0 and 1.
  For densities with a finite support minimum (e.g., <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">Lognormal</a> or
  <a href="Empirical.html">Empirical</a>) the default value is <code>left.tail.cutoff=0</code>;
  for densities with a support minimum of \(-\infty\), the default value is
  <code>left.tail.cutoff=.Machine$double.eps</code>.
  The \(j\)'th element of this argument is ignored if
  the \(j\)'th element of <code>sample.method</code> is equal to <code>"SRS"</code>.</p></dd>

  <dt id="arg-right-tail-cutoff">right.tail.cutoff<a class="anchor" aria-label="anchor" href="#arg-right-tail-cutoff"></a></dt>
<dd><p>a numeric vector of length \(k\) indicating, for each distribution,
  what proportion of the right-tail of the probability distribution to omit
  for Latin Hypercube sampling.  All elements of <code>right.tail.cutoff</code>
  must be between 0 and 1.
  For densities with a finite support maximum (e.g., <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">Beta</a> or
  <a href="Empirical.html">Empirical</a>) the default value is <code>right.tail.cutoff=0</code>;
  for densities with a support maximum of \(\infty\), the default value
  is <code>right.tail.cutoff=.Machine$double.eps</code>.
  The \(j\)'th element of this argument is ignored if
  the \(j\)'th element of <code>sample.method</code> is equal to <code>"SRS"</code>.</p></dd>

  <dt id="arg-tol-">tol.1<a class="anchor" aria-label="anchor" href="#arg-tol-"></a></dt>
<dd><p>a positive numeric scalar indicating the allowable absolute deviation
  from 1 for the diagonal elements of <code>cor.mat</code>.  The default value
  is <code>.Machine$double.eps</code>.</p></dd>

  <dt id="arg-tol-symmetry">tol.symmetry<a class="anchor" aria-label="anchor" href="#arg-tol-symmetry"></a></dt>
<dd><p>a positive numeric scalar indicating the allowable absolute deviation from
  0 for the difference between symmetric elements of <code>cor.mat</code>
  (e.g., <br><code>abs(cor.mat[3,2]-cor.mat[2,3])</code>. The default value is <br><code>.Machine$double.eps</code>.</p></dd>

  <dt id="arg-tol-recip-cond-num">tol.recip.cond.num<a class="anchor" aria-label="anchor" href="#arg-tol-recip-cond-num"></a></dt>
<dd><p>a positive numeric scalar indicating the allowable minimum value of the
  reciprocal of the condition number for <code>cor.mat</code>.  The condition number
  is defined to be the largest eigen value divided by the smallest eigen value.
  The reciprocal of the condition number is some number between 0 and 1.
  This value must be sufficiently large for <code>cor.mat</code> to be of full rank
  (i.e., to not be singular).  The default value of <code>tol.recip.cond.num</code>
  is <code>.Machine$double.eps</code>.</p></dd>

  <dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>a positive integer indicating the maximum number of iterations to use to
  produce the \(R\) matrix in the algorithm to create the output matrix.
  The sample correlation matrix of \(R\) must be positive definite.
  The number of iterations will rarely be more than 2 for moderate to
  large sample sizes (e.g., \(n &gt; 2k\)).  The default value is
  <code>max.iter=10</code>.  See the DETAILS section below for more information on
  the \(R\) matrix.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><b>Motivation</b> <br>
  In risk assessment and Monte Carlo simulation, the outcome variable of interest,
  say \(Y\), is usually some function of one or more other random variables:
  $$Y = h(\underline{X}) = h(X_1, X_2, \ldots, X_k) \;\;\;\;\;\; (1)$$
  For example, \(Y\) may be the incremental lifetime cancer risk due to
  ingestion of soil contaminated with benzene (Thompson et al., 1992;
  Hamed and Bedient, 1997).  In this case the random vector \(\underline{X}\)
  may represent observations from several kinds of distributions that characterize
  exposure and dose-response, such as benzene concentration in the soil,
  soil ingestion rate, average body weight, the cancer potency factor for benzene,
  etc.  These distributions may or may not be assumed to be independent of one
  another (Smith et al., 1992; Bukowski et al., 1995).  Often, input variables in a
  Monte Carlo simulation are in fact known to be correlated, such as body weight
  and dermal area.</p>
<p>Characterizing the joint distribution of a random vector \(\underline{X}\),
  where different elements of \(\underline{X}\) come from different distributions,
  is usually mathematically complex or impossible unless the elements
  (random variables) of \(\underline{X}\) are independent.
  Iman and Conover (1982) present an algorithm for creating a set of \(n\)
  multivariate observations with a rank correlation matrix that is approximately
  equal to a specified rank correlation matrix.  This method allows for different
  probability distributions for each element of the multivariate vector.  The
  details of this algorithm are as follows.
  <br></p>
<p><b>Algorithm</b> <br></p><ol><li><p>Specify \(n\), the desired number of random vectors (i.e., number of
    rows of the \(n \times k\) output matrix).  This is specified by the
    argument <code>n</code> for the function <code>simulateMvMatrix</code>.</p></li>
<li><p>Create \(C\), the desired \(k \times k\) correlation matrix.  This is
    specified by the argument <code>cor.mat</code>.</p></li>
<li><p>Compute \(P\), where \(P\) is a lower triangular \(k \times k\)
    matrix and
    $$PP^{'} = C \;\;\;\;\;\; (2)$$
    where \(P^{'}\) denotes the transpose of \(P\).  The function
    <code>simulateMvMatrix</code> uses the Cholesky decomposition to compute P
    (see the <span style="R">R</span> help file for <code><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></code>).</p></li>
<li><p>Create \(R\), an \(n \times k\) matrix, whose columns represent
    \(k\) independent permutations of van der Waerden scores.  That is, each
    column of \(R\) is a random permutation of the scores
    $$\Phi^{-1}(\frac{i}{n+1}), \; i = 1, 2, \ldots, n \;\;\;\;\;\; (3)$$
    where \(\Phi\) denotes the cumulative distribution function of the standard
    normal distribution.</p></li>
<li><p>Compute \(T\), the \(k \times k\) Pearson sample correlation matrix
    of \(R\).
    Make sure \(T\) is positive definite; if it is not, then repeat step 4.</p></li>
<li><p>Compute \(Q\), where \(Q\) is a lower triangular \(k \times k\)
    matrix and
    $$QQ^{'} = T \;\;\;\;\;\; (4)$$
    The function <code>simulateMvMatrix</code> uses the Cholesky decomposition to compute
    \(Q\) (see the <span style="R">R</span> help file for <code><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></code>).</p></li>
<li><p>Compute the lower triangular \(k \times k\) matrix \(S\), where
    $$S = PQ^{-1} \;\;\;\;\;\; (5)$$</p></li>
<li><p>Compute the matrix \(R^{*}\), where
    $$R^{*} = RS^{'} \;\;\;\;\;\; (6)$$</p></li>
<li><p>Generate an \(n \times k\) matrix of random numbers \(\underline{X}\),
    where each column of \(\underline{X}\) comes from the distribution specified
    by the arguments <code>distributions</code> and <code>param.list</code>.  Generate each
    column of random numbers independently of the other columns.  If the \(j\)'th
    element of <code>sample.method</code> equals <code>"SRS"</code>, use simple random sampling
    to generate the random numbers for the \(j\)'th column of \(\underline{X}\).
    If the \(j\)'th element of <code>sample.method</code> equals <code>"LHS"</code>, use
    Latin Hypercube sampling to generate the random numbers for the \(j\)'th column
    of \(\underline{X}\).  At this stage in the algorithm, the function
    <code>simulateMvMatrix</code> calls the function <code><a href="simulateVector.html">simulateVector</a></code> to
    create each column of \(\underline{X}\).</p></li>
<li><p>Order the observations within each column of \(\underline{X}\) so that
    the order of the ranks within each column of \(\underline{X}\) matches the
    order of the ranks within each column of \(R^{*}\).  This way, \(\underline{X}\)
    and \(R^{*}\) have exactly the same sample rank correlation matrix.</p></li>
</ol><p><b>Explanation</b> <br>
  Iman and Conover (1982) present two algorithms for computing an \(n \times k\)
  output matrix with a specified rank correlation.  The algorithm presented above is
  the second, more complicated one.  In order to explain the reasoning behind this
  algorithm, we need to explain the simple algorithm first.
  <br></p>
<p><em>Simple Algorithm</em> <br>
  Let \(R_i\) denote the \(i\)'th row vector of the matrix \(R\), the
  matrix of scores.  This row vector has a population correlation matrix of \(I\),
  where \(I\) denotes the \(k \times k\) identity matrix.  Thus, the
  \(1 \times k\) vector \(R_i P^{'}\) has a population correlation matrix equal to
  \(C\). Therefore, if we define \(R^{*}\) by
  $$R^{*} = RP^{'} \;\;\;\;\;\; (7)$$
  each row of \(R^{*}\) has the same multivariate distribution with population
  correlation matrix \(C\).  The rank correlation matrix of \(R^{*}\) should
  therefore be close to \(C\).  Ordering the columns of \(\underline{X}\) as
  described in Step 10 above will yield a matrix of observations with the
  specified distributions and the exact same rank correlation matrix as the
  rank correlation matrix of \(R^{*}\).</p>
<p>Iman and Conover (1982) use van der Waerden scores instead of raw ranks to create
  \(R\) because van der Waerden scores yield more "natural-looking" pairwise
  scatterplots.</p>
<p>If the Pearson sample correlation matrix of \(R\), denoted \(T\) in Step 5
  above, is exactly equal to the true population correlation matrix \(I\),
  then the sample correlation matrix of \(R^{*}\) is exactly equal to \(C\),
  and the rank correlation matrix of \(R^{*}\) is approximately equal to \(C\).
  The Pearson sample correlation matrix of \(R\), however, is an estimate of the
  true population correlation matrix \(I\), and is therefore
  “bouncing around” \(I\).  Likewise, the Pearson sample correlation matrix
  of \(R^{*}\) is an estimate of the true population correlation matrix \(C\),
  and is therefore bouncing around \(C\).  Using this simple algorithm, the
  Pearson sample correlation matrix of \(R^{*}\), as \(R^{*}\) is defined in
  Equation (7) above, may not be “close” enough to the desired rank
  correlation matrix \(C\), and thus the rank correlation of \(R^{*}\) will not
  be close enough to \(C\).  Iman and Conover (1982), therefore present a more
  complicated algorithm.
  <br></p>
<p><em>More Complicated Algorithm</em> <br>
  To get around the problem mentioned above, Iman and Conover (1982) find a
  \(k \times k\) lower triangular matrix \(S\) such that the matrix \(R^{*}\)
  as defined in Equation (6) above has a correlation matrix exactly equal to \(C\).
  The formula for \(S\) is given in Steps 6 and 7 of the algorithm above.</p>
<p>Iman and Conover (1982, p.330) note that even if the desired rank correlation matrix
  \(C\) is in fact the identity matrix \(I\), this method of generating the
  matrix will produce a matrix with an associated rank correlation that more closely
  resembles \(I\) than you would get by simply generating random numbers within
  each column of \(\underline{X}\).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A numeric matrix of dimension \(n \times k\) of random numbers,
  where the \(j\)'th column of numbers comes from the distribution
  specified by the \(j\)'th elements of the arguments <code>distributions</code>
  and <code>param.list</code>, and the rank correlation of this matrix is
  approximately equal to the argument <code>cor.mat</code>.  The value of \(n\)
  is determined by the argument <code>n</code>, and the value of \(k\) is
  determined by the length of the argument <code>distributions</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bukowski, J., L. Korn, and D. Wartenberg. (1995).
  Correlated Inputs in Quantitative Risk Assessment: The Effects of Distributional
  Shape.  <em>Risk Analysis</em> <b>15</b>(2), 215–219.</p>
<p>Hamed, M., and P.B. Bedient. (1997).  On the Effect of Probability Distributions
  of Input Variables in Public Health Risk Assessment.  <em>Risk Analysis</em>
  <b>17</b>(1), 97–105.</p>
<p>Iman, R.L., and W.J. Conover. (1980).  Small Sample Sensitivity Analysis
  Techniques for Computer Models, With an Application to Risk Assessment
  (with Comments).  <em>Communications in Statistics–Volume A, Theory and Methods</em>,
  <b>9</b>(17), 1749–1874.</p>
<p>Iman, R.L., and W.J. Conover. (1982).  A Distribution-Free Approach to Inducing
  Rank Correlation Among Input Variables.
  <em>Communications in Statistics–Volume B, Simulation and Computation</em>,
  <b>11</b>(3), 311–334.</p>
<p>Iman, R.L., and J.M. Davenport. (1982).  Rank Correlation Plots For Use With
  Correlated Input Variables.
  <em>Communications in Statistics–Volume B, Simulation and Computation</em>,
  <b>11</b>(3), 335–360.</p>
<p>Iman, R.L., and J.C. Helton. (1988).  An Investigation of Uncertainty and
  Sensitivity Analysis Techniques for Computer Models.  <em>Risk Analysis</em>
  <b>8</b>(1), 71–90.</p>
<p>Iman, R.L. and J.C. Helton. (1991).  The Repeatability of Uncertainty and
  Sensitivity Analyses for Complex Probabilistic Risk Assessments.
  <em>Risk Analysis</em> <b>11</b>(4), 591–606.</p>
<p>McKay, M.D., R.J. Beckman., and W.J. Conover. (1979).  A Comparison of Three
  Methods for Selecting Values of Input Variables in the Analysis of Output
  From a Computer Code.  <em>Technometrics</em> <b>21</b>(2), 239–245.</p>
<p>Millard, S.P. (2013).  <em>EnvStats: an R Package for Environmental Statistics</em>.
  Springer, New York.  <a href="https://link.springer.com/book/10.1007/978-1-4614-8456-1" class="external-link">https://link.springer.com/book/10.1007/978-1-4614-8456-1</a>.</p>
<p>Smith, A.E., P.B. Ryan, and J.S. Evans. (1992).  The Effect of Neglecting
  Correlations When Propagating Uncertainty and Estimating the Population
  Distribution of Risk.  <em>Risk Analysis</em> <b>12</b>(4), 467–474.</p>
<p>Thompson, K.M., D.E. Burmaster, and E.A.C. Crouch. (1992).  Monte Carlo Techniques
  for Quantitative Uncertainty Analysis in Public Health Risk Assessments.
  <em>Risk Analysis</em> <b>12</b>(1), 53–63.</p>
<p>Vose, D. (2008).  <em>Risk Analysis:  A Quantitative Guide</em>.  Third Edition.
  John Wiley &amp; Sons, West Sussex, UK, 752 pp.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Monte Carlo simulation and risk assessment often involve looking at the
  distribution or characteristics of the distribution of some outcome variable
  that depends upon several input variables (see Equation (1) above).  Usually
  these input variables can be considered random variables.  An important part
  of both sensitivity analysis and uncertainty analysis involves looking at how
  the distribution of the outcome variable changes with changing assumptions on
  the input variables.  One important assumption is the correlation between the
  input random variables.</p>
<p>Often, the input random variables are assumed to be independent when in fact they
  are know to be correlated (Smith et al., 1992; Bukowski et al., 1995).  It is
  therefore important to assess the effect of the assumption of independence on the
  distribution of the outcome variable.  One way to assess the effect of this
  assumption is to run the Monte Carlo simulation assuming independence and then
  also run it assuming certain forms of correlations among the input variables.</p>
<p>Iman and Davenport (1982) present a series of scatterplots showing “typical”
  scatterplots with various distributions on the \(x\)- and \(y\)-axes and
  various assumed rank correlations.  These plots are meant to aid in developing
  reasonable estimates of rank correlation between input variables.  These plots can
  easily be produced using the <code>simulateMvMatrix</code> and <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code> functions.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="FcnsByCatProbDists.html">Probability Distributions and Random Numbers</a>, <a href="Empirical.html">Empirical</a>,
  <code><a href="simulateVector.html">simulateVector</a></code>, <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>, <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 5 observations from a standard bivariate normal distribution</span></span></span>
<span class="r-in"><span>  <span class="co"># with a rank correlation matrix (approximately) equal to the 2 x 2</span></span></span>
<span class="r-in"><span>  <span class="co"># identity matrix, using simple random sampling for each</span></span></span>
<span class="r-in"><span>  <span class="co"># marginal distribution.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">simulateMvMatrix</span><span class="op">(</span><span class="fl">5</span>, seed <span class="op">=</span> <span class="fl">47</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Var.1       Var.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.98548216 -1.82822917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.46575030 -0.92245624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.08573747  0.49382018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.25204590  0.03960243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.01513086  0.09147291</span>
<span class="r-in"><span>  <span class="co">#           Var.1       Var.2</span></span></span>
<span class="r-in"><span>  <span class="co">#[1,]  0.01513086  0.03960243</span></span></span>
<span class="r-in"><span>  <span class="co">#[2,] -1.08573747  0.09147291</span></span></span>
<span class="r-in"><span>  <span class="co">#[3,] -0.98548216  0.49382018</span></span></span>
<span class="r-in"><span>  <span class="co">#[4,] -0.25204590 -0.92245624</span></span></span>
<span class="r-in"><span>  <span class="co">#[5,] -1.46575030 -1.82822917</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at the observed rank correlation matrix for 100 observations</span></span></span>
<span class="r-in"><span>  <span class="co"># from a standard bivariate normal distribution with a rank correlation matrix</span></span></span>
<span class="r-in"><span>  <span class="co"># (approximately) equal to the 2 x 2 identity matrix. Compare this observed</span></span></span>
<span class="r-in"><span>  <span class="co"># rank correlation matrix with the observed rank correlation matrix based on</span></span></span>
<span class="r-in"><span>  <span class="co"># generating two independent sets of standard normal random numbers.</span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the cross-correlation is closer to 0 for the matrix created with</span></span></span>
<span class="r-in"><span>  <span class="co"># simulateMvMatrix.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu">simulateMvMatrix</span><span class="op">(</span><span class="fl">100</span>, seed <span class="op">=</span> <span class="fl">47</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Var.1       Var.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.1 1.000000000 0.002472247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Var.2 0.002472247 1.000000000</span>
<span class="r-in"><span>  <span class="co">#             Var.1        Var.2</span></span></span>
<span class="r-in"><span>  <span class="co">#Var.1  1.000000000 -0.005976598</span></span></span>
<span class="r-in"><span>  <span class="co">#Var.2 -0.005976598  1.000000000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="simulateVector.html">simulateVector</a></span><span class="op">(</span><span class="fl">200</span>, seed <span class="op">=</span> <span class="fl">47</span><span class="op">)</span>, <span class="fl">100</span> , <span class="fl">2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.05374137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.05374137  1.00000000</span>
<span class="r-in"><span>  <span class="co">#            [,1]        [,2]</span></span></span>
<span class="r-in"><span>  <span class="co">#[1,]  1.00000000 -0.05374137</span></span></span>
<span class="r-in"><span>  <span class="co">#[2,] -0.05374137  1.00000000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Generate 1000 observations from a bivariate distribution, where the first</span></span></span>
<span class="r-in"><span>  <span class="co"># distribution is a normal distribution with parameters mean=10 and sd=2,</span></span></span>
<span class="r-in"><span>  <span class="co"># the second distribution is a lognormal distribution with parameters</span></span></span>
<span class="r-in"><span>  <span class="co"># mean=10 and cv=1, and the desired rank correlation between the two</span></span></span>
<span class="r-in"><span>  <span class="co"># distributions is 0.8.  Look at the observed rank correlation matrix, and</span></span></span>
<span class="r-in"><span>  <span class="co"># plot the results.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">simulateMvMatrix</span><span class="op">(</span><span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    distributions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>N.10.2 <span class="op">=</span> <span class="st">"norm"</span>, LN.10.1 <span class="op">=</span> <span class="st">"lnormAlt"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    param.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N.10.2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">10</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      LN.10.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">10</span>, cv<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    cor.mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.8</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">47</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         N.10.2 LN.10.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N.10.2    1.00    0.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LN.10.1   0.79    1.00</span>
<span class="r-in"><span>  <span class="co">#        N.10.2 LN.10.1</span></span></span>
<span class="r-in"><span>  <span class="co">#N.10.2    1.00    0.78</span></span></span>
<span class="r-in"><span>  <span class="co">#LN.10.1   0.78    1.00</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat</span>, xlab <span class="op">=</span> <span class="st">"Observations from N(10, 2)"</span>,</span></span>
<span class="r-in"><span>    ylab <span class="op">=</span> <span class="st">"Observations from LN(mean=10, cv=1)"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Lognormal vs. Normal Deviates with Rank Correlation 0.8"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the last example, but use Latin Hypercube sampling for both</span></span></span>
<span class="r-in"><span>  <span class="co"># distributions. Note the wider range on the y-axis.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mat.LHS</span> <span class="op">&lt;-</span> <span class="fu">simulateMvMatrix</span><span class="op">(</span><span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    distributions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>N.10.2 <span class="op">=</span> <span class="st">"norm"</span>, LN.10.1 <span class="op">=</span> <span class="st">"lnormAlt"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    param.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N.10.2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">10</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      LN.10.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">10</span>, cv<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    cor.mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.8</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    sample.method <span class="op">=</span> <span class="st">"LHS"</span>, seed <span class="op">=</span> <span class="fl">298</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat.LHS</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         N.10.2 LN.10.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N.10.2    1.00    0.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LN.10.1   0.79    1.00</span>
<span class="r-in"><span>  <span class="co">#        N.10.2 LN.10.1</span></span></span>
<span class="r-in"><span>  <span class="co">#N.10.2    1.00    0.79</span></span></span>
<span class="r-in"><span>  <span class="co">#LN.10.1   0.79    1.00</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mat.LHS</span>, xlab <span class="op">=</span> <span class="st">"Observations from N(10, 2)"</span>,</span></span>
<span class="r-in"><span>    ylab <span class="op">=</span> <span class="st">"Observations from LN(mean=10, cv=1)"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Lognormal vs. Normal Deviates with Rank Correlation 0.8"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"(Latin Hypercube Sampling)"</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Generate 1000 observations from a multivariate distribution, where the</span></span></span>
<span class="r-in"><span>  <span class="co"># first distribution is a normal distribution with parameters</span></span></span>
<span class="r-in"><span>  <span class="co"># mean=10 and sd=2, the second distribution is a lognormal distribution</span></span></span>
<span class="r-in"><span>  <span class="co"># with parameters mean=10 and cv=1, the third distribution is a beta</span></span></span>
<span class="r-in"><span>  <span class="co"># distribution with parameters shape1=2 and shape2=3, and the fourth</span></span></span>
<span class="r-in"><span>  <span class="co"># distribution is an empirical distribution of 100 observations that</span></span></span>
<span class="r-in"><span>  <span class="co"># we'll generate from a Pareto distribution with parameters</span></span></span>
<span class="r-in"><span>  <span class="co"># location=10 and shape=2. Set the desired rank correlation matrix to:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">cor.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.8</span>, <span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.8</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">.7</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.2</span>, <span class="fl">.5</span>, <span class="fl">.7</span>, <span class="fl">.2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">cor.mat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.0  0.8  0.0  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.8  1.0  0.0  0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0  0.0  1.0  0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.5  0.7  0.2  1.0</span>
<span class="r-in"><span>  <span class="co">#     [,1] [,2] [,3] [,4]</span></span></span>
<span class="r-in"><span>  <span class="co">#[1,]  1.0  0.8  0.0  0.5</span></span></span>
<span class="r-in"><span>  <span class="co">#[2,]  0.8  1.0  0.0  0.7</span></span></span>
<span class="r-in"><span>  <span class="co">#[3,]  0.0  0.0  1.0  0.2</span></span></span>
<span class="r-in"><span>  <span class="co">#[4,]  0.5  0.7  0.2  1.0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Use Latin Hypercube sampling for each variable, look at the observed</span></span></span>
<span class="r-in"><span>  <span class="co"># rank correlation matrix, and plot the results.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pareto.rns</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulateVector.html">simulateVector</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"pareto"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">10</span>, shape <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, sample.method <span class="op">=</span> <span class="st">"LHS"</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">56</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">simulateMvMatrix</span><span class="op">(</span><span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    distributions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Normal <span class="op">=</span> <span class="st">"norm"</span>, Lognormal <span class="op">=</span> <span class="st">"lnormAlt"</span>,</span></span>
<span class="r-in"><span>      Beta <span class="op">=</span> <span class="st">"beta"</span>, Empirical <span class="op">=</span> <span class="st">"emp"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    param.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Normal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">10</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      Lognormal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fl">10</span>, cv<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      Beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      Empirical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="va">pareto.rns</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    cor.mat <span class="op">=</span> <span class="va">cor.mat</span>, seed <span class="op">=</span> <span class="fl">47</span>, sample.method <span class="op">=</span> <span class="st">"LHS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Normal Lognormal Beta Empirical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Normal      1.00      0.79 0.00      0.48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lognormal   0.79      1.00 0.01      0.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beta        0.00      0.01 1.00      0.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical   0.48      0.68 0.21      1.00</span>
<span class="r-in"><span>  <span class="co">#          Normal Lognormal  Beta Empirical</span></span></span>
<span class="r-in"><span>  <span class="co">#Normal      1.00      0.78 -0.01      0.47</span></span></span>
<span class="r-in"><span>  <span class="co">#Lognormal   0.78      1.00 -0.01      0.67</span></span></span>
<span class="r-in"><span>  <span class="co">#Beta       -0.01     -0.01  1.00      0.19</span></span></span>
<span class="r-in"><span>  <span class="co">#Empirical   0.47      0.67  0.19      1.00</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">mat</span>, <span class="va">mat.LHS</span>, <span class="va">pareto.rns</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

