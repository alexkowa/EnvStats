<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Parameters of a Three-Parameter Lognormal Distribution (Log-Scale) — elnorm3 • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Parameters of a Three-Parameter Lognormal Distribution (Log-Scale) — elnorm3"><meta property="og:description" content="Estimate the mean, standard deviation, and threshold parameters for a
  three-parameter lognormal distribution, and optionally
  construct a confidence interval for the threshold or the median of the distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Parameters of a Three-Parameter Lognormal Distribution (Log-Scale)</h1>

    <div class="hidden name"><code>elnorm3.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the mean, standard deviation, and threshold parameters for a
  <a href="Lognormal3.html">three-parameter lognormal distribution</a>, and optionally
  construct a confidence interval for the threshold or the median of the distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">elnorm3</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"lmle"</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, ci.parameter <span class="op">=</span> <span class="st">"threshold"</span>, </span>
<span>    ci.method <span class="op">=</span> <span class="st">"avar"</span>, ci.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    threshold.lb.sd <span class="op">=</span> <span class="fl">100</span>, evNormOrdStats.method <span class="op">=</span> <span class="st">"royston"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of observations.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string specifying the method of estimation.  Possible values are:</p><ul><li><p><code>"lmle"</code> (local maximum likelihood; the default)</p></li>
<li><p><code>"mme"</code> (method of moments)</p></li>
<li><p><code>"mmue"</code> (method of moments using an unbaised estimate of variance)</p></li>
<li><p><code>"mmme"</code> (modified method of moments due to Cohen and Whitten (1980))</p></li>
<li><p><code>"zero.skew"</code> (zero-skewness estimator due to Griffiths (1980))</p></li>
<li><p><code>"royston.skew"</code> (estimator based on Royston's (1992b) index of skewness).</p></li>
</ul><p>See the DETAILS section for more information.</p></dd>

  <dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for either
  the threshold or median of the distribution.  The default value is <code>FALSE</code>.</p></dd>

  <dt id="arg-ci-parameter">ci.parameter<a class="anchor" aria-label="anchor" href="#arg-ci-parameter"></a></dt>
<dd><p>character string indicating the parameter for which the confidence interval is
  desired.  The possible values are <code>"threshold"</code> (the default) and
  <code>"median"</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating the method to use to construct the confidence interval.
  The possible values are <code>"avar"</code> (asymptotic variance; the default), <br><code>"likelihood.profile"</code>, and <code>"skewness"</code> (method suggested by Royston
  (1992b) for <code>method="zero.skew"</code>).  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>character string indicating what kind of confidence interval to compute.  The
  possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
  The default value is <code>conf.level=0.95</code>. This argument is ignored if
  <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-threshold-lb-sd">threshold.lb.sd<a class="anchor" aria-label="anchor" href="#arg-threshold-lb-sd"></a></dt>
<dd><p>a positive numeric scalar specifying the range over which to look for the
  local maximum likelihood (<code>method="lmle"</code>) or zero-skewness <br>
  (<code>method="zero.skewness"</code>) estimator of threshold.  The range is set to <br><code>[ mean(x) - threshold.lb.sd * sd(x), min(x) ]</code>.  If you receive a warning
  message that <code>elnorm3</code> is unable to find an acceptable estimate of threshold
  in this range, it may be because of convergence problems specific to the data in
  <code>x</code>.  When this occurs, try changing the value of <code>threshold.lb.sd</code>.  This
  same range is used in constructing confidence intervals for the threshold parameter.
  The default value is <code>threshold.lb.sd=100</code>.  This argument is relevant only if
  <code>method="lmle"</code>, <code>method="zero.skew"</code>,
  <code>ci.method="likelihood.profile"</code>, and/or <code>ci.method="skewness"</code>.</p></dd>

  <dt id="arg-evnormordstats-method">evNormOrdStats.method<a class="anchor" aria-label="anchor" href="#arg-evnormordstats-method"></a></dt>
<dd><p>character string indicating which method to use in the call to
  <code>link{evNormOrdStatsScalar}</code> when <code>method="mmme"</code>.  See the DETAILS
  section for more information.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or
  infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to
  performing the estimation.</p>
<p>Let \(X\) denote a random variable from a
  <a href="Lognormal3.html">three-parameter lognormal distribution</a> with
  parameters <code>meanlog=</code>\(\mu\), <code>sdlog=</code>\(\sigma\), and
  <code>threshold=</code>\(\gamma\).  Let \(\underline{x}\) denote a vector of
  \(n\) observations from this distribution.  Furthermore, let \(x_{(i)}\) denote
  the \(i\)'th order statistic in the sample, so that \(x_{(1)}\) denotes the
  smallest value and \(x_{(n)}\) denote the largest value in \(\underline{x}\).
  Finally, denote the sample mean and variance by:
  $$\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\; (1)$$
  $$s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\; (2)$$
  Note that the sample variance is the unbiased version.  Denote the method of
  moments estimator of variance by:
  $$s^2_m = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\; (3)$$</p>
<p><b>Estimation</b> <br></p>
<p><em>Local Maximum Likelihood Estimation</em> (<code>method="lmle"</code>) <br>
  Hill (1963) showed that the likelihood function approaches infinity as \(\gamma\)
  approaches \(x_{(1)}\), so that the global maximum likelihood estimators of
  \((\mu, \sigma, \gamma)\) are \((-\infty, \infty, x_{(1)})\), which are
  inadmissible, since \(\gamma\) must be smaller than \(x_{(1)}\).  Cohen (1951)
  suggested using local maximum likelihood estimators (lmle's), derived by equating
  partial derivatives of the log-likelihood function to zero.  These estimators were
  studied by Harter and Moore (1966), Calitz (1973), Cohen and Whitten (1980), and
  Griffiths (1980), and appear to possess most of the desirable properties ordinarily
  associated with maximum likelihood estimators.</p>
<p>Cohen (1951) showed that the lmle of \(\gamma\) is given by the solution to the
  following equation:
  $$[\sum_{i=1}^n \frac{1}{w_i}] \, \{\sum_{i=1}^n y_i - \sum_{i=1}^n y_i^2 + \frac{1}{n}[\sum_{i=1}^n y_i]^2 \} - n \sum_{i=1}^n \frac{y_i}{w_i} = 0 \;\;\;\; (4)$$
  where
  $$w_i = x_i - \hat{\gamma} \;\;\;\; (5)$$
  $$y_i = log(x_i - \hat{\gamma}) = log(w_i) \;\;\;\; (6)$$
  and that the lmle's of \(\mu\) and \(\sigma\) then follow as:
  $$\hat{\mu} = \frac{1}{n} \sum_{i=1}^n y_i = \bar{y} \;\;\;\; (7)$$
  $$\hat{\sigma}^2 = \frac{1}{n} \sum_{i=1}^n (y_i - \bar{y})^2 \;\;\;\; (8)$$
  Unfortunately, while equation (4) simplifies the task of computing the lmle's,
  for certain data sets there still may be convergence problems (Calitz, 1973), and
  occasionally multiple roots of equation (4) may exist.  When multiple roots to
  equation (4) exisit, Cohen and Whitten (1980) recommend using the one that results
  in closest agreement between the mle of \(\mu\) (equation (7)) and the sample
  mean (equation (1)).</p>
<p>On the other hand, Griffiths (1980) showed that for a given value of the threshold
  parameter \(\gamma\), the maximized value of the log-likelihood (the
  “profile likelihood” for \(\gamma\)) is given by:
  $$log[L(\gamma)] = \frac{-n}{2} [1 + log(2\pi) + 2\hat{\mu} + log(\hat{\sigma}^2) ] \;\;\;\; (9)$$
  where the estimates of \(\mu\) and \(\sigma\) are defined in equations (7)
  and (8), so the lmle of \(\gamma\) reduces to an iterative search over the values
  of \(\gamma\).  Griffiths (1980) noted that the distribution of the lmle of
  \(\gamma\) is far from normal and that \(log[L(\gamma)]\) is not quadratic
  near the lmle of \(\gamma\).  He suggested a better parameterization based on
  $$\eta = -log(x_{(1)} - \gamma) \;\;\;\; (10)$$
  Thus, once the lmle of \(\eta\) is found using equations (9) and (10), the lmle of
  \(\gamma\) is given by:
  $$\hat{\gamma} = x_{(1)} - exp(-\hat{\eta}) \;\;\;\; (11)$$
  When <code>method="lmle"</code>, the function <code>elnorm3</code> uses the function
  <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> to search for the minimum of \(-2log[L(\eta)]\), using the
  modified method of moments estimator (<code>method="mmme"</code>; see below) as the
  starting value for \(\gamma\).  Equation (11) is then used to solve for the
  lmle of \(\gamma\), and equation (4) is used to “fine tune” the estimated
  value of \(\gamma\).  The lmle's of \(\mu\) and \(\sigma\) are then computed
  using equations (6)-(8).
  <br></p>
<p><em>Method of Moments Estimation</em> (<code>method="mme"</code>) <br>
  Denote the \(r\)'th sample central moment by:
  $$m_r = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^r \;\;\;\; (12)$$
  and note that
  $$s^2_m = m_2 \;\;\;\; (13)$$
  Equating the sample first moment (the sample mean) with its population value
  (the population mean), and equating the second and third sample central moments
  with their population values yields (Johnson et al., 1994, p.228):
  $$\bar{x} = \gamma + \beta \sqrt{\omega} \;\;\;\; (14)$$
  $$m_2 = s^2_m = \beta^2 \omega (\omega - 1) \;\;\;\; (15)$$
  $$m_3 = \beta^3 \omega^{3/2} (\omega - 1)^2 (\omega + 2) \;\;\;\; (16)$$
  where
  $$\beta = exp(\mu) \;\;\;\; (17)$$
  $$\omega = exp(\sigma^2) \;\;\;\; (18)$$
  Combining equations (15) and (16) yields:
  $$b_1 = \frac{m_3}{m_2^{3/2}} = (\omega + 2) \sqrt{\omega - 1} \;\;\;\; (19)$$
  The quantity on the left-hand side of equation (19) is the usual estimator of
  skewness.  Solving equation (19) for \(\omega\) yields:
  $$\hat{\omega} = (d + h)^{1/3} + (d - h)^{1/3} - 1 \;\;\;\; (20)$$
  where
  $$d = 1 + \frac{b_1}{2} \;\;\;\; (21)$$
  $$h = sqrt{d^2 - 1} \;\;\;\; (22)$$
  Using equation (18), the method of moments estimator of \(\sigma\) is then
  computed as:
  $$\hat{\sigma}^2 = log(\hat{\omega}) \;\;\;\; (23)$$
  Combining equations (15) and (17), the method of moments estimator of \(\mu\)
  is computed as:
  $$\hat{\mu} = \frac{1}{2} log[\frac{s^2_m}{\hat{omega}(\hat{\omega} - 1)}] \;\;\;\; (24)$$
  Finally, using equations (14), (17), and (18), the method of moments estimator of
  \(\gamma\) is computed as:
  $$\bar{x} - exp(\hat{mu} + \frac{\hat{\sigma}^2}{2}) \;\;\;\; (25)$$
  There are two major problems with using method of moments estimators for the
  three-parameter lognormal distribution.  First, they are subject to very large
  sampling error due to the use of second and third sample moments
  (Cohen, 1988, p.121; Johnson et al., 1994, p.228).  Second, Heyde (1963) showed
  that the lognormal distribution is not uniquely determined by its moments.
  <br></p>
<p><em>Method of Moments Estimators Using an Unbiased Estimate of Variance</em> (<code>method="mmue"</code>) <br>
  This method of estimation is exactly the same as the method of moments
  (<code>method="mme"</code>), except that the unbiased estimator of variance (equation (3))
  is used in place of the method of moments one (equation (4)).  This modification is
  given in Cohen (1988, pp.119-120).
  <br></p>
<p><em>Modified Method of Moments Estimation</em> (<code>method="mmme"</code>) <br>
  This method of estimation is described by Cohen (1988, pp.125-132).  It was
  introduced by Cohen and Whitten (1980; their MME-II with r=1) and was further
  investigated by Cohen et al. (1985).  It is motivated by the fact that the first
  order statistic in the sample, \(x_{(1)}\), contains more information about
  the threshold parameter \(\gamma\) than any other observation and often more
  information than all of the other observations combined (Cohen, 1988, p.125).</p>
<p>The first two sets of equations are the same as for the modified method of moments
  estimators (<code>method="mmme"</code>), i.e., equations (14) and (15) with the
  unbiased estimator of variance (equation (3)) used in place of the method of
  moments one (equation (4)).  The third equation replaces equation (16)
  by equating a function of the first order statistic with its expected value:
  $$log(x_{(1)} - \gamma) = \mu + \sigma E[Z_{(1,n)}] \;\;\;\; (26)$$
  where \(E[Z_{(i,n)}]\) denotes the expected value of the \(i\)'th order
  statistic in a random sample of \(n\) observations from a standard normal
  distribution.  (See the help file for <code><a href="evNormOrdStats.html">evNormOrdStats</a></code> for information
  on how \(E[Z_{(i,n)}]\) is computed.)  Using equations (17) and (18),
  equation (26) can be rewritten as:
  $$x_{(1)} = \gamma + \beta exp\{\sqrt{log(\omega)} \, E[Z_{(i,n)}] \} \;\;\;\; (27)$$
  Combining equations (14), (15), (17), (18), and (27) yields the following equation
  for the estimate of \(\omega\):
  $$\frac{s^2}{[\bar{x} - x_{(1)}]^2} = \frac{\hat{\omega}(\hat{\omega} - 1)}{[\sqrt{\hat{\omega}} - exp\{\sqrt{log(\omega)} \, E[Z_{(i,n)}] \} ]^2} \;\;\;\; (28)$$
  After equation (28) is solved for \(\hat{\omega}\), the estimate of \(\sigma\)
  is again computed using equation (23), and the estimate of \(\mu\) is computed
  using equation (24), where the unbiased estimate of variaince is used in place of
  the biased one (just as for <code>method="mmue"</code>).
  <br></p>
<p><em>Zero-Skewness Estimation</em> (<code>method="zero.skew"</code>) <br>
  This method of estimation was introduced by Griffiths (1980), and elaborated upon
  by Royston (1992b).  The idea is that if the threshold parameter \(\gamma\) were
  known, then the distribution of:
  $$Y = log(X - \gamma) \;\;\;\; (29)$$
  is normal, so the skew of \(Y\) is 0.  Thus, the threshold parameter \(\gamma\)
  is estimated as that value that forces the sample skew (defined in equation (19)) of
  the observations defined in equation (6) to be 0.  That is, the zero-skewness
  estimator of \(\gamma\) is the value that satisfies the following equation:
  $$0 = \frac{\frac{1}{n} \sum_{i=1}^n (y_i - \bar{y})^3}{[\frac{1}{n} \sum_{i=1}^n (y_i - \bar{y})^2]^{3/2}} \;\;\;\; (30)$$
  where
  $$y_i = log(x_i - \hat{\gamma}) \;\;\;\; (31)$$
  Note that since the denominator in equation (30) is always positive (assuming
  there are at least two unique values in \(\underline{x}\)), only the numerator
  needs to be used to determine the value of \(\hat{\gamma}\).</p>
<p>Once the value of \(\hat{\gamma}\) has been determined, \(\mu\) and \(\sigma\)
  are estimated using equations (7) and (8), except the unbiased estimator of variance
  is used in equation (8).</p>
<p>Royston (1992b) developed a modification of the Shaprio-Wilk goodness-of-fit test
  for normality based on tranforming the data using equation (6) and the zero-skewness
  estimator of \(\gamma\) (see <code><a href="gofTest.html">gofTest</a></code>).
  <br></p>
<p><em>Estimators Based on Royston's Index of Skewness</em> (<code>method="royston.skew"</code>) <br>
  This method of estimation is discussed by Royston (1992b), and is similar to the
  zero-skewness method discussed above, except a different measure of skewness is used.
  Royston's (1992b) index of skewness is given by:
  $$q = \frac{y_{(n)} - \tilde{y}}{\tilde{y} - y_{(1)}} \;\;\;\; (32)$$
  where \(y_{(i)}\) denotes the \(i\)'th order statistic of \(y\) and \(y\)
  is defined in equation (31) above, and \(\tilde{y}\) denotes the median of \(y\).
  Royston (1992b) shows that the value of \(\gamma\) that yields a value of
  \(q=0\) is given by:
  $$\hat{\gamma} = \frac{y_{(1)}y_{(n)} - \tilde{y}^2}{y_{(1)} + y_{(n)} - 2\tilde{y}} \;\;\;\; (33)$$
  Again, as for the zero-skewness method, once the value of \(\hat{\gamma}\) has
  been determined, \(\mu\) and \(\sigma\) are estimated using equations (7) and (8),
  except the unbiased estimator of variance is used in equation (8).</p>
<p>Royston (1992b) developed this estimator as a quick way to estimate \(\gamma\).
  <br></p>
<p><b>Confidence Intervals</b> <br>
  This section explains three different methods for constructing confidence intervals
  for the threshold parameter \(\gamma\), or the median of the three-parameter
  lognormal distribution, which is given by:
  $$Med[X] = \gamma + exp(\mu) = \gamma + \beta \;\;\;\; (34)$$
  <br></p>
<p><em>Normal Approximation Based on Asymptotic Variances and Covariances</em> (<code>ci.method="avar"</code>) <br>
  Formulas for asymptotic variances and covariances for the three-parameter lognormal
  distribution, based on the information matrix, are given in Cohen (1951), Cohen and
  Whitten (1980), Cohen et al., (1985), and Cohen (1988).  The relevant quantities for
  \(\gamma\) and the median are:
  $$Var(\hat{\gamma}) = \sigma^2_{\hat{\gamma}} = \frac{\sigma^2}{n} \, (\frac{\beta^2}{\omega}) H \;\;\;\; (35)$$
  $$Var(\hat{\beta}) = \sigma^2_{\hat{\beta}} = \frac{\sigma^2}{n} \, \beta^2 (1 + H) \;\;\;\; (36)$$
  $$Cov(\hat{\gamma}, \hat{\beta}) = \sigma_{\hat{\gamma}, \hat{\beta}} = \frac{-\sigma^3}{n} \, (\frac{\beta^2}{\sqrt{\omega}}) H \;\;\;\; (37)$$
  where
  $$H = [\omega (1 + \sigma^2) - 2\sigma^2 - 1]^{-1} \;\;\;\; (38)$$
  A two-sided \((1-\alpha)100\%\) confidence interval for \(\gamma\) is computed as:
  $$\hat{\gamma} - t_{n-2, 1-\alpha/2} \hat{\sigma}_{\hat{\gamma}}, \, \hat{\gamma} + t_{n-2, 1-\alpha/2} \hat{\sigma}_{\hat{\gamma}} \;\;\;\; (39)$$
  where \(t_{\nu, p}\) denotes the \(p\)'th quantile of
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(n\) degrees of freedom, and the
  quantity \(\hat{\sigma}_{\hat{\gamma}}\) is computed using equations (35) and (38)
  and substituting estimated values of \(\beta\), \(\omega\), and \(\sigma\).
  One-sided confidence intervals are computed in a similar manner.</p>
<p>A two-sided \((1-\alpha)100\%\) confidence interval for the median (see equation
  (34) above) is computed as:
  $$\hat{\gamma} + \hat{\beta} - t_{n-2, 1-\alpha/2} \hat{\sigma}_{\hat{\gamma} + \hat{\beta}}, \, \hat{\gamma} + \hat{\beta} + t_{n-2, 1-\alpha/2} \hat{\sigma}_{\hat{\gamma} + \hat{\beta}} \;\;\;\; (40)$$
  where
  $$\hat{\sigma}^2_{\hat{\gamma} + \hat{\beta}} = \hat{\sigma}^2_{\hat{\gamma}} + \hat{\sigma}^2_{\hat{\beta}} + \hat{\sigma}_{\hat{\gamma}, \hat{\beta}} \;\;\;\; (41)$$
  is computed using equations (35)-(38) and substituting estimated values of
  \(\beta\), \(\omega\), and \(\sigma\).  One-sided confidence intervals are
  computed in a similar manner.</p>
<p>This method of constructing confidence intervals is analogous to using the Wald test
  (e.g., Silvey, 1975, pp.115-118) to test hypotheses on the parameters.</p>
<p>Because of the regularity problems associated with the global maximum likelihood
  estimators, it is questionble whether the asymptotic variances and covariances shown
  above apply to local maximum likelihood estimators.  Simulation studies, however,
  have shown that these estimates of variance and covariance perform reasonably well
  (Harter and Moore, 1966; Cohen and Whitten, 1980).</p>
<p>Note that this method of constructing confidence intervals can be used with
  estimators other than the lmle's.  Cohen and Whitten (1980) and Cohen et al. (1985)
  found that the asymptotic variances and covariances are reasonably close to
  corresponding simulated variances and covariances for the modified method of moments
  estimators (<code>method="mmme"</code>).
  <br></p>
<p><em>Likelihood Profile</em> (<code>ci.method="likelihood.profile"</code>) <br>
  Griffiths (1980) suggested constructing confidence intervals for the threshold
  parameter \(\gamma\) based on the profile likelihood function given in equations
  (9) and (10).  Royston (1992b) further elaborated upon this procedure.  A
  two-sided \((1-\alpha)100\%\) confidence interval for \(\eta\) is constructed as:
  $$[\eta_{LCL}, \eta_{UCL}] \;\;\;\; (42)$$
  by finding the two values of \(\eta\) (one larger than the lmle of \(\eta\) and
  one smaller than the lmle of \(\eta\)) that satisfy:
  $$log[L(\eta)] = log[L(\hat{\eta}_{lmle})] - \frac{1}{2} \chi^2_{1, \alpha/2} \;\;\;\; (43)$$
  where \(\chi^2_{\nu, p}\) denotes the \(p\)'th quantile of the
  <a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">chi-square distribution</a> with \(\nu\) degrees of freedom.
  Once these values are found, the two-sided confidence for \(\gamma\) is computed as:
  $$[\gamma_{LCL}, \gamma_{UCL}] \;\;\;\; (44)$$
  where
  $$\gamma_{LCL} = x_{(1)} - exp(-\eta_{LCL}) \;\;\;\; (45)$$
  $$\gamma_{UCL} = x_{(1)} - exp(-\eta_{UCL}) \;\;\;\; (46)$$
  One-sided intervals are construced in a similar manner.</p>
<p>This method of constructing confidence intervals is analogous to using the
  likelihood-ratio test (e.g., Silvey, 1975, pp.108-115) to test hypotheses on the
  parameters.</p>
<p>To construct a two-sided \((1-\alpha)100\%\) confidence interval for the median
  (see equation (34)), Royston (1992b) suggested the following procedure:</p><ol><li><p>Construct a confidence interval for \(\gamma\) using the likelihood
      profile procedure.</p></li>
<li><p>Construct a confidence interval for \(\beta\) as:
    $$[\beta_{LCL}, \beta_{UCL}] = [exp(\hat{\mu} - t_{n-2, 1-\alpha/2} \frac{\hat{\sigma}}{n}), \, exp(\hat{\mu} + t_{n-2, 1-\alpha/2} \frac{\hat{\sigma}}{n})] \;\;\;\; (47)$$</p></li>
<li><p>Construct the confidence interval for the median as:
    $$[\gamma_{LCL} + \beta_{LCL}, \gamma_{UCL} + \beta_{UCL}] \;\;\;\; (48)$$</p></li>
</ol><p>Royston (1992b) actually suggested using the quantile from the standard normal
  distribution instead of Student's t-distribution in step 2 above.  The function
  <code>elnorm3</code>, however, uses the Student's t quantile.</p>
<p>Note that this method of constructing confidence intervals can be used with
  estimators other than the lmle's.
  <br></p>
<p><em>Royston's Confidence Interval Based on Significant Skewness</em> (<code>ci.method="skewness"</code>) <br>
  Royston (1992b) suggested constructing confidence intervals for the threshold
  parameter \(\gamma\) based on the idea behind the zero-skewness estimator
  (<code>method="zero.skew"</code>).  A two-sided \((1-\alpha)100\%\) confidence interval
  for \(\gamma\) is constructed by finding the two values of \(\gamma\) that yield
  a p-value of \(\alpha/2\) for the test of zero-skewness on the observations
  \(\underline{y}\) defined in equation (6) (see <code><a href="gofTest.html">gofTest</a></code>).  One-sided
  confidence intervals are constructed in a similar manner.</p>
<p>To construct \((1-\alpha)100\%\) confidence intervals for the median
  (see equation (34)), the exact same procedure is used as for
  <code>ci.method="likelihood.profile"</code>, except that the confidence interval for
  \(\gamma\) is based on the zero-skewness method just described instead of the
  likelihood profile method.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"estimate"</code> containing the estimated parameters and other information.
  See <br><code><a href="estimate.object.html">estimate.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Aitchison, J., and J.A.C. Brown (1957).  <em>The Lognormal Distribution
  (with special references to its uses in economics)</em>.  Cambridge University Press,
  London, Chapter 5.</p>
<p>Calitz, F. (1973).  Maximum Likelihood Estimation of the Parameters of the
  Three-Parameter Lognormal Distribution–a Reconsideration.  <em>Australian
  Journal of Statistics</em> <b>15</b>(3), 185–190.</p>
<p>Cohen, A.C. (1951).  Estimating Parameters of Logarithmic-Normal Distributions by
  Maximum Likelihood.  <em>Journal of the American Statistical Association</em>
  <b>46</b>, 206–212.</p>
<p>Cohen, A.C. (1988).  Three-Parameter Estimation.  In Crow, E.L., and K. Shimizu, eds.
  <em>Lognormal Distributions: Theory and Applications</em>.  Marcel Dekker, New York,
  Chapter 4.</p>
<p>Cohen, A.C., and B.J. Whitten. (1980).  Estimation in the Three-Parameter Lognormal
  Distribution.  <em>Journal of the American Statistical Association</em> <b>75</b>,
  399–404.</p>
<p>Cohen, A.C., B.J. Whitten, and Y. Ding. (1985).  Modified Moment Estimation for the
  Three-Parameter Lognormal Distribution.  <em>Journal of Quality Technology</em>
  <b>17</b>, 92–99.</p>
<p>Crow, E.L., and K. Shimizu. (1988).  <em>Lognormal Distributions: Theory and
  Applications</em>.  Marcel Dekker, New York, Chapter 2.</p>
<p>Griffiths, D.A. (1980).  Interval Estimation for the Three-Parameter Lognormal
  Distribution via the Likelihood Function.  <em>Applied Statistics</em> <b>29</b>,
  58–68.</p>
<p>Harter, H.L., and A.H. Moore. (1966).  Local-Maximum-Likelihood Estimation of the
  Parameters of Three-Parameter Lognormal Populations from Complete and Censored
  Samples.  <em>Journal of the American Statistical Association</em> <b>61</b>, 842–851.</p>
<p>Heyde, C.C. (1963).  On a Property of the Lognormal Distribution.  <em>Journal of
  the Royal Statistical Society, Series B</em> <b>25</b>, 392–393.</p>
<p>Hill, .B.M. (1963).  The Three-Parameter Lognormal Distribution and Bayesian
  Analysis of a Point-Source Epidemic.  <em>Journal of the American Statistical
  Association</em> <b>58</b>, 72–84.</p>
<p>Hoshi, K., J.R. Stedinger, and J. Burges. (1984).  Estimation of Log-Normal
  Quantiles: Monte Carlo Results and First-Order Approximations.  <em>Journal of
  Hydrology</em> <b>71</b>, 1–30.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1994).
  <em>Continuous Univariate Distributions, Volume 1</em>.
  Second Edition. John Wiley and Sons, New York.</p>
<p>Royston, J.P. (1992b).  Estimation, Reference Ranges and Goodness of Fit for the
  Three-Parameter Log-Normal Distribution.  <em>Statistics in Medicine</em> <b>11</b>,
  897–912.</p>
<p>Stedinger, J.R. (1980).  Fitting Lognormal Distributions to Hydrologic Data.
  <em>Water Resources Research</em> <b>16</b>(3), 481–490.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The problem of estimating the parameters of a three-parameter lognormal distribution
  has been extensively discussed by Aitchison and Brown (1957, Chapter 6),
  Calitz (1973), Cohen (1951), Cohen (1988), Cohen and Whitten (1980),
  Cohen et al. (1985), Griffiths (1980), Harter and Moore (1966), Hill (1963), and
  Royston (1992b).  Stedinger (1980) and Hoshi et al. (1984) discuss fitting the
  three-parameter lognormal distribution to hydrologic data.</p>
<p>The global maximum likelihood estimates are inadmissible.  In the past, several
  researchers have found that the local maximum likelihood estimates (lmle's)
  occasionally fail because of convergence problems, but they were not using the
  likelihood profile and reparameterization of Griffiths (1980).  Cohen (1988)
  recommends the modified methods of moments estimators over lmle's because they are
  easy to compute, they are unbiased with respect to \(\mu\) and \(\sigma^2\) (the
  mean and standard deviation on the log-scale), their variances are minimal or near
  minimal, and they do not suffer from regularity problems.</p>
<p>Because the distribution of the lmle of the threshold parameter \(\gamma\) is far
  from normal for moderate sample sizes (Griffiths, 1980), it is questionable whether
  confidence intervals for \(\gamma\) or the median based on asymptotic variances
  and covariances will perform well.  Cohen and Whitten (1980) and Cohen et al. (1985),
  however, found that the asymptotic variances and covariances are reasonably close to
  corresponding simulated variances and covariances for the modified method of moments
  estimators (<code>method="mmme"</code>).  In a simulation study (5000 monte carlo trials),
  Royston (1992b) found that the coverage of confidence intervals for \(\gamma\)
  based on the likelihood profile (<code>ci.method="likelihood.profile"</code>) was very
  close the nominal level (94.1% for a nominal level of 95%), although not
  symmetric.  Royston (1992b) also found that the coverage of confidence intervals
  for \(\gamma\) based on the skewness method (<code>ci.method="skewness"</code>) was also
  very close (95.4%) and symmetric.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="Lognormal3.html">Lognormal3</a>, <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">Lognormal</a>, <a href="LognormalAlt.html">LognormalAlt</a>,
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a 3-parameter lognormal distribution </span></span></span>
<span class="r-in"><span>  <span class="co"># with parameters meanlog=1.5, sdlog=1, and threshold=10, then use </span></span></span>
<span class="r-in"><span>  <span class="co"># Cohen and Whitten's (1980) modified moments estimators to estimate </span></span></span>
<span class="r-in"><span>  <span class="co"># the parameters, and construct a confidence interval for the </span></span></span>
<span class="r-in"><span>  <span class="co"># threshold based on the estimated asymptotic variance. </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="Lognormal3.html">rlnorm3</a></span><span class="op">(</span><span class="fl">20</span>, meanlog <span class="op">=</span> <span class="fl">1.5</span>, sdlog <span class="op">=</span> <span class="fl">1</span>, threshold <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"mmme"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "3-Parameter Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.5206664 0.5330974 9.6620403 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mmme"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "threshold"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6.985258 12.338823 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Approximation\n                                 Based on Asymptotic Variance"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            3-Parameter Lognormal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          meanlog   = 1.5206664</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sdlog     = 0.5330974</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 threshold = 9.6620403</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mmme</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         threshold</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Based on Asymptotic Variance</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =  6.985258</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 12.338823</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the above example using the other methods of estimation </span></span></span>
<span class="r-in"><span>  <span class="co"># and compare. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, <span class="st">"lmle"</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span>, <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.3       0.7      10.5 </span>
<span class="r-in"><span>  <span class="co">#meanlog     sdlog threshold </span></span></span>
<span class="r-in"><span>  <span class="co">#    1.3       0.7      10.5 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, <span class="st">"mme"</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span>, <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2.1       0.3       6.0 </span>
<span class="r-in"><span>  <span class="co">#meanlog     sdlog threshold </span></span></span>
<span class="r-in"><span>  <span class="co">#    2.1       0.3       6.0 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, <span class="st">"mmue"</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span>, <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2.2       0.3       5.8 </span>
<span class="r-in"><span>  <span class="co">#meanlog     sdlog threshold </span></span></span>
<span class="r-in"><span>  <span class="co">#    2.2       0.3       5.8 </span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, <span class="st">"mmme"</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span>, <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.5       0.5       9.7 </span>
<span class="r-in"><span>  <span class="co">#meanlog     sdlog threshold </span></span></span>
<span class="r-in"><span>  <span class="co">#    1.5       0.5       9.7 </span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, <span class="st">"zero.skew"</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span>, <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.3       0.6      10.3 </span>
<span class="r-in"><span>  <span class="co">#meanlog     sdlog threshold </span></span></span>
<span class="r-in"><span>  <span class="co">#    1.3       0.6      10.3 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, <span class="st">"royston"</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.4       0.6      10.1 </span>
<span class="r-in"><span>  <span class="co">#meanlog     sdlog threshold </span></span></span>
<span class="r-in"><span>  <span class="co">#    1.4       0.6      10.1 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare methods for computing a two-sided 95% confidence interval </span></span></span>
<span class="r-in"><span>  <span class="co"># for the threshold: </span></span></span>
<span class="r-in"><span>  <span class="co"># modified method of moments estimator using asymptotic variance, </span></span></span>
<span class="r-in"><span>  <span class="co"># lmle using asymptotic variance, </span></span></span>
<span class="r-in"><span>  <span class="co"># lmle using likelihood profile, and </span></span></span>
<span class="r-in"><span>  <span class="co"># zero-skewness estimator using the skewness method.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"mmme"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"avar"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6.985258 12.338823 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co"># 6.985258 12.338823 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"lmle"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"avar"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9.017223 11.980107 </span>
<span class="r-in"><span>  <span class="co">#       LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#  9.017223 11.980107 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"lmle"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>    ci.method<span class="op">=</span><span class="st">"likelihood.profile"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3.699989 11.266030 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co"># 3.699989 11.266029 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"zero.skew"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"skewness"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -25.18851  11.18652 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#-25.18851  11.18652</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now construct a confidence interval for the median of the distribution </span></span></span>
<span class="r-in"><span>  <span class="co"># based on using the modified method of moments estimator for threshold </span></span></span>
<span class="r-in"><span>  <span class="co"># and the asymptotic variances and covariances.  Note that the true median </span></span></span>
<span class="r-in"><span>  <span class="co"># is given by threshold + exp(meanlog) = 10 + exp(1.5) = 14.48169.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"mmme"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.parameter <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "3-Parameter Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   meanlog     sdlog threshold </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.5206664 0.5330974 9.6620403 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mmme"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "median"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.20541 17.26922 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal Approximation\n                                 Based on Asymptotic Variance"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            3-Parameter Lognormal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          meanlog   = 1.5206664</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sdlog     = 0.5330974</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 threshold = 9.6620403</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mmme</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         median</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Normal Approximation</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Based on Asymptotic Variance</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 11.20541</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 17.26922</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare methods for computing a two-sided 95% confidence interval </span></span></span>
<span class="r-in"><span>  <span class="co"># for the median: </span></span></span>
<span class="r-in"><span>  <span class="co"># modified method of moments estimator using asymptotic variance, </span></span></span>
<span class="r-in"><span>  <span class="co"># lmle using asymptotic variance, </span></span></span>
<span class="r-in"><span>  <span class="co"># lmle using likelihood profile, and </span></span></span>
<span class="r-in"><span>  <span class="co"># zero-skewness estimator using the skewness method.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"mmme"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.parameter <span class="op">=</span> <span class="st">"median"</span>, </span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"avar"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.20541 17.26922 </span>
<span class="r-in"><span>  <span class="co">#     LCL      UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#11.20541 17.26922 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"lmle"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.parameter <span class="op">=</span> <span class="st">"median"</span>, </span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"avar"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.28326 15.87233 </span>
<span class="r-in"><span>  <span class="co">#     LCL      UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#12.28326 15.87233 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"lmle"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.parameter <span class="op">=</span> <span class="st">"median"</span>, </span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"likelihood.profile"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6.314583 16.165526 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co"># 6.314583 16.165525 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">elnorm3</span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">"zero.skew"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.parameter <span class="op">=</span> <span class="st">"median"</span>, </span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"skewness"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -22.38322  16.33569 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#-22.38322  16.33569</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

