<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Parameters of a Lognormal Distribution (Original Scale) — elnormAlt • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Parameters of a Lognormal Distribution (Original Scale) — elnormAlt"><meta property="og:description" content="Estimate the mean and coefficient of variation of a 
  lognormal distribution, and optionally construct a 
  confidence interval for the mean."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Parameters of a Lognormal Distribution (Original Scale)</h1>
    
    <div class="hidden name"><code>elnormAlt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the mean and coefficient of variation of a 
  <a href="LognormalAlt.html">lognormal distribution</a>, and optionally construct a 
  confidence interval for the mean.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">elnormAlt</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"mvue"</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, ci.type <span class="op">=</span> <span class="st">"two-sided"</span>, </span>
<span>    ci.method <span class="op">=</span> <span class="st">"land"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, parkin.list <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>numeric vector of positive observations.</p></dd>

  <dt>method</dt>
<dd><p>character string specifying the method of estimation.  Possible values are 
  <code>"mvue"</code> (minimum variance unbiased; the default), <code>"qmle"</code> 
  (quasi maximum likelihood), <code>"mle"</code> (maximum likelihood), <code>"mme"</code> 
  (method of moments), and <code>"mmue"</code> (method of moments based on the unbiased 
  estimate of variance).  See the DETAILS section for more information on these 
  estimation methods.</p></dd>

  <dt>ci</dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for the 
  mean.  The default value is <code>FALSE</code>.</p></dd>

  <dt>ci.type</dt>
<dd><p>character string indicating what kind of confidence interval to compute.  The 
  possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
  <code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt>ci.method</dt>
<dd><p>character string indicating what method to use to construct the confidence interval 
  for the mean.  The possible values are <code>"land"</code> (Land's method; the default), 
  <code>zou</code> (Zou et al.'s method), <code>"parkin"</code> (Parkin et al.'s method), 
  <code>"cox"</code> (Cox's approximation), and <code>"normal.approx"</code> (normal approximation).  
  See the DETAILS section for more information.  This argument is ignored if 
  <code>ci=FALSE</code>.</p></dd>

  <dt>conf.level</dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.  
  The default value is <code>conf.level=0.95</code>. This argument is ignored if 
  <code>ci=FALSE</code>.</p></dd>

  <dt>parkin.list</dt>
<dd><p>a list containing arguments for the function <code><a href="eqnpar.html">eqnpar</a></code>.  The components 
  of this list are <code>lcl.rank</code> (set to <code>NULL</code> by default), <code>ucl.rank</code> 
  (set to <code>NULL</code> by default), <code>ci.method</code> (set to <code>"exact"</code> if the 
  sample size is \(\le 20\), otherwise set to <br><code>"normal.approx"</code>), and 
  <code>approx.conf.level</code> (set to the value of <code>conf.level</code>).  This argument is 
  ignored unless <code>ci=TRUE</code> and <code>ci.method="parkin"</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or 
  infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to 
  performing the estimation.</p>
<p>Let \(\underline{x}\) be a vector of \(n\) observations from a  
  <a href="LognormalAlt.html">lognormal distribution</a> with 
  parameters <code>mean=</code>\(\theta\) and <code>cv=</code>\(\tau\).  Let \(\eta\) denote the 
  standard deviation of this distribution, so that \(\eta = \theta \tau\).  Set 
  \(\underline{y} = log(\underline{x})\).  Then \(\underline{y}\) is a vector of observations 
  from a normal distribution with parameters <code>mean=</code>\(\mu\) and <code>sd=</code>\(\sigma\).  
  See the help file for <a href="LognormalAlt.html">LognormalAlt</a> for the relationship between 
  \(\theta, \tau, \eta, \mu\), and \(\sigma\).</p>
<p><b>Estimation</b> <br>
  This section explains how each of the estimators of <code>mean=</code>\(\theta\) and 
  <code>cv=</code>\(\tau\) are computed.  The approach is to first compute estimates of 
  \(\theta\) and \(\eta^2\) (the mean and variance of the lognormal distribution), 
  say \(\hat{\theta}\) and \(\hat{\eta}^2\), then compute the estimate of the cv 
  \(\tau\) by \(\hat{\tau} = \hat{\eta}/\hat{\theta}\).</p>
<p><em>Minimum Variance Unbiased Estimation</em> (<code>method="mvue"</code>) <br>
  The minimum variance unbiased estimators (mvue's) of \(\theta\) and \(\eta^2\) were derived 
  by Finney (1941) and are discussed in Gilbert (1987, pp. 164-167) and Cohn et al. (1989).  These 
  estimators are computed as:
  $$\hat{\theta}_{mvue} = e^{\bar{y}} g_{n-1}(\frac{s^2}{2}) \;\;\;\; (1)$$
  $$\hat{\eta}^2_{mvue} = e^{2 \bar{y}} \{g_{n-1}(2s^2) - g_{n-1}[\frac{(n-2)s^2}{n-1}]\} \;\;\;\; (2)$$
  where
  $$\bar{y} = \frac{1}{n} \sum_{i=1}^n y_i \;\;\;\; (3)$$
  $$s^2 = \frac{1}{n-1} \sum_{i=1}^n (y_i - \bar{y})^2 \;\;\;\; (4)$$
  $$g_m(z) = \sum_{i=0}^\infty \frac{m^i (m+2i)}{m(m+2) \cdots (m+2i)} (\frac{m}{m+1})^i (\frac{z^i}{i!}) \;\;\;\; (5)$$</p>
<p>The expected value and variance of the mvue of \(\theta\) are 
  (Bradu and Mundlak, 1970; Cohn et al., 1989):
  $$E[\hat{\theta}_{mvue}] = \theta \;\;\;\; (6)$$
  $$Var[\hat{\theta}_{mvue}] = e^{2\mu} \{e^{[(2+n-1)\sigma^2]/n} g_{n-1}(\frac{\sigma^4}{4n}) - e^{\sigma^2} \} \;\;\;\; (7)$$</p>
<p><em>Maximum Likelihood Estimation</em> (<code>method="mle"</code>) <br>
  The maximum likelihood estimators (mle's) of \(\theta\) and \(\eta^2\) are given by:
  $$\hat{\theta}_{mle} = exp(\bar{y} + \frac{\hat{\sigma}^2_{mle}}{2})  \;\;\;\; (8)$$
  $$\hat{\eta}^2_{mle} = \hat{\theta}^2_{mle} \hat{\tau}^2_{mle} \;\;\;\; (9)$$
  where
  $$\hat{\tau}^2_{mle} = exp(\hat{\sigma}^2_{mle}) - 1 \;\;\;\; (10)$$
  $$\hat{\sigma}^2_{mle} = \frac{n-1}{n} s^2 \;\;\;\; (11)$$</p>
<p>The expected value and variance of the mle of \(\theta\) are (after Cohn et al., 1989):
  $$E[\hat{\theta}_{mle}] = \theta exp[\frac{-(n-1)\sigma^2}{2n}] (1 - \frac{\sigma^2}{n})^{-(n-1)/2} \;\;\;\; (12)$$
  $$Var[\hat{\theta}_{mle}] = exp(2\mu + \frac{\sigma^2}{n}) \{exp(\frac{\sigma^2}{n}) [1 - \frac{2\sigma^2}{n}]^{-(n-1)/2} - [1 - \frac{\sigma^2}{n}]^{-(n-1)} \} \;\;\;\; (13)$$
  As can be seen from equation (12), the expected value of the mle of \(\theta\) does not exist 
  when \(\sigma^2 &gt; n\).  In general, the \(p\)'th moment of the mle of \(\theta\) does not 
  exist when \(\sigma^2 &gt; n/p\).</p>
<p><em>Quasi Maximum Likelihood Estimation</em> (<code>method="qmle"</code>) <br> 
  The quasi maximum likelihood estimators (qmle's; Cohn et al., 1989; Gilbert, 1987, p.167) of 
  \(\theta\) and \(\eta^2\) are the same as the mle's, except the mle of 
  \(\sigma^2\) in equations (8) and (10) is replaced with the more commonly used 
  mvue of \(\sigma^2\) shown in equation (4):
  $$\hat{\theta}_{qmle} = exp(\bar{y} + \frac{s^2}{2})  \;\;\;\; (14)$$
  $$\hat{\eta}^2_{qmle} = \hat{\theta}^2_{qmle} \hat{\tau}^2_{qmle} \;\;\;\; (15)$$
  $$\hat{\tau}^2_{qmle} = exp(s^2) - 1 \;\;\;\; (16)$$</p>
<p>The expected value and variance of the qmle of \(\theta\) are (Cohn et al., 1989):
  $$E[\hat{\theta}_{mle}] = \theta exp[\frac{-(n-1)\sigma^2}{2n}] (1 - \frac{\sigma^2}{n-1})^{-(n-1)/2} \;\;\;\; (17)$$
  $$Var[\hat{\theta}_{mle}] = exp(2\mu + \frac{\sigma^2}{n}) \{exp(\frac{\sigma^2}{n}) [1 - \frac{2\sigma^2}{n-1}]^{-(n-1)/2} - [1 - \frac{\sigma^2}{n-1}]^{-(n-1)} \} \;\;\;\; (18)$$
  As can be seen from equation (17), the expected value of the qmle of \(\theta\) does not exist 
  when \(\sigma^2 &gt; (n - 1)\).  In general, the \(p\)'th moment of the mle of \(\theta\) does 
  not exist when \(\sigma^2 &gt; (n - 1)/p\).</p>
<p>Note that Gilbert (1987, p. 167) incorrectly presents equation (12) rather than 
  equation (17) as the expected value of the qmle of \(\theta\).  For large values 
  of \(n\) relative to \(\sigma^2\), however, equations (12) and (17) are 
  virtually identical.</p>
<p><em>Method of Moments Estimation</em> (<code>method="mme"</code>) <br>
  The method of moments estimators (mme's) of \(\theta\) and \(\eta^2\) are found by equating 
  the sample mean and variance with their population values:
  $$\hat{\theta}_{mme} = \bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\; (19)$$
  $$\hat{\eta}_{mme} = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\; (20)$$
  Note that the estimator of variance in equation (20) is biased.</p>
<p>The expected value and variance of the mme of \(\theta\) are:
  $$E[\hat{\theta}_{mme}] = \theta \;\;\;\; (21)$$
  $$Var[\hat{\theta}_{mme}] = \frac{\eta^2}{n} = \frac{1}{n} exp(2\mu + \sigma^2) [exp(\sigma^2)-1] \;\;\;\; (22)$$</p>
<p><em>Method of Moments Estimation Based on the Unbiased Estimate of Variance</em> (<code>method="mmue"</code>) <br>
  These estimators are exactly the same as the method of moments estimators described above, except 
  that the usual unbiased estimate of variance is used:
  $$\hat{\theta}_{mmue} = \bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\; (23)$$
  $$\hat{\eta}_{mmue} = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\; (24)$$
  Since the mmue of \(\theta\) is equivalent to the mme of \(\theta\), so are its mean and varaince.
  <br></p> 
<p><b>Confidence Intervals</b> <br>
  This section explains the different methods for constructing confidence intervals 
  for \(\theta\), the mean of the lognormal distribution.</p>
<p><em>Land's Method</em> (<code>ci.method="land"</code>) <br>
  Land (1971, 1975) derived a method for computing one-sided (lower or upper) 
  uniformly most accurate unbiased confidence intervals for \(\theta\).  A 
  two-sided confidence interval can be constructed by combining an optimal lower 
  confidence limit with an optimal upper confidence limit.  This procedure for 
  two-sided confidence intervals is only asymptotically optimal, but for most 
  purposes should be acceptable (Land, 1975, p.387).</p>
<p>As shown in equation (3) in the help file for <a href="LognormalAlt.html">LognormalAlt</a>, the mean 
  \(\theta\) of a lognormal random variable is related to the mean \(\mu\) and 
  standard deviation \(\sigma\) of the log-transformed random variable by the 
  following relationship:
  $$\theta = e^{\beta} \;\;\;\; (25)$$
  where
  $$\beta = \mu + \frac{\sigma^2}{2} \;\;\;\; (26)$$
  Land (1971) developed confidence bounds for the quantity \(\beta\).  The mvue of 
  \(\beta\) is given by:
  $$\hat{\beta}_{mvue} = \bar{y} + \frac{s^2}{2} \;\;\;\; (27)$$
  Note that \(\hat{\theta}_{qmle} = exp(\hat{\beta}_{mvue})\).  
  The \((1-\alpha)100\%\) two-sided confidence interval for \(\beta\) is 
  given by:
  $$[ \hat{\beta}_{mvue} + s \frac{C_{\alpha/2}}{\sqrt{n-1}}, \;  \hat{\beta}_{mvue} + s \frac{C_{1-\alpha/2}}{\sqrt{n-1}} ] \;\;\;\; (28)$$
  the \((1-\alpha)100\%\) one-sided upper confidence interval for \(\beta\) is 
  given by:
  $$[ -\infty, \;  \hat{\beta}_{mvue} + s \frac{C_{1-\alpha}}{\sqrt{n-1}} ] \;\;\;\; (29)$$
  and the \((1-\alpha)100\%\) one-sided lower confidence interval for \(\beta\) is 
  given by:
  $$[ \hat{\beta}_{mvue} + s \frac{C_{\alpha}}{\sqrt{n-1}}, \;  \infty ] \;\;\;\; (30)$$
  where \(s\) is the estimate of \(\sigma\) (see equation (4) above), and the 
  factor \(C\) is given in tables in Land (1975).</p>
<p>Thus, by equations (25)-(30), the two-sided \((1-\alpha)100\%\) confidence 
  interval for \(\theta\) is given by:
  $$\{\hat{\theta}_{qmle} exp[s \frac{C_{\alpha/2}}{\sqrt{n-1}}], \;  \hat{\theta}_{qmle} exp[s \frac{C_{1-\alpha/2}}{\sqrt{n-1}}] \} \;\;\;\; (31)$$
  the \((1-\alpha)100\%\) one-sided upper confidence interval for \(\theta\) is 
  given by:
  $$\{ 0, \;  \hat{\theta}_{qmle} exp[s \frac{C_{1-\alpha}}{\sqrt{n-1}}] \} \;\;\;\; (32)$$
  and the \((1-\alpha)100\%\) one-sided lower confidence interval for \(\theta\) 
  is given by:
  $$\{\hat{\theta}_{qmle} exp[s \frac{C_{\alpha}}{\sqrt{n-1}} ], \;  \infty \} \;\;\;\; (33)$$</p>
<p>Note that Gilbert (1987, pp. 169-171, 264-265) denotes the quantity \(C\) above as 
  \(H\) and reproduces a subset of Land's (1975) tables.  Some guidance documents 
  (e.g., USEPA, 1992d) refer to this quantity as the \(H\)-statistic.</p> 
<p><em>Zou et al.'s Method</em> (<code>ci.method="zou"</code>) <br>
  Zou et al. (2009) proposed the following approximation for the two-sided 
  \((1-\alpha)100\%\) confidence intervals for \(\theta\).  The lower limit \(LL\) 
  is given by:
  $$LL = \hat{\theta}_{qmle} exp\{ -[\frac{z^2_{1-\alpha/2}s^2}{n} + (\frac{s^2}{2} - \frac{(n-1)s^2}{2\chi^2_{1-\alpha/2, n-1}})^2]^{1/2}\} \;\;\;\; (34)$$
  and the upper limit \(UL\) is given by:
  $$UL = \hat{\theta}_{qmle} exp\{ [\frac{z^2_{1-\alpha/2}s^2}{n} + (\frac{(n-1)s^2}{2\chi^2_{\alpha/2, n-1}} - \frac{s^2}{2})^2]^{1/2}\} \;\;\;\; (35)$$
  where \(z_p\) denotes the \(p\)'th quantile of the standard 
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribuiton</a>, and \(\chi_{p, \nu}\) denotes the 
  \(p\)'th quantile of the <a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">chi-square distribution</a> with 
  \(\nu\) degrees of freedom.  The \((1-\alpha)100\%\) one-sided lower confidence 
  limit and one-sided upper confidence limit are given by equations (34) and (35), 
  respectively, with \(\alpha/2\) replaced by \(\alpha\).</p>
<p><em>Parkin et al.'s Method</em> (<code>ci.method="parkin"</code>) <br>
  This method was developed by Parkin et al. (1990).  It can be shown that the 
  mean of a lognormal distribution corresponds to the \(p\)'th quantile, where
  $$p = \Phi(\frac{\sigma}{2}) \;\;\;\; (36)$$
  and \(\Phi\) denotes the cumulative distribution function of the standard 
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a>.  Parkin et al. (1990) suggested 
  estimating \(p\) by replacing \(\sigma\) in equation (36) with the estimate 
  \(s\) as computed in equation (4).  Once an estimate of \(p\) is obtained, a 
  nonparametric confidence interval can be constructed for \(p\), assuming \(p\) 
  is equal to its estimated value (see <code><a href="eqnpar.html">eqnpar</a></code>).</p> 
<p><em>Cox's Method</em> (<code>ci.method="cox"</code>) <br>
  This method was suggested by Professor D.R. Cox and is illustrated in Land (1972).  
  El-Shaarawi (1989) adapts this method to the case of censored water quality data.  
  Cox's idea is to construct an approximate \((1-\alpha)100\%\) confidence interval 
  for the quantity \(\beta\) defined in equation (26) above assuming the estimate of 
  \(\beta\) is approximately normally distributed, and then exponentiate the 
  confidence limits.  That is, a two-sided \((1-\alpha)100\%\) confidence interval 
  for \(\theta\) is constructed as:
  $$[exp(\hat{\beta} - t_{1-\alpha/2, n-1}\hat{\sigma}_{\hat{\beta}}), \; exp(\hat{\beta} + t_{1-\alpha/2, n-1}\hat{\sigma}_{\hat{\beta}})] \;\;\;\; (37)$$
  where \(t(p, \nu)\) denotes the \(p\)'th quantile of 
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(\nu\) degrees of freedom.  
  Note that this method, unlike the normal approximation method discussed below, 
  guarantees a positive value for the lower confidence limit.  One-sided confidence 
  intervals are computed in a similar fashion.</p>
<p>Define an estimator of \(\beta\) by:
  $$\hat{\beta} = \hat{\mu} + \frac{\hat{\sigma}^2}{2} \;\;\;\; (38)$$
  Then the variance of this estimator is given by:
  $$Var(\hat{\beta}) = Var(\hat{\mu}) + Cov(\hat{\mu}, \hat{\sigma}^2) + \frac{1}{4}Var(\hat{\sigma}^2) \;\;\;\; (39)$$
  The function <code>elnormAlt</code> follows Land (1972) and uses the minimum variance 
  unbiased estimator for \(\beta\) shown in equation (27) above, so the variance and 
  estimated variance of this estimator are:
  $$Var(\hat{\beta}_{mvue}) = \frac{\sigma^2}{n} + \frac{\sigma^4}{2(n-1)} \;\;\;\; (40)$$
  $$\hat{\sigma}^2_{\hat{\beta}} = \frac{s^2}{n} + \frac{s^4}{2(n+1)} \;\;\;\; (41)$$
  Note that El-Shaarawi (1989, equation 5) simply replaces the value of \(s^2\) in 
  equation (41) with some estimator of \(\sigma^2\) (the mle or mvue of 
  \(\sigma^2\)), rather than using the mvue of the variance of \(\beta\) as shown 
  in equation (41).</p>
<p><em>Normal Approximation</em> (<code>ci.method="normal.approx"</code>)
  This method constructs approximate \((1-\alpha)100\%\) confidence intervals for 
  \(\theta\) based on the assumption that the estimator of \(\theta\) is 
  approximately normally distributed.  That is, a two-sided \((1-\alpha)100\%\) 
  confidence interval for \(\theta\) is constructed as:
  $$[\hat{\theta} - t_{1-\alpha/2, n-1}\hat{\sigma}_{\hat{\theta}}, \; \hat{\theta} + t_{1-\alpha/2, n-1}\hat{\sigma}_{\hat{\theta}}] \;\;\;\; (42)$$
  One-sided confidence intervals are computed in a similar fashion.</p>
<p>When <code>method="mvue"</code> is used to estimate \(\theta\), an unbiased estimate of 
  the variance of the estimator of \(\theta\) is used in equation (42) 
  (Bradu and Mundlak, 1970, equation 4.3; Gilbert, 1987, equation 13.5):
  $$\hat{\sigma^2}_{\hat{\theta}} = e^{2\bar{y}} \{[g_{n-1}(\frac{s^2}{2})]^2 - g_{n-1}[\frac{s^2(n-2)}{n-1}] \} \;\;\;\; (43)$$</p>
<p>When <code>method="mle"</code> is used to estimate \(\theta\), the estimate of the 
  variance of the estimator of \(\theta\) is computed by replacing \(\mu\) and 
  \(\sigma^2\) in equation (13) with their mle's:
  $$\hat{\sigma}^2_{\hat{\theta}} = exp(2\bar{y} + \frac{\hat{\sigma}^2_{mle}}{n}) \{exp(\frac{\hat{\sigma}^2_{mle}}{n}) [1 - \frac{2\hat{\sigma}^2_{mle}}{n}]^{-(n-1)/2} - [1 - \frac{\hat{\sigma}^2_{mle}}{n}]^{-(n-1)} \} \;\;\;\; (44)$$</p>
<p>When <code>method="qmle"</code> is used to estimate \(\theta\), the estimate of the 
  variance of the estimator of \(\theta\) is computed by replacing \(\mu\) and 
  \(\sigma^2\) in equation (18) with their mvue's:
  $$\hat{\sigma}^2_{\hat{\theta}} = exp(2\bar{y} + \frac{s^2}{n}) \{exp(\frac{s^2}{n}) [1 - \frac{2 s^2}{n-1}]^{-(n-1)/2} - [1 - \frac{s^2}{n-1}]^{-(n-1)} \} \;\;\;\; (45)$$
  Note that equation (45) is exactly the same as Gilbert's (1987, p. 167) equation 
  13.8a, except that Gilbert (1987) erroneously uses \(n\) where he should use 
  \(n-1\) instead.  For large values of \(n\) relative to \(s^2\), however, 
  this makes little difference.</p>
<p>When <code>method="mme"</code>, the estimate of the variance of the estimator of 
  \(\theta\) is computed by replacing \(eta^2\) in equation (22) with the 
  mme of \(\eta^2\) defined in equation (20):
  $$\hat{\sigma}^2_{\hat{\theta}} = \frac{\hat{\eta}_{mme}^2}{n} = \frac{1}{n^2} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\; (46)$$</p>
<p>When <code>method="mmue"</code>, the estimate of the variance of the estimator of 
  \(\theta\) is computed by replacing \(eta^2\) in equation (22) with the 
  mmue of \(\eta^2\) defined in equation (24):
  $$\hat{\sigma}^2_{\hat{\theta}} = \frac{\hat{\eta}_{mmue}^2}{n} = \frac{1}{n(n-1)} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\; (47)$$</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>a list of class <code>"estimate"</code> containing the estimated parameters and other information.  
  See <br></p>
<p></p>
<p><code><a href="estimate.object.html">estimate.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Aitchison, J., and J.A.C. Brown (1957).  <em>The Lognormal Distribution 
  (with special references to its uses in economics)</em>.  Cambridge University Press, 
  London, Chapter 5.</p>
<p>Armstrong, B.G. (1992).  Confidence Intervals for Arithmetic Means of Lognormally 
  Distributed Exposures.  <em>American Industrial Hygiene Association Journal</em> 
  <b>53</b>, 481--485.</p>
<p>Bradu, D., and Y. Mundlak. (1970).  Estimation in Lognormal Linear Models.  
  <em>Journal of the American Statistical Association</em> <b>65</b>, 198--211.</p>
<p>Cohn, T.A., L.L. DeLong, E.J. Gilroy, R.M. Hirsch, and D.K. Wells. (1989).  
  Estimating Constituent Loads.  <em>Water Resources Research</em> <b>25</b>(5), 
  937--942.</p>
<p>Crow, E.L., and K. Shimizu. (1988).  <em>Lognormal Distributions: Theory and 
  Applications</em>.  Marcel Dekker, New York, Chapter 2.</p>
<p>El-Shaarawi, A.H., and J. Lin. (2007).  Interval Estimation for Log-Normal Mean 
  with Applications to Water Quality.  <em>Environmetrics</em> <b>18</b>, 1--10.</p>
<p>El-Shaarawi, A.H., and R. Viveros. (1997).  Inference About the Mean in 
  Log-Regression with Environmental Applications.  <em>Environmetrics</em> 
  <b>8</b>, 569--582.</p>
<p>Forbes, C., M. Evans, N. Hastings, and B. Peacock. (2011).  Statistical Distributions. 
  Fourth Edition. John Wiley and Sons, Hoboken, NJ.</p>
<p>Finney, D.J. (1941).  On the Distribution of a Variate Whose Logarithm is 
  Normally Distributed.  <em>Supplement to the Journal of the Royal Statistical 
  Society</em> <b>7</b>, 155--161.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>. 
  Van Nostrand Reinhold, New York, NY.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1994). 
  <em>Continuous Univariate Distributions, Volume 1</em>. 
  Second Edition. John Wiley and Sons, New York.</p>
<p>Krishnamoorthy, K., and T.P. Mathew. (2003).  Inferences on the Means of Lognormal 
  Distributions Using Generalized p-Values and Generalized Confidence Intervals.  
  <em>Journal of Statistical Planning and Inference</em> <b>115</b>, 103--121.</p>
<p>Land, C.E. (1971).  Confidence Intervals for Linear Functions of the Normal Mean 
  and Variance.  <em>The Annals of Mathematical Statistics</em> <b>42</b>(4), 1187--1205.</p>
<p>Land, C.E. (1972).  An Evaluation of Approximate Confidence Interval Estimation 
  Methods for Lognormal Means.  <em>Technometrics</em> <b>14</b>(1), 145--158.</p>
<p>Land, C.E. (1973).  Standard Confidence Limits for Linear Functions of the Normal 
  Mean and Variance.  <em>Journal of the American Statistical Association</em> 
  <b>68</b>(344), 960--963.</p>
<p>Land, C.E. (1975).  Tables of Confidence Limits for Linear Functions of the 
  Normal Mean and Variance, in 
  <em>Selected Tables in Mathematical Statistics, Vol. III</em>.  
  American Mathematical Society, Providence, RI, pp. 385--419.</p>
<p>Likes, J. (1980).  Variance of the MVUE for Lognormal Variance. 
  <em>Technometrics</em> <b>22</b>(2), 253--258.</p>
<p>Limpert, E., W.A. Stahel, and M. Abbt. (2001).  Log-Normal Distributions Across the 
  Sciences:  Keys and Clues.  <em>BioScience</em> <b>51</b>, 341--352.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>. 
  CRC Press, Boca Raton, FL.</p>
<p>Ott, W.R. (1995). <em>Environmental Statistics and Data Analysis</em>. 
  Lewis Publishers, Boca Raton, FL.</p>
<p>Parkin, T.B., J.J. Meisinger, S.T. Chester, J.L. Starr, and J.A. Robinson. (1988).  
  Evaluation of Statistical Estimation Methods for Lognormally Distributed Variables.  
  <em>Journal of the Soil Science Society of America</em> <b>52</b>, 323--329.</p>
<p>Parkin, T.B., S.T. Chester, and J.A. Robinson. (1990).  Calculating Confidence 
  Intervals for the Mean of a Lognormally Distributed Variable.  
  <em>Journal of the Soil Science Society of America</em> <b>54</b>, 321--326.</p>
<p>Singh, A., A.K. Singh, and R.J. Iaci. (2002). 
  <em>Estimation of the Exposure Point Concentration Term Using a Gamma Distribution</em>.  
  EPA/600/R-02/084. October 2002. Technology Support Center for Monitoring and 
  Site Characterization, Office of Research and Development, Office of Solid Waste and 
  Emergency Response, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Singh, A., R. Maichle, and N. Armbya. (2010a). 
  <em>ProUCL Version 4.1.00 User Guide (Draft)</em>. EPA/600/R-07/041, May 2010. 
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Singh, A., N. Armbya, and A. Singh. (2010b). 
  <em>ProUCL Version 4.1.00 Technical Guide (Draft)</em>. EPA/600/R-07/041, May 2010.  
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (1992d).  <em>Supplemental Guidance to RAGS: Calculating the Concentration Term</em>.  
  Publication 9285.7-081, May 1992.  Intermittenet Bulletin, Volume 1, Number 1.  
  Office of Emergency and Remedial Response, Hazardous Site Evaluation Division, 
  OS-230. Office of Solid Waste and Emergency Response, 
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zou, G.Y., C.Y. Huo, and J. Taleban. (2009).  Simple Confidence Intervals for 
  Lognormal Means and their Differences with Environmental Applications.  
  <em>Environmetrics</em> <b>20</b>, 172--180.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The normal and lognormal distribution are probably the two most frequently used 
  distributions to model environmental data.  In order to make any kind of 
  probability statement about a normally-distributed population (of chemical 
  concentrations for example), you have to first estimate the mean and standard 
  deviation (the population parameters) of the distribution.  Once you estimate 
  these parameters, it is often useful to characterize the uncertainty in the 
  estimate of the mean or variance.  This is done with confidence intervals.</p>
<p>Some EPA guidance documents (e.g., Singh et al., 2002; Singh et al., 2010a,b) 
  strongly recommend against using a lognormal model for environmental data and 
  recommend trying a gamma distribuiton instead.</p>
<p>USEPA (1992d) directs persons involved in risk assessment for Superfund sites to 
  use Land's (1971, 1975) method (<code>ci.method="land"</code>) for computing the upper 
  95% confidence interval for the mean, assuming the data follow a lognormal 
  distribution (the guidance document cites Gilbert (1987) as a source of descriptions 
  and tables for this method).  The last example in the EXAMPLES section below 
  reproduces an example from this guidance document.</p>
<p>In the past, some authors suggested using the geometric mean, also called the 
  "rating curve" estimator (Cohn et al., 1989), as the estimator of the mean, 
  \(\theta\).  This estimator is computed as:
  $$\hat{\theta}_{rc} = e^{\bar{y}} \;\;\;\; (48)$$
  Cohn et al. (1989) cite several authors who have pointed out this estimator is 
  biased and is not even a consistent estimator of the mean.  In fact, it is the 
  maximum likelihood estimator of the median of the distribution 
  (see <code><a href="eqlnorm.html">eqlnorm</a></code>.)</p>
<p>Finney (1941) computed the efficiency of the method of moments estimators of the 
  mean (\(\theta\)) and variance (\(\eta^2\)) of the lognormal distribution 
  (equations (19)-(20)) relative to the mvue's (equations (1)-(2)) as a function of 
  \(\sigma^2\) (the variance of the log-transformed observations), and found that 
  while the mme of \(\theta\) is reasonably efficient compared to the mvue of 
  \(\theta\), the mme of \(\eta^2\) performs quite poorly relative to the 
  mvue of \(\eta^2\).</p>
<p>Cohn et al. (1989) and Parkin et al. (1988) have shown that the qmle and the mle 
  of the mean can be severely biased for typical environmental data, and suggest 
  always using the mvue.</p>
<p>Parkin et al. (1990) studied the performance of various methods for constructing a 
  confidence interval for the mean via Monte Carlo simulation.  They compared 
  approximate methods to Land's optimal method (<code>ci.method="land"</code>).  They used 
  four parent lognormal distributions to generate observations; all had mean 10, but 
  differed in coefficient of variation: 50, 100, 200, and 500%.  They also generated 
  sample sizes from 6 to 100 in increments of 2.  For each combination of parent 
  distribution and sample size, they generated 25,000 Monte Carlo trials.  
  Parkin et al. found that for small sample sizes (\(n &lt; 20\)), none of the 
  approximate methods (<code>"parkin"</code>, <code>"cox"</code>, <code>"normal.approx"</code>) worked 
  very well. For \(n &gt; 20\), their method (<code>"parkin"</code>) provided reasonably 
  accurate coverage.  Cox's method (<code>"cox"</code>) worked well for \(n &gt; 60\), and 
  performed slightly better than Parkin et al.'s method (<code>"parkin"</code>) for highly 
  skewed populations.</p>
<p>Zou et al. (2009) used Monte Carlo simulation to compare the performance of their 
  method with the CGI method of Krishnamoorthy and Mathew (2003) and 
  the modified Cox method of Armstrong (1992) and El-Shaarawi and Lin (2007).  
  Performance was assessed based on 1) percentage of times the interval contained the 
  parameter value (coverage%), 2) balance between left and right tail errors, and 
  3) confidence interval width.  All three methods showed acceptable coverage 
  percentages.  The modified Cox method showed unbalanced tail errors, and Zou 
  et al.'s method showed consistently narrower average width.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="LognormalAlt.html">LognormalAlt</a>, <a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">Lognormal</a>, <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Using the Reference area TcCB data in the data frame EPA.94b.tccb.df, </span></span></span>
<span class="r-in"><span>  <span class="co"># estimate the mean and coefficient of variation, </span></span></span>
<span class="r-in"><span>  <span class="co"># and construct a 95% confidence interval for the mean.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5989072 0.4899539 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TcCB[Area == \"Reference\"]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5243787 0.7016992 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Land"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Lognormal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 0.5989072</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 cv   = 0.4899539</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            TcCB[Area == "Reference"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     47</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Land</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 0.5243787</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 0.7016992</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare the different methods of estimating the distribution parameters using the </span></span></span>
<span class="r-in"><span>  <span class="co"># Reference area TcCB data.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"mvue"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5989072 0.4899539 </span>
<span class="r-in"><span>  <span class="co">#     mean        cv </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5989072 0.4899539</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"qmle"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6004468 0.4947791 </span>
<span class="r-in"><span>  <span class="co">#     mean        cv </span></span></span>
<span class="r-in"><span>  <span class="co">#0.6004468 0.4947791 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5990497 0.4888968 </span>
<span class="r-in"><span>  <span class="co">#     mean        cv </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5990497 0.4888968 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"mme"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5985106 0.4688423 </span>
<span class="r-in"><span>  <span class="co">#     mean        cv </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5985106 0.4688423 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"mmue"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5985106 0.4739110 </span>
<span class="r-in"><span>  <span class="co">#     mean        cv </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5985106 0.4739110</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare the different methods of constructing the confidence interval for</span></span></span>
<span class="r-in"><span>  <span class="co"># the mean using the Reference area TcCB data.</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"mvue"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.method <span class="op">=</span> <span class="st">"land"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5243787 0.7016992 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5243787 0.7016992</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"mvue"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.method <span class="op">=</span> <span class="st">"zou"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5230444 0.6962071 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5230444 0.6962071 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"mvue"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.method <span class="op">=</span> <span class="st">"parkin"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  LCL  UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.50 0.74 </span>
<span class="r-in"><span>  <span class="co"># LCL  UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#0.50 0.74 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>     method <span class="op">=</span> <span class="st">"mvue"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.method <span class="op">=</span> <span class="st">"cox"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5196213 0.6938444 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5196213 0.6938444 </span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.94b.tccb.df</span>, <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">TcCB</span><span class="op">[</span><span class="va">Area</span> <span class="op">==</span> <span class="st">"Reference"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>     method <span class="op">=</span> <span class="st">"mvue"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.method <span class="op">=</span> <span class="st">"normal.approx"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5130160 0.6847984 </span>
<span class="r-in"><span>  <span class="co">#      LCL       UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#0.5130160 0.6847984 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Reproduce the example in Highlights 7 and 8 of USEPA (1992d).  This example shows </span></span></span>
<span class="r-in"><span>  <span class="co"># how to compute the upper 95% confidence limit of the mean of a lognormal distribution </span></span></span>
<span class="r-in"><span>  <span class="co"># and compares it to the result of computing the upper 95% confidence limit assuming a </span></span></span>
<span class="r-in"><span>  <span class="co"># normal distribution. The data for this example are chromium concentrations (mg/kg) in </span></span></span>
<span class="r-in"><span>  <span class="co"># soil samples collected randomly over a Superfund site, and are stored in the data frame </span></span></span>
<span class="r-in"><span>  <span class="co"># EPA.92d.chromium.vec.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># First look at the data </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.92d.chromium.vec</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   10   13   20   36   41   59   67  110  110  136  140  160  200  230 1300</span>
<span class="r-in"><span>  <span class="co"># [1]   10   13   20   36   41   59   67  110  110  136  140  160  200  230 1300</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="stripChart.html">stripChart</a></span><span class="op">(</span><span class="va">EPA.92d.chromium.vec</span>, ylab <span class="op">=</span> <span class="st">"Chromium (mg/kg)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="elnormAlt-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Note there is one very large "outlier" (1300).  </span></span></span>
<span class="r-in"><span>  <span class="co"># Perform a goodness-of-fit test to determine whether a lognormal distribution </span></span></span>
<span class="r-in"><span>  <span class="co"># is appropriate:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">gof.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">EPA.92d.chromium.vec</span>, dist <span class="op">=</span> <span class="st">'lnormAlt'</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">gof.list</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist.abb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lnormAlt"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution.parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mean         cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159.855185   1.493994 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         W </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.9607179 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  n </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $z.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5384728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7048747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "True cdf does not equal the\n                                 Lognormal Distribution."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Shapiro-Wilk GOF"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   10   13   20   36   41   59   67  110  110  136  140  160  200  230 1300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "EPA.92d.chromium.vec"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gof"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Goodness-of-Fit Test </span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------- </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Method:                     Shapiro-Wilk GOF</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Hypothesized Distribution:       Lognormal </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 159.855185</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 cv   =   1.493994</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            EPA.92d.chromium.vec</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     15</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  W = 0.9607179</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic Parameter:        n = 15</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.7048747</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True cdf does not equal the</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Lognormal Distribution. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gof.list</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="elnormAlt-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The lognormal distribution seems to provide an adequate fit, although the largest </span></span></span>
<span class="r-in"><span>  <span class="co"># observation (1300) is somewhat suspect, and given the small sample size there is </span></span></span>
<span class="r-in"><span>  <span class="co"># not much power to detect any kind of mild deviation from a lognormal distribution.</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Now compute the one-sided 95% upper confidence limit for the mean.  </span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the value of 502 mg/kg shown in Hightlight 7 of USEPA (1992d) is a bit </span></span></span>
<span class="r-in"><span>  <span class="co"># larger than the exact value of 496.6 mg/kg shown below.  </span></span></span>
<span class="r-in"><span>  <span class="co"># This is simply due to rounding error.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">elnormAlt</span><span class="op">(</span><span class="va">EPA.92d.chromium.vec</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Lognormal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mean         cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159.855185   1.493994 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "EPA.92d.chromium.vec"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 496.6282 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Land"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation </span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------------- </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:          Lognormal </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):        mean = 159.855185</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 cv   =   1.493994 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:             mvue </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                          EPA.92d.chromium.vec </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                   15 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:       mean </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:    Land </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:      upper </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:              95% </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:           LCL =   0 </span></span></span>
<span class="r-in"><span>  <span class="co">#                               UCL = 496.6282 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now compare this result with the upper 95% confidence limit based on assuming </span></span></span>
<span class="r-in"><span>  <span class="co"># a normal distribution.  Again note that the value of 325 mg/kg shown in </span></span></span>
<span class="r-in"><span>  <span class="co"># Hightlight 8 is slightly larger than the exact value of 320.3 mg/kg shown below.  </span></span></span>
<span class="r-in"><span>  <span class="co"># This is simply due to rounding error.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="enorm.html">enorm</a></span><span class="op">(</span><span class="va">EPA.92d.chromium.vec</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mean       sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 175.4667 318.5440 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "EPA.92d.chromium.vec"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -Inf 320.3304 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 175.4667</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   = 318.5440</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            EPA.92d.chromium.vec</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     15</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         mean</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =     -Inf</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 320.3304</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">gof.list</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

