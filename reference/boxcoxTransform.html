<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Apply a Box-Cox Power Transformation to a Set of Data — boxcoxTransform • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Apply a Box-Cox Power Transformation to a Set of Data — boxcoxTransform"><meta property="og:description" content="Apply a Box-Cox power transformation to a set of data to attempt to induce
  normality and homogeneity of variance."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply a Box-Cox Power Transformation to a Set of Data</h1>

    <div class="hidden name"><code>boxcoxTransform.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Apply a Box-Cox power transformation to a set of data to attempt to induce
  normality and homogeneity of variance.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boxcoxTransform</span><span class="op">(</span><span class="va">x</span>, <span class="va">lambda</span>, eps <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector of positive numbers.</p></dd>

  <dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>finite numeric scalar indicating what power to use for the
  Box-Cox transformation.</p></dd>

  <dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>finite, positive numeric scalar.  When the absolute value of <code>lambda</code> is less
  than <code>eps</code>, lambda is assumed to be 0 for the Box-Cox transformation.
  The default value is <code>eps=.Machine$double.eps</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Two common assumptions for several standard parametric hypothesis tests are:</p><ol><li><p>The observations all come from a normal distribution.</p></li>
<li><p>The observations all come from distributions with the same variance.</p></li>
</ol><p>For example, the standard one-sample t-test assumes all the observations
  come from the same normal distribution, and the standard two-sample t-test
  assumes that all the observations come from a normal distribution with the same
  variance, although the mean may differ between the two groups.  For standard
  linear regression models, these assumptions can be stated as:  the error terms
  all come from a normal distribution with mean 0 and and a constant variance.</p>
<p>Often, especially with environmental data, the above assumptions do not hold
  because the original data are skewed and/or they follow a distribution that is
  not really shaped like a normal distribution.  It is sometimes possible, however,
  to transform the original data so that the transformed observations in fact come
  from a normal distribution or close to a normal distribution.  The transformation
  may also induce homogeneity of variance and, for the case of a linear regression
  model, a linear relationship between the response and predictor variable(s).</p>
<p>Sometimes, theoretical considerations indicate an appropriate transformation.
  For example, count data often follow a <a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">Poisson distribution</a>,
  and it can be shown that taking the square root of observations from a Poisson
  distribution tends to make these data look more bell-shaped
  (Johnson et al., 1992, p.163; Johnson and Wichern, 2007, p.192; Zar, 2010, p.291).
  A common example in the environmental field is that chemical concentration data
  often appear to come from a <a href="LognormalAlt.html">lognormal distribution</a> or some
  other positively-skewed distribution (e.g., <a href="GammaAlt.html">gamma</a>).
  In this case, taking the logarithm of the observations often appears to yield
  normally distributed data.</p>
<p>Ideally, a data transformation is chosen based on knowledge of the process
  generating the data, as well as graphical tools such as
  <a href="qqPlot.html">quantile-quantile plots</a> and histograms.</p>
<p>Box and Cox (1964) presented a formalized method for deciding on a data
  transformation.  Given a random variable \(X\) from some distribution with
  only positive values, the Box-Cox family of power transformations is defined as:</p><table class="table table"><tr><td>\(Y\)</td><td>=</td><td>\(\frac{X^\lambda - 1}{\lambda}\)</td><td>\(\lambda \ne 0\)</td></tr><tr><td></td><td></td><td>\(log(X)\)</td><td>\(\lambda = 0 \;\;\;\;\;\; (1)\)</td></tr></table><p>where \(Y\) is assumed to come from a normal distribution.  This transformation is
  continuous in \(\lambda\).  Note that this transformation also preserves ordering;
  that is, if \(X_1 &lt; X_2\) then \(Y_1 &lt; Y_2\).</p>
<p>Box and Cox (1964) proposed choosing the appropriate value of \(\lambda\)
  based on maximizing a likelihood function.  See the help file for
  <code><a href="boxcox.html">boxcox</a></code> for details.</p>
<p>Note that for non-zero values of \(\lambda\), instead of using the formula of
  Box and Cox in Equation (1), you may simply use the power transformation:
  $$Y = X^\lambda \;\;\;\;\;\; (2)$$
  since these two equations differ only by a scale difference and origin shift,
  and the essential character of the transformed distribution remains unchanged.</p>
<p>The value \(\lambda=1\) corresponds to no transformation.  Values of
  \(\lambda\) less than 1 shrink large values of \(X\), and are therefore
  useful for transforming positively-skewed (right-skewed) data.  Values of
  \(\lambda\) larger than 1 inflate large values of \(X\), and are therefore
  useful for transforming negatively-skewed (left-skewed) data
  (Helsel and Hirsch, 1992, pp.13-14; Johnson and Wichern, 2007, p.193).
  Commonly used values of \(\lambda\) include 0 (log transformation),
  0.5 (square-root transformation), -1 (reciprocal), and -0.5 (reciprocal root).</p>
<p>It is often recommend that when dealing with several similar data sets, it is best
  to find a common transformation that works reasonably well for all the data sets,
  rather than using slightly different transformations for each data set
  (Helsel and Hirsch, 1992, p.14; Shumway et al., 1989).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>numeric vector of transformed observations.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers, Second Edition</em>.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Box, G.E.P., and D.R. Cox. (1964).  An Analysis of Transformations
  (with Discussion).  <em>Journal of the Royal Statistical Society, Series B</em>
  <b>26</b>(2), 211–252.</p>
<p>Draper, N., and H. Smith. (1998). <em>Applied Regression Analysis</em>. Third Edition.
  John Wiley and Sons, New York, pp.47-53.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution
  Monitoring</em>. Van Nostrand Reinhold, NY.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY.</p>
<p>Hinkley, D.V., and G. Runger. (1984).  The Analysis of Transformed Data
  (with Discussion).  <em>Journal of the American Statistical Association</em>
  <b>79</b>, 302–320.</p>
<p>Hoaglin, D.C., F.M. Mosteller, and J.W. Tukey, eds. (1983).
  <em>Understanding Robust and Exploratory Data Analysis</em>.
  John Wiley and Sons, New York, Chapter 4.</p>
<p>Hoaglin, D.C. (1988).  Transformations in Everyday Experience.
  <em>Chance</em> <b>1</b>, 40–45.</p>
<p>Johnson, N. L., S. Kotz, and A.W. Kemp. (1992).  <em>Univariate
  Discrete Distributions, Second Edition</em>.  John Wiley and Sons, New York,
  p.163.</p>
<p>Johnson, R.A., and D.W. Wichern. (2007).
  <em>Applied Multivariate Statistical Analysis, Sixth Edition</em>.
  Pearson Prentice Hall, Upper Saddle River, NJ, pp.192–195.</p>
<p>Shumway, R.H., A.S. Azari, and P. Johnson. (1989).
  Estimating Mean Concentrations Under Transformations for Environmental
  Data With Detection Limits.  <em>Technometrics</em> <b>31</b>(3), 347–356.</p>
<p>Stoline, M.R. (1991).  An Examination of the Lognormal and Box and Cox
  Family of Transformations in Fitting Environmental Data.
  <em>Environmetrics</em> <b>2</b>(1), 85–106.</p>
<p>van Belle, G., L.D. Fisher, Heagerty, P.J., and Lumley, T. (2004).
  <em>Biostatistics: A Methodology for the Health Sciences, 2nd Edition</em>.
  John Wiley &amp; Sons, New York.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>.
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ,
  Chapter 13.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Data transformations are often used to induce normality, homoscedasticity,
  and/or linearity, common assumptions of parametric statistical tests and
  estimation procedures.  Transformations are not “tricks” used by the
  data analyst to hide what is going on, but rather useful tools for
  understanding and dealing with data (Berthouex and Brown, 2002, p.61).
  Hoaglin (1988) discusses “hidden” transformations that are used everyday,
  such as the pH scale for measuring acidity.</p>
<p>In the case of a linear model, there are at least two approaches to improving
  a model fit:  transform the \(Y\) and/or \(X\) variable(s), and/or use
  more predictor variables.  Often in environmental data analysis, we assume the
  observations come from a lognormal distribution and automatically take
  logarithms of the data.  For a simple linear regression
  (i.e., one predictor variable), if regression diagnostic plots indicate that a
  straight line fit is not adequate, but that the variance of the errors
  appears to be fairly constant, you may only need to transform the predictor
  variable \(X\) or perhaps use a quadratic or cubic model in \(X\).
  On the other hand, if the diagnostic plots indicate that the constant
  variance and/or normality assumptions are suspect, you probably need to consider
  transforming the response variable \(Y\).  Data transformations for
  linear regression models are discussed in Draper and Smith (1998, Chapter 13)
  and Helsel and Hirsch (1992, pp. 228-229).</p>
<p>One problem with data transformations is that translating results on the
  transformed scale back to the original scale is not always straightforward.
  Estimating quantities such as means, variances, and confidence limits in the
  transformed scale and then transforming them back to the original scale
  usually leads to biased and inconsistent estimates (Gilbert, 1987, p.149;
  van Belle et al., 2004, p.400).  For example, exponentiating the confidence
  limits for a mean based on log-transformed data does not yield a
  confidence interval for the mean on the original scale.  Instead, this yields
  a confidence interval for the median (see the help file for <code><a href="elnormAlt.html">elnormAlt</a></code>).
  It should be noted, however, that quantiles (percentiles) and rank-based
  procedures are invariant to monotonic transformations
  (Helsel and Hirsch, 1992, p.12).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="boxcox.html">boxcox</a></code>, <a href="FcnsByCatDataTrans.html">Data Transformations</a>, <a href="FcnsByCatGOFTests.html">Goodness-of-Fit Tests</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 30 observations from a lognormal distribution with </span></span></span>
<span class="r-in"><span>  <span class="co"># mean=10 and cv=2, then look at some normal quantile-quantile </span></span></span>
<span class="r-in"><span>  <span class="co"># plots for various transformations.</span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalAlt.html">rlnormAlt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">10</span>, cv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">x</span>, add.line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="fu">boxcoxTransform</span><span class="op">(</span><span class="va">x</span>, lambda <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, add.line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="fu">boxcoxTransform</span><span class="op">(</span><span class="va">x</span>, lambda <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, add.line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

