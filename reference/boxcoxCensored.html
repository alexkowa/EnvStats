<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Boxcox Power Transformation for Type I Censored Data — boxcoxCensored • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Boxcox Power Transformation for Type I Censored Data — boxcoxCensored"><meta property="og:description" content="Compute the value(s) of an objective for one or more Box-Cox power transformations, 
  or to compute an optimal power transformation based on a specified objective, based on 
  Type I censored data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Boxcox Power Transformation for Type I Censored Data</h1>
    
    <div class="hidden name"><code>boxcoxCensored.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the value(s) of an objective for one or more Box-Cox power transformations, 
  or to compute an optimal power transformation based on a specified objective, based on 
  Type I censored data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">boxcoxCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, censoring.side <span class="op">=</span> <span class="st">"left"</span>, 
    lambda <span class="op">=</span> <span class="op">{</span><span class="kw">if</span> <span class="op">(</span><span class="va">optimize</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">}</span>, optimize <span class="op">=</span> <span class="cn">FALSE</span>, 
    objective.name <span class="op">=</span> <span class="st">"PPCC"</span>, eps <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, 
    include.x.and.censored <span class="op">=</span> <span class="cn">TRUE</span>, prob.method <span class="op">=</span> <span class="st">"michael-schucany"</span>, 
    plot.pos.con <span class="op">=</span> <span class="fl">0.375</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector of positive numbers.  
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>-Inf, Inf</code>) 
  values are allowed but will be removed.</p></dd>
<dt>censored</dt>
<dd><p>numeric or logical vector indicating which values of <code>x</code> are censored.  This must be the 
  same length as <code>x</code>.  If the mode of <code>censored</code> is <code>"logical"</code>, <code>TRUE</code> values 
  correspond to elements of <code>x</code> that are censored, and <code>FALSE</code> values correspond to 
  elements of <code>x</code> that are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>, 
  it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to <code>TRUE</code> and 
  <code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>) values are allowed but will be removed.</p></dd>
<dt>censoring.side</dt>
<dd><p>character string indicating on which side the censoring occurs.  The possible values are 
  <code>"left"</code> (the default) and <code>"right"</code>.</p></dd>
<dt>lambda</dt>
<dd><p>numeric vector of finite values indicating what powers to use for the 
  Box-Cox transformation.  When <code>optimize=FALSE</code>, the default value is <br><code>lambda=seq(-2, 2, by=0.5)</code>.  When <code>optimize=TRUE</code>, <code>lambda</code> 
  must be a vector with two values indicating the range over which the 
  optimization will occur and the range of these two values must include 1.  
  In this case, the default value is <code>lambda=c(-2, 2)</code>.</p></dd>
<dt>optimize</dt>
<dd><p>logical scalar indicating whether to simply evalute the objective function at the 
  given values of <code>lambda</code> (<code>optimize=FALSE</code>; the default), or to compute 
  the optimal power transformation within the bounds specified by 
  <code>lambda</code> (<code>optimize=TRUE</code>).</p></dd>
<dt>objective.name</dt>
<dd><p>character string indicating what objective to use. The possible values are
  <code>"PPCC"</code> (probability plot correlation coefficient; the default), 
  <code>"Shapiro-Wilk"</code> (the Shapiro-Wilk goodness-of-fit statistic), and 
  <code>"Log-Likelihood"</code> (the log-likelihood function).</p></dd>
<dt>eps</dt>
<dd><p>finite, positive numeric scalar.  When the absolute value of <code>lambda</code> is less 
  than <code>eps</code>, lambda is assumed to be 0 for the Box-Cox transformation.  
  The default value is <code>eps=.Machine$double.eps</code>.</p></dd>
<dt>include.x.and.censored</dt>
<dd><p>logical scalar indicating whether to include the finite, non-missing values of 
  the argument <code>x</code> and the corresponding values of <code>censored</code> with the 
  returned object.  The default value is <code>include.x.and.censored=TRUE</code>.</p></dd>
<dt>prob.method</dt>
<dd><p>for multiply censored data, 
  character string indicating what method to use to compute the plotting positions 
  (empirical probabilities) when <br><code>objective.name="PPCC"</code>.  Possible values are: <br></p>
<p><code>"kaplan-meier"</code> (product-limit method of Kaplan and Meier (1958)), <br><code>"modified kaplan-meier"</code> (same as <code>"kaplan-meier"</code> with the maximum value included), <br><code>"nelson"</code> (hazard plotting method of Nelson (1972)), <br><code>"michael-schucany"</code> (generalization of the product-limit method due to Michael and Schucany (1986)), and <br><code>"hirsch-stedinger"</code> (generalization of the product-limit method due to Hirsch and Stedinger (1987)). <br></p>
<p>The default value is <code>prob.method="michael-schucany"</code>. <br></p>
<p>The <code>"nelson"</code> method is only available for <code>censoring.side="right"</code>, and 
  the <code>"modified kaplan-meier"</code> is only available for <code>censoring.side="left"</code>.  
  See the DETAILS section for more explanation.</p>
<p>This argument is ignored if <code>objective.name</code> is not equal to <code>"PPCC"</code> 
  and/or the data are singly censored.</p></dd>
<dt>plot.pos.con</dt>
<dd><p>for multiply censored data, 
  numeric scalar between 0 and 1 containing the value of the plotting position 
  constant when <code>objective.name="PPCC"</code>.  
  The default value is <code>plot.pos.con=0.375</code>.  See the DETAILS section 
  for more information.  
  This argument is used only if <code>prob.method</code> is equal to 
  <code>"michael-schucany"</code> or <code>"hirsch-stedinger"</code>.</p>
<p>This argument is ignored if <code>objective.name</code> is not equal to <code>"PPCC"</code> 
  and/or the data are singly censored.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Two common assumptions for several standard parametric hypothesis tests are:</p><ol><li><p>The observations all come from a normal distribution.</p></li>
<li><p>The observations all come from distributions with the same variance.</p></li>
</ol><p>For example, the standard one-sample t-test assumes all the observations 
  come from the same normal distribution, and the standard two-sample t-test 
  assumes that all the observations come from a normal distribution with the same 
  variance, although the mean may differ between the two groups.</p>
<p>When the original data do not satisfy the above assumptions, data transformations 
  are often used to attempt to satisfy these assumptions.  
  Box and Cox (1964) presented a formalized method for deciding on a data 
  transformation.  Given a random variable \(X\) from some distribution with 
  only positive values, the Box-Cox family of power transformations is defined as:</p><table class="table table"><tr><td>\(Y\)</td><td>=</td><td>\(\frac{X^\lambda - 1}{\lambda}\)</td><td>\(\lambda \ne 0\)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>\(log(X)\)</td><td>\(\lambda = 0 \;\;\;\;\;\; (1)\)</td></tr></table><p>where \(Y\) is assumed to come from a normal distribution.  This transformation is 
  continuous in \(\lambda\).  Note that this transformation also preserves ordering.  
  See the help file for <code><a href="boxcoxTransform.html">boxcoxTransform</a></code> for more information on data 
  transformations.</p>
<p>Box and Cox (1964) proposed choosing the appropriate value of \(\lambda\) based on 
  maximizing the likelihood function.  Alternatively, an appropriate value of 
  \(\lambda\) can be chosen based on another objective, such as maximizing the 
  probability plot correlation coefficient or the Shapiro-Wilk goodness-of-fit 
  statistic.</p>
<p>Shumway et al. (1989) investigated extending the method of Box and Cox (1964) to 
  the case of Type I censored data, motivated by the desire to produce estimated 
  means and confidence intervals for air monitoring data that included censored 
  values.</p>
<p>In the case when <code>optimize=TRUE</code>, the function <code>boxcoxCensored</code> calls the 
  <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> to minimize the negative value of the 
  objective (i.e., maximize the objective) over the range of possible values of 
  \(\lambda\) specified in the argument <code>lambda</code>.  The starting value for 
  the optimization is always \(\lambda=1\) (i.e., no transformation).</p>
<p>The next section explains assumptions and notation, and the section after that 
  explains how the objective is computed for the various options for 
  <code>objective.name</code>. 
  <br></p>
<p><b>Assumptions and Notation</b> <br>
  Let \(\underline{x}\) denote a random sample of \(N\) observations from 
  some continuous distribution.  Assume \(n\) (\(0 &lt; n &lt; N\)) of these 
  observations are known and \(c\) (\(c=N-n\)) of these observations are 
  all censored below (left-censored) or all censored above (right-censored) at 
  \(k\) fixed censoring levels
  $$T_1, T_2, \ldots, T_K; \; K \ge 1 \;\;\;\;\;\; (2)$$
  For the case when \(K \ge 2\), the data are said to be Type I 
  <b><em>multiply censored</em></b>.  For the case when \(K=1\), 
  set \(T = T_1\).  If the data are left-censored 
  and all \(n\) known observations are greater 
  than or equal to \(T\), or if the data are right-censored and all \(n\) 
  known observations are less than or equal to \(T\), then the data are 
  said to be Type I <b><em>singly censored</em></b> (Nelson, 1982, p.7), otherwise 
  they are considered to be Type I multiply censored.</p>
<p>Let \(c_j\) denote the number of observations censored below or above censoring 
  level \(T_j\) for \(j = 1, 2, \ldots, K\), so that
  $$\sum_{i=1}^K c_j = c \;\;\;\;\;\; (3)$$
  Let \(x_{(1)}, x_{(2)}, \ldots, x_{(N)}\) denote the “ordered” observations, 
  where now “observation” means either the actual observation (for uncensored 
  observations) or the censoring level (for censored observations).  For 
  right-censored data, if a censored observation has the same value as an 
  uncensored one, the uncensored observation should be placed first.  
  For left-censored data, if a censored observation has the same value as an 
  uncensored one, the censored observation should be placed first.</p>
<p>Note that in this case the quantity \(x_{(i)}\) does not necessarily represent 
  the \(i\)'th “largest” observation from the (unknown) complete sample.</p>
<p>Finally, let \(\Omega\) (omega) denote the set of \(n\) subscripts in the 
  “ordered” sample that correspond to uncensored observations, and let 
  \(\Omega_j\) denote the set of \(c_j\) subscripts in the “ordered” 
  sample that correspond to the censored observations censored at censoring level 
  \(T_j\) for \(j = 1, 2, \ldots, k\).</p>
<p>We assume that there exists some value of \(\lambda\) such that the transformed 
  observations</p><table class="table table"><tr><td>\(y_i\)</td><td>=</td><td>\(\frac{x_i^\lambda - 1}{\lambda}\)</td><td>\(\lambda \ne 0\)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>\(log(x_i)\)</td><td>\(\lambda = 0 \;\;\;\;\;\; (4)\)</td></tr></table><p>(\(i = 1, 2, \ldots, n\)) form a random sample of Type I censored data from a 
  normal distribution.</p>
<p>Note that for the censored observations, Equation (4) becomes:</p><table class="table table"><tr><td>\(y_{(i)} = T_j^*\)</td><td>=</td><td>\(\frac{T_j^\lambda - 1}{\lambda}\)</td><td>\(\lambda \ne 0\)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>\(log(T_j)\)</td><td>\(\lambda = 0 \;\;\;\;\;\; (5)\)</td></tr></table><p>where \(i \in \Omega_j\).
  <br></p>
<p><b>Computing the Objective</b> <br></p>
<p><em>Objective Based on Probability Plot Correlation Coefficient</em> (<code>objective.name="PPCC"</code>) <br>
  When <code>objective.name="PPCC"</code>, the objective is computed as the value of the 
  normal probability plot correlation coefficient based on the transformed data 
  (see the description of the Probability Plot Correlation Coefficient (PPCC) 
  goodness-of-fit test in the help file for <code><a href="gofTestCensored.html">gofTestCensored</a></code>).  That is, 
  the objective is the correlation coefficient for the normal 
  <a href="qqPlotCensored.html">quantile-quantile plot</a> for the transformed data.  
  Large values of the PPCC tend to indicate a good fit to a normal distribution.
  <br></p> 
<p><em>Objective Based on Shapiro-Wilk Goodness-of-Fit Statistic</em> (<code>objective.name="Shapiro-Wilk"</code>) <br>
  When <code>objective.name="Shapiro-Wilk"</code>, the objective is computed as the value of 
  the Shapiro-Wilk goodness-of-fit statistic based on the transformed data 
  (see the description of the Shapiro-Wilk test in the help file for 
  <code><a href="gofTestCensored.html">gofTestCensored</a></code>).  Large values of the Shapiro-Wilk statistic tend to 
  indicate a good fit to a normal distribution.
  <br></p> 
<p><em>Objective Based on Log-Likelihood Function</em> (<code>objective.name="Log-Likelihood"</code>) <br>
  When <code>objective.name="Log-Likelihood"</code>, the objective is computed as the value 
  of the log-likelihood function.  Assuming the transformed observations in 
  Equation (4) above come from a normal distribution with mean \(\mu\) and 
  standard deviation \(\sigma\), we can use the change of variable formula to 
  write the log-likelihood function as follows.</p>
<p>For Type I left censored data, the likelihood function is given by:
  $$log[L(\lambda, \mu, \sigma)] = log[{N \choose c_1 c_2 \ldots c_k n}] + \sum_{j=1}^k c_j log[F(T_j^*)] + \sum_{i \in \Omega} log\{f[y_{(i)}]\} + (\lambda - 1) \sum_{i \in \Omega} log[x_{(i)}] \;\;\;\;\;\; (6)$$
  where \(f\) and \(F\) denote the probability density function (pdf) and 
  cumulative distribution function (cdf) of the population. That is,
  $$f(t) = \phi(\frac{t-\mu}{\sigma}) \;\;\;\;\;\; (7)$$
  $$F(t) = \Phi(\frac{t-\mu}{\sigma}) \;\;\;\;\;\; (8)$$
  where \(\phi\) and \(\Phi\) denote the pdf and cdf of the standard normal 
  distribution, respectively (Shumway et al., 1989).  For left singly 
  censored data, Equation (6) simplifies to:
  $$log[L(\lambda, \mu, \sigma)] = log[{N \choose c}] + c log[F(T^*)] + \sum_{i = c+1}^N log\{f[y_{(i)}]\} + (\lambda - 1) \sum_{i = c+1}^N log[x_{(i)}] \;\;\;\;\;\; (9)$$</p>
<p>Similarly, for Type I right censored data, the likelihood function is given by:
  $$log[L(\lambda, \mu, \sigma)] = log[{N \choose c_1 c_2 \ldots c_k n}] + \sum_{j=1}^k c_j log[1 - F(T_j^*)] + \sum_{i \in \Omega} log\{f[y_{(i)}]\} + (\lambda - 1) \sum_{i \in \Omega} log[x_{(i)}] \;\;\;\;\;\; (10)$$
  and for right singly censored data this simplifies to:
  $$log[L(\lambda, \mu, \sigma)] = log[{N \choose c}] + c log[1 - F(T^*)] + \sum_{i = 1}^n log\{f[y_{(i)}]\} + (\lambda - 1) \sum_{i = 1}^n log[x_{(i)}] \;\;\;\;\;\; (11)$$</p>
<p>For a fixed value of \(\lambda\), the log-likelihood function 
  is maximized by replacing \(\mu\) and \(\sigma\) with their maximum likelihood 
  estimators (see the section <em>Maximum Likelihood Estimation</em> in the help file 
  for <code><a href="enormCensored.html">enormCensored</a></code>).</p>
<p>Thus, when <code>optimize=TRUE</code>, Equation (6) or (10) is maximized by iteratively 
  solving for \(\lambda\) using the MLEs for \(\mu\) and \(\sigma\).  
  When <code>optimize=FALSE</code>, the value of the objective is computed by using 
  Equation (6) or (10), using the values of \(\lambda\) specified in the 
  argument <code>lambda</code>, and using the MLEs of \(\mu\) and \(\sigma\).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>boxcoxCensored</code> returns a list of class <code>"boxcoxCensored"</code>  containing the results.  
  See the help file for <code><a href="boxcoxCensored.object.html">boxcoxCensored.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002). 
  <em>Statistics for Environmental Engineers, Second Edition</em>. 
  Lewis Publishers, Boca Raton, FL.</p>
<p>Box, G.E.P., and D.R. Cox. (1964).  An Analysis of Transformations 
  (with Discussion).  <em>Journal of the Royal Statistical Society, Series B</em> 
  <b>26</b>(2), 211--252.</p>
<p>Cohen, A.C. (1991).  Truncated and Censored Samples.  <em>Marcel Dekker</em>, 
  New York, New York, pp.50--59.</p>
<p>Draper, N., and H. Smith. (1998). <em>Applied Regression Analysis</em>. Third Edition. 
  John Wiley and Sons, New York, pp.47-53.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution 
  Monitoring</em>. Van Nostrand Reinhold, NY.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).  
  <em>Statistical Methods in Water Resources Research</em>. 
  Elsevier, New York, NY.</p>
<p>Hinkley, D.V., and G. Runger. (1984).  The Analysis of Transformed Data 
  (with Discussion).  <em>Journal of the American Statistical Association</em> 
  <b>79</b>, 302--320.</p>
<p>Hoaglin, D.C., F.M. Mosteller, and J.W. Tukey, eds. (1983).  
  <em>Understanding Robust and Exploratory Data Analysis</em>.  
  John Wiley and Sons, New York, Chapter 4.</p>
<p>Hoaglin, D.C. (1988).  Transformations in Everyday Experience. 
  <em>Chance</em> <b>1</b>, 40--45.</p>
<p>Johnson, N. L., S. Kotz, and A.W. Kemp. (1992).  <em>Univariate 
  Discrete Distributions, Second Edition</em>.  John Wiley and Sons, New York, 
  p.163.</p>
<p>Johnson, R.A., and D.W. Wichern. (2007).  
  <em>Applied Multivariate Statistical Analysis, Sixth Edition</em>.  
  Pearson Prentice Hall, Upper Saddle River, NJ, pp.192--195.</p>
<p>Shumway, R.H., A.S. Azari, and P. Johnson. (1989).  
  Estimating Mean Concentrations Under Transformations for Environmental 
  Data With Detection Limits.  <em>Technometrics</em> <b>31</b>(3), 347--356.</p>
<p>Stoline, M.R. (1991).  An Examination of the Lognormal and Box and Cox 
  Family of Transformations in Fitting Environmental Data.  
  <em>Environmetrics</em> <b>2</b>(1), 85--106.</p>
<p>van Belle, G., L.D. Fisher, Heagerty, P.J., and Lumley, T. (2004). 
  <em>Biostatistics: A Methodology for the Health Sciences, 2nd Edition</em>. 
  John Wiley &amp; Sons, New York.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. 
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ, 
  Chapter 13.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Data transformations are often used to induce normality, homoscedasticity, 
  and/or linearity, common assumptions of parametric statistical tests and 
  estimation procedures.  Transformations are not “tricks” used by the 
  data analyst to hide what is going on, but rather useful tools for 
  understanding and dealing with data (Berthouex and Brown, 2002, p.61).  
  Hoaglin (1988) discusses “hidden” transformations that are used everyday, 
  such as the pH scale for measuring acidity.  Johnson and Wichern (2007, p.192) 
  note that "Transformations are nothing more than a reexpression of the data 
  in different units."</p>
<p>Shumway et al. (1989) investigated extending the method of Box and Cox (1964) to 
  the case of Type I censored data, motivated by the desire to produce estimated 
  means and confidence intervals for air monitoring data that included censored values.</p>
<p>Stoline (1991) compared the goodness-of-fit of Box-Cox transformed data (based on 
  using the “optimal” power transformation from a finite set of values between 
  -1.5 and 1.5) with log-transformed data for 17 groundwater chemistry variables.  
  Using the Probability Plot Correlation Coefficient statistic for censored data as a 
  measure of goodness-of-fit (see <code><a href="gofTest.html">gofTest</a></code>), Stoline (1991) found that 
  only 6 of the variables were adequately modeled by a Box-Cox transformation 
  (p &gt;0.10 for these 6 variables).  Of these variables, five were adequately modeled 
  by a a log transformation.  Ten of variables were “marginally” fit by an 
  optimal Box-Cox transformation, and of these 10 only 6 were marginally fit by a 
  log transformation.  Based on these results, Stoline (1991) recommends checking 
  the assumption of lognormality before automatically assuming environmental data fit 
  a lognormal distribution.</p>
<p>One problem with data transformations is that translating results on the 
  transformed scale back to the original scale is not always straightforward.  
  Estimating quantities such as means, variances, and confidence limits in the 
  transformed scale and then transforming them back to the original scale 
  usually leads to biased and inconsistent estimates (Gilbert, 1987, p.149; 
  van Belle et al., 2004, p.400).  For example, exponentiating the confidence 
  limits for a mean based on log-transformed data does not yield a 
  confidence interval for the mean on the original scale.  Instead, this yields 
  a confidence interval for the median (see the help file for 
  <code><a href="elnormAltCensored.html">elnormAltCensored</a></code>).  
  It should be noted, however, that quantiles (percentiles) and rank-based 
  procedures are invariant to monotonic transformations 
  (Helsel and Hirsch, 1992, p.12).</p>
<p>Finally, there is no guarantee that a Box-Cox tranformation based on the 
  “optimal” value of \(\lambda\) will provide an adequate transformation 
  to allow the assumption of approximate normality and constant variance.  Any 
  set of transformed data should be inspected relative to the assumptions you 
  want to make about it (Johnson and Wichern, 2007, p.194).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="boxcoxCensored.object.html">boxcoxCensored.object</a></code>, <code><a href="plot.boxcoxCensored.html">plot.boxcoxCensored</a></code>, 
  <code><a href="print.boxcoxCensored.html">print.boxcoxCensored</a></code>, 
  <code><a href="boxcox.html">boxcox</a></code>, <a href="FcnsByCatDataTrans.html">Data Transformations</a>, <a href="FcnsByCatGOFTests.html">Goodness-of-Fit Tests</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Generate 15 observations from a lognormal distribution with </span></span>
<span class="r-in">  <span class="co"># mean=10 and cv=2 and censor the observations less than 2.  </span></span>
<span class="r-in">  <span class="co"># Then generate 15 more observations from this distribution and </span></span>
<span class="r-in">  <span class="co"># censor the observations less than 4.  </span></span>
<span class="r-in">  <span class="co"># Then Look at some values of various objectives for various transformations.  </span></span>
<span class="r-in">  <span class="co"># Note that for both the PPCC objective the optimal value is about -0.3, </span></span>
<span class="r-in">  <span class="co"># whereas for the Log-Likelihood objective it is about 0.3.</span></span>
<span class="r-in">  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">x.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalAlt.html">rlnormAlt</a></span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">10</span>, cv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">censored.1</span> <span class="op">&lt;-</span> <span class="va">x.1</span> <span class="op">&lt;</span> <span class="fl">2</span></span>
<span class="r-in">  <span class="va">x.1</span><span class="op">[</span><span class="va">censored.1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">x.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalAlt.html">rlnormAlt</a></span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">10</span>, cv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">censored.2</span> <span class="op">&lt;-</span> <span class="va">x.2</span> <span class="op">&lt;</span> <span class="fl">4</span></span>
<span class="r-in">  <span class="va">x.2</span><span class="op">[</span><span class="va">censored.2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x.1</span>, <span class="va">x.2</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">censored</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">censored.1</span>, <span class="va">censored.2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in">  <span class="co"># Using the PPCC objective:</span></span>
<span class="r-in">  <span class="co">#--------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">boxcoxCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8954683 0.9338467 0.9643680 0.9812969 0.9776834 0.9471025 0.8901990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.8187488 0.7480494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PPCC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    NA    NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.019218  2.000000 13.005066 14.696442  4.475899  2.807566  2.747506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8]  4.500526  2.299411  3.659471  9.262740  8.037256  3.673584  3.710599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15]  3.408152 13.442147  4.000000  4.000000  4.193124  6.383201  9.237636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22]  4.000000  4.000000 12.401404  4.000000 22.456461  4.000000 30.017613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29]  8.898790  4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  TRUE FALSE  TRUE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 26.66667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcoxCensored"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Box-Cox Transformation</span></span>
<span class="r-in">  <span class="co">#Based on Type I Censored Data</span></span>
<span class="r-in">  <span class="co">#---------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Objective Name:                  PPCC</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Variable:              censored</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Side:                  left</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Level(s):              2 4 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     30</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Percent Censored:                26.7%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co"># lambda      PPCC</span></span>
<span class="r-in">  <span class="co">#   -2.0 0.8954683</span></span>
<span class="r-in">  <span class="co">#   -1.5 0.9338467</span></span>
<span class="r-in">  <span class="co">#   -1.0 0.9643680</span></span>
<span class="r-in">  <span class="co">#   -0.5 0.9812969</span></span>
<span class="r-in">  <span class="co">#    0.0 0.9776834</span></span>
<span class="r-in">  <span class="co">#    0.5 0.9471025</span></span>
<span class="r-in">  <span class="co">#    1.0 0.8901990</span></span>
<span class="r-in">  <span class="co">#    1.5 0.8187488</span></span>
<span class="r-in">  <span class="co">#    2.0 0.7480494</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">boxcoxCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.3194799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9827546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PPCC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -2     2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.019218  2.000000 13.005066 14.696442  4.475899  2.807566  2.747506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8]  4.500526  2.299411  3.659471  9.262740  8.037256  3.673584  3.710599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15]  3.408152 13.442147  4.000000  4.000000  4.193124  6.383201  9.237636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22]  4.000000  4.000000 12.401404  4.000000 22.456461  4.000000 30.017613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29]  8.898790  4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  TRUE FALSE  TRUE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 26.66667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcoxCensored"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Box-Cox Transformation</span></span>
<span class="r-in">  <span class="co">#Based on Type I Censored Data</span></span>
<span class="r-in">  <span class="co">#---------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Objective Name:                  PPCC</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Variable:              censored</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Side:                  left</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Level(s):              2 4 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     30</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Percent Censored:                26.7%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Bounds for Optimization:         lower = -2</span></span>
<span class="r-in">  <span class="co">#                                 upper =  2</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Optimal Value:                   lambda = -0.3194799</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Value of Objective:              PPCC = 0.9827546</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#-----------------------------------</span></span>
<span class="r-in">  <span class="co"># Using the Log-Likelihodd objective</span></span>
<span class="r-in">  <span class="co">#-----------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">boxcoxCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, objective.name <span class="op">=</span> <span class="st">"Log-Likelihood"</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -95.38785 -84.76697 -75.36204 -68.12058 -63.98902 -63.56701 -66.92599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] -73.61638 -82.87970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Log-Likelihood"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    NA    NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.019218  2.000000 13.005066 14.696442  4.475899  2.807566  2.747506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8]  4.500526  2.299411  3.659471  9.262740  8.037256  3.673584  3.710599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15]  3.408152 13.442147  4.000000  4.000000  4.193124  6.383201  9.237636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22]  4.000000  4.000000 12.401404  4.000000 22.456461  4.000000 30.017613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29]  8.898790  4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  TRUE FALSE  TRUE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 26.66667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcoxCensored"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Box-Cox Transformation</span></span>
<span class="r-in">  <span class="co">#Based on Type I Censored Data</span></span>
<span class="r-in">  <span class="co">#---------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Objective Name:                  Log-Likelihood</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Variable:              censored</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Side:                  left</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Level(s):              2 4 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     30</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Percent Censored:                26.7%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co"># lambda Log-Likelihood</span></span>
<span class="r-in">  <span class="co">#   -2.0      -95.38785</span></span>
<span class="r-in">  <span class="co">#   -1.5      -84.76697</span></span>
<span class="r-in">  <span class="co">#   -1.0      -75.36204</span></span>
<span class="r-in">  <span class="co">#   -0.5      -68.12058</span></span>
<span class="r-in">  <span class="co">#    0.0      -63.98902</span></span>
<span class="r-in">  <span class="co">#    0.5      -63.56701</span></span>
<span class="r-in">  <span class="co">#    1.0      -66.92599</span></span>
<span class="r-in">  <span class="co">#    1.5      -73.61638</span></span>
<span class="r-in">  <span class="co">#    2.0      -82.87970</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">boxcoxCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, objective.name <span class="op">=</span> <span class="st">"Log-Likelihood"</span>, </span>
<span class="r-in">    optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3049744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -63.2733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Log-Likelihood"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -2     2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.019218  2.000000 13.005066 14.696442  4.475899  2.807566  2.747506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8]  4.500526  2.299411  3.659471  9.262740  8.037256  3.673584  3.710599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15]  3.408152 13.442147  4.000000  4.000000  4.193124  6.383201  9.237636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22]  4.000000  4.000000 12.401404  4.000000 22.456461  4.000000 30.017613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29]  8.898790  4.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  TRUE FALSE  TRUE FALSE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 26.66667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcoxCensored"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Box-Cox Transformation</span></span>
<span class="r-in">  <span class="co">#Based on Type I Censored Data</span></span>
<span class="r-in">  <span class="co">#---------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Objective Name:                  Log-Likelihood</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            x</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Variable:              censored</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Side:                  left</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Censoring Level(s):              2 4 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     30</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Percent Censored:                26.7%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Bounds for Optimization:         lower = -2</span></span>
<span class="r-in">  <span class="co">#                                 upper =  2</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Optimal Value:                   lambda = 0.3049744</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Value of Objective:              Log-Likelihood = -63.2733</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Plot the results based on the PPCC objective</span></span>
<span class="r-in">  <span class="co">#---------------------------------------------</span></span>
<span class="r-in">  <span class="va">boxcox.list</span> <span class="op">&lt;-</span> <span class="fu">boxcoxCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boxcox.list</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Look at QQ-Plots for the candidate values of lambda</span></span>
<span class="r-in">  <span class="co">#---------------------------------------------------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boxcox.list</span>, plot.type <span class="op">=</span> <span class="st">"Q-Q Plots"</span>, same.window <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="co">#---------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x.1</span>, <span class="va">censored.1</span>, <span class="va">x.2</span>, <span class="va">censored.2</span>, <span class="va">x</span>, <span class="va">censored</span>, <span class="va">boxcox.list</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

