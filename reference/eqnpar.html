<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Quantiles of a Distribution Nonparametrically — eqnpar • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Quantiles of a Distribution Nonparametrically — eqnpar"><meta property="og:description" content="Estimate quantiles of a distribution, and optionally create confidence intervals
  for them, without making any assumptions about the form of the distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Quantiles of a Distribution Nonparametrically</h1>

    <div class="hidden name"><code>eqnpar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate quantiles of a distribution, and optionally create confidence intervals
  for them, without making any assumptions about the form of the distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eqnpar</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">0.5</span>, type <span class="op">=</span> <span class="fl">7</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, lcl.rank <span class="op">=</span> <span class="cn">NULL</span>, ucl.rank <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    lb <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ub <span class="op">=</span> <span class="cn">Inf</span>, ci.type <span class="op">=</span> <span class="st">"two-sided"</span>,</span>
<span>    ci.method <span class="op">=</span> <span class="st">"interpolate"</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>,</span>
<span>    approx.conf.level <span class="op">=</span> <span class="fl">0.95</span>, min.coverage <span class="op">=</span> <span class="cn">TRUE</span>, tol <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>numeric vector of probabilities for which quantiles will be estimated.
  All values of <code>p</code> must be between 0 and 1.  When <code>ci=TRUE</code>, <code>p</code>
  must be a scalar. The default value is <code>p=0.5</code>.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>an integer between 1 and 9 indicating which algorithm to use to estimate the
  quantile.  The default value is <code>type=7</code>.  See the help file for
  <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code> for details.</p></dd>

  <dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for the quantile.
  The default value is <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-lcl-rank-ucl-rank">lcl.rank, ucl.rank<a class="anchor" aria-label="anchor" href="#arg-lcl-rank-ucl-rank"></a></dt>
<dd><p>positive integers indicating the ranks of the order statistics that are used
  for the lower and upper bounds of the confidence interval for the specified
  quantile.  Both arguments must be integers between 1 and the number of non-missing
  values in <code>x</code>, and <code>lcl.rank</code> must be strictly less than <code>ucl.rank</code>.
  Setting values for <code>lcl.rank</code> and/or <code>ucl.rank</code> allows the user to
  bypass the automatic selection of order statistics.  By default the value of these
  arguments is <code>NULL</code>, in which case order statistics are chosen based on the
  value of <code>ci.type</code> and <code>ci.method</code>.  If only <code>lcl.rank</code> is supplied,
  a lower confidence interval is constructed.  If only <code>ucl.rank</code> is supplied,
  an upper confidence interval is constructed.  If both <code>lcl.rank</code> and
  <code>ucl.rank</code> are supplied, a two-sided confidence interval is constructed.
  These arguments are ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-lb-ub">lb, ub<a class="anchor" aria-label="anchor" href="#arg-lb-ub"></a></dt>
<dd><p>scalars indicating lower and upper bounds on the distribution.  By default, <br><code>lb=-Inf</code> and <code>ub=Inf</code>.  If you are constructing a confidence interval
  for a quantile from a distribution that you know has a lower bound other than
  <code>-Inf</code> (e.g., <code>0</code>), set <code>lb</code> to this value.  Similarly, if you
  know the distribution has an upper bound other than <code>Inf</code>, set
  <code>ub</code> to this value.  These arguments are ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>character string indicating what kind of confidence interval to compute.
  The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>, or
  <code>lcl.rank</code> and/or <code>ucl.rank</code> are supplied.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating the method to use to construct the confidence interval.
  The possible values are <code>"interpolate"</code> (the default), <code>"exact"</code>, and
  <code>"normal.approx"</code>.  See the DETAILS section for more information on these methods.
  This argument is ignored if <code>ci=FALSE</code>, or <code>lcl.rank</code> and/or
  <code>ucl.rank</code> are supplied.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>an integer indicating the number of decimal places to round to when printing out
  the value of <code>100*p</code>. The default value is <code>digits=0</code>.</p></dd>

  <dt id="arg-approx-conf-level">approx.conf.level<a class="anchor" aria-label="anchor" href="#arg-approx-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the desired confidence level of the confidence
  interval.  The default value is <code>0.95</code>.  The true confidence level usually
  will not be exactly equal to <code>approx.conf.level</code> (see DETAILS).  This argument
  is ignored if <code>ci=FALSE</code>, or <code>lcl.rank</code> and/or <code>ucl.rank</code> are supplied.</p></dd>

  <dt id="arg-min-coverage">min.coverage<a class="anchor" aria-label="anchor" href="#arg-min-coverage"></a></dt>
<dd><p>for the case when <code>ci.method="exact"</code>, a logical scalar indicating whether the
  confidence interval should have a minimum coverage at least as great as the value
  of the argument <code>approx.conf.level</code>. The default value is <br><code>min.coverage=TRUE</code>.  This argument is ignored if <code>ci=FALSE</code> or
  <code>ci.method</code> is not equal to <code>"exact"</code>.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>for the case when <code>ci.method="exact"</code> and <code>min.coverage=FALSE</code>,
  a scalar between 0 and 1 indicating the maximum amount of coverage greater than
  the value of <code>approx.conf.level</code> the user is willing to allow.
  The default value is <code>tol=0</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or
  infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to
  performing the estimation.</p>
<p><b>Estimation</b> <br>
  The function <code>eqnpar</code> calls the <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>
  to estimate quantiles.
  <br></p>
<p><b>Confidence Intervals</b> <br>
  Let \(x_1, x_2, \ldots, x_n\) denote a sample of \(n\) independent and
  identically distributed random variables from some arbitrary distribution.
  Furthermore, let \(x_{(i)}\) denote the \(i\)'th order statistic for these
  \(n\) random variables. That is,
  $$x_{(1)} \le x_{(2)} \le \ldots \le x_{(n)} \;\;\;\;\;\; (1)$$
  Finally, let \(x_p\) denote the \(p\)'th quantile of the distribution, that is:
  $$Pr(X &lt; x_p) \le p \;\;\;\;\;\; (2)$$
  $$Pr(X \le x_p) \ge p \;\;\;\;\;\; (3)$$
  It can be shown (e.g., Conover, 1980, pp. 114-116) that for the \(i\)'th order
  statistic:
  $$Pr[x_p &lt; x_{(i)}] = F_{B(n,p)}[i-1]; \; i = 1, 2, \ldots, n \;\;\;\;\;\; (4)$$
  for a continuous distribution and
  $$Pr[x_p &lt; x_{(i)}] \le F_{B(n,p)}[i-1]; \; i = 1, 2, \ldots, n \;\;\;\;\;\; (5)$$
  $$Pr[x_p \le x_{(i)}] \ge F_{B(n,p)}[i-1]; \; i = 1, 2, \ldots, n \;\;\;\;\;\; (6)$$
  for a discrete distribution,
  where \(F_{B(n,p)}[y]\) denotes the cumulative distribution function of a
  <a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">binomial random variable</a> with parameters <code>size=</code>\(n\)
  and <code>prob=</code>\(p\) evaluated at \(y\).  These facts are used to construct
  confidence intervals for quantiles (see below).
  <br></p>
<p><b>Two-Sided Confidence Interval</b> (<code>ci.type="two-sided"</code>) <br>
  A two-sided nonparametric confidence interval for the \(p\)'th quantile is
  constructed as:
  $$[x_{(r)}, x_{(s)}] \;\;\;\;\;\; (7)$$
  where
  $$1 \le r \le (n-1) \;\;\;\;\;\; (8)$$
  $$2 \le s \le n \;\;\;\;\;\; (9)$$
  $$r &lt; s \;\;\;\;\;\; (10)$$
  Note that the argument <code>lcl.rank</code> corresponds to \(r\), and the argument
  <code>ucl.rank</code> corresponds to \(s\).</p>
<p>This confidence interval has an associated confidence level that is at least as
  large as:
  $$F_{B(n,p)}[s-1] - F_{B(n,p)}[r-1] \;\;\;\;\;\; (11)$$
  for a discrete distribution and exactly equal to this value for a continuous
  distribution.  This is because by Equations (4)-(6) above:
  $$Pr[x_{(r)} \le x_p \le x_{(s)}]$$
  $$= Pr[x_p \le x_{(s)}] - Pr[x_p &lt; x_{(r)}]$$
  $$\ge F_{B(n,p)}[s-1] - F_{B(n,p)}[r-1] \;\;\;\;\;\; (12)$$
  with equality if the distribution is continuous.
  <br></p>
<p><em>Exact Method</em> (<code>ci.method="exact"</code>) <br>
  When <code>lcl.rank</code> (\(r\)) and <code>ucl.rank</code> (\(s\)) are not supplied by
  the user, and <code>ci.method="exact"</code>, \(r\) and \(s\) are initially chosen such that
  \(r\) is the smallest integer satisfying equation (13) below, and \(s\) is
  the largest integer satisfying equation (14) below:
  $$F_{B(n,p)}[r-1] \ge \frac{\alpha}{2} \;\;\;\;\;\; (13)$$
  $$F_{B(n,p)}[s-1] \le 1-\frac{\alpha}{2} \;\;\;\;\;\; (14)$$
  where \(\alpha = 1 -\)<code>approx.conf.level</code>.
  The values of \(r\) and \(s\) are then each varied by \(\pm 2\) (with the
  restrictions \(r \ge 1\), \(s \le n\), and \(r &lt; s\)), and confidence levels
  computed for each of these combinations.  If <code>min.coverage=TRUE</code>, the
  combination of \(r\) and \(s\) is selected that provides the closest coverage
  to <code>approx.conf.level</code>, with coverage greater than or equal to
  <code>approx.conf.level</code>.  If <code>min.coverage=FALSE</code>, the
  combination of \(r\) and \(s\) is selected that provides the closest coverage
  to <code>approx.conf.level</code>, with coverage less than or equal to
  <code>approx.conf.level + tol</code>.</p>
<p>For this method, the confidence level associated with the confidence interval
  is exact if the underlying distribution is continuous.
  <br></p>
<p><em>Approximate Method</em> (<code>ci.method="approx"</code>) <br>
  Here the term “Approximate” simply refers to the method of initially
  choosing the ranks for the lower and upper bounds.  As for <code>ci.method="exact"</code>,
  the confidence level associated with the confidence interval is exact if the
  underlying distribution is continuous.</p>
<p>When <code>lcl.rank</code> (\(r\)) and <code>ucl.rank</code> (\(s\)) are not supplied by
  the user and <code>ci.method="normal.approx"</code>, \(r\) and \(s\) are initially chosen
  such that:
  $$r = np - h \;\;\;\;\;\; (15)$$
  $$s = np + h \;\;\;\;\;\; (16)$$
  where
  $$h = t_{n-1, 1-\alpha/2} \sqrt{np(1-p)} \;\;\;\;\;\; (17)$$
  and \(t_{\nu,q}\) denotes the \(q\)'th quantile of
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(\nu\) degrees of freedom,
  and \(\alpha = 1 -\)<code>approx.conf.level</code> (Conover, 1980, p. 112).
  With the restictions that \(r \ge 1\) and \(s \le n\),
  \(r\) is rounded down to the nearest integer \(r = r^* = floor(r)\) and
  \(s\) is rounded up to the nearest integer \(s = s^* = ceiling(s)\).
  Again, with the restictions that \(s \le n\),
  if the confidence level using \(s = s^* + 1\) and \(r = r^*\) is less than or equal
  to <code>approx.conf.level</code>, then \(s\) is set to \(s = s^* + 1\).
  Once this has been checked, with the restriction that \(r \ge 1\),
  if the confidence level using the current value of \(s\)
  and \(r = r^* - 1\) is less than or equal to <code>approx.conf.level</code>, then
  \(r\) is set to \(r = r^* - 1\).
  <br></p>
<p><em>Interpolate Method</em> (<code>ci.method="interpolate"</code>) <br>
  Let \(\gamma\) denote the desired confidence level associated with the
  confidence interval for the \(p\)'th quantile.
  Based on the work of Hettmansperger and Sheather (1986), Nyblom (1992) showed that
  if \([-\infty, x_{(w+1)}]\) is a one-sided upper confidence interval for the
  \(p\)'th quantile with associated confidence level \(\gamma_{w+1}\), and
  \(\gamma_{w+1} \ge \gamma \ge \gamma_{w}\), then the one-sided upper
  confidence interval
  $$[-\infty, (1-\lambda) x_{(w)} + \lambda x_{(w+1)}] \;\;\;\;\;\; (18)$$
  where
  $$\lambda = \lambda(\beta, p, w, n)$$
  $$= [ 1 + \frac{w(1-p)(\pi_{w+1}-\beta)}{(n-w)p(\beta-\pi_w)} ] ^ {-1} \;\;\;\;\;\; (19)$$
  $$\pi_w = F_{B(n,p)}[w-1] \;\;\;\;\;\; (20)$$
  $$\beta = \gamma \;\;\;\;\;\; (21)$$
  has associated confidence level approximately equal to \(\gamma\) for a wide
  range of distributions.</p>
<p>Thus, to construct an approximate two-sided confidence interval for the
  \(p\)'th quantile with confidence level \(\gamma\), if
  \([x_{(r)}, x_{(s)}]\) has confidence level \(\ge \gamma\) and
  \([x_{(r+1)}, x_{(s-1)}]\) has confidence level \(\le \gamma\), then
  the lower bound of the two-sided confidence interval is computed as:
  $$(1-\lambda) x_{(r)} + \lambda x_{(r+1)} \;\;\;\;\;\; (21)$$
  where
  $$\beta = \alpha/2; \;\;\;\; \alpha = 1 - \gamma \;\;\;\;\;\; (22)$$
  and the upper bound of the two-sided confidence interval is computed as:
  $$(1-\lambda) x_{(s-1)} + \lambda x_{(s)} \;\;\;\;\;\; (23)$$
  where
  $$\beta = 1 - \alpha/2 \;\;\;\;\;\; (24)$$</p>
<p>The values of \(r\) and \(s\) in Equations (21) and (23) are computed by
  using <code>ci.method="exact"</code> with the argument <code>min.coverage=TRUE</code>.
  <br></p>


<p><b>One-Sided Lower Confidence Interval</b> (<code>ci.type="lower"</code>) <br>
  A one-sided lower nonparametric confidence interval for the \(p\)'th quantile is
  constructed as:
  $$[x_{(r)}, ub] \;\;\;\;\;\; (25)$$
  where \(ub\) denotes the value of the <code>ub</code> argument (the user-supplied
  upper bound).
  <br></p>
<p><em>Exact Method</em> (<code>ci.method="exact"</code>) <br>
  When <code>lcl.rank</code> (\(r\)) is not supplied by the user, and
  <code>ci.method="exact"</code>, \(r\) is initially chosen such that it is the
  smallest integer satisfying the following equation:
  $$F_{B(n,p)}[r-1] \ge \alpha \;\;\;\;\;\; (26)$$
  where \(\alpha = 1 - \)<code>approx.conf.level</code>.
  The value of \(r\) is varied by \(\pm 2\) (with the
  restrictions \(r \ge 1\) and \(r \le n\)), and confidence levels
  computed for each of these combinations.  If <code>min.coverage=TRUE</code>, the
  value of \(r\) is selected that provides the closest coverage
  to <code>approx.conf.level</code>, with coverage greater than or equal to
  <code>approx.conf.level</code>.  If <code>min.coverage=FALSE</code>, the
  value of \(r\)  is selected that provides the closest coverage
  to <code>approx.conf.level</code>, with coverage less than or equal to
  <code>approx.conf.level + tol</code>.</p>
<p>For this method, the confidence level associated with the confidence interval
  is exact if the underlying distribution is continuous.
  <br></p>
<p><em>Approximate Method</em> (<code>ci.method="approx"</code>) <br>
  When <code>lcl.rank</code> (\(r\)) is not supplied by the user and
  <code>ci.method="normal.approx"</code>, \(r\) is initially chosen such that
  $$r = np - t_{n-1, 1-\alpha} \sqrt{np(1-p)} \;\;\;\;\;\; (27)$$
  With the restriction that \(r \ge 1\) and \(r \le n\),
  if <code>p</code> is less than 0.5 then \(r\) is rounded up to the nearest integer,
  otherwise it is rounded down to the nearest integer.  Denote this value by
  \(r^*\).  With the restriction that \(r \ge 1\), if the confidence level using
  \(r^* - 1\) is less than or equal to <code>approx.conf.level</code>, then
  \(r\) is set to \(r = r^* - 1\).
  <br></p>
<p><em>Interpolate Method</em> (<code>ci.method="interpolate"</code>) <br>
  Let \(\gamma\) denote the desired confidence level associated with the
  confidence interval for the \(p\)'th quantile.
  To construct an approximate one-sided lower confidence interval for the
  \(p\)'th quantile with confidence level \(\gamma\), if
  \([x_{(r)}, ub]\) has confidence level \(\ge \gamma\) and
  \([x_{(r+1)}, ub]\) has confidence level \(\le \gamma\), then
  the lower bound of the confidence interval is computed as:
  $$(1-\lambda) x_{(r)} + \lambda x_{(r+1)} \;\;\;\;\;\; (28)$$
  where
  $$\beta = \alpha; \;\;\;\; \alpha = 1 - \gamma \;\;\;\;\;\; (29)$$</p>
<p>The value of \(r\) in Equation (28) is computed by
  using <code>ci.method="exact"</code> with the arguments
  <code>ci.type="lower"</code> and <code>min.coverage=TRUE</code>.
  <br></p>


<p><b>One-Sided Upper Confidence Interval</b> (<code>ci.type="upper"</code>) <br>
  A one-sided upper nonparametric confidence interval for the \(p\)'th quantile is
  constructed as:
  $$[lb, x_{(s)}] \;\;\;\;\;\; (30)$$
  where \(lb\) denotes the value of the <code>lb</code> argument (the user-supplied
  lower bound).
  <br></p>
<p><em>Exact Method</em> (<code>ci.method="exact"</code>) <br>
  When <code>ucl.rank</code> (\(s\)) is not supplied by the user, and
  <code>ci.method="exact"</code>, \(s\) is initially chosen such that it is the
  largest integer satisfying the following equation:
  $$F_{B(n,p)}[s-1] \le 1-\alpha \;\;\;\;\;\; (31)$$
  where \(\alpha = 1 - \)<code>approx.conf.level</code>.
  The value of \(s\) is varied by \(\pm 2\) (with the
  restrictions \(s \ge 1\) and \(s \le n\)), and confidence levels
  computed for each of these combinations.  If <code>min.coverage=TRUE</code>, the
  value of \(s\) is selected that provides the closest coverage
  to <code>approx.conf.level</code>, with coverage greater than or equal to
  <code>approx.conf.level</code>.  If <code>min.coverage=FALSE</code>, the
  value of \(s\)  is selected that provides the closest coverage
  to <code>approx.conf.level</code>, with coverage less than or equal to
  <code>approx.conf.level + tol</code>.</p>
<p>For this method, the confidence level associated with the confidence interval
  is exact if the underlying distribution is continuous.
  <br></p>
<p><em>Approximate Method</em> (<code>ci.method="approx"</code>) <br>
  When <code>ucl.rank</code> (\(s\)) is not supplied by the user and
  <code>ci.method="normal.approx"</code>, \(s\) is initially chosen such that
  $$s = np + t_{n-1, 1-\alpha} \sqrt{np(1-p)} \;\;\;\;\;\; (31)$$
  With the restriction that \(s \ge 1\) and \(s \le n\),
  if <code>p</code> is greater than 0.5 then \(s\) is rounded down to the nearest integer,
  otherwise it is rounded up to the nearest integer.  Denote this value by
  \(s^*\).  With the restriction that \(s \le n\), if the confidence level using
  \(s^* + 1\) is less than or equal to <code>approx.conf.level</code>, then
  \(s\) is set to \(s = s^* + 1\).</p>
<p>For this method, the confidence level associated with the confidence interval
  is exact if the underlying distribution is continuous.
  <br></p>
<p><em>Interpolate Method</em> (<code>ci.method="interpolate"</code>) <br>
  Let \(\gamma\) denote the desired confidence level associated with the
  confidence interval for the \(p\)'th quantile.
  To construct an approximate one-sided upper confidence interval for the
  \(p\)'th quantile with confidence level \(\gamma\), if
  \([lb, x_{(s)}]\) has confidence level \(\ge \gamma\) and
  \([lb, x_{(s-1)}]\) has confidence level \(\le \gamma\), then
  the upper bound of the confidence interval is computed as:
  $$(1-\lambda) x_{(s-1)} + \lambda x_{(s)} \;\;\;\;\;\; (32)$$
  where
  $$\beta = \gamma \;\;\;\;\;\; (33)$$</p>
<p>The value of \(s\) in Equation (32) is computed by
  using <code>ci.method="exact"</code> with the arguments
  <code>ci.type = "upper"</code>, and <code>min.coverage=TRUE</code>.
  <br></p>


<p><b>Note on Value of Confidence Level</b> <br>
  Because of the discrete nature of order statistics, when <code>ci.method="exact"</code> or <br><code>ci.method="normal.approx"</code>, the value of the confidence level returned by
  <code>eqnpar</code> will usually differ from the desired confidence level indicated by
  the value of the argument <code>approx.conf.level</code>.  When <br><code>ci.method="interpolate"</code>,
  <code>eqnpar</code> returns for the confidence level the value of the argument
  <code>approx.conf.level</code>.  Nyblom (1992) and Hettmasperger and Sheather (1986) have
  shown that the Interpolate method produces confidence intervals with confidence levels
  quite close to the assumed confidence level for a wide range of distributions.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"estimate"</code> containing the estimated quantile(s) and other
  information.  See <br><code><a href="estimate.object.html">estimate.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002). <em>Statistics for Environmental Engineers</em>.
  Lewis Publishers, Boca Raton.</p>
<p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>. Second Edition.
  John Wiley and Sons, New York.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY, pp.132-136.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, pp.88-90.</p>
<p>Hettmansperger, T.P., and Sheather, S.J. (1986).  Confidence Intervals Based on
  Interpolated Order Statistics.  <em>Statistics &amp; Probability Letters</em>, <b>4</b>, 75–79.</p>
<p>Nyblom, J. (1992).  Note on Interpolated Order Statistics.
  <em>Statistics &amp; Probability Letters</em>, <b>14</b>, 129–131.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
<p>The author is grateful to Michael H?hle,
    Department of Mathematics, Stockholm University
    (<a href="http://www2.math.su.se/~hoehle" class="external-link">http://www2.math.su.se/~hoehle</a>) for making me aware of the work of Nyblom (1992),
    and for suggesting improvements to the algorithm that was used in <span class="pkg">EnvStats</span>
    Version 2.1.1 to construct a confidence interval when <code>ci.method="exact"</code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Percentiles are sometimes used in environmental standards and regulations.  For example,
  Berthouex and Brown (2002, p.71) note that England has water quality limits based on
  the 90th and 95th percentiles of monitoring data not exceeding specified levels.  They also
  note that the U.S. EPA has specifications for air quality monitoring, aquatic standards on
  toxic chemicals, and maximum daily limits for industrial effluents that are all based on
  percentiles.  Given the importance of these quantities, it is essential to characterize
  the amount of uncertainty associated with the estimates of these quantities.
  This is done with confidence intervals.</p>
<p>It can be shown (e.g., Conover, 1980, pp.119-121) that an upper confidence interval for the
  \(p\)'th quantile with confidence level \(100(1-\alpha)\%\) is equivalent to an
  upper \(\beta\)-content tolerance interval with coverage \(100p\%\) and confidence level
  \(100(1-\alpha)\%\).  Also, a lower confidence interval for the \(p\)'th quantile with
  confidence level \(100(1-\alpha)\%\) is equivalent to a lower \(\beta\)-content tolerance
  interval with coverage \(100(1-p)\%\) and confidence level \(100(1-\alpha)\%\).  See the
  help file for <code><a href="tolIntNpar.html">tolIntNpar</a></code> for more information on nonparametric tolerance
  intervals.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>, <code><a href="tolIntNpar.html">tolIntNpar</a></code>,
  <a href="FcnsByCatEstDistQuants.html">Estimating Distribution Quantiles</a>,
  <a href="FcnsByCatTolInts.html">Tolerance Intervals</a>, <code><a href="estimate.object.html">estimate.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The data frame ACE.13.TCE.df contains observations on</span></span></span>
<span class="r-in"><span>  <span class="co"># Trichloroethylene (TCE) concentrations (mg/L) at</span></span></span>
<span class="r-in"><span>  <span class="co"># 10 groundwater monitoring wells before and after remediation.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the median concentration for each period along with</span></span></span>
<span class="r-in"><span>  <span class="co"># a 95% confidence interval for the median.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># Before remediation:  20.3 [8.8, 35.9]</span></span></span>
<span class="r-in"><span>  <span class="co"># After  remediation:   2.5 [0.8,  5.9]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">ACE.13.TCE.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">eqnpar</span><span class="op">(</span><span class="va">TCE.mg.per.L</span><span class="op">[</span><span class="va">Period</span><span class="op">==</span><span class="st">"Before"</span><span class="op">]</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Median </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   20.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TCE.mg.per.L[Period == \"Before\"]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "50'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   lcl.rank ucl.rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> limit.ranks.over         2        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> limit.ranks.under        3        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8.804775 35.874775 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "interpolate (Nyblom, 1992)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           Median = 20.3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            TCE.mg.per.L[Period == "Before"]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         50'th %ile</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      interpolate (Nyblom, 1992)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        2 9</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 3 8</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =  8.804775</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 35.874775</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">ACE.13.TCE.df</span>, <span class="fu">eqnpar</span><span class="op">(</span><span class="va">TCE.mg.per.L</span><span class="op">[</span><span class="va">Period</span><span class="op">==</span><span class="st">"After"</span><span class="op">]</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Median </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TCE.mg.per.L[Period == \"After\"]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "50'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   lcl.rank ucl.rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> limit.ranks.over         2        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> limit.ranks.under        3        8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7810901 5.8763063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "interpolate (Nyblom, 1992)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           Median = 2.48</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            TCE.mg.per.L[Period == "After"]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         50'th %ile</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      interpolate (Nyblom, 1992)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        2 9</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 3 8</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 0.7810901</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 5.8763063</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Generate 20 observations from a cauchy distribution with parameters</span></span></span>
<span class="r-in"><span>  <span class="co"># location=0, scale=1.  The true 75th percentile of this distribution is 1.</span></span></span>
<span class="r-in"><span>  <span class="co"># Use eqnpar to estimate the 75th percentile and construct a 90% confidence interval.</span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Cauchy.html" class="external-link">rcauchy</a></span><span class="op">(</span><span class="fl">20</span>, location <span class="op">=</span> <span class="fl">0</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co"># First, use the default method, ci.method="interpolate"</span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">eqnpar</span><span class="op">(</span><span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.75</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, approx.conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.524903 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "75'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   lcl.rank ucl.rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> limit.ranks.over        12       19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> limit.ranks.under       13       18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8191423 2.1215570 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "interpolate (Nyblom, 1992)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           75'th %ile = 1.524903</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         75'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      interpolate (Nyblom, 1992)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                90%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        12 19</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 13 18</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 0.8191423</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 2.1215570</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co"># Now use ci.method="exact".</span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the returned confidence level is greater than 90%.</span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">eqnpar</span><span class="op">(</span><span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.75</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, approx.conf.level <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.524903 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "75'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcl.rank ucl.rank </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       12       19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LCL       UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7494692 2.2156601 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9347622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           75'th %ile = 1.524903</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         75'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                93.47622%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        12 19</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 0.7494692</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 2.2156601</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co"># Now use ci.method="exact" with min.coverage=FALSE.</span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the returned confidence level is less than 90%.</span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">eqnpar</span><span class="op">(</span><span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.75</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, approx.conf.level <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>    ci.method <span class="op">=</span> <span class="st">"exact"</span>, min.coverage <span class="op">=</span> <span class="cn">FALSE</span>, <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.524903 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "75'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lcl.rank ucl.rank </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       13       20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.018038 5.002399 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8950169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           75'th %ile = 1.524903</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         75'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                89.50169%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        13 20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 1.018038</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 5.002399</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co"># Now supply our own bounds for the confidence interval.</span></span></span>
<span class="r-in"><span>  <span class="co"># The first example above based on the Interpolate method</span></span></span>
<span class="r-in"><span>  <span class="co"># used lcl.rank=12, ucl.rank=19 and lcl.rank=13, ucl.rank=18</span></span></span>
<span class="r-in"><span>  <span class="co"># and interpolated between these two confidence intervals.</span></span></span>
<span class="r-in"><span>  <span class="co"># Here we will specify lcl.rank=13 and ucl.rank=18.  The</span></span></span>
<span class="r-in"><span>  <span class="co"># resulting confidence level is 81%.</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">eqnpar</span><span class="op">(</span><span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.75</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, lcl.rank <span class="op">=</span> <span class="fl">13</span>, ucl.rank <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1.524903 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "75'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.018038 2.071172 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8069277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           75'th %ile = 1.524903</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         75'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                80.69277%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        13 18</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 1.018038</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 2.071172</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Modify Example 17-4 on page 17-21 of USEPA (2009).  This example uses</span></span></span>
<span class="r-in"><span>  <span class="co"># copper concentrations (ppb) from 3 background wells to set an upper</span></span></span>
<span class="r-in"><span>  <span class="co"># limit for 2 compliance wells.  Here we will attempt to compute an upper</span></span></span>
<span class="r-in"><span>  <span class="co"># 95% confidence interval for the 95'th percentile of the distribution of</span></span></span>
<span class="r-in"><span>  <span class="co"># copper concentrations in the background wells.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># The data are stored in EPA.92c.copper2.df.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># Note that even though these data are Type I left singly censored,</span></span></span>
<span class="r-in"><span>  <span class="co"># it is still possible to compute an estimate of the 95'th percentile.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.92c.copper2.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Copper.orig Copper Censored Month Well  Well.type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           &lt;5    5.0     TRUE     1    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           &lt;5    5.0     TRUE     2    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          7.5    7.5    FALSE     3    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           &lt;5    5.0     TRUE     4    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           &lt;5    5.0     TRUE     5    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           &lt;5    5.0     TRUE     6    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          6.4    6.4    FALSE     7    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            6    6.0    FALSE     8    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          9.2    9.2    FALSE     1    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          &lt;5    5.0     TRUE     2    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11          &lt;5    5.0     TRUE     3    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         6.1    6.1    FALSE     4    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           8    8.0    FALSE     5    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         5.9    5.9    FALSE     6    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15          &lt;5    5.0     TRUE     7    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16          &lt;5    5.0     TRUE     8    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17          &lt;5    5.0     TRUE     1    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         5.4    5.4    FALSE     2    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         6.7    6.7    FALSE     3    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20          &lt;5    5.0     TRUE     4    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21          &lt;5    5.0     TRUE     5    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22          &lt;5    5.0     TRUE     6    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23          &lt;5    5.0     TRUE     7    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24          &lt;5    5.0     TRUE     8    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25                 NA    FALSE     1    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26                 NA    FALSE     2    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                 NA    FALSE     3    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28                 NA    FALSE     4    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         6.2    6.2    FALSE     5    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30          &lt;5    5.0     TRUE     6    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         7.8    7.8    FALSE     7    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32        10.4   10.4    FALSE     8    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33                 NA    FALSE     1    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                 NA    FALSE     2    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35                 NA    FALSE     3    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36                 NA    FALSE     4    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37          &lt;5    5.0     TRUE     5    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38          &lt;5    5.0     TRUE     6    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         5.6    5.6    FALSE     7    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40          &lt;5    5.0     TRUE     8    5 Compliance</span>
<span class="r-in"><span>  <span class="co">#   Copper.orig Copper Censored Month Well  Well.type</span></span></span>
<span class="r-in"><span>  <span class="co">#1           &lt;5    5.0     TRUE     1    1 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#2           &lt;5    5.0     TRUE     2    1 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#3          7.5    7.5    FALSE     3    1 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#9          9.2    9.2    FALSE     1    2 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#10          &lt;5    5.0     TRUE     2    2 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#11          &lt;5    5.0     TRUE     3    2 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#17          &lt;5    5.0     TRUE     1    3 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#18         5.4    5.4    FALSE     2    3 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#19         6.7    6.7    FALSE     3    3 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#29         6.2    6.2    FALSE     5    4 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#30          &lt;5    5.0     TRUE     6    4 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#31         7.8    7.8    FALSE     7    4 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#38          &lt;5    5.0     TRUE     6    5 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#39         5.6    5.6    FALSE     7    5 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#40          &lt;5    5.0     TRUE     8    5 Compliance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Because of the small sample size of n=24 observations, it is not possible</span></span></span>
<span class="r-in"><span>  <span class="co"># to create a nonparametric confidence interval for the 95th percentile</span></span></span>
<span class="r-in"><span>  <span class="co"># that has an associated confidence level of 95%.  If we tried to do this,</span></span></span>
<span class="r-in"><span>  <span class="co"># we would get an error message:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># with(EPA.92c.copper2.df,</span></span></span>
<span class="r-in"><span>  <span class="co">#    eqnpar(Copper[Well.type=="Background"], p = 0.95, ci = TRUE, lb = 0,</span></span></span>
<span class="r-in"><span>  <span class="co">#      ci.type = "upper", approx.conf.level = 0.95))</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Error in ci.qnpar.interpolate(x = c(5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,  :</span></span></span>
<span class="r-in"><span>  <span class="co">#  Minimum coverage of 0.95 is not possible with the given sample size.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># So instead, we will use ci.method="exact" with min.coverage=FALSE</span></span></span>
<span class="r-in"><span>  <span class="co"># to construct the confidence interval.  Note that the associated</span></span></span>
<span class="r-in"><span>  <span class="co"># confidence level is only 71%.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.92c.copper2.df</span>,</span></span>
<span class="r-in"><span>     <span class="fu">eqnpar</span><span class="op">(</span><span class="va">Copper</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Background"</span><span class="op">]</span>, p <span class="op">=</span> <span class="fl">0.95</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>        ci.method <span class="op">=</span> <span class="st">"exact"</span>, min.coverage <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        ci.type <span class="op">=</span> <span class="st">"upper"</span>, lb <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>        approx.conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      7.925 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Copper[Well.type == \"Background\"]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "95'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LCL UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0 9.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.708011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           95'th %ile = 7.925</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Copper[Well.type == "Background"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         95'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                70.8011%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        NA 24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 0.0</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 9.2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># For the above example, the true confidence level is 71% instead of 95%.</span></span></span>
<span class="r-in"><span>  <span class="co"># This is a function of the small sample size.  In fact, as Example 17-4 on</span></span></span>
<span class="r-in"><span>  <span class="co"># pages 17-21 of USEPA (2009) shows, the largest quantile for which you can</span></span></span>
<span class="r-in"><span>  <span class="co"># construct a nonparametric confidence interval that will have associated</span></span></span>
<span class="r-in"><span>  <span class="co"># confidence level of 95% is the 88'th percentile:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.92c.copper2.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">eqnpar</span><span class="op">(</span><span class="va">Copper</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Background"</span><span class="op">]</span>, p <span class="op">=</span> <span class="fl">0.88</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      ci.type <span class="op">=</span> <span class="st">"upper"</span>, lb <span class="op">=</span> <span class="fl">0</span>, ucl.rank <span class="op">=</span> <span class="fl">24</span>,</span></span>
<span class="r-in"><span>      approx.conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      6.892 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Copper[Well.type == \"Background\"]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "88'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LCL UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0 9.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.953486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           88'th %ile = 6.892</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Copper[Well.type == "Background"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         88'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95.3486%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        NA 24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 0.0</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 9.2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Reproduce Example 21-6 on pages 21-21 to 21-22 of USEPA (2009).</span></span></span>
<span class="r-in"><span>  <span class="co"># Use 12 measurements of nitrate (mg/L) at a well used for drinking water</span></span></span>
<span class="r-in"><span>  <span class="co"># to determine with 95% confidence whether or not the infant-based, acute</span></span></span>
<span class="r-in"><span>  <span class="co"># risk standard of 10 mg/L has been violated.  Assume that the risk</span></span></span>
<span class="r-in"><span>  <span class="co"># standard represents an upper 95'th percentile limit on nitrate</span></span></span>
<span class="r-in"><span>  <span class="co"># concentrations.  So what we need to do is construct a one-sided</span></span></span>
<span class="r-in"><span>  <span class="co"># lower nonparametric confidence interval for the 95'th percentile</span></span></span>
<span class="r-in"><span>  <span class="co"># that has associated confidence level of no more than 95%, and we will</span></span></span>
<span class="r-in"><span>  <span class="co"># compare the lower confidence limit with the MCL of 10 mg/L.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># The data for this example are stored in EPA.09.Ex.21.6.nitrate.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at the data:</span></span></span>
<span class="r-in"><span>  <span class="co">#------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.09.Ex.21.6.nitrate.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sampling.Date       Date Nitrate.mg.per.l.orig Nitrate.mg.per.l Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      7/28/1999 1999-07-28                  &lt;5.0              5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       9/3/1999 1999-09-03                  12.3             12.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     11/24/1999 1999-11-24                  &lt;5.0              5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       5/3/2000 2000-05-03                  &lt;5.0              5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      7/14/2000 2000-07-14                   8.1              8.1    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     10/31/2000 2000-10-31                  &lt;5.0              5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     12/14/2000 2000-12-14                    11             11.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      3/27/2001 2001-03-27                  35.1             35.1    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      6/13/2001 2001-06-13                  &lt;5.0              5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     9/16/2001 2001-09-16                  &lt;5.0              5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    11/26/2001 2001-11-26                   9.3              9.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      3/2/2002 2002-03-02                  10.3             10.3    FALSE</span>
<span class="r-in"><span>  <span class="co">#   Sampling.Date       Date Nitrate.mg.per.l.orig Nitrate.mg.per.l Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#1      7/28/1999 1999-07-28                  &lt;5.0              5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#2       9/3/1999 1999-09-03                  12.3             12.3    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#3     11/24/1999 1999-11-24                  &lt;5.0              5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#4       5/3/2000 2000-05-03                  &lt;5.0              5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#5      7/14/2000 2000-07-14                   8.1              8.1    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#6     10/31/2000 2000-10-31                  &lt;5.0              5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#7     12/14/2000 2000-12-14                    11             11.0    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#8      3/27/2001 2001-03-27                  35.1             35.1    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#9      6/13/2001 2001-06-13                  &lt;5.0              5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#10     9/16/2001 2001-09-16                  &lt;5.0              5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#11    11/26/2001 2001-11-26                   9.3              9.3    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#12      3/2/2002 2002-03-02                  10.3             10.3    FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Determine what order statistic to use for the lower confidence limit</span></span></span>
<span class="r-in"><span>  <span class="co"># in order to achieve no more than 95% confidence.</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf.levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="ciNparConfLevel.html">ciNparConfLevel</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span>, p <span class="op">=</span> <span class="fl">0.95</span>, lcl.rank <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,</span></span>
<span class="r-in"><span>    ci.type <span class="op">=</span> <span class="st">"lower"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">conf.levels</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf.levels</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1    2    3    4    5    6    7    8    9   10   11   12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.88 0.54 </span>
<span class="r-in"><span>  <span class="co">#   1    2    3    4    5    6    7    8    9   10   11   12</span></span></span>
<span class="r-in"><span>  <span class="co">#1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.88 0.54</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Using the 11'th largest observation for the lower confidence limit</span></span></span>
<span class="r-in"><span>  <span class="co"># yields a confidence level of 88%.  Using the 10'th largest</span></span></span>
<span class="r-in"><span>  <span class="co"># observation yields a confidence level of 98%.  The example in</span></span></span>
<span class="r-in"><span>  <span class="co"># USEPA (2009) uses the 10'th largest observation.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># The 10'th largest observation is 11 mg/L which exceeds the</span></span></span>
<span class="r-in"><span>  <span class="co"># MCL of 10 mg/L, so there is evidence of contamination.</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.21.6.nitrate.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">eqnpar</span><span class="op">(</span><span class="va">Nitrate.mg.per.l</span>, p <span class="op">=</span> <span class="fl">0.95</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      ci.type <span class="op">=</span> <span class="st">"lower"</span>, lcl.rank <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      22.56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonparametric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nitrate.mg.per.l"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "95'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LCL UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11 Inf </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "lower"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9804317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           95'th %ile = 22.56</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Nonparametric</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Nitrate.mg.per.l</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     12</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         95'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        lower</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                98.04317%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Limit Rank(s):        10 NA</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =  11</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = Inf</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">conf.levels</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

