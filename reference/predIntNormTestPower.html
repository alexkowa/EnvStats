<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Probability That at Least One Future Observation Falls Outside a Prediction Interval for a Normal Distribution — predIntNormTestPower • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Probability That at Least One Future Observation Falls Outside a Prediction Interval for a Normal Distribution — predIntNormTestPower"><meta property="og:description" content="Compute the probability that at least one out of \(k\) future observations
  (or means) falls outside a prediction interval for \(k\) future observations
  (or means) for a normal distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Probability That at Least One Future Observation Falls Outside a Prediction Interval for a Normal Distribution</h1>

    <div class="hidden name"><code>predIntNormTestPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the probability that at least one out of \(k\) future observations
  (or means) falls outside a prediction interval for \(k\) future observations
  (or means) for a normal distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predIntNormTestPower</span><span class="op">(</span><span class="va">n</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, n.mean <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>vector of positive integers greater than 2 indicating the sample size upon which
  the prediction interval is based.</p></dd>

  <dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>vector of positive integers indicating the degrees of freedom associated with
  the sample size.  The default value is <code>df=n-1</code>.</p></dd>

  <dt id="arg-n-mean">n.mean<a class="anchor" aria-label="anchor" href="#arg-n-mean"></a></dt>
<dd><p>positive integer specifying the sample size associated with the future averages.
  The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all
  future averages must be based on the same sample size.</p></dd>

  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>vector of positive integers specifying the number of future observations that the
  prediction interval should contain with confidence level <code>conf.level</code>.  The
  default value is <code>k=1</code>.</p></dd>

  <dt id="arg-delta-over-sigma">delta.over.sigma<a class="anchor" aria-label="anchor" href="#arg-delta-over-sigma"></a></dt>
<dd><p>vector of numbers indicating the ratio \(\Delta/\sigma\).  The quantity
  \(\Delta\) (delta) denotes the difference between the mean of the population
  that was sampled to construct the prediction interval, and the mean of the
  population that will be sampled to produce the future observations.  The quantity
  \(\sigma\) (sigma) denotes the population standard deviation for both populations.
  See the DETAILS section below for more information.  The default value is
  <code>delta.over.sigma=0</code>.</p></dd>

  <dt id="arg-pi-type">pi.type<a class="anchor" aria-label="anchor" href="#arg-pi-type"></a></dt>
<dd><p>character string indicating what kind of prediction interval to compute.
  The possible values are <code>pi.type="upper"</code> (the default), and
  <code>pi.type="lower"</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>numeric vector of values between 0 and 1 indicating the confidence level of the
  prediction interval.  The default value is <code>conf.level=0.95</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><em>What is a Prediction Interval?</em> <br>
  A prediction interval for some population is an interval on the real line
  constructed so that it will contain \(k\) future observations or averages
  from that population with some specified probability \((1-\alpha)100\%\),
  where \(0 &lt; \alpha &lt; 1\) and \(k\) is some pre-specified positive integer.
  The quantity \((1-\alpha)100\%\) is call the confidence coefficient or
  confidence level associated with the prediction interval.  The function
  <code><a href="predIntNorm.html">predIntNorm</a></code> computes a standard prediction interval based on a
  sample from a normal distribution.  The function <code>predIntNormTestPower</code>
  computes the probability that at least one out of \(k\) future observations or
  averages will <b>not</b> be contained in the prediction interval,
  where the population mean for the future observations is allowed to differ from
  the population mean for the observations used to construct the prediction interval.
  <br></p>
<p><em>The Form of a Prediction Interval</em> <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a vector of \(n\)
  observations from a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> with parameters
  <code>mean=</code>\(\mu\) and <code>sd=</code>\(\sigma\).  Also, let \(m\) denote the
  sample size associated with the \(k\) future averages (i.e., <code>n.mean=</code>\(m\)).
  When \(m=1\), each average is really just a single observation, so in the rest of
  this help file the term “averages” will replace the phrase
  “observations or averages”.</p>
<p>For a normal distribution, the form of a two-sided \((1-\alpha)100\%\) prediction
  interval is:
  $$[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)$$
  where \(\bar{x}\) denotes the sample mean:
  $$\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)$$
  \(s\) denotes the sample standard deviation:
  $$s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)$$
  and \(K\) denotes a constant that depends on the sample size \(n\), the
  confidence level, the number of future averages \(k\), and the
  sample size associated with the future averages, \(m\).  Do not confuse the
  constant \(K\) (uppercase K) with the number of future averages \(k\)
  (lowercase k).  The symbol \(K\) is used here to be consistent with the
  notation used for tolerance intervals (see <code><a href="tolIntNorm.html">tolIntNorm</a></code>).</p>
<p>Similarly, the form of a one-sided lower prediction interval is:
  $$[\bar{x} - Ks, \infty] \;\;\;\;\;\; (4)$$
  and the form of a one-sided upper prediction interval is:
  $$[-\infty, \bar{x} + Ks] \;\;\;\;\;\; (5)$$
  but \(K\) differs for one-sided versus two-sided prediction intervals.
  The derivation of the constant \(K\) is explained in the help file for
  <code><a href="predIntNormK.html">predIntNormK</a></code>.
  <br></p>
<p><em>Computing Power</em> <br>
  The "power" of the prediction interval is defined as the probability that at
  least one out of the \(k\) future observations or averages
  will <b>not</b> be contained in the prediction interval, where the population mean
  for the future observations is allowed to differ from the population mean for the
  observations used to construct the prediction interval.  The probability \(p\)
  that all \(k\) future observations will be contained in a one-sided upper
  prediction interval (<code>pi.type="upper"</code>) is given in Equation (6) of the help
  file for
  <code><a href="predIntNormSimultaneousK.html">predIntNormSimultaneousK</a></code>, where \(k=m\) and \(r=1\):
  $$p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) [\frac{v^{k-1}}{B(k, 1)}] dv \;\;\;\;\;\; (6)$$
  where \(T(x; \nu, \delta)\) denotes the cdf of the
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">non-central Student's t-distribution</a> with parameters
  <code>df=</code>\(\nu\) and <code>ncp=</code>\(\delta\) evaluated at \(x\);
  \(\Phi(x)\) denotes the cdf of the standard <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a>
  evaluated at \(x\); and \(B(\nu, \omega)\) denotes the value of the
  <a href="https://rdrr.io/r/base/Special.html" class="external-link">beta function</a> with parameters <code>a=</code>\(\nu\) and
  <code>b=</code>\(\omega\).</p>
<p>The quantity \(\Delta\) (upper case delta) denotes the difference between the
  mean of the population that was sampled to construct the prediction interval, and
  the mean of the population that will be sampled to produce the future observations.
  The quantity \(\sigma\) (sigma) denotes the population standard deviation of both
  of these populations.  Usually you assume \(\Delta=0\) unless you are interested
  in computing the power of the rule to detect a change in means between the
  populations, as we are here.</p>
<p>If we are interested in using averages instead of single observations, with
  \(w \ge 1\) (i.e., <code>n.mean</code>\(\ge 1\)), the first
  term in the integral in Equation (6) that involves the cdf of the
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">non-central Student's t-distribution</a> becomes:
  $$T(\sqrt{n}K; n-1, \frac{\sqrt{n}}{\sqrt{w}}[\Phi^{-1}(v) + \frac{\sqrt{w}\Delta}{\sigma}]) \;\;\;\;\;\; (7)$$</p>
<p>For a given confidence level \((1-\alpha)100\%\), the power of the rule to detect
  a change in means is simply given by:
  $$Power = 1 - p \;\;\;\;\;\; (8)$$
  where \(p\) is defined in Equation (6) above using the value of \(K\) that
  corresponds to \(\Delta/\sigma = 0\).  Thus, when the argument
  <code>delta.over.sigma=0</code>, the value of \(p\) is \(1-\alpha\) and the power is
  simply \(\alpha 100\%\).  As <code>delta.over.sigma</code> increases above 0, the power
  increases.</p>
<p>When <code>pi.type="lower"</code>, the same value of <code>K</code> is used as when
  <code>pi.type="upper"</code>, but Equation (4) is used to construct the prediction
  interval.  Thus, the power increases as <code>delta.over.sigma</code> decreases below 0.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>vector of values between 0 and 1 equal to the probability that at least one of
  \(k\) future observations or averages will fall outside the prediction interval.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>See the help files for <code><a href="predIntNorm.html">predIntNorm</a></code> and
  <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>See the help files for <code><a href="predIntNorm.html">predIntNorm</a></code> and
  <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>.</p>
<p>In the course of designing a sampling program, an environmental scientist may wish
  to determine the relationship between sample size, significance level, power, and
  scaled difference if one of the objectives of the sampling program is to determine
  whether two distributions differ from each other.  The functions
  <code>predIntNormTestPower</code> and <code><a href="plotPredIntNormTestPowerCurve.html">plotPredIntNormTestPowerCurve</a></code> can be
  used to investigate these relationships for the case of normally-distributed
  observations.  In the case of a simple shift between the two means, the test based
  on a prediction interval is not as powerful as the two-sample t-test.  However, the
  test based on a prediction interval is more efficient at detecting a shift in the
  tail.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="predIntNorm.html">predIntNorm</a></code>, <code><a href="predIntNormK.html">predIntNormK</a></code>,
  <code><a href="plotPredIntNormTestPowerCurve.html">plotPredIntNormTestPowerCurve</a></code>, <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>,
  <code><a href="predIntNormSimultaneousK.html">predIntNormSimultaneousK</a></code>,
  <code><a href="predIntNormSimultaneousTestPower.html">predIntNormSimultaneousTestPower</a></code>, <a href="FcnsByCatPredInts.html">Prediction Intervals</a>,
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Show how the power increases as delta.over.sigma increases.  </span></span></span>
<span class="r-in"><span>  <span class="co"># Assume a 95% upper prediction interval.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNormTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0500000 0.1743014 0.3990892</span>
<span class="r-in"><span>  <span class="co">#[1] 0.0500000 0.1743014 0.3990892</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power increases with sample size for a one-sided upper </span></span></span>
<span class="r-in"><span>  <span class="co"># prediction interval with k=3, delta.over.sigma=2, and a confidence level </span></span></span>
<span class="r-in"><span>  <span class="co"># of 95%.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNormTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">3</span>, delta.over.sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3578250 0.5752113</span>
<span class="r-in"><span>  <span class="co">#[1] 0.3578250 0.5752113</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Show how the power for an upper 95% prediction limit increases as the </span></span></span>
<span class="r-in"><span>  <span class="co"># number of future observations k increases.  Here, we'll use n=20 and </span></span></span>
<span class="r-in"><span>  <span class="co"># delta.over.sigma=1.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNormTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, delta.over.sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2408527 0.2751074 0.2936486</span>
<span class="r-in"><span>  <span class="co">#[1] 0.2408527 0.2751074 0.2936486</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

