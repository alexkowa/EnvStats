<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nonparametric Prediction Interval for a Continuous Distribution — predIntNpar • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Nonparametric Prediction Interval for a Continuous Distribution — predIntNpar"><meta property="og:description" content="Construct a nonparametric prediction interval to contain at least \(k\) out of the 
  next \(m\) future observations with probability \((1-\alpha)100\%\) for a 
  continuous distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nonparametric Prediction Interval for a Continuous Distribution</h1>
    
    <div class="hidden name"><code>predIntNpar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Construct a nonparametric prediction interval to contain at least \(k\) out of the 
  next \(m\) future observations with probability \((1-\alpha)100\%\) for a 
  continuous distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">predIntNpar</span><span class="op">(</span><span class="va">x</span>, k <span class="op">=</span> <span class="va">m</span>, m <span class="op">=</span> <span class="fl">1</span>,  lpl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"upper"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, 
    n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"lower"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, 
    lb <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ub <span class="op">=</span> <span class="cn">Inf</span>, pi.type <span class="op">=</span> <span class="st">"two-sided"</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and 
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>
<dt>k</dt>
<dd><p>positive integer specifying the minimum number of future observations out of <code>m</code> 
  that should be contained in the prediction interval. The default value is <code>k=m</code>.</p></dd>
<dt>m</dt>
<dd><p>positive integer specifying the number of future observations.  The default value is 
  <code>m=1</code>.</p></dd>
<dt>lpl.rank</dt>
<dd><p>positive integer indicating the rank of the order statistic to use for the lower 
  bound of the prediction interval.  If <code>pi.type="two-sided"</code> or 
  <code>pi.type="lower"</code>, the default value is <code>lpl.rank=1</code> (implying the 
  minimum value of <code>x</code> is used as the lower bound of the prediction interval).  
  If <code>pi.type="upper"</code>, this argument is set equal to <code>0</code> and the value of 
  <code>lb</code> is used as the lower bound of the tolerance interval.</p></dd>
<dt>n.plus.one.minus.upl.rank</dt>
<dd><p>positive integer related to the rank of the order statistic to use for the upper 
  bound of the prediction interval.  A value of <code>n.plus.one.minus.upl.rank=1</code> 
  (the default when <code>pi.type="two.sided"</code> or <code>pi.type="upper"</code>) means use 
  the first largest value, and in general a value of 
  <code>n.plus.one.minus.upl.rank=</code>\(i\) means use the \(i\)'th largest value.  
  If <code>pi.type="lower"</code>, this argument is set equal to <code>0</code> and the value of 
  <code>ub</code> is used as the upper bound of the prediction interval.</p></dd>
<dt>lb, ub</dt>
<dd><p>scalars indicating lower and upper bounds on the distribution.  By default, <br><code>lb=-Inf</code> and <code>ub=Inf</code>.  If you are constructing a prediction interval for 
  a distribution that you know has a lower bound other than <code>-Inf</code> 
  (e.g., <code>0</code>), set <code>lb</code> to this value.  Similarly, if you know the 
  distribution has an upper bound other than <code>Inf</code>, set <code>ub</code> to this value.  
  The argument <code>lb</code> is ignored if <code>pi.type="two-sided"</code> or 
  <code>pi.type="lower"</code>.  The argument <code>ub</code> is ignored if 
  <code>pi.type="two-sided"</code> or <code>pi.type="upper"</code>.</p></dd>
<dt>pi.type</dt>
<dd><p>character string indicating what kind of prediction interval to compute.  
  The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
  <code>"upper"</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><b>What is a Nonparametric Prediction Interval?</b> <br>
  A nonparametric prediction interval for some population is an interval on the 
  real line constructed so that it will contain at least \(k\) of \(m\) future 
  observations from that population with some specified probability 
  \((1-\alpha)100\%\), where \(0 &lt; \alpha &lt; 1\) and \(k\) and \(m\) are 
  pre-specified positive integer where \(k \le m\).  
  The quantity \((1-\alpha)100\%\) is called  
  the confidence coefficient or confidence level associated with the prediction 
  interval.</p>
<p><b>The Form of a Nonparametric Prediction Interval</b> <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a vector of \(n\) 
  independent observations from some continuous distribution, and let 
  \(x_{(i)}\) denote the the \(i\)'th order statistics in \(\underline{x}\).  
  A two-sided nonparametric prediction interval is constructed as:
  $$[x_{(u)}, x_{(v)}] \;\;\;\;\;\; (1)$$
  where \(u\) and \(v\) are positive integers between 1 and \(n\), and 
  \(u &lt; v\).  That is, \(u\) denotes the rank of the lower prediction limit, and 
  \(v\) denotes the rank of the upper prediction limit.  To make it easier to write 
  some equations later on, we can also write the prediction interval (1) in a slightly 
  different way as:
  $$[x_{(u)}, x_{(n + 1 - w)}] \;\;\;\;\;\; (2)$$
  where
  $$w = n + 1 - v \;\;\;\;\;\; (3)$$
  so that \(w\) is a positive integer between 1 and \(n-1\), and 
  \(u &lt; n+1-w\).  In terms of the arguments to the function <code>predIntNpar</code>, 
  the argument <code>lpl.rank</code> corresponds to \(u\), and the argument 
  <code>n.plus.one.minus.upl.rank</code> corresponds to \(w\).</p>
<p>If we allow \(u=0\) and \(w=0\) and define lower and upper bounds as:
  $$x_{(0)} = lb \;\;\;\;\;\; (4)$$
  $$x_{(n+1)} = ub \;\;\;\;\;\; (5)$$
  then Equation (2) above can also represent a one-sided lower or one-sided upper 
  prediction interval as well.  That is, a one-sided lower nonparametric prediction 
  interval is constructed as:
  $$[x_{(u)}, x_{(n + 1)}] =  [x_{(u)}, ub] \;\;\;\;\;\; (6)$$
  and a one-sided upper nonparametric prediction interval is constructed as:
  $$[x_{(0)}, x_{(n + 1 - w)}]  = [lb, x_{(n + 1 - w)}] \;\;\;\;\;\; (7)$$
  Usually, \(lb = -\infty\) or \(lb = 0\) and \(ub = \infty\).</p>
<p><b>Constructing Nonparametric Prediction Intervals for Future Observations</b> <br>
  Danziger and Davis (1964) show that the probability that at least \(k\) out of 
  the next \(m\) observations will fall in the interval defined in Equation (2) 
  is given by:
  $$(1 - \alpha) = [\sum_{i=k}^m {{m-i+u+w-1} \choose {m-i}} {{i+n-u-w} \choose i}] / {{n+m} \choose m} \;\;\;\;\;\; (8)$$</p>
<p>(Note that computing a nonparametric prediction interval for the case 
  \(k = m = 1\) is equivalent to computing a nonparametric \(\beta\)-expectation 
  tolerance interval with coverage \((1-\alpha)100\%\); see <code><a href="tolIntNpar.html">tolIntNpar</a></code>).
  <br></p>
<p><em>The Special Case of Using the Minimum and the Maximum</em> <br>
  Setting \(u = w = 1\) implies using the smallest and largest observed values as 
  the prediction limits.  In this case, it can be shown that the probability that at 
  least \(k\) out of the next \(m\) observations will fall in the interval
  $$[x_{(1)}, x_{(n)}] \;\;\;\;\;\; (9)$$
  is given by:
  $$(1 - \alpha) = [\sum_{i=k}^m (m-i-1){{n+i-2} \choose i}] / {{n+m} \choose m} \;\;\;\;\;\; (10)$$</p>
<p>Setting \(k=m\) in Equation (10), the probability that all of the next \(m\) 
  observations will fall in the interval defined in Equation (9) is given by:
  $$(1 - \alpha) = \frac{n(n-1)}{(n+m)(n+m-1)} \;\;\;\;\;\; (11)$$</p>
<p>For one-sided prediction limits, the probability that all \(m\) future 
  observations will fall below \(x_{(n)}\) (upper prediction limit; 
  <code>pi.type="upper"</code>) and the probabilitiy that all \(m\) future observations 
  will fall above \(x_{(1)}\) (lower prediction limit; <code>pi.type="lower"</code>) are 
  both given by:
  $$(1 - \alpha) = \frac{n}{n+m} \;\;\;\;\;\; (12)$$
  <br></p>
<p><b>Constructing Nonparametric Prediction Intervals for Future Medians</b> <br>
  To construct a nonparametric prediction interval for a future median based on 
  \(s\) future observations, where \(s\) is odd, note that this is equivalent to 
  constructing a nonparametric prediction interval that must hold 
  at least \(k = (s+1)/2\) of the next \(m = s\) future observations.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"estimate"</code> containing the prediction interval and other 
  information.  See the help file for <code><a href="estimate.object.html">estimate.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Danziger, L., and S. Davis. (1964).  Tables of Distribution-Free Tolerance Limits.  
  <em>Annals of Mathematical Statistics</em> <b>35</b>(5), 1361--1365.</p>
<p>Davis, C.B. (1994).  Environmental Regulatory Statistics.  In Patil, G.P., 
  and C.R. Rao, eds., <em>Handbook of Statistics, Vol. 12: Environmental Statistics</em>.  
  North-Holland, Amsterdam, a division of Elsevier, New York, NY, Chapter 26, 817--865.</p>
<p>Davis, C.B., and R.J. McNichols. (1987).  One-sided Intervals for at Least p of m 
  Observations from a Normal Population on Each of r Future Occasions.  
  <em>Technometrics</em> <b>29</b>, 359--370.</p>
<p>Davis, C.B., and R.J. McNichols. (1994a).  Ground Water Monitoring Statistics Update:  
  Part I: Progress Since 1988.  <em>Ground Water Monitoring and Remediation</em> 
  <b>14</b>(4), 148--158.</p>
<p>Davis, C.B., and R.J. McNichols. (1994b).  Ground Water Monitoring Statistics Update:  
  Part II:  Nonparametric Prediction Limits.  
  <em>Ground Water Monitoring and Remediation</em> <b>14</b>(4), 159--175.</p>
<p>Davis, C.B., and R.J. McNichols. (1999).  Simultaneous Nonparametric Prediction 
  Limits (with Discusson).  <em>Technometrics</em> <b>41</b>(2), 89--112.</p>
<p>Gibbons, R.D. (1987a).  Statistical Prediction Intervals for the Evaluation of 
  Ground-Water Quality.  <em>Ground Water</em> <b>25</b>, 455--465.</p>
<p>Gibbons, R.D. (1991b).  Statistical Tolerance Limits for Ground-Water Monitoring.  
  <em>Ground Water</em> <b>29</b>, 563--570.</p>
<p>Gibbons, R.D., and J. Baker. (1991).  The Properties of Various Statistical 
  Prediction Intervals for Ground-Water Detection Monitoring.  
  <em>Journal of Environmental Science and Health</em> <b>A26</b>(4), 535--553.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009). 
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.  
  John Wiley &amp; Sons, Hoboken.</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991).  
  <em>Statistical Intervals: A Guide for Practitioners</em>.  John Wiley and Sons, 
  New York, 392pp.</p>
<p>Hahn, G., and W. Nelson. (1973).  A Survey of Prediction Intervals and Their 
  Applications.  <em>Journal of Quality Technology</em> <b>5</b>, 178--188.</p>
<p>Hall, I.J., R.R. Prairie, and C.K. Motlagh. (1975).  Non-Parametric Prediction 
  Intervals.  <em>Journal of Quality Technology</em> <b>7</b>(3), 109--114.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>. 
  CRC Press, Boca Raton, Florida.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Prediction and tolerance intervals have long been applied to quality control and 
  life testing problems (Hahn, 1970b,c; Hahn and Nelson, 1973; 
  Krishnamoorthy and Mathew, 2009).  
  In the context of environmental statistics, prediction intervals are useful for 
  analyzing data from groundwater detection monitoring programs at hazardous and 
  solid waste facilities (e.g., Gibbons et al., 2009; Millard and Neerchal, 2001; 
  USEPA, 2009).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="estimate.object.html">estimate.object</a></code>, <code><a href="predIntNparN.html">predIntNparN</a></code>, 
  <code><a href="predIntNparConfLevel.html">predIntNparConfLevel</a></code>, <code><a href="plotPredIntNparDesign.html">plotPredIntNparDesign</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Generate 20 observations from a lognormal mixture distribution with </span></span>
<span class="r-in">  <span class="co"># parameters mean1=1, cv1=0.5, mean2=5, cv2=1, and p.mix=0.1.  Use </span></span>
<span class="r-in">  <span class="co"># predIntNpar to construct a two-sided prediction interval using the </span></span>
<span class="r-in">  <span class="co"># minimum and maximum observed values.  Note that the associated confidence </span></span>
<span class="r-in">  <span class="co"># level is 90%.  A larger sample size is required to obtain a larger </span></span>
<span class="r-in">  <span class="co"># confidence level (see the help file for predIntNparN). </span></span>
<span class="r-in">  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalMixAlt.html">rlnormMixAlt</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, mean1 <span class="op">=</span> <span class="fl">1</span>, cv1 <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span class="r-in">    mean2 <span class="op">=</span> <span class="fl">5</span>, cv2 <span class="op">=</span> <span class="fl">1</span>, p.mix <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNpar</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LPL       UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3647875 1.8173115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9047619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            None</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      Exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                90.47619%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Limit Rank(s):        1 20 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number of Future Observations:   1</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL = 0.3647875</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 1.8173115</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Repeat the above example, but specify m=5 future observations should be </span></span>
<span class="r-in">  <span class="co"># contained in the prediction interval.  Note that the confidence level is </span></span>
<span class="r-in">  <span class="co"># now only 63%.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNpar</span><span class="op">(</span><span class="va">dat</span>, m <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LPL       UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3647875 1.8173115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            None</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      Exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                63.33333%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Limit Rank(s):        1 20 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number of Future Observations:   5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL = 0.3647875</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 1.8173115</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Repeat the above example, but specify that a minimum of k=3 observations </span></span>
<span class="r-in">  <span class="co"># out of a total of m=5 future observations should be contained in the </span></span>
<span class="r-in">  <span class="co"># prediction interval.  Note that the confidence level is now 98%.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNpar</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">3</span>, m <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       LPL       UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3647875 1.8173115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9837945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            None</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      Exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        two-sided</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                98.37945%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Limit Rank(s):        1 20 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Minimum Number of</span></span>
<span class="r-in">  <span class="co">#Future Observations</span></span>
<span class="r-in">  <span class="co">#Interval Should Contain:         3</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Total Number of</span></span>
<span class="r-in">  <span class="co">#Future Observations:             5</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL = 0.3647875</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 1.8173115</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Example 18-3 of USEPA (2009, p.18-19) shows how to construct </span></span>
<span class="r-in">  <span class="co"># a one-sided upper nonparametric prediction interval for the next </span></span>
<span class="r-in">  <span class="co"># 4 future observations of trichloroethylene (TCE) at a downgradient well.  </span></span>
<span class="r-in">  <span class="co"># The data for this example are stored in EPA.09.Ex.18.3.TCE.df.  </span></span>
<span class="r-in">  <span class="co"># There are 6 monthly observations of TCE (ppb) at 3 background wells, </span></span>
<span class="r-in">  <span class="co"># and 4 monthly observations of TCE at a compliance well.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at the data</span></span>
<span class="r-in">  <span class="co">#-----------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">EPA.09.Ex.18.3.TCE.df</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Month Well  Well.type TCE.ppb.orig TCE.ppb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 BW-1 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2 BW-1 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      3 BW-1 Background            8     8.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4 BW-1 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      5 BW-1 Background            9     9.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      6 BW-1 Background           10    10.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      1 BW-2 Background            7     7.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      2 BW-2 Background          6.5     6.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      3 BW-2 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     4 BW-2 Background            6     6.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     5 BW-2 Background           12    12.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     6 BW-2 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     1 BW-3 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     2 BW-3 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     3 BW-3 Background         10.5    10.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     4 BW-3 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     5 BW-3 Background           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     6 BW-3 Background            9     9.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     1 CW-4 Compliance                   NA    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     2 CW-4 Compliance                   NA    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     3 CW-4 Compliance          7.5     7.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     4 CW-4 Compliance           &lt;5     5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     5 CW-4 Compliance            8     8.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     6 CW-4 Compliance           14    14.0    FALSE</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#   Month Well  Well.type TCE.ppb.orig TCE.ppb Censored</span></span>
<span class="r-in">  <span class="co">#1      1 BW-1 Background           &lt;5     5.0     TRUE</span></span>
<span class="r-in">  <span class="co">#2      2 BW-1 Background           &lt;5     5.0     TRUE</span></span>
<span class="r-in">  <span class="co">#3      3 BW-1 Background            8     8.0    FALSE</span></span>
<span class="r-in">  <span class="co">#...</span></span>
<span class="r-in">  <span class="co">#22     4 CW-4 Compliance           &lt;5     5.0     TRUE</span></span>
<span class="r-in">  <span class="co">#23     5 CW-4 Compliance            8     8.0    FALSE</span></span>
<span class="r-in">  <span class="co">#24     6 CW-4 Compliance           14    14.0    FALSE</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="longToWide.html">longToWide</a></span><span class="op">(</span><span class="va">EPA.09.Ex.18.3.TCE.df</span>, <span class="st">"TCE.ppb.orig"</span>, <span class="st">"Month"</span>, <span class="st">"Well"</span>, </span>
<span class="r-in">    paste.row.name <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         BW-1 BW-2 BW-3 CW-4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.1   &lt;5    7   &lt;5     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.2   &lt;5  6.5   &lt;5     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.3    8   &lt;5 10.5  7.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.4   &lt;5    6   &lt;5   &lt;5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.5    9   12   &lt;5    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.6   10   &lt;5    9   14</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#        BW-1 BW-2 BW-3 CW-4</span></span>
<span class="r-in">  <span class="co">#Month.1   &lt;5    7   &lt;5     </span></span>
<span class="r-in">  <span class="co">#Month.2   &lt;5  6.5   &lt;5     </span></span>
<span class="r-in">  <span class="co">#Month.3    8   &lt;5 10.5  7.5</span></span>
<span class="r-in">  <span class="co">#Month.4   &lt;5    6   &lt;5   &lt;5</span></span>
<span class="r-in">  <span class="co">#Month.5    9   12   &lt;5    8</span></span>
<span class="r-in">  <span class="co">#Month.6   10   &lt;5    9   14</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Construct the prediction limit based on the background well data </span></span>
<span class="r-in">  <span class="co"># using the maximum value as the upper prediction limit.  </span></span>
<span class="r-in">  <span class="co"># Note that since all censored observations are censored at one </span></span>
<span class="r-in">  <span class="co"># censoring level and the censoring level is less than all of the </span></span>
<span class="r-in">  <span class="co"># uncensored observations, we can just supply the censoring level </span></span>
<span class="r-in">  <span class="co"># to predIntNpar.</span></span>
<span class="r-in">  <span class="co">#-----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.18.3.TCE.df</span>, </span>
<span class="r-in">    <span class="fu">predIntNpar</span><span class="op">(</span><span class="va">TCE.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      m <span class="op">=</span> <span class="fl">4</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "TCE.ppb[Well.type == \"Background\"]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LPL UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0  12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8181818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            None</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            TCE.ppb[Well.type == "Background"]</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     18</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      Exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                81.81818%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Limit Rank(s):        18 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Number of Future Observations:   4</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL =  0</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 12</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Since the value of 14 ppb for Month 6 at the compliance well exceeds </span></span>
<span class="r-in">  <span class="co"># the upper prediction limit of 12, we might conclude that there is </span></span>
<span class="r-in">  <span class="co"># statistically significant evidence of an increase over background </span></span>
<span class="r-in">  <span class="co"># at CW-4.  However, the confidence level associated with this </span></span>
<span class="r-in">  <span class="co"># prediction limit is about 82%, which implies a Type I error level of </span></span>
<span class="r-in">  <span class="co"># 18%.  This means there is nearly a one in five chance of a false positive. </span></span>
<span class="r-in">  <span class="co"># Only additional background data and/or use of a retesting strategy </span></span>
<span class="r-in">  <span class="co"># (see predIntNparSimultaneous) would lower the false positive rate.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Example 18-4 of USEPA (2009, p.18-19) shows how to construct </span></span>
<span class="r-in">  <span class="co"># a one-sided upper nonparametric prediction interval for the next </span></span>
<span class="r-in">  <span class="co"># median of order 3 of xylene at a downgradient well.  </span></span>
<span class="r-in">  <span class="co"># The data for this example are stored in EPA.09.Ex.18.4.xylene.df.  </span></span>
<span class="r-in">  <span class="co"># There are 8 monthly observations of xylene (ppb) at 3 background wells, </span></span>
<span class="r-in">  <span class="co"># and 3 montly observations of TCE at a compliance well.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at the data</span></span>
<span class="r-in">  <span class="co">#-----------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">EPA.09.Ex.18.4.xylene.df</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Month   Well  Well.type Xylene.ppb.orig Xylene.ppb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 Well.1 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2 Well.1 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      3 Well.1 Background             7.5        7.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4 Well.1 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      5 Well.1 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      6 Well.1 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      7 Well.1 Background             6.4        6.4    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      8 Well.1 Background               6        6.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1 Well.2 Background             9.2        9.2    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2 Well.2 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     3 Well.2 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     4 Well.2 Background             6.1        6.1    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     5 Well.2 Background               8        8.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     6 Well.2 Background             5.9        5.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     7 Well.2 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     8 Well.2 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     1 Well.3 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     2 Well.3 Background             5.4        5.4    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     3 Well.3 Background             6.7        6.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     4 Well.3 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     5 Well.3 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     6 Well.3 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     7 Well.3 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     8 Well.3 Background              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25     1 Well.4 Compliance                         NA    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     2 Well.4 Compliance                         NA    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27     3 Well.4 Compliance                         NA    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     4 Well.4 Compliance                         NA    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29     5 Well.4 Compliance                         NA    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30     6 Well.4 Compliance              &lt;5        5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31     7 Well.4 Compliance             7.8        7.8    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32     8 Well.4 Compliance            10.4       10.4    FALSE</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#   Month   Well  Well.type Xylene.ppb.orig Xylene.ppb Censored</span></span>
<span class="r-in">  <span class="co">#1      1 Well.1 Background              &lt;5        5.0     TRUE</span></span>
<span class="r-in">  <span class="co">#2      2 Well.1 Background              &lt;5        5.0     TRUE</span></span>
<span class="r-in">  <span class="co">#3      3 Well.1 Background             7.5        7.5    FALSE</span></span>
<span class="r-in">  <span class="co">#...</span></span>
<span class="r-in">  <span class="co">#30     6 Well.4 Compliance              &lt;5        5.0     TRUE</span></span>
<span class="r-in">  <span class="co">#31     7 Well.4 Compliance             7.8        7.8    FALSE</span></span>
<span class="r-in">  <span class="co">#32     8 Well.4 Compliance            10.4       10.4    FALSE</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="longToWide.html">longToWide</a></span><span class="op">(</span><span class="va">EPA.09.Ex.18.4.xylene.df</span>, <span class="st">"Xylene.ppb.orig"</span>, <span class="st">"Month"</span>, <span class="st">"Well"</span>, </span>
<span class="r-in">    paste.row.name <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Well.1 Well.2 Well.3 Well.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.1     &lt;5    9.2     &lt;5       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.2     &lt;5     &lt;5    5.4       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.3    7.5     &lt;5    6.7       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.4     &lt;5    6.1     &lt;5       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.5     &lt;5      8     &lt;5       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.6     &lt;5    5.9     &lt;5     &lt;5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.7    6.4     &lt;5     &lt;5    7.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.8      6     &lt;5     &lt;5   10.4</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#        Well.1 Well.2 Well.3 Well.4</span></span>
<span class="r-in">  <span class="co">#Month.1     &lt;5    9.2     &lt;5       </span></span>
<span class="r-in">  <span class="co">#Month.2     &lt;5     &lt;5    5.4       </span></span>
<span class="r-in">  <span class="co">#Month.3    7.5     &lt;5    6.7       </span></span>
<span class="r-in">  <span class="co">#Month.4     &lt;5    6.1     &lt;5       </span></span>
<span class="r-in">  <span class="co">#Month.5     &lt;5      8     &lt;5       </span></span>
<span class="r-in">  <span class="co">#Month.6     &lt;5    5.9     &lt;5     &lt;5</span></span>
<span class="r-in">  <span class="co">#Month.7    6.4     &lt;5     &lt;5    7.8</span></span>
<span class="r-in">  <span class="co">#Month.8      6     &lt;5     &lt;5   10.4</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Construct the prediction limit based on the background well data </span></span>
<span class="r-in">  <span class="co"># using the maximum value as the upper prediction limit. </span></span>
<span class="r-in">  <span class="co"># Note that since all censored observations are censored at one </span></span>
<span class="r-in">  <span class="co"># censoring level and the censoring level is less than all of the </span></span>
<span class="r-in">  <span class="co"># uncensored observations, we can just supply the censoring level </span></span>
<span class="r-in">  <span class="co"># to predIntNpar.</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co"># To compute a prediction interval for a median of order 3 (i.e., </span></span>
<span class="r-in">  <span class="co"># a median based on 3 observations), this is equivalent to </span></span>
<span class="r-in">  <span class="co"># constructing a nonparametric prediction interval that must hold </span></span>
<span class="r-in">  <span class="co"># at least 2 of the next 3 future observations.</span></span>
<span class="r-in">  <span class="co">#-----------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.18.4.xylene.df</span>, </span>
<span class="r-in">    <span class="fu">predIntNpar</span><span class="op">(</span><span class="va">Xylene.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span>, </span>
<span class="r-in">      k <span class="op">=</span> <span class="fl">2</span>, m <span class="op">=</span> <span class="fl">3</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "None"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Xylene.ppb[Well.type == \"Background\"]"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limit.ranks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LPL UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0 9.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.991453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            None</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            Xylene.ppb[Well.type == "Background"]</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     24</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Method:      Exact</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                99.1453%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Limit Rank(s):        24 </span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Minimum Number of</span></span>
<span class="r-in">  <span class="co">#Future Observations</span></span>
<span class="r-in">  <span class="co">#Interval Should Contain:         2</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Total Number of</span></span>
<span class="r-in">  <span class="co">#Future Observations:             3</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Prediction Interval:             LPL = 0.0</span></span>
<span class="r-in">  <span class="co">#                                 UPL = 9.2</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The Month 8 observation at the Complance well is 10.4 ppb of Xylene, </span></span>
<span class="r-in">  <span class="co"># which is greater than the upper prediction limit of 9.2 ppb, so</span></span>
<span class="r-in">  <span class="co"># conclude there is evidence of contamination at the </span></span>
<span class="r-in">  <span class="co"># 100% - 99% = 1% Type I Error Level</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Cleanup</span></span>
<span class="r-in">  <span class="co">#--------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

