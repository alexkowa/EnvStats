<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simultaneous Prediction Interval for a Normal Distribution — predIntNormSimultaneous • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simultaneous Prediction Interval for a Normal Distribution — predIntNormSimultaneous"><meta property="og:description" content="Estimate the mean and standard deviation of a
  normal distribution, and construct a simultaneous prediction
  interval for the next \(r\) sampling &amp;#8220;occasions&amp;#8221;, based on one of three
  possible rules: \(k\)-of-\(m\), California, or Modified California."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simultaneous Prediction Interval for a Normal Distribution</h1>
    
    <div class="hidden name"><code>predIntNormSimultaneous.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the mean and standard deviation of a
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a>, and construct a simultaneous prediction
  interval for the next \(r\) sampling “occasions”, based on one of three
  possible rules: \(k\)-of-\(m\), California, or Modified California.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">x</span>, n.mean <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">1</span>, rule <span class="op">=</span> <span class="st">"k.of.m"</span>,
    delta.over.sigma <span class="op">=</span> <span class="fl">0</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>,
    K.tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector of observations, or an object resulting from a call to an estimating
  function that assumes a normal (Gaussian) distribution (e.g., <code><a href="enorm.html">enorm</a></code>,
  <code><a href="eqnorm.html">eqnorm</a></code>, <code><a href="enormCensored.html">enormCensored</a></code>, etc.).  If <code>x</code> is a
  numeric vector, missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>
<dt>n.mean</dt>
<dd><p>positive integer specifying the sample size associated with the future averages.
  The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all
  future averages must be based on the same sample size.</p></dd>
<dt>k</dt>
<dd><p>for the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), a positive integer
  specifying the minimum number of observations (or averages) out of \(m\)
  observations (or averages) (all obtained on one future sampling “occassion”)
  the prediction interval should contain with confidence level <code>conf.level</code>.
  The default value is <code>k=1</code>.  This argument is ignored when the argument
  <code>rule</code> is not equal to <code>"k.of.m"</code>.</p></dd>
<dt>m</dt>
<dd><p>positive integer specifying the maximum number of future observations (or
  averages) on one future sampling “occasion”.
  The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which
  case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.</p></dd>
<dt>r</dt>
<dd><p>positive integer specifying the number of future sampling “occasions”.
  The default value is <code>r=1</code>.</p></dd>
<dt>rule</dt>
<dd><p>character string specifying which rule to use.  The possible values are
  <code>"k.of.m"</code> (\(k\)-of-\(m\) rule; the default), <code>"CA"</code> (California rule),
  and <code>"Modified.CA"</code> (modified California rule).
  See the DETAILS section below for more information.</p></dd>
<dt>delta.over.sigma</dt>
<dd><p>numeric scalar indicating the ratio \(\Delta/\sigma\).  The quantity
  \(\Delta\) (delta) denotes the difference between the mean of the population
  that was sampled to construct the prediction interval, and the mean of the
  population that will be sampled to produce the future observations.  The quantity
  \(\sigma\) (sigma) denotes the population standard deviation for both populations.
  See the DETAILS section below for more information.  The default value is
  <code>delta.over.sigma=0</code>.</p></dd>
<dt>pi.type</dt>
<dd><p>character string indicating what kind of prediction interval to compute.
  The possible values are <code>pi.type="upper"</code> (the default),
  <code>pi.type="lower"</code> and <code>pi.type="two-sided"</code>.</p></dd>
<dt>conf.level</dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the prediction interval.
  The default value is <code>conf.level=0.95</code>.</p></dd>
<dt>K.tol</dt>
<dd><p>numeric scalar indicating the tolerance to use in the nonlinear search algorithm to
  compute \(K\).  The default value is <code>K.tol=.Machine$double.eps^(1/2)</code>.
  For many applications, the value of \(K\) needs to be known only to the second
  decimal place, in which case setting <code>K.tol=1e-4</code> will speed up computation a
  bit.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><em>What is a Simultaneous Prediction Interval?</em> <br>
  A prediction interval for some population is an interval on the real line constructed
  so that it will contain \(k\) future observations from that population
  with some specified probability \((1-\alpha)100\%\), where
  \(0 &lt; \alpha &lt; 1\) and \(k\) is some pre-specified positive integer.
  The quantity \((1-\alpha)100\%\) is called
  the confidence coefficient or confidence level associated with the prediction
  interval.  The function <code><a href="predIntNorm.html">predIntNorm</a></code> computes a standard prediction
  interval based on a sample from a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a>.</p>
<p>The function <code>predIntNormSimultaneous</code> computes a simultaneous prediction
  interval that will contain a certain number of future observations with probability
  \((1-\alpha)100\%\) for each of \(r\) future sampling “occasions”,
  where \(r\) is some pre-specified positive integer.  The quantity \(r\) may
  refer to \(r\) distinct future sampling occasions in time, or it may for example
  refer to sampling at \(r\) distinct locations on one future sampling occasion,
  assuming that the population standard deviation is the same at all of the \(r\)
  distinct locations.</p>
<p>The function <code>predIntNormSimultaneous</code> computes a simultaneous prediction
  interval based on one of three possible rules:</p><ul><li><p>For the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), at least \(k\) of
    the next \(m\) future observations will fall in the prediction
    interval with probability \((1-\alpha)100\%\) on each of the \(r\) future
    sampling occasions.  If obserations are being taken sequentially, for a particular
    sampling occasion, up to \(m\) observations may be taken, but once
    \(k\) of the observations fall within the prediction interval, sampling can stop.
    Note:  When \(k=m\) and \(r=1\), the results of <code>predIntNormSimultaneous</code>
    are equivalent to the results of <code><a href="predIntNorm.html">predIntNorm</a></code>.</p></li>
<li><p>For the California rule (<code>rule="CA"</code>), with probability
    \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either
    the first observation will fall in the prediction interval, or else all of the next
    \(m-1\) observations will fall in the prediction interval. That is, if the first
    observation falls in the prediction interval then sampling can stop.  Otherwise,
    \(m-1\) more observations must be taken.</p></li>
<li><p>For the Modified California rule (<code>rule="Modified.CA"</code>), with probability
    \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either the
    first observation will fall in the prediction interval, or else at least 2 out of
    the next 3 observations will fall in the prediction interval.  That is, if the first
    observation falls in the prediction interval then sampling can stop.  Otherwise, up
    to 3 more observations must be taken.</p></li>
</ul><p>Simultaneous prediction intervals can be extended to using averages (means) in place
  of single observations (USEPA, 2009, Chapter 19).  That is, you can create a
  simultaneous prediction interval
  that will contain a specified number of averages (based on which rule you choose) on
  each of \(r\) future sampling occassions, where each each average is based on
  \(w\) individual observations.  For the function <code>predIntNormSimultaneous</code>,
  the argument <code>n.mean</code> corresponds to \(w\).
  <br></p>
<p><em>The Form of a Prediction Interval</em> <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a vector of \(n\)
  observations from a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> with parameters
  <code>mean=</code>\(\mu\) and <code>sd=</code>\(\sigma\).  Also, let \(w\) denote the
  sample size associated with the future averages (i.e., <code>n.mean=</code>\(w\)).
  When \(w=1\), each average is really just a single observation, so in the rest of
  this help file the term “averages” will replace the phrase
  “observations or averages”.</p>
<p>For a normal distribution, the form of a two-sided \((1-\alpha)100\%\)
  prediction interval is:
  $$[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)$$
  where \(\bar{x}\) denotes the sample mean:
  $$\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)$$
  \(s\) denotes the sample standard deviation:
  $$s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)$$
  and \(K\) denotes a constant that depends on the sample size \(n\), the
  confidence level, the number of future sampling occassions \(r\), and the
  sample size associated with the future averages, \(w\).  Do not confuse the
  constant \(K\) (uppercase K) with the number of future averages \(k\)
  (lowercase k) in the \(k\)-of-\(m\) rule.  The symbol \(K\) is used here
  to be consistent with the notation used for tolerance intervals
  (see <code><a href="tolIntNorm.html">tolIntNorm</a></code>).</p>
<p>Similarly, the form of a one-sided lower prediction interval is:
  $$[\bar{x} - Ks, \infty] \;\;\;\;\;\; (4)$$
  and the form of a one-sided upper prediction interval is:
  $$[-\infty, \bar{x} + Ks] \;\;\;\;\;\; (5)$$</p>
<p><b>Note:</b>  For simultaneous prediction intervals, only lower
  (<code>pi.type="lower"</code>) and upper <br>
  (<code>pi.type="upper"</code>) prediction
  intervals are available.</p>
<p>The derivation of the constant \(K\) is explained in the help file for
  <code><a href="predIntNormSimultaneousK.html">predIntNormSimultaneousK</a></code>.
  <br></p>
<p><em>Prediction Intervals are Random Intervals</em> <br>
  A prediction interval is a <em>random</em> interval; that is, the lower and/or
  upper bounds are random variables computed based on sample statistics in the
  baseline sample.  Prior to taking one specific baseline sample, the probability
  that the prediction interval will perform according to the rule chosen is
  \((1-\alpha)100\%\).  Once a specific baseline sample is taken and the prediction
  interval based on that sample is computed, the probability that that prediction
  interval will perform according to the rule chosen is not necessarily
  \((1-\alpha)100\%\), but it should be close.  See the help file for
  <code><a href="predIntNorm.html">predIntNorm</a></code> for more information.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>x</code> is a numeric vector, <code>predIntNormSimultaneous</code> returns a list of
  class <code>"estimate"</code> containing the estimated parameters, the prediction interval,
  and other information.  See the help file for <br><code><a href="estimate.object.html">estimate.object</a></code> for details.
  If <code>x</code> is the result of calling an estimation function,
<code>predIntNormSimultaneous</code> returns a list whose class is the same as <code>x</code>.
  The list contains the same components as <code>x</code>, as well as a component called
<code>interval</code> containing the prediction interval information.
  If <code>x</code> already has a component called <code>interval</code>, this component is
  replaced with the prediction interval information.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><b>Barclay's California Code of Regulations</b>. (1991). Title 22,
  Section 66264.97 [concerning hazardous waste facilities] and Title 23,
  Section 2550.7(e)(8) [concerning solid waste facilities].
  Barclay's Law Publishers, San Francisco, CA.</p>
<p>Davis, C.B. (1998a).  <em>Ground-Water Statistics \&amp; Regulations:  Principles,
  Progress and Problems</em>.  Second Edition.  Environmetrics \&amp; Statistics Limited,
  Henderson, NV.</p>
<p>Davis, C.B. (1998b). Personal Communication, September 3, 1998.</p>
<p>Davis, C.B., and R.J. McNichols. (1987).  One-sided Intervals for at Least \(p\)
  of \(m\) Observations from a Normal Population on Each of \(r\) Future Occasions.
  <em>Technometrics</em> <b>29</b>, 359--370.</p>
<p>Fertig, K.W., and N.R. Mann. (1977).  One-Sided Prediction Intervals for at Least
  \(p\) Out of \(m\) Future Observations From a Normal Population.
  <em>Technometrics</em> <b>19</b>, 167--177.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
  John Wiley &amp; Sons, Hoboken.</p>
<p>Hahn, G.J. (1969). Factors for Calculating Two-Sided Prediction Intervals for
  Samples from a Normal Distribution.
  <em>Journal of the American Statistical Association</em> <b>64</b>(327), 878-898.</p>
<p>Hahn, G.J. (1970a). Additional Factors for Calculating Prediction Intervals for
  Samples from a Normal Distribution.
  <em>Journal of the American Statistical Association</em> <b>65</b>(332), 1668-1676.</p>
<p>Hahn, G.J. (1970b). Statistical Intervals for a Normal Population, Part I: Tables,
  Examples and Applications. <em>Journal of Quality Technology</em> <b>2</b>(3), 115-125.</p>
<p>Hahn, G.J. (1970c). Statistical Intervals for a Normal Population, Part II:
  Formulas, Assumptions, Some Derivations. <em>Journal of Quality Technology</em>
  <b>2</b>(4), 195-206.</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991). <em>Statistical Intervals: A Guide for
  Practitioners</em>.  John Wiley and Sons, New York.</p>
<p>Hahn, G., and W. Nelson. (1973). A Survey of Prediction Intervals and Their
  Applications.  <em>Journal of Quality Technology</em> <b>5</b>, 178-188.</p>
<p>Hall, I.J., and R.R. Prairie. (1973).  One-Sided Prediction Intervals to Contain at
  Least \(m\) Out of \(k\) Future Observations.
  <em>Technometrics</em> <b>15</b>, 897--914.</p>
<p>Millard, S.P. (1987).  Environmental Monitoring, Statistics, and the Law:  Room for
  Improvement (with Comment).  <em>The American Statistician</em> <b>41</b>(4), 249--259.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, Florida.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p><em>Motivation</em> <br>
  Prediction and tolerance intervals have long been applied to quality control and
  life testing problems (Hahn, 1970b,c; Hahn and Nelson, 1973).  In the context of
  environmental statistics, prediction intervals are useful for analyzing data from
  groundwater detection monitoring programs at hazardous and solid waste facilities.</p>
<p>One of the main statistical problems that plague groundwater monitoring programs at
  hazardous and solid waste facilities is the requirement of testing several wells and
  several constituents at each well on each sampling occasion.  This is an obvious
  multiple comparisons problem, and the naive approach of using a standard t-test at
  a conventional \(\alpha\)-level (e.g., 0.05 or 0.01) for each test leads to a
  very high probability of at least one significant result on each sampling occasion,
  when in fact no contamination has occurred.  This problem was pointed out years ago
  by Millard (1987) and others.</p>
<p>Davis and McNichols (1987) proposed simultaneous prediction intervals as a way of
  controlling the facility-wide false positive rate (FWFPR) while maintaining adequate
  power to detect contamination in the groundwater.  Because of the ubiquitous presence
  of spatial variability, it is usually best to use simultaneous prediction intervals
  at each well (Davis, 1998a).  That is, by constructing prediction intervals based on
  background (pre-landfill) data on each well, and comparing future observations at a
  well to the prediction interval for that particular well.  In each of these cases,
  the individual \(\alpha\)-level at each well is equal to the FWFRP divided by the
  product of the number of wells and constituents.</p>
<p>Often, observations at downgradient wells are not available prior to the
  construction and operation of the landfill.  In this case, upgradient well data can
  be combined to create a background prediction interval, and observations at each
  downgradient well can be compared to this prediction interval.  If spatial
  variability is present and a major source of variation, however, this method is not
  really valid (Davis, 1994; Davis, 1998a).</p>
<p>Chapter 19 of USEPA (2009) contains an extensive discussion of using the
  \(1\)-of-\(m\) rule and the Modified California rule.</p>
<p>Chapters 1 and 3 of Gibbons et al. (2009) discuss simultaneous prediction intervals
  for the normal and lognormal distributions, respectively.
  <br></p>
<p><em>The k-of-m Rule</em> <br>
  For the \(k\)-of-\(m\) rule, Davis and McNichols (1987) give tables with
  “optimal” choices of \(k\) (in terms of best power for a given overall
  confidence level) for selected values of \(m\), \(r\), and \(n\).  They found
  that the optimal ratios of \(k\) to \(m\) (i.e., \(k/m\)) are generally small,
  in the range of 15-50%.
  <br></p>
<p><em>The California Rule</em> <br>
  The California rule was mandated in that state for groundwater monitoring at waste
  disposal facilities when resampling verification is part of the statistical program
  (Barclay's Code of California Regulations, 1991).  The California code mandates a
  “California” rule with \(m \ge 3\).  The motivation for this rule may have
  been a desire to have a majority of the observations in bounds (Davis, 1998a).  For
  example, for a \(k\)-of-\(m\) rule with \(k=1\) and \(m=3\), a monitoring
  location will pass if the first observation is out of bounds, the second resample
  is out of bounds, but the last resample is in bounds, so that 2 out of 3 observations
  are out of bounds.  For the California rule with \(m=3\), either the first
  observation must be in bounds, or the next 2 observations must be in bounds in order
  for the monitoring location to pass.</p>
<p>Davis (1998a) states that if the FWFPR is kept constant, then the California rule
  offers little increased power compared to the \(k\)-of-\(m\) rule, and can
  actually decrease the power of detecting contamination.
  <br></p>
<p><em>The Modified California Rule</em> <br>
  The Modified California Rule was proposed as a compromise between a 1-of-\(m\)
  rule and the California rule.  For a given FWFPR, the Modified California rule
  achieves better power than the California rule, and still requires at least as many
  observations in bounds as out of bounds, unlike a 1-of-\(m\) rule.
  <br></p>
<p><em>Different Notations Between Different References</em> <br>
  For the \(k\)-of-\(m\) rule described in this help file, both
  Davis and McNichols (1987) and USEPA (2009, Chapter 19) use the variable
  \(p\) instead of \(k\) to represent the minimum number
  of future observations the interval should contain on each of the \(r\) sampling
  occasions.</p>
<p>Gibbons et al. (2009, Chapter 1) presents extensive lists of the value of
  \(K\) for both \(k\)-of-\(m\) rules and California rules.  Gibbons et al.'s
  notation reverses the meaning of \(k\) and \(r\) compared to the notation used
  in this help file.  That is, in Gibbons et al.'s notation, \(k\) represents the
  number of future sampling occasions or monitoring wells, and \(r\) represents the
  minimum number of observations the interval should contain on each sampling occasion.</p>
<p>USEPA (2009, Chapter 19) uses \(p\) in place of \(k\).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="predIntNormSimultaneousK.html">predIntNormSimultaneousK</a></code>,
  <code><a href="predIntNormSimultaneousTestPower.html">predIntNormSimultaneousTestPower</a></code>,
  <code><a href="predIntNorm.html">predIntNorm</a></code>, <br><code><a href="predIntLnormSimultaneous.html">predIntLnormSimultaneous</a></code>, <code><a href="tolIntNorm.html">tolIntNorm</a></code>,
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>, <code><a href="estimate.object.html">estimate.object</a></code>, <code><a href="enorm.html">enorm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Generate 8 observations from a normal distribution with parameters</span></span>
<span class="r-in">  <span class="co"># mean=10 and sd=2, then use predIntNormSimultaneous to estimate the</span></span>
<span class="r-in">  <span class="co"># mean and standard deviation of the true distribution and construct an</span></span>
<span class="r-in">  <span class="co"># upper 95% prediction interval to contain at least 1 out of the next</span></span>
<span class="r-in">  <span class="co"># 3 observations.</span></span>
<span class="r-in">  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">479</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">8</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.269773  2.210246 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rule</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "k.of.m"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LPL     UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -Inf 11.4021 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $delta.over.sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Repeat the above example, but do it in two steps.  First create a list called</span></span>
<span class="r-in">  <span class="co"># est.list containing information about the estimated parameters, then create the</span></span>
<span class="r-in">  <span class="co"># prediction interval.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">est.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="enorm.html">enorm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">est.list</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.269773  2.210246 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">est.list</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10.269773  2.210246 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rule</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "k.of.m"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LPL     UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -Inf 11.4021 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $delta.over.sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the 95% 1-of-3 upper prediction interval to the California and</span></span>
<span class="r-in">  <span class="co"># Modified California prediction intervals.  Note that the upper prediction</span></span>
<span class="r-in">  <span class="co"># bound for the Modified California rule is between the bound for the</span></span>
<span class="r-in">  <span class="co"># 1-of-3 rule bound and the bound for the California rule.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.4021 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, m <span class="op">=</span> <span class="fl">3</span>, rule <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13.03717 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, rule <span class="op">=</span> <span class="st">"Modified.CA"</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12.12201 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Show how the upper bound on an upper 95% simultaneous prediction limit increases</span></span>
<span class="r-in">  <span class="co"># as the number of future sampling occasions r increases.  Here, we'll use the</span></span>
<span class="r-in">  <span class="co"># 1-of-3 rule.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.4021 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13.28234 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the upper simultaneous prediction limit for the 1-of-3 rule</span></span>
<span class="r-in">  <span class="co"># based on individual observations versus based on means of order 4.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.4021 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span><span class="va">dat</span>, n.mean <span class="op">=</span> <span class="fl">4</span>, k <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">    m <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11.26157 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Example 19-1 of USEPA (2009, p. 19-17) shows how to compute an</span></span>
<span class="r-in">  <span class="co"># upper simultaneous prediction limit for the 1-of-3 rule for</span></span>
<span class="r-in">  <span class="co"># r = 2 future sampling occasions.  The data for this example are</span></span>
<span class="r-in">  <span class="co"># stored in EPA.09.Ex.19.1.sulfate.df.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># We will pool data from 4 background wells that were sampled on</span></span>
<span class="r-in">  <span class="co"># a number of different occasions, giving us a sample size of</span></span>
<span class="r-in">  <span class="co"># n = 25 to use to construct the prediction limit.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># There are 50 compliance wells and we will monitor 10 different</span></span>
<span class="r-in">  <span class="co"># constituents at each well at each of the r=2 future sampling</span></span>
<span class="r-in">  <span class="co"># occasions.  To determine the confidence level we require for</span></span>
<span class="r-in">  <span class="co"># the simultaneous prediction interval, USEPA (2009) recommends</span></span>
<span class="r-in">  <span class="co"># setting the individual Type I Error level at each well to</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># 1 - (1 - SWFPR)^(1 / (Number of Constituents * Number of Wells))</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># which translates to setting the confidence limit to</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># (1 - SWFPR)^(1 / (Number of Constituents * Number of Wells))</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># where SWFPR = site-wide false positive rate.  For this example, we</span></span>
<span class="r-in">  <span class="co"># will set SWFPR = 0.1.  Thus, the confidence level is given by:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span class="r-in">  <span class="va">nw</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span class="r-in">  <span class="va">SWFPR</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span class="r-in">  <span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">SWFPR</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">nc</span> <span class="op">*</span> <span class="va">nw</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">conf.level</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9997893</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at the data:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.1.sulfate.df</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Well"                 "Month"                "Day"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "Year"                 "Date"                 "Sulfate.mg.per.l"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "log.Sulfate.mg.per.l"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">EPA.09.Ex.19.1.sulfate.df</span><span class="op">[</span>,</span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Well"</span>, <span class="st">"Date"</span>, <span class="st">"Sulfate.mg.per.l"</span>, <span class="st">"log.Sulfate.mg.per.l"</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Well       Date Sulfate.mg.per.l log.Sulfate.mg.per.l</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  GW-01 1999-07-08             63.0             4.143135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  GW-01 1999-09-12             51.0             3.931826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  GW-01 1999-10-16             60.0             4.094345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  GW-01 1999-11-02             86.0             4.454347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  GW-04 1999-07-09            104.0             4.644391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  GW-04 1999-09-14            102.0             4.624973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  GW-04 1999-10-12             84.0             4.430817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  GW-04 1999-11-15             72.0             4.276666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  GW-08 1997-10-12             31.0             3.433987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 GW-08 1997-11-16             84.0             4.430817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 GW-08 1998-01-28             65.0             4.174387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 GW-08 1999-04-20             41.0             3.713572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 GW-08 2002-06-04             51.8             3.947390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 GW-08 2002-09-16             57.5             4.051785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 GW-08 2002-12-02             66.8             4.201703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 GW-08 2003-03-24             87.1             4.467057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 GW-09 1997-10-16             59.0             4.077537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 GW-09 1998-01-28             85.0             4.442651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 GW-09 1998-04-12             75.0             4.317488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 GW-09 1998-07-12             99.0             4.595120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 GW-09 2000-01-30             75.8             4.328098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 GW-09 2000-04-24             82.5             4.412798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 GW-09 2000-10-24             85.5             4.448516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 GW-09 2002-12-01            188.0             5.236442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 GW-09 2003-03-24            150.0             5.010635</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Construct the upper simultaneous prediction limit for the</span></span>
<span class="r-in">  <span class="co"># 1-of-3 plan based on the log-transformed sulfate data</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">log.Sulfate</span> <span class="op">&lt;-</span> <span class="va">EPA.09.Ex.19.1.sulfate.df</span><span class="op">$</span><span class="va">log.Sulfate.mg.per.l</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">pred.int.list.log</span> <span class="op">&lt;-</span></span>
<span class="r-in">    <span class="fu">predIntNormSimultaneous</span><span class="op">(</span>x <span class="op">=</span> <span class="va">log.Sulfate</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">      rule <span class="op">=</span> <span class="st">"k.of.m"</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">pred.int.list.log</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.3156194 0.3756697 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "log.Sulfate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rule</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "k.of.m"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LPL      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -Inf 5.072355 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9997893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $delta.over.sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Now exponentiate the prediction interval to get the limit on</span></span>
<span class="r-in">  <span class="co"># the original scale</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">pred.int.list.log</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"UPL"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159.5497 </span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#two-sided</span></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneous</span><span class="op">(</span>x <span class="op">=</span> <span class="va">log.Sulfate</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">      rule <span class="op">=</span> <span class="st">"k.of.m"</span>, pi.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.3156194 0.3756697 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mvue"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "log.Sulfate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prediction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rule</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "k.of.m"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LPL      UPL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.558884 5.072355 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "two-sided"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "exact"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9997893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $r</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $delta.over.sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

