<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Probability-Weighted Moments — pwMoment • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Probability-Weighted Moments — pwMoment"><meta property="og:description" content="Estimate the \(1jk\)'th probability-weighted moment from a random sample,
  where either \(j = 0\), \(k = 0\), or both."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Probability-Weighted Moments</h1>

    <div class="hidden name"><code>pwMoment.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the \(1jk\)'th probability-weighted moment from a random sample,
  where either \(j = 0\), \(k = 0\), or both.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pwMoment</span><span class="op">(</span><span class="va">x</span>, j <span class="op">=</span> <span class="fl">0</span>, k <span class="op">=</span> <span class="fl">0</span>, method <span class="op">=</span> <span class="st">"unbiased"</span>, </span>
<span>    plot.pos.cons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.35</span>, b <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of observations.</p></dd>

  <dt id="arg-j-k">j, k<a class="anchor" aria-label="anchor" href="#arg-j-k"></a></dt>
<dd><p>non-negative integers specifying the order of the moment.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string specifying what method to use to compute the
  probability-weighted moment.  The possible values are <code>"unbiased"</code>
  (method based on the U-statistic; the default), or <code>"plotting.position"</code>
  (method based on the plotting position formula).  See the DETAILS section for
  more information.</p></dd>

  <dt id="arg-plot-pos-cons">plot.pos.cons<a class="anchor" aria-label="anchor" href="#arg-plot-pos-cons"></a></dt>
<dd><p>numeric vector of length 2 specifying the constants used in the formula for the
  plotting positions when <code>method="plotting.position"</code>.  The default value is
  <code>plot.pos.cons=c(a=0.35, b=0)</code>.  If this vector has a names attribute with
  the value <code>c("a","b")</code> or <code>c("b","a")</code>, then the elements will be
  matched by name in the formula for computing the plotting positions.  Otherwise,
  the first element is mapped to the name <code>"a"</code> and the second element to the
  name <code>"b"</code>.  See the DETAILS section for more information.  This argument is
  ignored if <code>method="ubiased"</code>.</p></dd>

  <dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>logical scalar indicating whether to remove missing values from <code>x</code>.
  If <code>na.rm=FALSE</code> (the default) and <code>x</code> contains missing values,
  then a missing value (<code>NA</code>) is returned.  If <code>na.rm=TRUE</code>, missing
  values are removed from <code>x</code> prior to computing the probability-weighted
  moment.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The definition of a probability-weighted moment, introduced by
  Greenwood et al. (1979), is as follows.  Let \(X\) denote a random variable
  with cdf \(F\), and let \(x(p)\) denote the \(p\)'th quantile of the
  distribution.  Then the \(ijk\)'th probability-weighted moment is given by:
  $$M(i, j, k) = E[X^i F^j (1 - F)^k] = \int^1_0 [x(F)]^i F^j (1 - F)^k \, dF$$
  where \(i\), \(j\), and \(k\) are real numbers.  Note that if \(i\) is a
  nonnegative integer, then \(M(i, 0, 0)\) is the conventional \(i\)'th moment
  about the origin.</p>
<p>Greenwood et al. (1979) state that in the special case where \(i\), \(j\), and
  \(k\) are nonnegative integers:
  $$M(i, j, k) = B(j + 1, k + 1) E[X^i_{j+1, j+k+1}]$$
  where \(B(a, b)\) denotes the <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta function</a> evaluated at
  \(a\) and \(b\), and
  $$E[X^i_{j+1, j+k+1}]$$
  denotes the \(i\)'th moment about the origin of the \((j + 1)\)'th order
  statistic for a sample of size \((j + k + 1)\). In particular,
  $$M(1, 0, k) = \frac{1}{k+1} E[X_{1, k+1}]$$
  $$M(1, j, 0) = \frac{1}{j+1} E[X_{j+1, j+1}]$$
  where
  $$E[X_{1, k+1}]$$
  denotes the expected value of the first order statistic (i.e., the minimum) in a
  sample of size \((k + 1)\), and
  $$E[X_{j+1, j+1}]$$
  denotes the expected value of the \((j+1)\)'th order statistic (i.e., the maximum)
  in a sample of size \((j+1)\).</p>
<p><em>Unbiased Estimators</em> (<code>method="unbiased"</code>) <br>
  Landwehr et al. (1979) show that, given a random sample of \(n\) values from
  some arbitrary distribution, an unbiased, distribution-free, and parameter-free
  estimator of \(M(1, 0, k)\) is given by:
  $$\hat{M}(1, 0, k) = \frac{1}{n} \sum^{n-k}_{i=1} x_{i,n} \frac{{n-i \choose k}}{{n-1 \choose k}}$$
  where the quantity \(x_{i,n}\) denotes the \(i\)'th order statistic in the
  random sample of size \(n\).  Hosking et al. (1985) note that this estimator is
  closely related to U-statistics (Hoeffding, 1948; Lehmann, 1975, pp. 362-371).
  Hosking et al. (1985) note that an unbiased, distribution-free, and parameter-free
  estimator of \(M(1, j, 0)\) is given by:
  $$\hat{M}(1, j, 0) = \frac{1}{n} \sum^n_{i=j+1} x_{i,n} \frac{{i-1 \choose j}}{{n-1 \choose j}}$$
  <br></p>
<p><em>Plotting-Position Estimators</em> (<code>method="plotting.position"</code>) <br>
  Hosking et al. (1985) propose alternative estimators of \(M(1, 0, k)\) and
  \(M(1, j, 0)\) based on plotting positions:
  $$\hat{M}(1, 0, k) = \frac{1}{n} \sum^n_{i=1} (1 - p_{i,n})^k x_{i,n}$$
  $$\hat{M}(1, j, 0) = \frac{1}{n} \sum^n_{i=1} p_{i,n}^j x_{i,n}$$
  where
  $$p_{i,n} = \hat{F}(x_{i,n})$$
  denotes the plotting position of the \(i\)'th order statistic in the random
  sample of size \(n\), that is, a distribution-free estimate of the cdf of
  \(X\) evaluated at the \(i\)'th order statistic.  Typically, plotting
  positions have the form:
  $$p_{i,n} = \frac{i-a}{n+b}$$
  where \(b &gt; -a &gt; -1\).  For this form of plotting position, the
  plotting-position estimators are asymptotically equivalent to the U-statistic
  estimators.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A numeric scalar–the value of the \(1jk\)'th probability-weighted moment
  as defined by Greenwood et al. (1979).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Greenwood, J.A., J.M. Landwehr, N.C. Matalas, and J.R. Wallis. (1979).
  Probability Weighted Moments: Definition and Relation to Parameters of Several
  Distributions Expressible in Inverse Form.  <em>Water Resources Research</em>
  <b>15</b>(5), 1049–1054.</p>
<p>Hoeffding, W. (1948).  A Class of Statistics with Asymptotically Normal
  Distribution.  <em>Annals of Mathematical Statistics</em> <b>19</b>, 293–325.</p>
<p>Hosking, J.R.M. (1990).  L-Moments: Analysis and Estimation of Distributions
  Using Linear Combinations of Order Statistics.  <em>Journal of the Royal
  Statistical Society, Series B</em> <b>52</b>(1), 105–124.</p>
<p>Hosking, J.R.M., and J.R. Wallis (1995).  A Comparison of Unbiased and
  Plotting-Position Estimators of L Moments.  <em>Water Resources Research</em>
  <b>31</b>(8), 2019–2025.</p>
<p>Hosking, J.R.M., J.R. Wallis, and E.F. Wood. (1985).  Estimation of the
  Generalized Extreme-Value Distribution by the Method of
  Probability-Weighted Moments.  <em>Technometrics</em> <b>27</b>(3), 251–261.</p>
<p>Landwehr, J.M., N.C. Matalas, and J.R. Wallis. (1979).  Probability Weighted
  Moments Compared With Some Traditional Techniques in Estimating Gumbel
  Parameters and Quantiles.  <em>Water Resources Research</em> <b>15</b>(5),
  1055–1064.</p>
<p>Lehmann, E.L. (1975).  <em>Nonparametrics: Statistical Methods Based on Ranks</em>.
  Holden-Day, Oakland, CA, pp.362-371.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Greenwood et al. (1979) introduced the concept of probability-weighted moments
  as a tool to derive estimates of distribution parameters for distributions that
  can be (perhaps only be) expressed in inverse form.  The term “inverse form”
  simply means that instead of characterizing the distribution by the formula for
  its cumulative distribution function (cdf), the distribution is characterized by
  the formula for the \(p\)'th quantile (\(0 \le p \le 1\)).</p>
<p>For distributions that can only be expressed in inverse form, moment estimates of
  their parameters are not available, and maximum likelihood estimates are not easy
  to compute.  Greenwood et al. (1979) show that in these cases, it is often possible
  to derive expressions for the distribution parameters in terms of
  probability-weighted moments.  Thus, for these cases the distribution parameters
  can be estimated based on the sample probability-weighted moments, which are fairly
  easy to compute.  Furthermore, for distributions whose parameters can be expressed
  as functions of conventional moments, the method of probability-weighted moments
  provides an alternative to method of moments and maximum likelihood estimators.</p>
<p>Landwehr et al. (1979) use the method of probability-weighted moments to estimate
  the parameters of the <a href="EVD.html">Type I Extreme Value (Gumbel) distribution</a>.</p>
<p>Hosking et al. (1985) use the method of probability-weighted moments to estimate
  the parameters of the <a href="GEVD.html">generalized extreme value distribution</a>.</p>
<p>Hosking (1990) and Hosking and Wallis (1995) show the relationship between
  probabiity-weighted moments and <a href="lMoment.html">L-moments</a>.</p>
<p>Hosking and Wallis (1995) recommend using the unbiased estimators of
  probability-weighted moments for almost all applications.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="eevd.html">eevd</a></code>, <code><a href="egevd.html">egevd</a></code>, <code><a href="lMoment.html">lMoment</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a generalized extreme value distribution </span></span></span>
<span class="r-in"><span>  <span class="co"># with parameters location=10, scale=2, and shape=.25, then compute the </span></span></span>
<span class="r-in"><span>  <span class="co"># 0'th, 1'st and 2'nd probability-weighted moments. </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="GEVD.html">rgevd</a></span><span class="op">(</span><span class="fl">20</span>, location <span class="op">=</span> <span class="fl">10</span>, scale <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">pwMoment</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.59556</span>
<span class="r-in"><span>  <span class="co">#[1] 10.59556</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">pwMoment</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.798481</span>
<span class="r-in"><span>  <span class="co">#[1] 5.798481</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu">pwMoment</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.060574</span>
<span class="r-in"><span>  <span class="co">#[1] 4.060574</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu">pwMoment</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.797081</span>
<span class="r-in"><span>  <span class="co">#[1] 4.797081</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">pwMoment</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.059173</span>
<span class="r-in"><span>  <span class="co">#[1] 3.059173</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">pwMoment</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"plotting.position"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.852913</span>
<span class="r-in"><span>  <span class="co"># [1] 5.852913</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">pwMoment</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"plotting.position"</span>, </span></span>
<span class="r-in"><span>    plot.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.325</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.586817</span>
<span class="r-in"><span>  <span class="co">#[1] 5.586817 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean Up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

