<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Confidence Level of Simultaneous Nonparametric Prediction Interval for Continuous Distribution — predIntNparSimultaneousConfLevel • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence Level of Simultaneous Nonparametric Prediction Interval for Continuous Distribution — predIntNparSimultaneousConfLevel"><meta property="og:description" content="Compute the confidence level associated with a nonparametric simultaneous 
  prediction interval based on one of three possible rules: k-of-m, California, 
  or Modified California.  Observations are assumed to come from from a 
  continuous distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.8.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence Level of Simultaneous Nonparametric Prediction Interval for Continuous Distribution</h1>
    
    <div class="hidden name"><code>predIntNparSimultaneousConfLevel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the confidence level associated with a nonparametric simultaneous 
  prediction interval based on one of three possible rules: k-of-m, California, 
  or Modified California.  Observations are assumed to come from from a 
  continuous distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predIntNparSimultaneousConfLevel</span><span class="op">(</span><span class="va">n</span>, n.median <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    rule <span class="op">=</span> <span class="st">"k.of.m"</span>, lpl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"upper"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"lower"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    pi.type <span class="op">=</span> <span class="st">"upper"</span>, integrate.args.list <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>vector of positive integers specifying the sample sizes.  
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
  values are not allowed.</p></dd>

  <dt>n.median</dt>
<dd><p>vector of positive odd integers specifying the sample size associated with the 
  future medians.  The default value is <code>n.median=1</code> (i.e., individual 
  observations).  Note that all future medians must be based on the same 
  sample size.</p></dd>

  <dt>k</dt>
<dd><p>for the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), a vector of positive integers 
  specifying the minimum number of observations (or medians) out of \(m\) 
  observations (or medians) (all obtained on one future sampling “occassion”) 
  the prediction interval should contain.  
  The default value is <code>k=1</code>.  This argument is ignored when the argument 
  <code>rule</code> is not equal to <code>"k.of.m"</code>.</p></dd>

  <dt>m</dt>
<dd><p>vector of positive integers specifying the maximum number of future observations (or 
  medians) on one future sampling “occasion”.  
  The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which 
  case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.</p></dd>

  <dt>r</dt>
<dd><p>vector of positive integers specifying the number of future sampling 
  “occasions”.  The default value is <code>r=1</code>.</p></dd>

  <dt>rule</dt>
<dd><p>character string specifying which rule to use.  The possible values are 
  <code>"k.of.m"</code> (\(k\)-of-\(m\) rule; the default), <code>"CA"</code> (California rule), 
  and <code>"Modified.CA"</code> (modified California rule).</p></dd>

  <dt>lpl.rank</dt>
<dd><p>vector of positive integers indicating the rank of the order statistic to use for 
  the lower bound of the prediction interval.  When <code>pi.type="lower"</code>, the 
  default value is <code>lpl.rank=1</code> (implying the minimum value of <code>x</code> is used 
  as the lower bound of the prediction interval).  When <code>pi.type="upper"</code>, 
  the argument <code>lpl.rank</code> is set equal to <code>0</code>.</p></dd>

  <dt>n.plus.one.minus.upl.rank</dt>
<dd><p>vector of positive integers related to the rank of the order statistic to use for 
  the upper 
  bound of the prediction interval.  A value of <code>n.plus.one.minus.upl.rank=1</code> 
  (the default) means use the first largest value, and in general a value of <br><code>n.plus.one.minus.upl.rank=</code>\(i\) means use the \(i\)'th largest value.  If <br><code>pi.type="lower"</code>, this argument is set equal to <code>0</code>.</p></dd>

  <dt>pi.type</dt>
<dd><p>character string indicating what kind of prediction interval to compute.  
  The possible values are <code>"two.sided"</code> (the default), <code>"lower"</code>, and 
  <code>"upper"</code>.</p></dd>

  <dt>integrate.args.list</dt>
<dd><p>list of arguments to supply to the <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code> function.  The default 
  value is <code>NULL</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the arguments <code>n</code>, <code>k</code>, <code>m</code>, <code>r</code>, <code>lpl.rank</code>, and 
  <code>n.plus.one.minus.upl.rank</code> are not all the same length, they are replicated 
  to be the same length as the length of the longest argument.</p>
<p>The function <code>predIntNparSimultaneousConfLevel</code> computes the confidence level 
  based on Equation (8), (9), or (10) in the help file for 
  <code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code>, depending on the value of the argument 
  <code>rule</code>.</p>
<p>Note that when <code>rule="k.of.m"</code> and <code>r=1</code>, this is equivalent to a 
  standard nonparametric prediction interval and you can use the function 
  <code><a href="predIntNparConfLevel.html">predIntNparConfLevel</a></code> instead.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>vector of values between 0 and 1 indicating the confidence level associated with 
  the specified simultaneous nonparametric prediction interval.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>See the help file for <code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>See the help file for <code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="predIntNparSimultaneous.html">predIntNparSimultaneous</a></code>, 
  <code><a href="predIntNparSimultaneousN.html">predIntNparSimultaneousN</a></code>, 
  <code><a href="plotPredIntNparSimultaneousDesign.html">plotPredIntNparSimultaneousDesign</a></code>, 
  <code><a href="predIntNparSimultaneousTestPower.html">predIntNparSimultaneousTestPower</a></code>, 
  <code><a href="predIntNpar.html">predIntNpar</a></code>, <code><a href="tolIntNpar.html">tolIntNpar</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># For the 1-of-3 rule with r=20 future sampling occasions, look at how the </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence level of a simultaneous nonparametric prediction interval </span></span></span>
<span class="r-in"><span>  <span class="co"># increases with increasing sample size:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">25</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5 10 15 20 25</span>
<span class="r-in"><span>  <span class="co">#[1] 5 10 15 20 25 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu">predIntNparSimultaneousConfLevel</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">25</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.82 0.95 0.98 0.99 0.99</span>
<span class="r-in"><span>  <span class="co">#[1] 0.82 0.95 0.98 0.99 0.99</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># For the 1-of-m rule with r=20 future sampling occasions, look at how the </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence level of a simultaneous nonparametric prediction interval </span></span></span>
<span class="r-in"><span>  <span class="co"># increases as the number of future observations increases:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2 3 4 5</span>
<span class="r-in"><span>  <span class="co">#[1] 1 2 3 4 5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu">predIntNparSimultaneousConfLevel</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, r <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.33 0.81 0.95 0.98 0.99</span>
<span class="r-in"><span>  <span class="co">#[1] 0.33 0.81 0.95 0.98 0.99</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># For the 1-of-3 rule, look at how the confidence level of a simultaneous </span></span></span>
<span class="r-in"><span>  <span class="co"># nonparametric prediction interval decreases with number of future sampling </span></span></span>
<span class="r-in"><span>  <span class="co"># occasions (r):</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5 10 15 20</span>
<span class="r-in"><span>  <span class="co">#[1]  5 10 15 20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu">predIntNparSimultaneousConfLevel</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, </span></span>
<span class="r-in"><span>    r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.98 0.97 0.96 0.95</span>
<span class="r-in"><span>  <span class="co">#[1] 0.98 0.97 0.96 0.95</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># For the 1-of-3 rule with r=20 future sampling occasions, look at how the </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence level of a simultaneous nonparametric prediction interval </span></span></span>
<span class="r-in"><span>  <span class="co"># decreases as the rank of the upper prediction limit decreases:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu">predIntNparSimultaneousConfLevel</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">20</span>, </span></span>
<span class="r-in"><span>    n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95 0.82 0.63 0.43 0.25</span>
<span class="r-in"><span>  <span class="co">#[1] 0.95 0.82 0.63 0.43 0.25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">conf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example 19-5 of USEPA (2009, p. 19-33) shows how to compute nonparametric upper </span></span></span>
<span class="r-in"><span>  <span class="co"># simultaneous prediction limits for various rules based on trace mercury data (ppb) </span></span></span>
<span class="r-in"><span>  <span class="co"># collected in the past year from a site with four background wells and 10 compliance </span></span></span>
<span class="r-in"><span>  <span class="co"># wells (data for two of the compliance wells  are shown in the guidance document).  </span></span></span>
<span class="r-in"><span>  <span class="co"># The facility must monitor the 10 compliance wells for five constituents </span></span></span>
<span class="r-in"><span>  <span class="co"># (including mercury) annually.</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Here we will compute the confidence level associated with two different sampling plans: </span></span></span>
<span class="r-in"><span>  <span class="co"># 1) the 1-of-2 retesting plan for a median of order 3 using the background maximum and </span></span></span>
<span class="r-in"><span>  <span class="co"># 2) the 1-of-4 plan on individual observations using the 3rd highest background value.</span></span></span>
<span class="r-in"><span>  <span class="co"># The data for this example are stored in EPA.09.Ex.19.5.mercury.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We will pool data from 4 background wells that were sampled on </span></span></span>
<span class="r-in"><span>  <span class="co"># a number of different occasions, giving us a sample size of </span></span></span>
<span class="r-in"><span>  <span class="co"># n = 20 to use to construct the prediction limit.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># There are 10 compliance wells and we will monitor 5 different </span></span></span>
<span class="r-in"><span>  <span class="co"># constituents at each well annually.  For this example, USEPA (2009) </span></span></span>
<span class="r-in"><span>  <span class="co"># recommends setting r to the product of the number of compliance wells and </span></span></span>
<span class="r-in"><span>  <span class="co"># the number of evaluations per year.  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># To determine the minimum confidence level we require for </span></span></span>
<span class="r-in"><span>  <span class="co"># the simultaneous prediction interval, USEPA (2009) recommends </span></span></span>
<span class="r-in"><span>  <span class="co"># setting the maximum allowed individual Type I Error level per constituent to:</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="co"># 1 - (1 - SWFPR)^(1 / Number of Constituents)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># which translates to setting the confidence limit to </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># (1 - SWFPR)^(1 / Number of Constituents)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># where SWFPR = site-wide false positive rate.  For this example, we </span></span></span>
<span class="r-in"><span>  <span class="co"># will set SWFPR = 0.1.  Thus, the required individual Type I Error level </span></span></span>
<span class="r-in"><span>  <span class="co"># and confidence level per constituent are given as follows:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># n  = 20 based on 4 Background Wells</span></span></span>
<span class="r-in"><span>  <span class="co"># nw = 10 Compliance Wells</span></span></span>
<span class="r-in"><span>  <span class="co"># nc =  5 Constituents</span></span></span>
<span class="r-in"><span>  <span class="co"># ne =  1 Evaluation per year</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n</span>  <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span>  <span class="va">nw</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>  <span class="va">nc</span> <span class="op">&lt;-</span>  <span class="fl">5</span></span></span>
<span class="r-in"><span>  <span class="va">ne</span> <span class="op">&lt;-</span>  <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Set number of future sampling occasions r to </span></span></span>
<span class="r-in"><span>  <span class="co"># Number Compliance Wells x Number Evaluations per Year</span></span></span>
<span class="r-in"><span>  <span class="va">r</span>  <span class="op">&lt;-</span>  <span class="va">nw</span> <span class="op">*</span> <span class="va">ne</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">nc</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9791484</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9791484</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># So the required confidence level is 0.98, or 98%.</span></span></span>
<span class="r-in"><span>  <span class="co"># Now determine the confidence level associated with each plan.</span></span></span>
<span class="r-in"><span>  <span class="co"># Note that both plans achieve the required confidence level.</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="co"># 1) the 1-of-2 retesting plan for a median of order 3 using the </span></span></span>
<span class="r-in"><span>  <span class="co">#    background maximum</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousConfLevel</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, n.median <span class="op">=</span> <span class="fl">3</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9940354</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9940354</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># 2) the 1-of-4 plan on individual observations using the 3rd highest </span></span></span>
<span class="r-in"><span>  <span class="co">#    background value.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneousConfLevel</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">4</span>, r <span class="op">=</span> <span class="va">r</span>, </span></span>
<span class="r-in"><span>    n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9864909</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9864909</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Cleanup</span></span></span>
<span class="r-in"><span>  <span class="co">#--------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">nw</span>, <span class="va">nc</span>, <span class="va">ne</span>, <span class="va">r</span>, <span class="va">conf.level</span><span class="op">)</span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

