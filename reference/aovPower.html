<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute the Power of a One-Way Fixed-Effects Analysis of Variance — aovPower • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the Power of a One-Way Fixed-Effects Analysis of Variance — aovPower"><meta property="og:description" content="Compute the power of a one-way fixed-effects analysis of variance,
  given the sample sizes, population means, population standard deviation, and
  significance level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the Power of a One-Way Fixed-Effects Analysis of Variance</h1>

    <div class="hidden name"><code>aovPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the power of a one-way fixed-effects analysis of variance,
  given the sample sizes, population means, population standard deviation, and
  significance level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aovPower</span><span class="op">(</span><span class="va">n.vec</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n.vec</span><span class="op">)</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n-vec">n.vec<a class="anchor" aria-label="anchor" href="#arg-n-vec"></a></dt>
<dd><p>numeric vector of sample sizes for each group.  The \(i^{th}\) element of <code>n.vec</code>
  denotes the sample size for group \(i\).  The length of <code>n.vec</code> must be at least 2,
  and all elements of <code>n.vec</code> must be greater than or equal to 2.  Missing (<code>NA</code>),
  undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-mu-vec">mu.vec<a class="anchor" aria-label="anchor" href="#arg-mu-vec"></a></dt>
<dd><p>numeric vector of population means.  The length of <code>mu.vec</code> must be the
  same as the length of <code>n.vec</code>.  The default value is a vector of zeros.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are not allowed.</p></dd>

  <dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>numeric scalar specifying the population standard deviation (\(\sigma\))
  for each group. The default value is <code>sigma=1</code>.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>numeric scalar between 0 and 1 indicating the Type I error level associated
  with the hypothesis test.  The default value is <code>alpha=0.05</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Consider \(k\) normally distributed populations with common standard deviation
  \(\sigma\). Let \(\mu_i\) denote the mean of the \(i\)'th group
  (\(i = 1, 2, \ldots, k\)), and let
  \(\underline{x}_i = x_{i1}, x_{i2}, \ldots, x_{in_i}\) denote a vector of
  \(n_i\) observations from the \(i\)'th group.
  The statistical method of analysis of variance (ANOVA) tests the null hypothesis:
  $$H_0: \mu_1 = \mu_2 = \cdots = \mu_k \;\;\;\;\;\; (1)$$
  against the alternative hypothesis that at least one of the means is different from
  the rest by using the F-statistic given by:
  $$F = \frac{[\sum_{i=1}^k n_i(\bar{x}_{i.} - \bar{x}_{..})^2]/(k-1)}{[\sum_{i=1}^k \sum_{j=1}^{n_i} (x_{ij} - \bar{x}_{i.})^2]/(N-k)} \;\;\;\;\;\; (2)$$
  where
  $$\bar{x}_{i.} = \frac{1}{n_i} \sum_{j=1}^{n_i} x_{ij} \;\;\;\;\;\; (3)$$
  $$\bar{x}_{..} = \frac{1}{N} \sum_{i=1}^k n_i\bar{x}_{i.} = \frac{1}{N} \sum_{i=1}^k \sum_{j=1}^{n_i} x_{ij} \;\;\;\;\;\; (4)$$
  $$N = \sum_{i=1}^k n_i \;\;\;\;\;\; (5)$$
  Under the null hypothesis (1), the F-statistic in (2) follows an
  <a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">F-distribution</a> with \(k-1\) and \(N-k\) degrees of freedom.
  Analysis of variance rejects the null hypothesis (1) at significance level
  \(\alpha\) when
  $$F &gt; F_{k-1, N-k}(1 - \alpha) \;\;\;\;\;\; (6)$$
  where \(F_{\nu_1, \nu_2}(p)\) denotes the \(p\)'th quantile of the
  F-distribution with \(\nu_1\) and \(\nu_2\) degrees of freedom
  (Zar, 2010, Chapter 10; Berthouex and Brown, 2002, Chapter 24;
  Helsel and Hirsh, 1992, pp. 164–169).</p>
<p>The power of this test, denoted by \(1-\beta\), where \(\beta\) denotes the
  probability of a Type II error, is given by:
  $$1 - \beta = Pr[F_{k-1, N-k, \Delta} &gt; F_{k-1, N-k}(1 - \alpha)] \;\;\;\;\;\; (7)$$
  where
  $$\Delta = \frac{\sum_{i=1}^k n_i(\mu_i - \bar{\mu}_.)^2}{\sigma^2} \;\;\;\;\;\; (8)$$
  $$\bar{\mu}_. = \frac{1}{k} \sum_{i=1}^k \mu _i \;\;\;\;\;\; (9)$$
  and \(F_{\nu_1, \nu_2, \Delta}\) denotes a
  <a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">non-central F random variable</a> with \(\nu_1\) and
  \(\nu_2\) degrees of freedom and non-centrality parameter \(\Delta\).
  Equation (7) can be re-written as:
  $$1 - \beta = 1 - H[F_{k-1, N-k}(1 - \alpha), k-1, N-k, \Delta] \;\;\;\;\;\; (10)$$
  where \(H(x, \nu_1, \nu_2, \Delta)\) denotes the cumulative distribution function
  of this random variable evaluated at \(x\) (Scheffe, 1959, pp.38–39, 62–65).</p>
<p>The power of the one-way fixed-effects ANOVA depends on the
  sample sizes for each of the \(k\) groups, the value of the
  population means for each of the \(k\) groups, the population
  standard deviation \(\sigma\), and the significance level
  \(\alpha\).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a numeric scalar indicating the power of the one-way fixed-effects ANOVA for
  the given sample sizes, population means, population standard deviation, and
  significance level.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers</em>.  Second Edition.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, Chapter 7.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1995).
  <em>Continuous Univariate Distributions, Volume 2</em>.
  Second Edition. John Wiley and Sons, New York,
  Chapters 27, 29, 30.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, Florida.</p>
<p>Scheffe, H. (1959). <em>The Analysis of Variance</em>.
  John Wiley and Sons, New York, 477pp.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C. p.6-38.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>.
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ,
  Chapter 10.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The normal and lognormal distribution are probably the two most
  frequently used distributions to model environmental data.
  Sometimes it is necessary to compare several means to determine
  whether any are significantly different from each other
  (e.g., USEPA, 2009, p.6-38).  In this case, assuming
  normally distributed data, you perform a one-way parametric
  analysis of variance.</p>
<p>In the course of designing a sampling program, an environmental
  scientist may wish to determine the relationship between sample
  size, Type I error level, power, and differences in means if
  one of the objectives of the sampling program is to determine
  whether a particular mean differs from a group of means.  The
  functions <code>aovPower</code>, <code><a href="aovN.html">aovN</a></code>, and
  <code><a href="plotAovDesign.html">plotAovDesign</a></code> can be used to investigate these
  relationships for the case of normally-distributed observations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="aovN.html">aovN</a></code>, <code><a href="plotAovDesign.html">plotAovDesign</a></code>,
  <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a></code>, <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at how the power of a one-way ANOVA increases </span></span></span>
<span class="r-in"><span>  <span class="co"># with increasing sample size:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7015083</span>
<span class="r-in"><span>  <span class="co">#[1] 0.7015083 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9732551</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9732551</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of a one-way ANOVA increases </span></span></span>
<span class="r-in"><span>  <span class="co"># with increasing variability in the population means:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>, sigma<span class="op">=</span><span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05795739</span>
<span class="r-in"><span>  <span class="co">#[1] 0.05795739 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2831863</span>
<span class="r-in"><span>  <span class="co">#[1] 0.2831863 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">15</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2236093</span>
<span class="r-in"><span>  <span class="co">#[1] 0.2236093 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7015083</span>
<span class="r-in"><span>  <span class="co">#[1] 0.7015083</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of a one-way ANOVA increases </span></span></span>
<span class="r-in"><span>  <span class="co"># with increasing values of Type I error:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02655785</span>
<span class="r-in"><span>  <span class="co">#[1] 0.02655785 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1223527</span>
<span class="r-in"><span>  <span class="co">#[1] 0.1223527 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3085313</span>
<span class="r-in"><span>  <span class="co">#[1] 0.3085313 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">3</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4373292</span>
<span class="r-in"><span>  <span class="co">#[1] 0.4373292</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The example on pages 5-11 to 5-14 of USEPA (1989b) shows </span></span></span>
<span class="r-in"><span>  <span class="co"># log-transformed concentrations of lead (mg/L) at two </span></span></span>
<span class="r-in"><span>  <span class="co"># background wells and four compliance wells, where observations </span></span></span>
<span class="r-in"><span>  <span class="co"># were taken once per month over four months (the data are </span></span></span>
<span class="r-in"><span>  <span class="co"># stored in EPA.89b.loglead.df.)  Assume the true mean levels </span></span></span>
<span class="r-in"><span>  <span class="co"># at each well are 3.9, 3.9, 4.5, 4.5, 4.5, and 5, respectively. </span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the power of a one-way ANOVA to test for mean </span></span></span>
<span class="r-in"><span>  <span class="co"># differences between wells.  Use alpha=0.05, and assume the </span></span></span>
<span class="r-in"><span>  <span class="co"># true standard deviation is equal to the one estimated from </span></span></span>
<span class="r-in"><span>  <span class="co"># the data in this example.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># First look at the data </span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EPA.89b.loglead.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "LogLead"   "Month"     "Well"      "Well.type"</span>
<span class="r-in"><span>  <span class="co">#[1] "LogLead"   "Month"     "Well"      "Well.type"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="stripChart.html">stripChart</a></span><span class="op">(</span><span class="va">LogLead</span> <span class="op">~</span> <span class="va">Well</span>, data <span class="op">=</span> <span class="va">EPA.89b.loglead.df</span>,</span></span>
<span class="r-in"><span>    show.ci <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"Well Number"</span>, </span></span>
<span class="r-in"><span>    ylab<span class="op">=</span><span class="st">"Log [ Lead (ug/L) ]"</span>, </span></span>
<span class="r-in"><span>    main<span class="op">=</span><span class="st">"Lead Concentrations at Six Wells"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Note: The assumption of a constant variance across </span></span></span>
<span class="r-in"><span>  <span class="co"># all wells is suspect.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now perform the ANOVA and get the estimated sd </span></span></span>
<span class="r-in"><span>  <span class="va">aov.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">LogLead</span> <span class="op">~</span> <span class="va">Well</span>, data<span class="op">=</span><span class="va">EPA.89b.loglead.df</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov.list</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Well         5  5.745  1.1489   3.347  0.026 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals   18  6.179  0.3433                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span>  <span class="co">#            Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span></span></span>
<span class="r-in"><span>  <span class="co">#Well         5 5.7447 1.14895  3.3469 0.02599 *</span></span></span>
<span class="r-in"><span>  <span class="co">#Residuals   18 6.1791 0.34328                  </span></span></span>
<span class="r-in"><span>  <span class="co">#---</span></span></span>
<span class="r-in"><span>  <span class="co">#Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 '' 1 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now call the function aovPower </span></span></span>
<span class="r-in"><span>  <span class="fu">aovPower</span><span class="op">(</span>n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.9</span>,<span class="fl">3.9</span>,<span class="fl">4.5</span>,<span class="fl">4.5</span>,<span class="fl">4.5</span>,<span class="fl">5</span><span class="op">)</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.34</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5523148</span>
<span class="r-in"><span>  <span class="co">#[1] 0.5523148</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">aov.list</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

