<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute Sample Size Necessary to Achieve Specified Power for One-Way Fixed-Effects Analysis of Variance — aovN • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Sample Size Necessary to Achieve Specified Power for One-Way Fixed-Effects Analysis of Variance — aovN"><meta property="og:description" content="Compute the sample sizes necessary to achieve a specified power
  for a one-way fixed-effects analysis of variance test, given
  the population means, population standard deviation, and
  significance level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Sample Size Necessary to Achieve Specified Power for One-Way Fixed-Effects Analysis of Variance</h1>

    <div class="hidden name"><code>aovN.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the sample sizes necessary to achieve a specified power
  for a one-way fixed-effects analysis of variance test, given
  the population means, population standard deviation, and
  significance level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aovN</span><span class="op">(</span><span class="va">mu.vec</span>, sigma <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    round.up <span class="op">=</span> <span class="cn">TRUE</span>, n.max <span class="op">=</span> <span class="fl">5000</span>, tol <span class="op">=</span> <span class="fl">1e-07</span>, maxiter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-mu-vec">mu.vec<a class="anchor" aria-label="anchor" href="#arg-mu-vec"></a></dt>
<dd><p>required numeric vector of population means. The length of
  <code>mu.vec</code> must be at least 2.  Missing (<code>NA</code>),
  undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are not allowed.</p></dd>

  <dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>optional numeric scalar specifying the population standard
  deviation (\(\sigma\)) for each group.  The default value
  is <code>sigma=1</code>.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>optional numeric scalar between 0 and 1 indicating the Type I
  error level associated with the hypothesis test.  The default
  value is <code>alpha=0.05</code>.</p></dd>

  <dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>optional numeric scalar between 0 and 1 indicating the power
  associated with the hypothesis test.  The default value
  is <code>power=0.95</code>.</p></dd>

  <dt id="arg-round-up">round.up<a class="anchor" aria-label="anchor" href="#arg-round-up"></a></dt>
<dd><p>optional logical scalar indicating whether to round up the value of the
  computed sample size to the next smallest integer.  The default
  value is <code>round.up=TRUE</code>.</p></dd>

  <dt id="arg-n-max">n.max<a class="anchor" aria-label="anchor" href="#arg-n-max"></a></dt>
<dd><p>positive integer greater then 1 indicating the maximum sample size per group.
  The default value is <code>n.max=5000</code>.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>optional numeric scalar indicating the tolerance to use in the
  <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> search algorithm.  The default value is
  <code>tol=1e-7</code>.</p></dd>

  <dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>optional positive integer indicating the maximum number of iterations to use in the
  <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> search algorithm.  The default value is
  <code>maxiter=1000</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The F-statistic to test the equality of \(k\) population means
  assuming each population has a normal distribution with the same
  standard deviation \(\sigma\) is presented in most basic
  statistics texts, including Zar (2010, Chapter 10),
  Berthouex and Brown (2002, Chapter 24), and Helsel and Hirsh (1992, pp.164-169).
  The formula for the power of this test is given in Scheffe
  (1959, pp.38-39,62-65).  The power of the one-way fixed-effects ANOVA depends
  on the sample sizes for each of the \(k\) groups, the value of the
  population means for each of the \(k\) groups, the population
  standard deviation \(\sigma\), and the significance level
  \(\alpha\).  See the help file for <code><a href="aovPower.html">aovPower</a></code>.</p>
<p>The function <code>aovN</code> assumes equal sample
  sizes for each of the \(k\) groups and uses a search
  algorithm to determine the sample size \(n\) required to
  attain a specified power, given the values of the population
  means and the significance level.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>numeric scalar indicating the required sample size for each
  group.  (The number of groups is equal to the length of the
  argument <code>mu.vec</code>.)</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers</em>.  Second Edition.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, Chapter 7.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1995).
  <em>Continuous Univariate Distributions, Volume 2</em>.
  Second Edition. John Wiley and Sons, New York,
  Chapters 27, 29, 30.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, Florida.</p>
<p>Scheffe, H. (1959). <em>The Analysis of Variance</em>.
  John Wiley and Sons, New York, 477pp.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C. p.6-38.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>.
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ,
  Chapter 10.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The normal and lognormal distribution are probably the two most
  frequently used distributions to model environmental data.
  Sometimes it is necessary to compare several means to determine
  whether any are significantly different from each other
  (e.g., USEPA, 2009, p.6-38).  In this case, assuming
  normally distributed data, you perform a one-way parametric
  analysis of variance.</p>
<p>In the course of designing a sampling program, an environmental
  scientist may wish to determine the relationship between sample
  size, Type I error level, power, and differences in means if
  one of the objectives of the sampling program is to determine
  whether a particular mean differs from a group of means.  The
  functions <code><a href="aovPower.html">aovPower</a></code>, <code>aovN</code>, and
  <code><a href="plotAovDesign.html">plotAovDesign</a></code> can be used to investigate these
  relationships for the case of normally-distributed observations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="aovPower.html">aovPower</a></code>, <code><a href="plotAovDesign.html">plotAovDesign</a></code>,
  <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a></code>, <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at how the required sample size for a one-way ANOVA </span></span></span>
<span class="r-in"><span>  <span class="co"># increases with increasing power:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">15</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span>, power <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 21</span>
<span class="r-in"><span>  <span class="co">#[1] 21 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">15</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span>, power <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 27</span>
<span class="r-in"><span>  <span class="co">#[1] 27 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">15</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span>, power <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33</span>
<span class="r-in"><span>  <span class="co">#[1] 33</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the required sample size for a one-way ANOVA, </span></span></span>
<span class="r-in"><span>  <span class="co"># given a fixed power, decreases with increasing variability </span></span></span>
<span class="r-in"><span>  <span class="co"># in the population means:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>, sigma<span class="op">=</span><span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 581</span>
<span class="r-in"><span>  <span class="co">#[1] 581 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-in"><span>  <span class="co">#[1] 25 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">15</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33</span>
<span class="r-in"><span>  <span class="co">#[1] 33 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-in"><span>  <span class="co">#[1] 10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the required sample size for a one-way ANOVA, </span></span></span>
<span class="r-in"><span>  <span class="co"># given a fixed power, decreases with increasing values of </span></span></span>
<span class="r-in"><span>  <span class="co"># Type I error:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 89</span>
<span class="r-in"><span>  <span class="co">#[1] 89 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 67</span>
<span class="r-in"><span>  <span class="co">#[1] 67 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50</span>
<span class="r-in"><span>  <span class="co">#[1] 50 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">aovN</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 42</span>
<span class="r-in"><span>  <span class="co">#[1] 42</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

