<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Randomization (Permutation) Test to Compare Two Proportions (Fisher's Exact Test) — twoSamplePermutationTestProportion • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Randomization (Permutation) Test to Compare Two Proportions (Fisher's Exact Test) — twoSamplePermutationTestProportion"><meta property="og:description" content="Perform a two-sample randomization (permutation) test to compare two proportions.
  This is also called Fisher's exact test.
Note: You can perform Fisher's exact test in R using the function
  fisher.test."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Randomization (Permutation) Test to Compare Two Proportions (Fisher's Exact Test)</h1>

    <div class="hidden name"><code>twoSamplePermutationTestProportion.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform a two-sample randomization (permutation) test to compare two proportions.
  This is also called Fisher's exact test.</p>
<p><b>Note:</b> You can perform Fisher's exact test in <span style="R">R</span> using the function
  <code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">twoSamplePermutationTestProportion</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, x.and.y <span class="op">=</span> <span class="st">"Binomial Outcomes"</span>, </span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>When <code>x.and.y="Binomial Outcomes"</code> (the default), <code>x</code> and <code>y</code> are
  vectors of observations from groups 1 and 2, respectively.  The vectors <code>x</code>
  and <code>y</code> must contain no more than 2 unique values (e.g., <code>0</code> and <code>1</code>,
  <code>FALSE</code> and <code>TRUE</code>, <code>"No"</code> and <code>"Yes"</code>, etc.).  In this case,
  the result of <code>sort(unique(x))[2]</code> is taken to be the value that indicates a
  “success” for <code>x</code> and the result of <code>sort(unique(y))[2]</code> is taken
  to be the value that indicates a “success” for <code>y</code>.  For example, <br><code>x = c(FALSE, TRUE, FALSE, TRUE, TRUE)</code> indicates 3 successes in 5 trials, and
  <code>y = c(1, 0, 0, 0)</code> indicates 1 success in 4 trials.  When <br><code>x.and.y="Binomial Outcomes"</code>, missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p>
<p>When <code>x.and.y="Number of Successes and Trials"</code>, <code>x</code> must be a vector of
  length 2 containing the number of successes for groups 1 and 2, respectively, and
  <code>y</code> must be a vector of length 2 that contains the number of trials for groups
  1 and 2, respectively.  For example, <code>x = c(3, 1)</code> and <code>y = c(5, 4)</code>
  indicates 3 successes in 5 trials for group 1 and 1 success in 4 trials for
  group 2.</p></dd>

  <dt id="arg-x-and-y">x.and.y<a class="anchor" aria-label="anchor" href="#arg-x-and-y"></a></dt>
<dd><p>character string indicating the kind of data stored in the vectors <code>x</code> and
  <code>y</code>.  The possible values are <code>x.and.y="Binomial Outcomes"</code> (the default),
  and <br><code>x.and.y="Number Successes and Trials"</code>.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values
  are <code>"two.sided"</code> (the default), <code>"less"</code>, and <code>"greater"</code>.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numeric scalar indicating the tolerance to use for computing the p-value for the
  two-sample permutation test.  The default value is <br><code>tol=sqrt(.Machine$double.eps)</code>.  See the DETAILS section below for more
  information.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><em>Randomization Tests</em> <br>
  In 1935, R.A. Fisher introduced the idea of a <b><em>randomization test</em></b>
  (Manly, 2007, p. 107; Efron and Tibshirani, 1993, Chapter 15), which is based on
  trying to answer the question:  “Did the observed pattern happen by chance,
  or does the pattern indicate the null hypothesis is not true?”  A randomization
  test works by simply enumerating all of the possible outcomes under the null
  hypothesis, then seeing where the observed outcome fits in.  A randomization test
  is also called a <b><em>permutation test</em></b>, because it involves permuting the
  observations during the enumeration procedure (Manly, 2007, p. 3).</p>
<p>In the past, randomization tests have not been used as extensively as they are now
  because of the “large” computing resources needed to enumerate all of the
  possible outcomes, especially for large sample sizes.  The advent of more powerful
  personal computers and software has allowed randomization tests to become much
  easier to perform.  Depending on the sample size, however, it may still be too
  time consuming to enumerate all possible outcomes.  In this case, the randomization
  test can still be performed by sampling from the randomization distribution, and
  comparing the observed outcome to this sampled permutation distribution.
  <br></p>
<p><em>Two-Sample Randomization Test for Proportions</em> <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_{n_1}\) be a vector of \(n_1\)
  independent and identically distributed (i.i.d.) observations
  from a <a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">binomial distribution</a> with parameter <code>size=1</code> and
  probability of success <code>prob=</code>\(p_1\), and let
  \(\underline{y} = y_1, y_2, \ldots, y_{n_2}\) be a vector of \(n_2\)
  i.i.d. observations from a <a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">binomial distribution</a> with
  parameter <code>size=1</code> and probability of success <code>prob=</code>\(p_2\).</p>
<p>Consider the test of the null hypothesis:
  $$H_0: p_1 = p_2 \;\;\;\;\;\; (1)$$</p>
<p>The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>)
  $$H_a: p_1 &gt; p_2 \;\;\;\;\;\; (2)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: p_1 &lt; p_2 \;\;\;\;\;\; (3)$$
  and the two-sided alternative
  $$H_a: p_1 \ne p_2 \;\;\;\;\;\; (4)$$
  To perform the test of the null hypothesis (1) versus any of the three
  alternatives (2)-(4), you can use the two-sample permutation test, which is also
  called <a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">Fisher's exact test</a>.  When the observations are
  from a B(1, \(p\)) distribution, the sample mean is an estimate of \(p\).
  Fisher's exact test is simply a permutation test for the difference between two
  means from two different groups (see <code><a href="twoSamplePermutationTestLocation.html">twoSamplePermutationTestLocation</a></code>),
  where the underlying populations are binomial with size parameter <code>size=1</code>,
  but possibly different values of the <code>prob</code> parameter \(p\).
  Fisher's exact test is usually described in terms of testing hypotheses concerning
  a 2 x 2 contingency table (van Bell et al., 2004, p. 157;
  Hollander and Wolfe, 1999, p. 473; Sheskin, 2011; Zar, 2010, p. 561).
  The probabilities associated with the permutation distribution can be computed by
  using the <a href="https://rdrr.io/r/stats/Hypergeometric.html" class="external-link">hypergeometric distribution</a>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>"permutationTest"</code> containing the results of the hypothesis
  test.  See the help file for <code><a href="permutationTest.object.html">permutationTest.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Efron, B., and R.J. Tibshirani. (1993).  <em>An Introduction to the Bootstrap</em>.
  Chapman and Hall, New York, Chapter 15.</p>
<p>Hollander, M., and D.A. Wolfe. (1999). <em>Nonparametric Statistical Methods</em>.
  Second Edition.  John Wiley and Sons, New York, p.473.</p>
<p>Manly, B.F.J. (2007).  <em>Randomization, Bootstrap and Monte Carlo Methods in
  Biology</em>.  Third Edition. Chapman &amp; Hall, New York, Chapter 6.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001).
  <em>Environmental Statistics with S-PLUS</em>.  CRC Press, Boca Raton, FL,
  pp.441–446.</p>
<p>Graham, S.L., K.J. Davis, W.H. Hansen, and C.H. Graham. (1975).
  Effects of Prolonged Ethylene Thiourea Ingestion on the Thyroid of the Rat.
  <em>Food and Cosmetics Toxicology</em>, <b>13</b>(5), 493–499.</p>
<p>Rodricks, J.V. (1992).  <em>Calculated Risks: The Toxicity and Human Health
  Risks of Chemicals in Our Environment</em>. Cambridge University
  Press, New York.</p>
<p>Rodricks, J.V. (2007).  <em>Calculated Risks: The Toxicity and Human Health
  Risks of Chemicals in Our Environment</em>. Second Edition.  Cambridge University
  Press, New York.</p>
<p>Sheskin, D.J. (2011).  <em>Handbook of Parametric and Nonparametric
  Statistical Procedures</em>  Fifth Edition. CRC Press, Boca Raton, FL.</p>
<p>van Belle, G., L.D. Fisher, Heagerty, P.J., and Lumley, T. (2004).
  <em>Biostatistics: A Methodology for the Health Sciences, 2nd Edition</em>.
  John Wiley &amp; Sons, New York, p. 157.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>.
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ,
  p. 561.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Sometimes in environmental data analysis we are interested in determining whether
  two probabilities or rates or proportions differ from each other.  For example,
  we may ask the question: “Does exposure to pesticide X increase the risk of
  developing cancer Y?”, where cancer Y may be liver cancer, stomach cancer, or some
  other kind of cancer.  One way environmental scientists attempt to answer this kind
  of question is by conducting experiments on rodents in which one group (the
  “treatment” or “exposed” group) is exposed to the pesticide and the
  other group (the control group) is not.  The incidence of cancer Y in the exposed
  group is compared with the incidence of cancer Y in the control group.  (See
  Rodricks (2007) for a discussion of extrapolating results from experiments involving
  rodents to consequences in humans and the associated difficulties).</p>
<p>Hypothesis tests you can use to compare proportions or probability of
  “success” between two groups include Fisher's exact test and the test
  based on the normal approximation (see the <span style="R">R</span> help file for
  <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="permutationTest.object.html">permutationTest.object</a></code>, <code><a href="plot.permutationTest.html">plot.permutationTest</a></code>, <br><code><a href="twoSamplePermutationTestLocation.html">twoSamplePermutationTestLocation</a></code>,
  <code><a href="oneSamplePermutationTest.html">oneSamplePermutationTest</a></code>,
  <a href="FcnsByCatHypothTests.html">Hypothesis Tests</a>, <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 10 observations from a binomial distribution with parameters </span></span></span>
<span class="r-in"><span>  <span class="co"># size=1 and prob=0.3, and 20 observations from a binomial distribution </span></span></span>
<span class="r-in"><span>  <span class="co"># with parameters size=1 and prob=0.5.  Test the null hypothesis that the </span></span></span>
<span class="r-in"><span>  <span class="co"># probability of "success" for the two distributions is the same against the </span></span></span>
<span class="r-in"><span>  <span class="co"># alternative that the probability of "success" for group 1 is less than </span></span></span>
<span class="r-in"><span>  <span class="co"># the probability of "success" for group 2. </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed allows you to reproduce this example).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">23</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">10</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">20</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">test.list</span> <span class="op">&lt;-</span> <span class="fu">twoSamplePermutationTestProportion</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">dat1</span>, <span class="va">dat2</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Print the results of the test </span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------</span></span></span>
<span class="r-in"><span>  <span class="va">test.list</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.hat.x - p.hat.y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             -0.05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.548026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.hat.x p.hat.y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.60    0.65 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.x - p.y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "less"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Two-Sample Permutation Test\n                                 Based on Differences in Proportions\n                                 (Fisher's Exact Test)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nx ny </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      x      y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "dat1" "dat2" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stat.dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -0.95 -0.80 -0.65 -0.50 -0.35 -0.20 -0.05  0.10  0.25  0.40  0.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs.stat.dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 3.661173e-07 3.478114e-05 9.390909e-04 1.064303e-02 5.960097e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 1.788029e-01 2.980048e-01 2.767188e-01 1.383594e-01 3.382118e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 3.074653e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "permutationTest"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 p.x - p.y = 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True p.x - p.y is less than 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Two-Sample Permutation Test</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Based on Differences in Proportions</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (Fisher's Exact Test)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          p.hat.x = 0.60</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 p.hat.y = 0.65</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x = dat1</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 y = dat2</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Sizes:                    nx = 10</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 ny = 20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  p.hat.x - p.hat.y = -0.05</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.548026</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot the results of the test </span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test.list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare to the results of fisher.test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="va">x11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x21</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x22</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x11</span>, <span class="va">x12</span>, <span class="va">x21</span>, <span class="va">x22</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">mat</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Fisher's Exact Test for Count Data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value = 0.548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true odds ratio is less than 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.000000 4.076077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> odds ratio </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.8135355 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 odds ratio = 1</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True odds ratio is less than 1</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Fisher's Exact Test for Count Data</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          odds ratio = 0.8135355</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            mat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.548026</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#95% Confidence Interval:         LCL = 0.000000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 4.076077</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Rodricks (1992, p. 133) presents data from an experiment by </span></span></span>
<span class="r-in"><span>  <span class="co"># Graham et al. (1975) in which different groups of rats were exposed to </span></span></span>
<span class="r-in"><span>  <span class="co"># various concentration levels of ethylene thiourea (ETU), a decomposition </span></span></span>
<span class="r-in"><span>  <span class="co"># product of a certain class of fungicides that can be found in treated foods.  </span></span></span>
<span class="r-in"><span>  <span class="co"># In the group exposed to a dietary level of 250 ppm of ETU, 16 out of 69 rats </span></span></span>
<span class="r-in"><span>  <span class="co"># (23%) developed thyroid tumors, whereas in the control group </span></span></span>
<span class="r-in"><span>  <span class="co"># (no exposure to ETU) only 2 out of 72 (3%) rats developed thyroid tumors.  </span></span></span>
<span class="r-in"><span>  <span class="co"># If we use Fisher's exact test to test the null hypothesis that the proportion </span></span></span>
<span class="r-in"><span>  <span class="co"># of rats exposed to 250 ppm of ETU who will develop thyroid tumors over their </span></span></span>
<span class="r-in"><span>  <span class="co"># lifetime is no greater than the proportion of rats not exposed to ETU who will </span></span></span>
<span class="r-in"><span>  <span class="co"># develop tumors, we get a one-sided upper p-value of 0.0002.  Therefore, we </span></span></span>
<span class="r-in"><span>  <span class="co"># conclude that the true underlying rate of tumor incidence in the exposed group </span></span></span>
<span class="r-in"><span>  <span class="co"># is greater than in the control group.</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># The data for this example are stored in Graham.et.al.75.etu.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at the data</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Graham.et.al.75.etu.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dose tumors  n proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0      2 72 0.02777778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    5      2 75 0.02666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   25      1 73 0.01369863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  125      2 73 0.02739726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  250     16 69 0.23188406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  500     62 70 0.88571429</span>
<span class="r-in"><span>  <span class="co">#  dose tumors  n proportion</span></span></span>
<span class="r-in"><span>  <span class="co">#1    0      2 72 0.02777778</span></span></span>
<span class="r-in"><span>  <span class="co">#2    5      2 75 0.02666667</span></span></span>
<span class="r-in"><span>  <span class="co">#3   25      1 73 0.01369863</span></span></span>
<span class="r-in"><span>  <span class="co">#4  125      2 73 0.02739726</span></span></span>
<span class="r-in"><span>  <span class="co">#5  250     16 69 0.23188406</span></span></span>
<span class="r-in"><span>  <span class="co">#6  500     62 70 0.88571429</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Perform the test for a difference in tumor rates</span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Num.Tumors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Graham.et.al.75.etu.df</span>, <span class="va">tumors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Sample.Sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Graham.et.al.75.etu.df</span>, <span class="va">n</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">test.list</span> <span class="op">&lt;-</span> <span class="fu">twoSamplePermutationTestProportion</span><span class="op">(</span> </span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">Num.Tumors</span>, y <span class="op">=</span> <span class="va">Sample.Sizes</span>, </span></span>
<span class="r-in"><span>    x.and.y<span class="op">=</span><span class="st">"Number Successes and Trials"</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Print the results of the test </span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------</span></span></span>
<span class="r-in"><span>  <span class="va">test.list</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.hat.x - p.hat.y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.2041063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0002186462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    p.hat.x    p.hat.y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23188406 0.02777778 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $null.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p.x - p.y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alternative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "greater"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Two-Sample Permutation Test\n                                 Based on Differences in Proportions\n                                 (Fisher's Exact Test)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimation.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nx ny </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69 72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              x              n </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   "Num.Tumors" "Sample.Sizes" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $stat.dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -0.250000000 -0.221618357 -0.193236715 -0.164855072 -0.136473430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] -0.108091787 -0.079710145 -0.051328502 -0.022946860  0.005434783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  0.033816425  0.062198068  0.090579710  0.118961353  0.147342995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16]  0.175724638  0.204106280  0.232487923  0.260869565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probs.stat.dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.697434e-06 3.833115e-05 3.956322e-04 2.480221e-03 1.058370e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 3.264802e-02 7.545321e-02 1.335893e-01 1.836853e-01 1.976156e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 1.667381e-01 1.100705e-01 5.642502e-02 2.215540e-02 6.516295e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 1.385106e-03 2.003457e-04 1.759457e-05 7.059550e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "permutationTest"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 p.x - p.y = 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True p.x - p.y is greater than 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Two-Sample Permutation Test</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Based on Differences in Proportions</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (Fisher's Exact Test)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          p.hat.x = 0.23188406</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 p.hat.y = 0.02777778</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x = Num.Tumors  </span></span></span>
<span class="r-in"><span>  <span class="co">#                                 n = Sample.Sizes</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Sizes:                    nx = 69</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 ny = 72</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  p.hat.x - p.hat.y = 0.2041063</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         0.0002186462</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot the results of the test </span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test.list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">test.list</span>, <span class="va">x11</span>, <span class="va">x12</span>, <span class="va">x21</span>, <span class="va">x22</span>, <span class="va">mat</span>, <span class="va">Num.Tumors</span>, <span class="va">Sample.Sizes</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">#graphics.off()</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

