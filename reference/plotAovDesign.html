<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create Plots for a Sampling Design Based on a One-Way Fixed-Effects Analysis of Variance — plotAovDesign • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create Plots for a Sampling Design Based on a One-Way Fixed-Effects Analysis of Variance — plotAovDesign"><meta property="og:description" content="Create plots involving sample size, power, scaled difference, and significance level for a
  one-way fixed-effects analysis of variance."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create Plots for a Sampling Design Based on a One-Way Fixed-Effects Analysis of Variance</h1>

    <div class="hidden name"><code>plotAovDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create plots involving sample size, power, scaled difference, and significance level for a
  one-way fixed-effects analysis of variance.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotAovDesign</span><span class="op">(</span>x.var <span class="op">=</span> <span class="st">"n"</span>, y.var <span class="op">=</span> <span class="st">"power"</span>, range.x.var <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    n.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>, mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, power <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    round.up <span class="op">=</span> <span class="cn">FALSE</span>, n.max <span class="op">=</span> <span class="fl">5000</span>, tol <span class="op">=</span> <span class="fl">1e-07</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>, plot.it <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    add <span class="op">=</span> <span class="cn">FALSE</span>, n.points <span class="op">=</span> <span class="fl">50</span>, plot.col <span class="op">=</span> <span class="fl">1</span>, plot.lwd <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>, </span>
<span>    plot.lty <span class="op">=</span> <span class="fl">1</span>, digits <span class="op">=</span> <span class="va">.Options</span><span class="op">$</span><span class="va">digits</span>, main <span class="op">=</span> <span class="cn">NULL</span>, xlab <span class="op">=</span> <span class="cn">NULL</span>, ylab <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"l"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x-var">x.var<a class="anchor" aria-label="anchor" href="#arg-x-var"></a></dt>
<dd><p>character string indicating what variable to use for the x-axis.  Possible values are
  <code>"n"</code> (sample size; the default), <code>"power"</code> (power of the test), and
  <code>"alpha"</code> (significance level of the test).</p></dd>

  <dt id="arg-y-var">y.var<a class="anchor" aria-label="anchor" href="#arg-y-var"></a></dt>
<dd><p>character string indicating what variable to use for the y-axis.  Possible values are
  <code>"power"</code> (power of the test; the default) and <code>"n"</code> (sample size).</p></dd>

  <dt id="arg-range-x-var">range.x.var<a class="anchor" aria-label="anchor" href="#arg-range-x-var"></a></dt>
<dd><p>numeric vector of length 2 indicating the range of the x-variable to use for the plot.
  The default value depends on the value of <code>x.var</code>.  When <code>x.var="n"</code>
  the default value is <code>c(2,50)</code>.  When <code>x.var="power"</code> the default value is <br><code>c(alpha+.Machine$double.eps, 0.95)</code>.  When <code>x.var="alpha"</code>, the default
  value is <code>c(0.01, 0.2)</code>.</p></dd>

  <dt id="arg-n-vec">n.vec<a class="anchor" aria-label="anchor" href="#arg-n-vec"></a></dt>
<dd><p>numeric vector indicating the sample size for each group.  The default value is
  <code>n.vec=c(25, 25)</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.  This argument must be
  the same length as <code>mu.vec</code>.  This argument is ignored if either
  <code>x.var="n"</code> or <code>y.var="n"</code>.</p></dd>

  <dt id="arg-mu-vec">mu.vec<a class="anchor" aria-label="anchor" href="#arg-mu-vec"></a></dt>
<dd><p>numeric vector indicating the population mean for each group.  The default value is
  <code>mu.vec=c(0, 1)</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.  This argument must be
  the same length as <code>n.vec</code>.</p></dd>

  <dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>numeric scalar indicating the population standard deviation for all groups.  The default
  value is <code>sigma=1</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>numeric scalar between 0 and 1 indicating the Type I error level associated with the
  hypothesis test.  The default value is <code>alpha=0.05</code>.  This argument is ignored
  when <code>x.var="alpha"</code>.</p></dd>

  <dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>numeric scalar between 0 and 1 indicating the power associated with the hypothesis
  test.  The default value is <code>power=0.95</code>.  This argument is ignored when
  <code>x.var="power"</code> or <code>y.var="power"</code>.</p></dd>

  <dt id="arg-round-up">round.up<a class="anchor" aria-label="anchor" href="#arg-round-up"></a></dt>
<dd><p>logical scalar indicating whether to round up the values of the computed sample
  size(s) to the next smallest integer.  The default value is FALSE.  This argument
  is ignored unless <code>y.var="n"</code>.</p></dd>

  <dt id="arg-n-max">n.max<a class="anchor" aria-label="anchor" href="#arg-n-max"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>, a positive integer greater than 2 indicating the
  maximum sample size per group.  The default value is <code>n.max=5000</code>.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>, numeric scalar indicating the
  tolerance to use in the <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> search for the sample size.
  The default value is <code>tol=1e-7</code>.</p></dd>

  <dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>, positive integer greater then 1 indicating the
  maximum number of iterations to use in the <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> search for
  the sample size.  The default value is <code>maxiter=1000</code>.</p></dd>

  <dt id="arg-plot-it">plot.it<a class="anchor" aria-label="anchor" href="#arg-plot-it"></a></dt>
<dd><p>a logical scalar indicating whether to create a plot or add to the existing plot
  (see <code>add</code>) on the current graphics device.  If <code>plot.it=FALSE</code>, no plot
  is produced, but a list of (x,y) values is returned (see VALUE).  The default
  value is <code>plot.it=TRUE</code>.</p></dd>

  <dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>a logical scalar indicating whether to add the design plot to the existing plot
  (<code>add=TRUE</code>), or to create a new plot (<code>add=FALSE</code>).  The default value is <br><code>add=FALSE</code>.  This argument is ignored if <code>plot.it=FALSE</code>.</p></dd>

  <dt id="arg-n-points">n.points<a class="anchor" aria-label="anchor" href="#arg-n-points"></a></dt>
<dd><p>a numeric scalar specifying how many (x,y) pairs to use to produce the plot.  There are
  <code>n.points</code> x-values evenly spaced between <code>range.x.var[1]</code> and <br><code>range.x.var[2]</code>. The default value is <code>n.points=50</code>.</p></dd>

  <dt id="arg-plot-col">plot.col<a class="anchor" aria-label="anchor" href="#arg-plot-col"></a></dt>
<dd><p>a numeric scalar or character string determining the color of the plotted line or points.  The default value
  is <code>plot.col=1</code>.  See the entry for <code>col</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-plot-lwd">plot.lwd<a class="anchor" aria-label="anchor" href="#arg-plot-lwd"></a></dt>
<dd><p>a numeric scalar determining the width of the plotted line.  The default value is
  <code>3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-plot-lty">plot.lty<a class="anchor" aria-label="anchor" href="#arg-plot-lty"></a></dt>
<dd><p>a numeric scalar determining the line type of the plotted line.  The default value is
  <code>plot.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>a scalar indicating how many significant digits to print out on the plot.  The default
  value is the current setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a>("digits")</code>.</p></dd>

  <dt id="arg-main-xlab-ylab-type-">main, xlab, ylab, type, ...<a class="anchor" aria-label="anchor" href="#arg-main-xlab-ylab-type-"></a></dt>
<dd><p>additional graphical parameters (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>See the help files for <code><a href="aovPower.html">aovPower</a></code> and <code><a href="aovN.html">aovN</a></code>
  for information on how to compute the power and sample size for a
  one-way fixed-effects analysis of variance.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>plotAovDesign</code> invisibly returns a list with components:</p>
<p></p>
<dl><dt>x.var</dt>
<dd><p>x-coordinates of the points that have been or would have been plotted</p></dd>

  <dt>y.var</dt>
<dd><p>y-coordinates of the points that have been or would have been plotted</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (1994).
  <em>Statistics for Environmental Engineers</em>.
  Lewis Publishers, Boca Raton, FL, Chapter 17.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, Chapter 7.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1995).
  <em>Continuous Univariate Distributions, Volume 2</em>.
  Second Edition. John Wiley and Sons, New York,
  Chapters 27, 29, 30.</p>
<p>Scheffe, H. (1959). <em>The Analysis of Variance</em>.
  John Wiley and Sons, New York, 477pp.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>.
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ,
  Chapter 10.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The normal and lognormal distribution are probably the two most
  frequently used distributions to model environmental data.
  Sometimes it is necessary to compare several means to determine
  whether any are significantly different from each other
  (e.g., USEPA, 2009, p.6-38).  In this case, assuming
  normally distributed data, you perform a one-way parametric
  analysis of variance.</p>
<p>In the course of designing a sampling program, an environmental
  scientist may wish to determine the relationship between sample
  size, Type I error level, power, and differences in means if
  one of the objectives of the sampling program is to determine
  whether a particular mean differs from a group of means.  The
  functions <code><a href="aovPower.html">aovPower</a></code>, <code><a href="aovN.html">aovN</a></code>, and
  <code>plotAovDesign</code> can be used to investigate these
  relationships for the case of normally-distributed observations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="aovPower.html">aovPower</a></code>, <code><a href="aovN.html">aovN</a></code>,
  <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a></code>, <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at the relationship between power and sample size </span></span></span>
<span class="r-in"><span>  <span class="co"># for a one-way ANOVA, assuming k=2 groups, group means of </span></span></span>
<span class="r-in"><span>  <span class="co"># 0 and 1, a population standard deviation of 1, and a </span></span></span>
<span class="r-in"><span>  <span class="co"># 5% significance level:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotAovDesign</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot power vs. sample size for various levels of significance:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotAovDesign</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, main<span class="op">=</span><span class="st">""</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">plotAovDesign</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, add<span class="op">=</span><span class="cn">TRUE</span>, plot.col<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">plotAovDesign</span><span class="op">(</span>mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, add<span class="op">=</span><span class="cn">TRUE</span>, plot.col<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">0.6</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"20%"</span>, <span class="st">"10%"</span>, <span class="st">"   5%"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, </span></span>
<span class="r-in"><span>    bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Power vs. Sample Size for One-Way ANOVA"</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"with "</span>, <span class="va">mu</span>, <span class="st">"=(0, 0.5, 1), "</span>, <span class="va">sigma</span>, </span></span>
<span class="r-in"><span>    <span class="st">"=1, and Various Significance Levels"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    line <span class="op">=</span> <span class="fl">1.5</span>, cex <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The example on pages 5-11 to 5-14 of USEPA (1989b) shows </span></span></span>
<span class="r-in"><span>  <span class="co"># log-transformed concentrations of lead (mg/L) at two </span></span></span>
<span class="r-in"><span>  <span class="co"># background wells and four compliance wells, where </span></span></span>
<span class="r-in"><span>  <span class="co"># observations were taken once per month over four months </span></span></span>
<span class="r-in"><span>  <span class="co"># (the data are stored in EPA.89b.loglead.df).  </span></span></span>
<span class="r-in"><span>  <span class="co"># Assume the true mean levels at each well are </span></span></span>
<span class="r-in"><span>  <span class="co"># 3.9, 3.9, 4.5, 4.5, 4.5, and 5, respectively.  Plot the </span></span></span>
<span class="r-in"><span>  <span class="co"># power vs. sample size of a one-way ANOVA to test for mean </span></span></span>
<span class="r-in"><span>  <span class="co"># differences between wells.  Use alpha=0.05, and assume the </span></span></span>
<span class="r-in"><span>  <span class="co"># true standard deviation is equal to the one estimated </span></span></span>
<span class="r-in"><span>  <span class="co"># from the data in this example.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">EPA.89b.loglead.df</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "LogLead"   "Month"     "Well"      "Well.type"</span>
<span class="r-in"><span>  <span class="co">#[1] "LogLead"   "Month"     "Well"      "Well.type"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Perform the ANOVA and get the estimated sd </span></span></span>
<span class="r-in"><span>  <span class="va">aov.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">LogLead</span> <span class="op">~</span> <span class="va">Well</span>, data<span class="op">=</span><span class="va">EPA.89b.loglead.df</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov.list</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Well         5  5.745  1.1489   3.347  0.026 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals   18  6.179  0.3433                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span>  <span class="co">#            Df Sum Sq Mean Sq F value  Pr(&gt;F)  </span></span></span>
<span class="r-in"><span>  <span class="co">#Well         5 5.7447 1.14895  3.3469 0.02599 *</span></span></span>
<span class="r-in"><span>  <span class="co">#Residuals   18 6.1791 0.34328                  </span></span></span>
<span class="r-in"><span>  <span class="co">#---</span></span></span>
<span class="r-in"><span>  <span class="co">#Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 '' 1</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="co"># Now create the plot </span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotAovDesign</span><span class="op">(</span>range.x.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    mu.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.9</span>,<span class="fl">3.9</span>,<span class="fl">4.5</span>,<span class="fl">4.5</span>,<span class="fl">4.5</span>,<span class="fl">5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.34</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">aov.list</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

