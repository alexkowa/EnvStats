<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Power of a t-Test for Linear Trend — linearTrendTestPower • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Power of a t-Test for Linear Trend — linearTrendTestPower"><meta property="og:description" content="Compute the power of a parametric test for linear trend, given the sample size or
  predictor variable values, scaled slope, and significance level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Power of a t-Test for Linear Trend</h1>

    <div class="hidden name"><code>linearTrendTestPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the power of a parametric test for linear trend, given the sample size or
  predictor variable values, scaled slope, and significance level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linearTrendTestPower</span><span class="op">(</span><span class="va">n</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">seq</span><span class="op">)</span>, slope.over.sigma <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>    alternative <span class="op">=</span> <span class="st">"two.sided"</span>, approx <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>numeric vector of sample sizes.  All values of <code>n</code> must be positive integers
  larger than 2.  This argument is ignored when <code>x</code> is supplied.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are not allowed.</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of predictor variable values, or a list in which each component is
  a numeric vector of predictor variable values.  Usually, the predictor variable is
  time (e.g., days, months, quarters, etc.).  The default value is
  <code>x=lapply(n,seq)</code>, which yields a list in which the i'th component is the
  seqence of integers from 1 to the i'th value of the vector <code>n</code>.  If <code>x</code>
  is a numeric vector, it must contain at least three elements, two of which must be
  unique.  If <code>x</code> is a list of numeric vectors, each component of <code>x</code>
  must contain at least three elements, two of which must be unique.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are not allowed.</p></dd>

  <dt id="arg-slope-over-sigma">slope.over.sigma<a class="anchor" aria-label="anchor" href="#arg-slope-over-sigma"></a></dt>
<dd><p>numeric vector specifying the ratio of the true slope to the standard deviation of
  the error terms (\(\sigma\)).  This is also called the "scaled slope".  The
  default value is <code>slope.over.sigma=0</code>.</p></dd>

  <dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>numeric vector of numbers between 0 and 1 indicating the Type I error level
  associated with the hypothesis test.  The default value is <code>alpha=0.05</code>.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The possible values
  are <code>"two.sided"</code> (the default), <code>"greater"</code>, and <code>"less"</code>.</p></dd>

  <dt id="arg-approx">approx<a class="anchor" aria-label="anchor" href="#arg-approx"></a></dt>
<dd><p>logical scalar indicating whether to compute the power based on an approximation to
  the non-central t-distribution.  The default value is <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the argument <code>x</code> is a vector, it is converted into a list with one
  component.  If the arguments <code>n</code>, <code>x</code>, <code>slope.over.sigma</code>, and
  <code>alpha</code> are not all the same length, they are replicated to be the same
  length as the length of the longest argument.</p>
<p><b>Basic Model</b> <br>
  Consider the simple linear regression model
  $$Y = \beta_0 + \beta_1 X + \epsilon \;\;\;\;\;\; (1)$$
  where \(X\) denotes the predictor variable (observed without error),
  \(\beta_0\) denotes the intercept, \(\beta_1\) denotes the slope, and the
  error term \(\epsilon\) is assumed to be a random variable from a normal
  distribution with mean 0 and standard deviation \(\sigma\).  Let
  $$(\underline{x}, \underline{y}) = (x_1, y_1), (x_2, y_2), \ldots, (x_n, y_n) \;\;\;\;\;\; (2)$$
  denote \(n\) independent observed \((X,Y)\) pairs from the model (1).</p>
<p>Often in environmental data analysis, we are interested in determining whether there
  is a trend in some indicator variable over time.  In this case, the predictor
  variable \(X\) is time (e.g., day, month, quarter, year, etc.), and the \(n\)
  values of the response variable \(Y\) represent measurements taken over time.
  The slope then represents the change in the average of the response variable per
  one unit of time.</p>
<p>When the argument <code>x</code> is a numeric vector, it represents the
  \(n\) values of the predictor variable.  When the argument <code>x</code> is a
  list, each component of <code>x</code> is a numeric vector that represents a set values
  of the predictor variable (and the number of elements may vary by component).
  By default, the argument <code>x</code> is a list for which the i'th component is simply
  the integers from 1 to the value of the i'th element of the argument <code>n</code>,
  representing, for example, Day 1, Day2, ..., Day <code>n[i]</code>.</p>
<p>In the discussion that follows, be sure not to confuse the intercept and slope
  coefficients \(\beta_0\) and \(\beta_1\) with the Type II error of the
  hypothesis test, which is denoted by \(\beta\).
  <br></p>
<p><b>Estimation of Coefficients and Confidence Interval for Slope</b> <br>
  The standard least-squares estimators of the slope and intercept are given by:
  $$\hat{\beta}_1 = \frac{S_{xy}}{S_{xx}} \;\;\;\;\;\; (3)$$
  $$\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x} \;\;\;\;\;\; (4)$$
  where
  $$S_{xy} = \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) \;\;\;\;\;\; (5)$$
  $$S_{xx} = \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (6)$$
  $$\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (7)$$
  $$\bar{y} = \frac{1}{n} \sum_{i=1}^n y_i \;\;\;\;\;\; (8)$$
  (Draper and Smith, 1998, p.25; Zar, 2010, p.332-334; Berthoux and Brown, 2002, p.297;
  Helsel and Hirsch, p.226).  The estimator of slope in Equation (3) has a normal
  distribution with mean equal to the true slope, and variance given by:
  $$Var(\hat{\beta}_1) = \sigma_{\hat{\beta}_1}^2 = \frac{\sigma^2}{S_{xx}} \;\;\;\;\;\; (9)$$
  (Draper and Smith, 1998, p.35; Zar, 2010, p.341; Berthoux and Brown, 2002, p.299;
  Helsel and Hirsch, 1992, p.227). Thus, a \((1-\alpha)100\%\) two-sided confidence
  interval for the slope is given by:
  $$[ \hat{\beta}_1 - t_{n-2}(1-\alpha/2) \hat{\sigma}_{\hat{\beta}_1}, \;\; \hat{\beta}_1 + t_{n-2}(1-\alpha/2) \hat{\sigma}_{\hat{\beta}_1} ] \;\;\;\;\;\; (10)$$
  where
  $$\hat{\sigma}_{\hat{\beta}_1} = \frac{\hat{\sigma}}{\sqrt{S_{xx}}} \;\;\;\;\;\; (11)$$
  $$\hat{\sigma}^2 = s^2 = \frac{1}{n-2} \sum_{i=1}^n (y_i - \hat{y}_i)^2 \;\;\;\;\;\; (12)$$
  $$\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1 x_i \;\;\;\;\;\; (13)$$
  and \(t_{\nu}(p)\) denotes the \(p\)'th quantile of
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(\nu\) degrees of freedom
  (Draper and Smith, 1998, p.36; Zar, 2010, p.343; Berthoux and Brown, 2002, p.300;
  Helsel and Hirsch, 1992, p.240).
  <br></p>
<p><b>Testing for a Non-Zero Slope</b> <br>
  Consider the null hypothesis of a zero slope coefficient:
  $$H_0: \beta_1 = 0 \;\;\;\;\;\; (14)$$
  The three possible alternative hypotheses are the upper one-sided alternative
  (<code>alternative="greater"</code>):
  $$H_a: \beta_1 &gt; 0 \;\;\;\;\;\; (15)$$
  the lower one-sided alternative (<code>alternative="less"</code>)
  $$H_a: \beta_1 &lt; 0 \;\;\;\;\;\; (16)$$
  and the two-sided alternative (<code>alternative="two.sided"</code>)
  $$H_a: \beta_1 \ne 0 \;\;\;\;\;\; (17)$$
  The test of the null hypothesis (14) versus any of the three alternatives (15)-(17) is
  based on the Student t-statistic:
  $$t = \frac{\hat{\beta}_1}{\hat{\sigma}_{\hat{\beta}_1}} =  \frac{\hat{\beta}_1}{s/\sqrt{S_{xx}}} \;\;\;\;\;\; (18)$$
  Under the null hypothesis (14), the t-statistic in (18) follows a
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">Student's t-distribution</a> with \(n-2\) degrees of freedom
  (Draper and Smith, 1998, p.36; Zar, 2010, p.341;
  Helsel and Hirsch, 1992, pp.238-239).</p>
<p>The formula for the power of the test of a zero slope depends on which alternative
  is being tested.
  The two subsections below describe exact and approximate formulas for the power of
  the test.  Note that none of the equations for the power of the t-test
  requires knowledge of the values \(\beta_1\) or \(\sigma\)
  (the population standard deviation of the error terms), only the ratio
  \(\beta_1/\sigma\).  The argument <code>slope.over.sigma</code> is this ratio, and it is
  referred to as the “scaled slope”.
  <br></p>
<p><b><em>Exact Power Calculations</em></b> (<code>approx=FALSE</code>) <br>
  This subsection describes the exact formulas for the power of the t-test for a
  zero slope.
  <br></p>
<p><em>Upper one-sided alternative</em> (<code>alternative="greater"</code>) <br>
  The standard Student's t-test rejects the null hypothesis (1) in favor of the
  upper alternative hypothesis (2) at level-\(\alpha\) if
  $$t \ge t_{\nu}(1 - \alpha) \;\;\;\;\;\; (19)$$
  where
  $$\nu = n - 2 \;\;\;\;\;\; (20)$$
  and, as noted previously, \(t_{\nu}(p)\) denotes the \(p\)'th quantile of
  Student's t-distribution with \(\nu\) degrees of freedom.
  The power of this test, denoted by \(1-\beta\), where \(\beta\) denotes the
  probability of a Type II error, is given by:
  $$1 - \beta = Pr[t_{\nu, \Delta} \ge t_{\nu}(1 - \alpha)] = 1 - G[t_{\nu}(1 - \alpha), \nu, \Delta] \;\;\;\;\;\; (21)$$
  where
  $$\Delta = \sqrt{S_{xx}} \frac{\beta_1}{\sigma} \;\;\;\;\;\; (22)$$
  and \(t_{\nu, \Delta}\) denotes a
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">non-central Student's t-random variable</a> with
  \(\nu\) degrees of freedom and non-centrality parameter \(\Delta\), and
  \(G(x, \nu, \Delta)\) denotes the cumulative distribution function of this
  random variable evaluated at \(x\) (Johnson et al., 1995, pp.508-510).
  Note that when the predictor variable \(X\) represents equally-spaced measures
  of time (e.g., days, months, quarters, etc.) and
  $$x_i = i, \;\; i = 1, 2, \ldots, n \;\;\;\;\;\; (23)$$
  then the non-centrality parameter in Equation (22) becomes:
  $$\Delta = \sqrt{\frac{(n-1)n(n+1)}{12}} \frac{\beta_1}{\sigma} \;\;\;\;\;\; (24)$$
  <br></p>
<p><em>Lower one-sided alternative</em> (<code>alternative="less"</code>) <br>
  The standard Student's t-test rejects the null hypothesis (1) in favor of the
  lower alternative hypothesis (3) at level-\(\alpha\) if
  $$t \le t_{\nu}(\alpha) \;\;\;\;\;\; (25)$$
  and the power of this test is given by:
  $$1 - \beta = Pr[t_{\nu, \Delta} \le t_{\nu}(\alpha)] = G[t_{\nu}(\alpha), \nu, \Delta] \;\;\;\;\;\; (26)$$
  <br></p>
<p><em>Two-sided alternative</em> (<code>alternative="two.sided"</code>) <br>
  The standard Student's t-test rejects the null hypothesis (14) in favor of the
  two-sided alternative hypothesis (17) at level-\(\alpha\) if
  $$|t| \ge t_{\nu}(1 - \alpha/2) \;\;\;\;\;\; (27)$$
  and the power of this test is given by:
  $$1 - \beta = Pr[t_{\nu, \Delta} \le t_{\nu}(\alpha/2)] + Pr[t_{\nu, \Delta} \ge t_{\nu}(1 - \alpha/2)]$$
  $$= G[t_{\nu}(\alpha/2), \nu, \Delta] + 1 - G[t_{\nu}(1 - \alpha/2), \nu, \Delta] \;\;\;\;\;\; (28)$$
  The power of the t-test given in Equation (28) can also be expressed in terms of the
  cumulative distribution function of the <a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">non-central F-distribution</a>
  as follows. Let \(F_{\nu_1, \nu_2, \Delta}\) denote a
  <a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">non-central F random variable</a> with \(\nu_1\) and
  \(\nu_2\) degrees of freedom and non-centrality parameter \(\Delta\), and let
  \(H(x, \nu_1, \nu_2, \Delta)\) denote the cumulative distribution function of this
  random variable evaluated at \(x\). Also, let \(F_{\nu_1, \nu_2}(p)\) denote
  the \(p\)'th quantile of the central F-distribution with \(\nu_1\) and
  \(\nu_2\) degrees of freedom.  It can be shown that
  $$(t_{\nu, \Delta})^2 \cong F_{1, \nu, \Delta^2} \;\;\;\;\;\; (29)$$
  where \(\cong\) denotes “equal in distribution”.  Thus, it follows that
  $$[t_{\nu}(1 - \alpha/2)]^2 = F_{1, \nu}(1 - \alpha) \;\;\;\;\;\; (30)$$
  so the formula for the power of the t-test given in Equation (28) can also be
  written as:
  $$1 - \beta = Pr\{(t_{\nu, \Delta})^2  \ge [t_{\nu}(1 - \alpha/2)]^2\}$$
  $$= Pr[F_{1, \nu, \Delta^2} \ge F_{1, \nu}(1 - \alpha)] = 1 - H[F_{1, \nu}(1-\alpha), 1, \nu, \Delta^2] \;\;\;\;\;\; (31)$$
  <br></p>
<p><b><em>Approximate Power Calculations</em></b> (<code>approx=TRUE</code>) <br>
  Zar (2010, pp.115–118) presents an approximation to the power for the t-test
  given in Equations (21), (26), and (28) above.  His approximation to the power
  can be derived by using the approximation
  $$\sqrt{S_{xx}} \frac{\beta_1}{s} \approx \sqrt{SS_{xx}} \frac{\beta_1}{\sigma} = \Delta \;\;\;\;\;\; (32)$$
  where \(\approx\) denotes “approximately equal to”.  Zar's approximation
  can be summarized in terms of the cumulative distribution function of the
  non-central t-distribution as follows:
  $$G(x, \nu, \Delta) \approx G(x - \Delta, \nu, 0) = G(x - \Delta, \nu) \;\;\;\;\;\; (33)$$
  where \(G(x, \nu)\) denotes the cumulative distribution function of the
  central Student's t-distribution with \(\nu\) degrees of freedom evaluated at
  \(x\).</p>
<p>The following three subsections explicitly derive the approximation to the power of
  the t-test for each of the three alternative hypotheses.
  <br></p>
<p><em>Upper one-sided alternative</em> (<code>alternative="greater"</code>) <br>
  The power for the upper one-sided alternative (15) given in Equation (21) can be
  approximated as:
  $$1 - \beta = Pr[t \ge t_{\nu}(1 - \alpha)]$$
  $$= Pr[\frac{\hat{\beta}_1}{s/\sqrt{S_{xx}}} \ge t_{\nu}(1 - \alpha) - \sqrt{S_{xx}}\frac{\beta_1}{s}]$$
  $$\approx Pr[t_{\nu} \ge t_{\nu}(1 - \alpha) - \Delta]$$
  $$= 1 - Pr[t_{\nu} \le t_{\nu}(1 - \alpha) - \Delta]$$
  $$ = 1 - G[t_{\nu}(1-\alpha) - \Delta, \nu] \;\;\;\;\;\; (34)$$
  where \(t_{\nu}\) denotes a central Student's t-random variable with \(\nu\)
  degrees of freedom.
  <br></p>
<p><em>Lower one-sided alternative</em> (<code>alternative="less"</code>) <br>
  The power for the lower one-sided alternative (16) given in Equation (26) can be
  approximated as:
  $$1 - \beta = Pr[t \le t_{\nu}(\alpha)]$$
  $$= Pr[\frac{\hat{\beta}_1}{s/\sqrt{S_{xx}}} \le t_{\nu}(\alpha) - \sqrt{S_{xx}}\frac{\beta_1}{s}]$$
  $$\approx Pr[t_{\nu} \le t_{\nu}(\alpha) - \Delta]$$
  $$ = G[t_{\nu}(\alpha) - \Delta, \nu] \;\;\;\;\;\; (35)$$
  <br></p>
<p><em>Two-sided alternative</em> (<code>alternative="two.sided"</code>) <br>
  The power for the two-sided alternative (17) given in Equation (28) can be
  approximated as:
  $$1 - \beta = Pr[t \le t_{\nu}(\alpha/2)] + Pr[t \ge t_{\nu}(1 - \alpha/2)]$$
  $$= Pr[\frac{\hat{\beta}_1}{s/\sqrt{S_{xx}}} \le t_{\nu}(\alpha/2) - \sqrt{SS_{xx}}\frac{\beta_1}{s}] + Pr[\frac{\hat{\beta}_1}{s/\sqrt{S_{xx}}} \ge t_{\nu}(1 - \alpha) - \sqrt{SS_{xx}}\frac{\beta_1}{s}]$$
  $$\approx Pr[t_{\nu} \le t_{\nu}(\alpha/2) - \Delta] + Pr[t_{\nu} \ge t_{\nu}(1 - \alpha/2) - \Delta]$$
  $$= G[t_{\nu}(\alpha/2) - \Delta, \nu] + 1 - G[t_{\nu}(1-\alpha/2) - \Delta, \nu] \;\;\;\;\;\; (36)$$</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a numeric vector powers.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers</em>.  Second Edition.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Draper, N., and H. Smith. (1998).  <em>Applied Regression Analysis</em>.
  Third Edition.  John Wiley and Sons, New York, Chapter 1.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, Chapter 9.</p>
<p>Johnson, N. L., S. Kotz, and N. Balakrishnan. (1995).  <em>Continuous Univariate
  Distributions, Volume 2</em>.  Second Edition.  John Wiley and Sons, New York,
  Chapters 28, 31</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, FL.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Often in environmental data analysis, we are interested in determining whether
  there is a trend in some indicator variable over time.  In this case, the predictor
  variable \(X\) is time (e.g., day, month, quarter, year, etc.), and the \(n\)
  values of the response variable represent measurements taken over time.  The slope
  then represents the change in the average of the response variable per one unit of
  time.</p>
<p>You can use the parametric model (1) to model your data, then use the <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> to fit the regression coefficients and the <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm</a></code>
  function to perform a test for the significance of the slope coefficient.  The
  function <code>linearTrendTestPower</code> computes the power of this t-test, given a
  fixed value of the sample size, scaled slope, and significance level.</p>
<p>You can also use <a href="kendallTrendTest.html">Kendall's nonparametric test for trend</a>
  if you don't want to assume the error terms are normally distributed.  When the
  errors are truly normally distributed, the asymptotic relative efficiency of
  Kendall's test for trend versus the parametric t-test for a zero slope is 0.98,
  and Kendall's test can be more powerful than the parametric t-test when the errors
  are not normally distributed.  Thus the function <code>linearTrendTestPower</code> can
  also be used to estimate the power of Kendall's test for trend.</p>
<p>In the course of designing a sampling program, an environmental scientist may wish
  to determine the relationship between sample size, significance level, power, and
  scaled slope if one of the objectives of the sampling program is to determine
  whether a trend is occurring.  The functions <code>linearTrendTestPower</code>,
  <code><a href="linearTrendTestN.html">linearTrendTestN</a></code>, <code><a href="linearTrendTestScaledMds.html">linearTrendTestScaledMds</a></code>, and <br><code><a href="plotLinearTrendTestDesign.html">plotLinearTrendTestDesign</a></code> can be used to investigate these
  relationships.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="linearTrendTestN.html">linearTrendTestN</a></code>, <code><a href="linearTrendTestScaledMds.html">linearTrendTestScaledMds</a></code>,
  <code><a href="plotLinearTrendTestDesign.html">plotLinearTrendTestDesign</a></code>, <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <br><code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm</a></code>, <code><a href="kendallTrendTest.html">kendallTrendTest</a></code>,
  <a href="FcnsByCatPower.html">Power and Sample Size</a>, <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>, <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at how the power of the t-test for zero slope increases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># sample size:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  5 10 15 20 25 30</span>
<span class="r-in"><span>  <span class="co">#[1] 5 10 15 20 25 30 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">linearTrendTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, slope.over.sigma <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06 0.13 0.34 0.68 0.93 1.00</span>
<span class="r-in"><span>  <span class="co">#[1] 0.06 0.13 0.34 0.68 0.93 1.00</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the last example, but compute the approximate power instead of the </span></span></span>
<span class="r-in"><span>  <span class="co"># exact:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">linearTrendTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, slope.over.sigma <span class="op">=</span> <span class="fl">0.1</span>, </span></span>
<span class="r-in"><span>    approx <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05 0.11 0.32 0.68 0.93 0.99</span>
<span class="r-in"><span>  <span class="co">#[1] 0.05 0.11 0.32 0.68 0.93 0.99</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of the t-test for zero slope increases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># scaled slope:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05 0.10 0.15 0.20</span>
<span class="r-in"><span>  <span class="co">#[1] 0.05 0.10 0.15 0.20 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">linearTrendTestPower</span><span class="op">(</span><span class="fl">15</span>, slope.over.sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span>, by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.12 0.34 0.64 0.87</span>
<span class="r-in"><span>  <span class="co">#[1] 0.12 0.34 0.64 0.87</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the power of the t-test for zero slope increases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># values of Type I error:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">power</span> <span class="op">&lt;-</span> <span class="fu">linearTrendTestPower</span><span class="op">(</span><span class="fl">20</span>, slope.over.sigma <span class="op">=</span> <span class="fl">0.1</span>, </span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">power</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.14 0.41 0.68 0.80</span>
<span class="r-in"><span>  <span class="co">#[1] 0.14 0.41 0.68 0.80</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Show that for a simple regression model, you get a greater power of detecting </span></span></span>
<span class="r-in"><span>  <span class="co"># a non-zero slope if you take all the observations at two endpoints, rather than </span></span></span>
<span class="r-in"><span>  <span class="co"># spreading the observations evenly between two endpoints. </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: This design usually cannot work with environmental monitoring data taken </span></span></span>
<span class="r-in"><span>  <span class="co"># over time since usually observations taken close together in time are not </span></span></span>
<span class="r-in"><span>  <span class="co"># independent.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">linearTrendTestPower</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, slope.over.sigma <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1265976</span>
<span class="r-in"><span>  <span class="co">#[1] 0.1265976</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">linearTrendTestPower</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, slope.over.sigma <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2413823</span>
<span class="r-in"><span>  <span class="co">#[1] 0.2413823</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

