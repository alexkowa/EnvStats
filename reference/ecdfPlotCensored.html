<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Empirical Cumulative Distribution Function Plot Based on Type I Censored Data — ecdfPlotCensored • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical Cumulative Distribution Function Plot Based on Type I Censored Data — ecdfPlotCensored"><meta property="og:description" content="Produce an empirical cumulative distribution function plot for Type I left-censored
  or right-censored data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Empirical Cumulative Distribution Function Plot Based on Type I Censored Data</h1>

    <div class="hidden name"><code>ecdfPlotCensored.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produce an empirical cumulative distribution function plot for Type I left-censored
  or right-censored data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ecdfPlotCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, censoring.side <span class="op">=</span> <span class="st">"left"</span>, discrete <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    prob.method <span class="op">=</span> <span class="st">"michael-schucany"</span>, plot.pos.con <span class="op">=</span> <span class="fl">0.375</span>, plot.it <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    add <span class="op">=</span> <span class="cn">FALSE</span>, ecdf.col <span class="op">=</span> <span class="fl">1</span>, ecdf.lwd <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>, ecdf.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    include.cen <span class="op">=</span> <span class="cn">FALSE</span>, cen.pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">censoring.side</span> <span class="op">==</span> <span class="st">"left"</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    cen.cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>, cen.col <span class="op">=</span> <span class="fl">4</span>, <span class="va">...</span>,</span>
<span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">discrete</span>, <span class="st">"s"</span>, <span class="st">"l"</span><span class="op">)</span>, main <span class="op">=</span> <span class="cn">NULL</span>, xlab <span class="op">=</span> <span class="cn">NULL</span>, ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    xlim <span class="op">=</span> <span class="cn">NULL</span>, ylim <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-censored">censored<a class="anchor" aria-label="anchor" href="#arg-censored"></a></dt>
<dd><p>numeric or logical vector indicating which values of <code>x</code> are censored.  This must be the
  same length as <code>x</code>.  If the mode of <code>censored</code> is <code>"logical"</code>, <code>TRUE</code> values
  correspond to elements of <code>x</code> that are censored, and <code>FALSE</code> values correspond to
  elements of <code>x</code> that are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>,
  it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to <code>TRUE</code> and
  <code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-censoring-side">censoring.side<a class="anchor" aria-label="anchor" href="#arg-censoring-side"></a></dt>
<dd><p>character string indicating on which side the censoring occurs.  The possible values are
  <code>"left"</code> (the default) and <code>"right"</code>.</p></dd>

  <dt id="arg-discrete">discrete<a class="anchor" aria-label="anchor" href="#arg-discrete"></a></dt>
<dd><p>logical scalar indicating whether the assumed parent distribution of <code>x</code> is discrete
  (<code>discrete=TRUE</code>) or continuous (<code>discrete=FALSE</code>; the default).</p></dd>

  <dt id="arg-prob-method">prob.method<a class="anchor" aria-label="anchor" href="#arg-prob-method"></a></dt>
<dd><p>character string indicating what method to use to compute the plotting positions (empirical probabilities).
  Possible values are <code>"kaplan-meier"</code> (product-limit method of Kaplan and Meier (1958)),
  <code>"nelson"</code> (hazard plotting method of Nelson (1972)),
  <code>"michael-schucany"</code> (generalization of the product-limit method due to Michael and Schucany (1986)), and
  <code>"hirsch-stedinger"</code> (generalization of the product-limit method due to Hirsch and Stedinger (1987)).
  The default value is <code>prob.method="michael-schucany"</code>.</p>
<p>The <code>"nelson"</code> method is only available for <code>censoring.side="right"</code>.
  See the DETAILS section for more explanation.</p></dd>

  <dt id="arg-plot-pos-con">plot.pos.con<a class="anchor" aria-label="anchor" href="#arg-plot-pos-con"></a></dt>
<dd><p>numeric scalar between 0 and 1 containing the value of the plotting position constant.
  The default value is <code>plot.pos.con=0.375</code>.  See the DETAILS section for more information.
  This argument is used only if <code>prob.method</code> is equal to <code>"michael-schucany"</code> or
  <code>"hirsch-stedinger"</code>.</p></dd>

  <dt id="arg-plot-it">plot.it<a class="anchor" aria-label="anchor" href="#arg-plot-it"></a></dt>
<dd><p>logical scalar indicating whether to produce a plot or add to the current plot (see <code>add</code>)
  on the current graphics device.  The default value is <code>plot.it=TRUE</code>.</p></dd>

  <dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>logical scalar indicating whether to add the empirical cdf to the current plot (<code>add=TRUE</code>)
  or generate a new plot (<code>add=FALSE</code>; the default).  This argument is ignored if
  <code>plot.it=FALSE</code>.</p></dd>

  <dt id="arg-ecdf-col">ecdf.col<a class="anchor" aria-label="anchor" href="#arg-ecdf-col"></a></dt>
<dd><p>a numeric scalar or character string determining the color of the empirical cdf line or points.
  The default value is <code>ecdf.col=1</code>. See the entry for <code>col</code> in the help file for
  <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code> for more information.</p></dd>

  <dt id="arg-ecdf-lwd">ecdf.lwd<a class="anchor" aria-label="anchor" href="#arg-ecdf-lwd"></a></dt>
<dd><p>a numeric scalar determining the width of the empirical cdf line.  The default value is
  <code>ecdf.lwd=3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-ecdf-lty">ecdf.lty<a class="anchor" aria-label="anchor" href="#arg-ecdf-lty"></a></dt>
<dd><p>a numeric scalar determining the line type of the empirical cdf line.  The default value is
  <code>ecdf.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-include-cen">include.cen<a class="anchor" aria-label="anchor" href="#arg-include-cen"></a></dt>
<dd><p>logical scalar indicating whether to include censored values in the plot.  The default value is
  <code>include.cen=FALSE</code>.  If <code>include.cen=TRUE</code>, censored values are plotted using the
  plotting character indicated by the argument <code>cen.pch</code> (see below).</p></dd>

  <dt id="arg-cen-pch">cen.pch<a class="anchor" aria-label="anchor" href="#arg-cen-pch"></a></dt>
<dd><p>numeric scalar or character string indicating the plotting character to use to plot censored values.
  The default value is <code>cen.pch=2</code> (hollow triangle pointing up) when <code>censoring.side="right"</code>,
  and <code>cen.pch=6</code> (hollow triangle pointing down) when <code>censoring.side="left"</code>.
  See the help file for <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></code> for a list of other possible plotting characters.
  This argument is ignored if <br><code>include.cen=FALSE</code>.</p></dd>

  <dt id="arg-cen-cex">cen.cex<a class="anchor" aria-label="anchor" href="#arg-cen-cex"></a></dt>
<dd><p>numeric scalar that determines the size of the plotting character used to plot censored values.
  The default value is the current value of the cex graphics parameter.  See the entry for <code>cex</code>
  in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code> for more information.  This argument is ignored if
  <code>include.cen=FALSE</code>.</p></dd>

  <dt id="arg-cen-col">cen.col<a class="anchor" aria-label="anchor" href="#arg-cen-col"></a></dt>
<dd><p>numeric scalar or character string that determines the color of the plotting character used to
  plot censored values.  The default value is <code>cen.col=4</code>.  See the entry for <code>col</code> in
  the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code> for more information.  This argument is ignored if
  <code>include.cen=FALSE</code>.</p></dd>

  <dt id="arg-type-main-xlab-ylab-xlim-ylim-">type, main, xlab, ylab, xlim, ylim, ...<a class="anchor" aria-label="anchor" href="#arg-type-main-xlab-ylab-xlim-ylim-"></a></dt>
<dd><p>additional graphical parameters (see <code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></code> and <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).  In particular,
  the argument <code>type</code> specifies the kind of line type.  By default, the function
  <code>ecdfPlotCensored</code> plots a step function (<code>type="s"</code>) when <code>discrete=TRUE</code>, and
  plots a straight line between points (<code>type="l"</code>) when <code>discrete=FALSE</code>.
  The user may override these defaults by supplying the graphics parameter <code>type</code>
  (<code>type="s"</code> for a step function, <code>type="l"</code> for linear interpolation,
  <code>type="p"</code> for points only, etc.).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>ecdfPlotCensored</code> does exactly the same thing as
  <code><a href="ecdfPlot.html">ecdfPlot</a></code>, except it calls the function <code><a href="ppointsCensored.html">ppointsCensored</a></code>
  to compute the plotting positions (estimated cumulative probabilities) for the
  uncensored observations.</p>
<p>If <code>plot.it=TRUE</code>, the estimated cumulative probabilities for the uncensored
  observations are plotted against the uncensored observations.  By default, the
  function <code>ecdfPlotCensored</code> plots a step function when <code>discrete=TRUE</code>,
  and plots a straight line between points when <code>discrete=FALSE</code>.  The user may
  override these defaults by supplying the graphics parameter
  type (<code>type="s"</code> for a step function, <code>type="l"</code> for linear interpolation,
  <code>type="p"</code> for points only, etc.).</p>
<p>If <code>include.cen=TRUE</code>, censored observations are included on the plot as points.  The arguments
  <code>cen.pch</code>, <code>cen.cex</code>, and <code>cen.col</code> control the appearance of these points.</p>
<p>In cases where <code>x</code> is a random sample, the emprical cdf will change from sample to sample and
  the variability in these estimates can be dramatic for small sample sizes.  Caution must be used in
  interpreting the empirical cdf when a large percentage of the observations are censored.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>ecdfPlotCensored</code> returns a list with the following components:</p>
<p></p>
<dl><dt>Order.Statistics</dt>
<dd><p>numeric vector of the “ordered” observations.</p></dd>

  <dt>Cumulative.Probabilities</dt>
<dd><p>numeric vector of the associated plotting positions.</p></dd>

  <dt>Censored</dt>
<dd><p>logical vector indicating which of the ordered observations are censored.</p></dd>

  <dt>Censoring.Side</dt>
<dd><p>character string indicating whether the data are left- or right-censored.
    This is same value as the argument <code>censoring.side</code>.</p></dd>

  <dt>Prob.Method</dt>
<dd><p>character string indicating what method was used to compute the plotting positions.
    This is the same value as the argument <code>prob.method</code>.</p></dd>


</dl><p>Optional Component (only present when <code>prob.method="michael-schucany"</code> or <br><code>prob.method="hirsch-stedinger"</code>):</p>
<dl><dt>Plot.Pos.Con</dt>
<dd><p>numeric scalar containing the value of the plotting position constant that was used.
    This is the same as the argument <code>plot.pos.con</code>.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Chambers, J.M., W.S. Cleveland, B. Kleiner, and P.A. Tukey. (1983).
  <em>Graphical Methods for Data Analysis</em>. Duxbury Press, Boston, MA, pp.11-16.</p>
<p>Cleveland, W.S. (1993). <em>Visualizing Data</em>. Hobart Press, Summit, New Jersey, 360pp.</p>
<p>D'Agostino, R.B. (1986a). Graphical Analysis.
  In: D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>.
  Marcel Dekker, New York, Chapter 2, pp.7-62.</p>
<p>Gillespie, B.W., Q. Chen, H. Reichert, A. Franzblau, E. Hedgeman, J. Lepkowski,
  P. Adriaens, A. Demond, W. Luksemburg, and D.H. Garabrant. (2010).  Estimating Population
  Distributions When Some Data Are Below a Limit of Detection by Using a Reverse
  Kaplan-Meier Estimator.  <em>Epidemiology</em> <b>21</b>(4), S64–S70.</p>
<p>Helsel, D.R. (2012). <em>Statistics for Censored Environmental Data Using Minitab and R,
  Second Edition</em>.  John Wiley &amp; Sons, Hoboken, New Jersey.</p>
<p>Helsel, D.R., and T.A. Cohn. (1988). Estimation of Descriptive Statistics for Multiply Censored
  Water Quality Data. <em>Water Resources Research</em> <b>24</b>(12), 1997-2004.</p>
<p>Hirsch, R.M., and J.R. Stedinger. (1987). Plotting Positions for Historical Floods and Their Precision.
  <em>Water Resources Research</em> <b>23</b>(4), 715-727.</p>
<p>Kaplan, E.L., and P. Meier. (1958). Nonparametric Estimation From Incomplete Observations.
  <em>Journal of the American Statistical Association</em> <b>53</b>, 457-481.</p>
<p>Lee, E.T., and J.W. Wang. (2003).
  <em>Statistical Methods for Survival Data Analysis, Third Edition</em>.
  John Wiley &amp; Sons, Hoboken, New Jersey, 513pp.</p>
<p>Michael, J.R., and W.R. Schucany. (1986). Analysis of Data from Censored Samples.
  In D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>.
  Marcel Dekker, New York, 560pp, Chapter 11, 461-496.</p>
<p>Nelson, W. (1972). Theory and Applications of Hazard Plotting for Censored Failure Data.
  <em>Technometrics</em> <b>14</b>, 945-966.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C. Chapter 15.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>An empirical cumulative distribution function (ecdf) plot is a graphical tool that can be used in
  conjunction with other graphical tools such as histograms, strip charts, and boxplots to assess the
  characteristics of a set of data.</p>
<p>Censored observations complicate the procedures used to graphically explore data.  Techniques from
  survival analysis and life testing have been developed to generalize the procedures for constructing
  plotting positions, empirical cdf plots, and q-q plots to data sets with censored observations
  (see <code><a href="ppointsCensored.html">ppointsCensored</a></code>).</p>
<p>Empirical cumulative distribution function (ecdf) plots are often plotted with theoretical cdf plots
  (see <code><a href="cdfPlot.html">cdfPlot</a></code> and <code><a href="cdfCompareCensored.html">cdfCompareCensored</a></code>) to graphically assess whether a
  sample of observations comes from a particular distribution.  More often, however, quantile-quantile
  (Q-Q) plots are used instead (see <code><a href="qqPlot.html">qqPlot</a></code> and <code><a href="qqPlotCensored.html">qqPlotCensored</a></code>).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></code>, <code><a href="ppointsCensored.html">ppointsCensored</a></code>, <code><a href="ecdfPlot.html">ecdfPlot</a></code>,
  <code><a href="qqPlot.html">qqPlot</a></code>,  <code><a href="qqPlotCensored.html">qqPlotCensored</a></code>,  <code><a href="cdfPlot.html">cdfPlot</a></code>,
  <code><a href="cdfCompareCensored.html">cdfCompareCensored</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a normal distribution with mean=20 and sd=5,</span></span></span>
<span class="r-in"><span>  <span class="co"># censor all observations less than 18, then generate an empirical cdf plot</span></span></span>
<span class="r-in"><span>  <span class="co"># for the complete data set and the censored data set.  Note that the empirical</span></span></span>
<span class="r-in"><span>  <span class="co"># cdf plot for the censored data set starts at the first ordered uncensored</span></span></span>
<span class="r-in"><span>  <span class="co"># observation, and that for values of x &gt; 18 the two emprical cdf plots are</span></span></span>
<span class="r-in"><span>  <span class="co"># exactly the same.  This is because there is only one censoring level and</span></span></span>
<span class="r-in"><span>  <span class="co"># no uncensored observations fall below the censored observations.</span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean<span class="op">=</span><span class="fl">20</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">censored</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">18</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censored</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-in"><span>  <span class="co">#[1] 7</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">new.x</span> <span class="op">&lt;-</span> <span class="va">x</span></span></span>
<span class="r-in"><span>  <span class="va">new.x</span><span class="op">[</span><span class="va">censored</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">18</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ecdfPlot.html">ecdfPlot</a></span><span class="op">(</span><span class="va">x</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Empirical CDF Plot for\nComplete Data Set"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">ecdfPlotCensored</span><span class="op">(</span><span class="va">new.x</span>, <span class="va">censored</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    main<span class="op">=</span><span class="st">"Empirical CDF Plot for\nCensored Data Set"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, <span class="va">new.x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example 15-1 of USEPA (2009, page 15-10) gives an example of</span></span></span>
<span class="r-in"><span>  <span class="co"># computing plotting positions based on censored manganese</span></span></span>
<span class="r-in"><span>  <span class="co"># concentrations (ppb) in groundwater collected at 5 monitoring</span></span></span>
<span class="r-in"><span>  <span class="co"># wells.  The data for this example are stored in</span></span></span>
<span class="r-in"><span>  <span class="co"># EPA.09.Ex.15.1.manganese.df.  Here we will create an empirical</span></span></span>
<span class="r-in"><span>  <span class="co"># CDF plot based on the Kaplan-Meier method.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.09.Ex.15.1.manganese.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample   Well Manganese.Orig.ppb Manganese.ppb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 Well.1                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       2 Well.1               12.1          12.1    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       3 Well.1               16.9          16.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       4 Well.1               21.6          21.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       5 Well.1                 &lt;2           2.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1 Well.2                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       2 Well.2                7.7           7.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       3 Well.2               53.6          53.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       4 Well.2                9.5           9.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      5 Well.2               45.9          45.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      1 Well.3                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      2 Well.3                5.3           5.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      3 Well.3               12.6          12.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      4 Well.3              106.3         106.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      5 Well.3               34.5          34.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      1 Well.4                6.3           6.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      2 Well.4               11.9          11.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      3 Well.4                 10          10.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      4 Well.4                 &lt;2           2.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      5 Well.4               77.2          77.2    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      1 Well.5               17.9          17.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      2 Well.5               22.7          22.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      3 Well.5                3.3           3.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      4 Well.5                8.4           8.4    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      5 Well.5                 &lt;2           2.0     TRUE</span>
<span class="r-in"><span>  <span class="co">#   Sample   Well Manganese.Orig.ppb Manganese.ppb Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#1       1 Well.1                 &lt;5           5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#2       2 Well.1               12.1          12.1    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#3       3 Well.1               16.9          16.9    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#4       4 Well.1               21.6          21.6    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#5       5 Well.1                 &lt;2           2.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#21      1 Well.5               17.9          17.9    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#22      2 Well.5               22.7          22.7    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#23      3 Well.5                3.3           3.3    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#24      4 Well.5                8.4           8.4    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#25      5 Well.5                 &lt;2           2.0     TRUE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.15.1.manganese.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">ecdfPlotCensored</span><span class="op">(</span><span class="va">Manganese.ppb</span>, <span class="va">Censored</span>,</span></span>
<span class="r-in"><span>      prob.method <span class="op">=</span> <span class="st">"kaplan-meier"</span>, ecdf.col <span class="op">=</span> <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>      main <span class="op">=</span> <span class="st">"Empirical CDF of Manganese Data\nBased on Kaplan-Meier"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

