<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Quantiles of a Gamma Distribution — eqgamma • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Quantiles of a Gamma Distribution — eqgamma"><meta property="og:description" content="Estimate quantiles of a gamma distribution, and 
  optionally construct a confidence interval for a quantile."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Quantiles of a Gamma Distribution</h1>
    
    <div class="hidden name"><code>eqgamma.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate quantiles of a <a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">gamma distribution</a>, and 
  optionally construct a confidence interval for a quantile.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">eqgamma</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">0.5</span>, method <span class="op">=</span> <span class="st">"mle"</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, 
    ci.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, 
    normal.approx.transform <span class="op">=</span> <span class="st">"kulkarni.powar"</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

  <span class="fu">eqgammaAlt</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">0.5</span>, method <span class="op">=</span> <span class="st">"mle"</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, 
    ci.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, 
    normal.approx.transform <span class="op">=</span> <span class="st">"kulkarni.powar"</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector of observations, or an object resulting from a call to an 
  estimating function that assumes a gamma distribution 
  (e.g., <code><a href="egamma.html">egamma</a></code> or <code><a href="egamma.html">egammaAlt</a></code>).  
  If <code>ci=TRUE</code> then <code>x</code> must be a 
  numeric vector of observations.  If <code>x</code> is a numeric vector, 
  missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) 
  values are allowed but will be removed.</p></dd>
<dt>p</dt>
<dd><p>numeric vector of probabilities for which quantiles will be estimated.  
  All values of <code>p</code> must be between 0 and 1.  When <code>ci=TRUE</code>, <code>p</code> 
  must be a scalar. The default value is <code>p=0.5</code>.</p></dd>
<dt>method</dt>
<dd><p>character string specifying the method to use to estimate the shape and scale 
  parameters of the distribution.  The possible values are 
  <code>"mle"</code> (maximum likelihood; the default), <code>"bcmle"</code> (bias-corrected mle), 
  <code>"mme"</code> (method of moments), and 
  <code>"mmue"</code> (method of moments based on the unbiased estimator of variance). 
  See the DETAILS section of the help file for <code><a href="egamma.html">egamma</a></code> for more information.</p></dd>
<dt>ci</dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for the quantile.  
  The default value is <code>ci=FALSE</code>.</p></dd>
<dt>ci.type</dt>
<dd><p>character string indicating what kind of confidence interval for the quantile to compute.  
  The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and 
  <code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>
<dt>conf.level</dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.  
  The default value is <code>conf.level=0.95</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>
<dt>normal.approx.transform</dt>
<dd><p>character string indicating which power transformation to use.  
  Possible values are <code>"kulkarni.powar"</code> (the default), <code>"cube.root"</code>, and <br><code>"fourth.root"</code>.  See the DETAILS section for more informaiton.  
  This argument is ignored if <code>ci=FALSE</code>.</p></dd>
<dt>digits</dt>
<dd><p>an integer indicating the number of decimal places to round to when printing out 
  the value of <code>100*p</code>. The default value is <code>digits=0</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>eqgamma</code> returns estimated quantiles as well as 
  estimates of the shape and scale parameters.  
  The function <code>eqgammaAlt</code> returns estimated quantiles as well as 
  estimates of the mean and coefficient of variation.</p>
<p>Quantiles are estimated by 1) estimating the shape and scale parameters by 
  calling <code><a href="egamma.html">egamma</a></code>, and then 2) calling the function 
  <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></code> and using the estimated values for shape 
  and scale.</p>
<p>The confidence interval for a quantile is computed by:</p><ol><li><p>using a power transformation on the original data to induce approximate 
      normality,</p></li>
<li><p>using <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">eqnorm</a></code> to compute the confidence interval, 
    and then</p></li>
<li><p>back-transforming the interval to create a confidence interval on the original 
    scale.</p></li>
</ol><p>This is similar to what is done to create tolerance intervals for a gamma distribuiton 
  (Krishnamoorthy et al., 2008), and there is a one-to-one relationship between confidence 
  intervals for a quantile and tolerance intervals (see the DETAILS section of the 
  help file for <code><a href="eqnorm.html">eqnorm</a></code>).  The value <code>normal.approx.transform="cube.root"</code> 
  uses the cube root transformation suggested by Wilson and Hilferty (1931) and used by 
  Krishnamoorthy et al. (2008) and Singh et al. (2010b), and the value 
  <code>normal.approx.transform="fourth.root"</code> uses the fourth root transformation suggested 
  by Hawkins and Wixley (1986) and used by Singh et al. (2010b).  
  The default value <code>normal.approx.transform="kulkarni.powar"</code> 
  uses the “Optimum Power Normal Approximation Method” of Kulkarni and Powar (2010).  
  The “optimum” power \(r\) is determined by:</p><table class="table table"><tr><td>\(r = -0.0705 - 0.178 \, shape + 0.475 \, \sqrt{shape}\)</td><td>if \(shape \le 1.5\)</td></tr><tr><td>\(r = 0.246\)</td><td>if \(shape &gt; 1.5\)</td></tr></table><p>where \(shape\) denotes the estimate of the shape parameter.  Although 
  Kulkarni and Powar (2010) use the maximum likelihood estimate of shape to 
  determine the power \(r\), for the functions <code>eqgamma</code> and 
  <code>eqgammaAlt</code> the power \(r\) is based on whatever estimate of 
  shape is used <br>
  (e.g., <code>method="mle"</code>, <code>method="bcmle"</code>, etc.).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>x</code> is a numeric vector, <code>eqgamma</code> and <code>eqgammaAlt</code> return a 
  list of class <code>"estimate"</code> containing the estimated quantile(s) and other 
  information. See <code><a href="estimate.object.html">estimate.object</a></code> for details.
  If <code>x</code> is the result of calling an estimation function, <code>eqgamma</code> and 
<code>eqgammaAlt</code> return a list whose class is the same as <code>x</code>.  The list 
  contains the same components as <code>x</code>, as well as components called 
<code>quantiles</code> and <code>quantile.method</code>.  In addition, if <code>ci=TRUE</code>, 
  the returned list contains a component called <code>interval</code> containing the 
  confidence interval information.  If <code>x</code> already has a component called 
<code>interval</code>, this component is replaced with the confidence interval information.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002). <em>Statistics for Environmental Engineers</em>. 
  Lewis Publishers, Boca Raton.</p>
<p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>. Second Edition. 
  John Wiley and Sons, New York.</p>
<p>Forbes, C., M. Evans, N. Hastings, and B. Peacock. (2011).  Statistical Distributions. 
  Fourth Edition. John Wiley and Sons, Hoboken, NJ.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009). 
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.  
  John Wiley &amp; Sons, Hoboken.</p>
<p>Hawkins, D. M., and R.A.J. Wixley. (1986). A Note on the Transformation of 
  Chi-Squared Variables to Normality. <em>The American Statistician</em>, <b>40</b>, 
  296--298.</p>
<p>Johnson, N.L., S. Kotz, and N. Balakrishnan. (1994). 
  <em>Continuous Univariate Distributions, Volume 1</em>. Second Edition. 
  John Wiley and Sons, New York, Chapter 17.</p>
<p>Krishnamoorthy K., T. Mathew, and S. Mukherjee. (2008). Normal-Based Methods for a 
  Gamma Distribution: Prediction and Tolerance Intervals and Stress-Strength Reliability. 
  <em>Technometrics</em>, <b>50</b>(1), 69--78.</p>
<p>Krishnamoorthy K., and T. Mathew. (2009). 
  <em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>. 
  John Wiley and Sons, Hoboken.</p>
<p>Kulkarni, H.V., and S.K. Powar. (2010). A New Method for Interval Estimation of the Mean 
  of the Gamma Distribution. <em>Lifetime Data Analysis</em>, <b>16</b>, 431--447.</p>
<p>Singh, A., A.K. Singh, and R.J. Iaci. (2002). 
  <em>Estimation of the Exposure Point Concentration Term Using a Gamma Distribution</em>.  
  EPA/600/R-02/084. October 2002. Technology Support Center for Monitoring and 
  Site Characterization, Office of Research and Development, Office of Solid Waste and 
  Emergency Response, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Singh, A., R. Maichle, and N. Armbya. (2010a). 
  <em>ProUCL Version 4.1.00 User Guide (Draft)</em>. EPA/600/R-07/041, May 2010. 
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Singh, A., N. Armbya, and A. Singh. (2010b). 
  <em>ProUCL Version 4.1.00 Technical Guide (Draft)</em>. EPA/600/R-07/041, May 2010.  
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Wilson, E.B., and M.M. Hilferty. (1931). The Distribution of Chi-Squares. 
  <em>Proceedings of the National Academy of Sciences</em>, <b>17</b>, 684--688.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.  
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The gamma distribution takes values on the positive real line. 
  Special cases of the gamma are the <a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">exponential</a> distribution and 
  the <a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">chi-square distributions</a>. Applications of the gamma include 
  life testing, statistical ecology, queuing theory, inventory control, and precipitation 
  processes. A gamma distribution starts to resemble a normal distribution as the 
  shape parameter a tends to infinity.</p>
<p>Some EPA guidance documents (e.g., Singh et al., 2002; Singh et al., 2010a,b) strongly 
  recommend against using a lognormal model for environmental data and recommend trying a 
  gamma distribuiton instead.</p>
<p>Percentiles are sometimes used in environmental standards and regulations.  For example, 
  Berthouex and Brown (2002, p.71) note that England has water quality limits based on 
  the 90th and 95th percentiles of monitoring data not exceeding specified levels.  They also 
  note that the U.S. EPA has specifications for air quality monitoring, aquatic standards on 
  toxic chemicals, and maximum daily limits for industrial effluents that are all based on 
  percentiles.  Given the importance of these quantities, it is essential to characterize 
  the amount of uncertainty associated with the estimates of these quantities.  
  This is done with confidence intervals.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="egamma.html">egamma</a></code>, <code><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">GammaDist</a></code>, 
  <code><a href="estimate.object.html">estimate.object</a></code>, <code><a href="eqnorm.html">eqnorm</a></code>, <code><a href="tolIntGamma.html">tolIntGamma</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># Generate 20 observations from a gamma distribution with parameters </span></span>
<span class="r-in">  <span class="co"># shape=3 and scale=2, then estimate the 90th percentile and create </span></span>
<span class="r-in">  <span class="co"># a one-sided upper 95% confidence interval for that percentile. </span></span>
<span class="r-in">  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this </span></span>
<span class="r-in">  <span class="co"># example.)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span>
<span class="r-in">  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">20</span>, shape <span class="op">=</span> <span class="fl">3</span>, scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span class="r-in">  <span class="fu">eqgamma</span><span class="op">(</span><span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Gamma"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    shape    scale </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.203862 2.174928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MLE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.113446 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Quantile(s) Based on\n                                 MLE Estimators"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "90'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.00000 13.79733 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact using\n                                 Kulkarni &amp; Powar (2010)\n                                 transformation to Normality\n                                 based on mle of 'shape'"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Gamma</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          shape = 2.203862</span></span>
<span class="r-in">  <span class="co">#                                 scale = 2.174928</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mle</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Quantile(s):           90'th %ile = 9.113446</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Quantile Estimation Method:      Quantile(s) Based on</span></span>
<span class="r-in">  <span class="co">#                                 mle Estimators</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval for:         90'th %ile</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Method:      Exact using</span></span>
<span class="r-in">  <span class="co">#                                 Kulkarni &amp; Powar (2010)</span></span>
<span class="r-in">  <span class="co">#                                 transformation to Normality</span></span>
<span class="r-in">  <span class="co">#                                 based on mle of 'shape'</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval:             LCL =  0.00000</span></span>
<span class="r-in">  <span class="co">#                                 UCL = 13.79733</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in">  <span class="co"># Compare these results with the true 90'th percentile:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">qgamma</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.9</span>, shape <span class="op">=</span> <span class="fl">3</span>, scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.64464</span>
<span class="r-in">  <span class="co">#[1] 10.64464</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Using the same data as in the previous example, use egammaAlt</span></span>
<span class="r-in">  <span class="co"># to estimate the mean and cv based on the bias-corrected </span></span>
<span class="r-in">  <span class="co"># estimate of shape, and use the cube-root transformation to </span></span>
<span class="r-in">  <span class="co"># normality.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">eqgammaAlt</span><span class="op">(</span><span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, method <span class="op">=</span> <span class="st">"bcmle"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span class="r-in">    ci.type <span class="op">=</span> <span class="st">"upper"</span>, normal.approx.transform <span class="op">=</span> <span class="st">"cube.root"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Gamma"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean        cv </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.7932408 0.7242165 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Bias-Corrected MLE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dat"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9.427999 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Quantile(s) Based on\n                                 Bias-Corrected MLE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "90'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.00000 12.89643 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact using\n                                 Wilson &amp; Hilferty (1931) cube-root\n                                 transformation to Normality"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Gamma</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          mean = 4.7932408</span></span>
<span class="r-in">  <span class="co">#                                 cv   = 0.7242165</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               bcmle of 'shape'</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Quantile(s):           90'th %ile = 9.428</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Quantile Estimation Method:      Quantile(s) Based on</span></span>
<span class="r-in">  <span class="co">#                                 bcmle of 'shape'</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            dat</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     20</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval for:         90'th %ile</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Method:      Exact using</span></span>
<span class="r-in">  <span class="co">#                                 Wilson &amp; Hilferty (1931) cube-root</span></span>
<span class="r-in">  <span class="co">#                                 transformation to Normality</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval:             LCL =  0.00000</span></span>
<span class="r-in">  <span class="co">#                                 UCL = 12.89643</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co">#--------------------------------------------------------------------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Example 17-3 of USEPA (2009, p. 17-17) shows how to construct a </span></span>
<span class="r-in">  <span class="co"># beta-content upper tolerance limit with 95% coverage and </span></span>
<span class="r-in">  <span class="co"># 95% confidence  using chrysene data and assuming a lognormal </span></span>
<span class="r-in">  <span class="co"># distribution.  Here we will use the same chrysene data but assume a </span></span>
<span class="r-in">  <span class="co"># gamma distribution.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># A beta-content upper tolerance limit with 95% coverage and </span></span>
<span class="r-in">  <span class="co"># 95% confidence is equivalent to the 95% upper confidence limit for </span></span>
<span class="r-in">  <span class="co"># the 95th percentile.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">EPA.09.Ex.17.3.chrysene.df</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">Chrysene</span> <span class="op">&lt;-</span> <span class="va">Chrysene.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span></span>
<span class="r-in">  <span class="fu">eqgamma</span><span class="op">(</span><span class="va">Chrysene</span>, p <span class="op">=</span> <span class="fl">0.95</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Gamma"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    shape    scale </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.806929 5.286026 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MLE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Chrysene"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   31.74348 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Quantile(s) Based on\n                                 MLE Estimators"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "95'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.00000 69.32425 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact using\n                                 Kulkarni &amp; Powar (2010)\n                                 transformation to Normality\n                                 based on mle of 'shape'"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimate"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimate"</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Results of Distribution Parameter Estimation</span></span>
<span class="r-in">  <span class="co">#--------------------------------------------</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Assumed Distribution:            Gamma</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Parameter(s):          shape = 2.806929</span></span>
<span class="r-in">  <span class="co">#                                 scale = 5.286026</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimation Method:               mle</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Estimated Quantile(s):           95'th %ile = 31.74348</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Quantile Estimation Method:      Quantile(s) Based on</span></span>
<span class="r-in">  <span class="co">#                                 mle Estimators</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Data:                            Chrysene</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Sample Size:                     8</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval for:         95'th %ile</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Method:      Exact using</span></span>
<span class="r-in">  <span class="co">#                                 Kulkarni &amp; Powar (2010)</span></span>
<span class="r-in">  <span class="co">#                                 transformation to Normality</span></span>
<span class="r-in">  <span class="co">#                                 based on mle of 'shape'</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval Type:        upper</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Level:                95%</span></span>
<span class="r-in">  <span class="co">#</span></span>
<span class="r-in">  <span class="co">#Confidence Interval:             LCL =  0.00000</span></span>
<span class="r-in">  <span class="co">#                                 UCL = 69.32425</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">Chrysene</span><span class="op">)</span></span>
<span class="r-in">  <span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="st">"EPA.09.Ex.17.3.chrysene.df"</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

