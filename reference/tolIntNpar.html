<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nonparametric Tolerance Interval for a Continuous Distribution — tolIntNpar • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Nonparametric Tolerance Interval for a Continuous Distribution — tolIntNpar"><meta property="og:description" content="Construct a \(\beta\)-content or \(\beta\)-expectation tolerance interval
  nonparametrically without making any assumptions about the form of the
  distribution except that it is continuous."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nonparametric Tolerance Interval for a Continuous Distribution</h1>

    <div class="hidden name"><code>tolIntNpar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Construct a \(\beta\)-content or \(\beta\)-expectation tolerance interval
  nonparametrically without making any assumptions about the form of the
  distribution except that it is continuous.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tolIntNpar</span><span class="op">(</span><span class="va">x</span>, <span class="va">coverage</span>, <span class="va">conf.level</span>, cov.type <span class="op">=</span> <span class="st">"content"</span>, </span>
<span>    ltl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ti.type</span> <span class="op">==</span> <span class="st">"upper"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    n.plus.one.minus.utl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ti.type</span> <span class="op">==</span> <span class="st">"lower"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    lb <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ub <span class="op">=</span> <span class="cn">Inf</span>, ti.type <span class="op">=</span> <span class="st">"two-sided"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of observations. Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-coverage">coverage<a class="anchor" aria-label="anchor" href="#arg-coverage"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the desired coverage of the \(\beta\)-content
  tolerance interval.
  The default value is <code>coverage=0.95</code>.  If <code>cov.type="content"</code>, you must
  supply a value for <code>coverage</code> or a value for <code>conf.level</code>, but not both.
  If <code>cov.type="expectation"</code>, this argument is ignored.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level associated with the \(\beta\)-content
  tolerance interval.  The default value is <code>conf.level=0.95</code>.  If <br><code>cov.type="content"</code>,
  you must supply a value for <code>coverage</code> or a value for <code>conf.level</code>, but not both.
  If <code>cov.type="expectation"</code>, this argument is ignored.</p></dd>

  <dt id="arg-cov-type">cov.type<a class="anchor" aria-label="anchor" href="#arg-cov-type"></a></dt>
<dd><p>character string specifying the coverage type for the tolerance interval.
  The possible values are <code>"content"</code> (\(\beta\)-content; the default), and
  <code>"expectation"</code> (\(\beta\)-expectation).  See the DETAILS section for more
  information.</p></dd>

  <dt id="arg-ltl-rank">ltl.rank<a class="anchor" aria-label="anchor" href="#arg-ltl-rank"></a></dt>
<dd><p>positive integer indicating the rank of the order statistic to use for the lower bound
  of the tolerance interval.  If <code>ti.type="two-sided"</code> or <code>ti.type="lower"</code>,
  the default value is <code>ltl.rank=1</code> (implying the minimum value of <code>x</code> is used
  as the lower bound of the tolerance interval).  If <code>ti.type="upper"</code>, this argument
  is set equal to <code>0</code> and the value of <code>lb</code> is used as the lower bound of the
  tolerance interval.</p></dd>

  <dt id="arg-n-plus-one-minus-utl-rank">n.plus.one.minus.utl.rank<a class="anchor" aria-label="anchor" href="#arg-n-plus-one-minus-utl-rank"></a></dt>
<dd><p>positive integer related to the rank of the order statistic to use for
  the upper bound of the toleracne interval.  A value of
  <code>n.plus.one.minus.utl.rank=1</code> (the default) means use the
  first largest value of <code>x</code>, and in general a value of
  <code>n.plus.one.minus.utl.rank=</code>\(i\) means use the \(i\)'th largest value.  If <br><code>ti.type="lower"</code>,
  this argument is set equal to <code>0</code> and the value of <code>ub</code> is used as the upper
  bound of the tolerance interval.</p></dd>

  <dt id="arg-lb-ub">lb, ub<a class="anchor" aria-label="anchor" href="#arg-lb-ub"></a></dt>
<dd><p>scalars indicating lower and upper bounds on the distribution.  By default, <code>lb=-Inf</code> and
  <code>ub=Inf</code>.  If you are constructing a tolerance interval for a distribution
  that you know has a lower bound other than <code>-Inf</code> (e.g., <code>0</code>), set <code>lb</code> to this
  value.  Similarly, if you know the distribution has an upper bound other than <code>Inf</code>, set
  <code>ub</code> to this value.  The argument <code>lb</code> is ignored if <code>ti.type="two-sided"</code> or
  <code>ti.type="lower"</code>.  The argument <code>ub</code> is ignored if <code>ti.type="two-sided"</code> or
  <code>ti.type="upper"</code>.</p></dd>

  <dt id="arg-ti-type">ti.type<a class="anchor" aria-label="anchor" href="#arg-ti-type"></a></dt>
<dd><p>character string indicating what kind of tolerance interval to compute.
  The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>A tolerance interval for some population is an interval on the real line constructed so as to
  contain \(100 \beta \%\) of the population (i.e., \(100 \beta \%\) of all
  future observations), where \(0 &lt; \beta &lt; 1\).  The quantity \(100 \beta \%\) is called
  the <em>coverage</em>.</p>
<p>There are two kinds of tolerance intervals (Guttman, 1970):</p><ul><li><p>A \(\beta\)-content tolerance interval with confidence level \(100(1-\alpha)\%\) is
    constructed so that it contains at least \(100 \beta \%\) of the population (i.e., the
    coverage is at least \(100 \beta \%\)) with probability \(100(1-\alpha)\%\), where
    \(0 &lt; \alpha &lt; 1\). The quantity \(100(1-\alpha)\%\) is called the confidence level or
    confidence coefficient associated with the tolerance interval.</p></li>
<li><p>A \(\beta\)-expectation tolerance interval is constructed so that the <em>average</em> coverage of
    the interval is \(100 \beta \%\).</p></li>
</ul><p><b>Note:</b> A \(\beta\)-expectation tolerance interval with coverage \(100 \beta \%\) is
  equivalent to a prediction interval for one future observation with associated confidence level
  \(100 \beta \%\).  Note that there is no explicit confidence level associated with a
  \(\beta\)-expectation tolerance interval.  If a \(\beta\)-expectation tolerance interval is
  treated as a \(\beta\)-content tolerance interval, the confidence level associated with this
  tolerance interval is usually around 50% (e.g., Guttman, 1970, Table 4.2, p.76).
  <br></p>
<p><b>The Form of a Nonparametric Tolerance Interval</b> <br>
  Let \(\underline{x}\) denote a random sample of \(n\) independent observations
  from some continuous distribution and let \(x_{(i)}\) denote the \(i\)'th order
  statistic in \(\underline{x}\).  A two-sided nonparametric tolerance interval is
  constructed as:
  $$[x_{(u)}, x_{(v)}] \;\;\;\;\;\; (1)$$
  where \(u\) and \(v\) are positive integers between \(1\) and \(n\), and
  \(u &lt; v\).  That is, \(u\) denotes the rank of the lower tolerance limit, and
  \(v\) denotes the rank of the upper tolerance limit.  To make it easier to write
  some equations later on, we can also write the tolerance interval (1) in a slightly
  different way as:
  $$[x_{(u)}, x_{(n+1-w)}] \;\;\;\;\;\; (2)$$
  where
  $$w = n + 1 - v \;\;\;\;\;\; (3)$$
  so that \(w\) is a positive integer between \(1\) and \(n-1\), and \(u &lt; n+1-w\).
  In terms of the arguments to the function <code>tolIntNpar</code>, the argument
  <code>ltl.rank</code> corresponds to \(u\), and the argument <code>n.plus.one.minus.utl.rank</code>
  corresponds to \(w\).</p>
<p>If we allow \(u=0\) and \(w=0\) and define lower and upper bounds as:
  $$x_{(0)} = lb \;\;\;\;\;\; (4)$$
  $$x_{(n+1)} = ub \;\;\;\;\;\; (5)$$
  then equation (2) above can also represent a one-sided lower or one-sided upper
  tolerance interval as well.  That is, a one-sided lower nonparametric tolerance interval
  is constructed as:
  $$[x_{(u)}, x_{(n+1)}] = [x_{(u)}, ub] \;\;\;\;\;\; (6)$$
  and a one-sided upper nonparametric tolerance interval is constructed as:
  $$[x_{(0)}, x_{(v)}] = [lb, x_{(v)}] \;\;\;\;\;\; (7)$$
  Usually, \(lb = -\infty\) or \(lb = 0\) and \(ub = \infty\).</p>
<p>Let \(C\) be a random variable denoting the coverage of the above nonparametric
  tolerance intervals.  Wilks (1941) showed that the distribution of \(C\) follows a
  <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta distribution</a> with parameters <code>shape1=</code>\(v-u\) and
  <code>shape2=</code>\(w+u\) when the unknown distribution is continuous.
  <br></p>
<p><b>Computations for a \(\beta\)-Content Tolerance Interval</b> <br>
  For a \(\beta\)-content tolerance interval, if the coverage \(C = \beta\) is specified,
  then the associated confidence level \((1-\alpha)100\%\) is computed as:
  $$1 - \alpha = 1 - F(\beta, v-u, w+u) \;\;\;\;\;\; (8)$$
  where \(F(y, \delta, \gamma)\) denotes the cumulative distribution function of a
  <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta random variable</a> with parameters <code>shape1=</code>\(\delta\) and
  <code>shape2=</code>\(\gamma\) evaluated at \(y\).</p>
<p>Similarly, if the confidence level associated with the tolerance interval is specified as
  \((1-\alpha)100\%\), then the coverage \(C = \beta\) is computed as:
  $$\beta = B(\alpha, v-u, w+u) \;\;\;\;\;\; (9)$$
  where \(B(p, \delta, \gamma)\) denotes the \(p\)'th quantile of a
  <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta distribution</a> with parameters <code>shape1=</code>\(\delta\)
  and <code>shape2=</code>\(\gamma\).
  <br></p>
<p><b>Computations for a \(\beta\)-Expectation Tolerance Interval</b> <br>
  For a \(\beta\)-expectation tolerance interval, the expected coverage is simply
  the mean of a <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta random variable</a> with parameters
  <code>shape1=</code>\(v-u\) and <code>shape2=</code>\(w+u\), which is given by:
  $$E(C) = \frac{v-u}{n+1} \;\;\;\;\;\; (10)$$
  As stated above, a \(\beta\)-expectation tolerance interval with coverage
  \(\beta 100\%\) is equivalent to a prediction interval for one future observation
  with associated confidence level \(\beta 100\%\).  This is because the probability
  that any single future observation will fall into this interval is \(\beta 100\%\),
  so the distribution of the number of \(N\) future observations that will fall into
  this interval is <a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">binomial</a> with parameters <code>size=</code>\(N\)
  and <code>prob=</code>\(\beta\).  Hence the expected proportion of future observations
  that fall into this interval is \(\beta 100\%\) and is independent of the value of \(N\).
  See the help file for <code><a href="predIntNpar.html">predIntNpar</a></code> for more information on constructing
  a nonparametric prediction interval.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>"estimate"</code> containing the estimated parameters,
  the tolerance interval, and other information.  See <code><a href="estimate.object.html">estimate.object</a></code>
  for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>. Second Edition.
  John Wiley and Sons, New York.</p>
<p>Danziger, L., and S. Davis. (1964).  Tables of Distribution-Free Tolerance Limits.
  <em>Annals of Mathematical Statistics</em> <b>35</b>(5), 1361–1365.</p>
<p>Davis, C.B. (1994).  Environmental Regulatory Statistics. In Patil, G.P., and C.R. Rao, eds.,
  <em>Handbook of Statistics, Vol. 12: Environmental Statistics</em>.
  North-Holland, Amsterdam, a division of Elsevier, New York, NY, Chapter 26, 817–865.</p>
<p>Davis, C.B., and R.J. McNichols. (1994a).  Ground Water Monitoring Statistics Update: Part I:
  Progress Since 1988.  <em>Ground Water Monitoring and Remediation</em> <b>14</b>(4), 148–158.</p>
<p>Gibbons, R.D. (1991b).  Statistical Tolerance Limits for Ground-Water Monitoring.
  <em>Ground Water</em> <b>29</b>, 563–570.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
  John Wiley &amp; Sons, Hoboken.</p>
<p>Guttman, I. (1970).  <em>Statistical Tolerance Regions: Classical and Bayesian</em>.
  Hafner Publishing Co., Darien, CT, Chapter 2.</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991).  <em>Statistical Intervals: A Guide for Practitioners</em>.
  John Wiley and Sons, New York, 392pp.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, pp.88-90.</p>
<p>Krishnamoorthy K., and T. Mathew. (2009).
  <em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>.
  John Wiley and Sons, Hoboken.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Wilks, S.S. (1941).  Determination of Sample Sizes for Setting Tolerance Limits.
  <em>Annals of Mathematical Statistics</em> <b>12</b>, 91–96.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Tolerance intervals have long been applied to quality control and
  life testing problems (Hahn, 1970b,c; Hahn and Meeker, 1991; Krishnamoorthy and Mathew, 2009).
  References that discuss tolerance intervals in the context of environmental monitoring include:
  Berthouex and Brown (2002, Chapter 21), Gibbons et al. (2009),
  Millard and Neerchal (2001, Chapter 6), Singh et al. (2010b), and USEPA (2009).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="eqnpar.html">eqnpar</a></code>, <code><a href="estimate.object.html">estimate.object</a></code>,
  <code><a href="tolIntNparN.html">tolIntNparN</a></code>, <a href="FcnsByCatTolInts.html">Tolerance Intervals</a>,
  <a href="FcnsByCatEstDistParams.html">Estimating Distribution Parameters</a>, <a href="FcnsByCatEstDistQuants.html">Estimating Distribution Quantiles</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a lognormal mixture distribution</span></span></span>
<span class="r-in"><span>  <span class="co"># with parameters mean1=1, cv1=0.5, mean2=5, cv2=1, and p.mix=0.1.  </span></span></span>
<span class="r-in"><span>  <span class="co"># The exact two-sided interval that contains 90% of this distribution is given by: </span></span></span>
<span class="r-in"><span>  <span class="co"># [0.682312, 13.32052].  Use tolIntNpar to construct a two-sided 90% </span></span></span>
<span class="r-in"><span>  <span class="co"># \eqn{\beta}-content tolerance interval.  Note that the associated confidence level </span></span></span>
<span class="r-in"><span>  <span class="co"># is only 61%.  A larger sample size is required to obtain a larger confidence </span></span></span>
<span class="r-in"><span>  <span class="co"># level (see the help file for tolIntNparN). </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">23</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalMixAlt.html">rlnormMixAlt</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu">tolIntNpar</span><span class="op">(</span><span class="va">dat</span>, coverage <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            dat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Coverage:     90%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coverage Type:                   content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Method:       Exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Type:         two-sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                60.8253%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Limit Rank(s):         1 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval:              LTL = 0.5035035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UTL = 9.9504662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Coverage:     90%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Coverage Type:                   content</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Method:       Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Type:         two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                60.8253%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Limit Rank(s):         1 20 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval:              LTL = 0.5035035</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UTL = 9.9504662</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Reproduce Example 17-4 on page 17-21 of USEPA (2009).  This example uses </span></span></span>
<span class="r-in"><span>  <span class="co"># copper concentrations (ppb) from 3 background wells to set an upper </span></span></span>
<span class="r-in"><span>  <span class="co"># limit for 2 compliance wells.  The maximum value from the 3 wells is set </span></span></span>
<span class="r-in"><span>  <span class="co"># to the 95% confidence upper tolerance limit, and we need to determine the </span></span></span>
<span class="r-in"><span>  <span class="co"># coverage of this tolerance interval.  The data are stored in EPA.92c.copper2.df.  </span></span></span>
<span class="r-in"><span>  <span class="co"># Note that even though these data are Type I left singly censored, it is still </span></span></span>
<span class="r-in"><span>  <span class="co"># possible to compute an upper tolerance interval using any of the uncensored </span></span></span>
<span class="r-in"><span>  <span class="co"># observations as the upper limit. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.92c.copper2.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Copper.orig Copper Censored Month Well  Well.type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           &lt;5    5.0     TRUE     1    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           &lt;5    5.0     TRUE     2    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          7.5    7.5    FALSE     3    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           &lt;5    5.0     TRUE     4    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           &lt;5    5.0     TRUE     5    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           &lt;5    5.0     TRUE     6    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          6.4    6.4    FALSE     7    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            6    6.0    FALSE     8    1 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          9.2    9.2    FALSE     1    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          &lt;5    5.0     TRUE     2    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11          &lt;5    5.0     TRUE     3    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         6.1    6.1    FALSE     4    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           8    8.0    FALSE     5    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         5.9    5.9    FALSE     6    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15          &lt;5    5.0     TRUE     7    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16          &lt;5    5.0     TRUE     8    2 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17          &lt;5    5.0     TRUE     1    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         5.4    5.4    FALSE     2    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         6.7    6.7    FALSE     3    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20          &lt;5    5.0     TRUE     4    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21          &lt;5    5.0     TRUE     5    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22          &lt;5    5.0     TRUE     6    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23          &lt;5    5.0     TRUE     7    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24          &lt;5    5.0     TRUE     8    3 Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25                 NA    FALSE     1    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26                 NA    FALSE     2    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                 NA    FALSE     3    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28                 NA    FALSE     4    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         6.2    6.2    FALSE     5    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30          &lt;5    5.0     TRUE     6    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         7.8    7.8    FALSE     7    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32        10.4   10.4    FALSE     8    4 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33                 NA    FALSE     1    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                 NA    FALSE     2    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35                 NA    FALSE     3    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36                 NA    FALSE     4    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37          &lt;5    5.0     TRUE     5    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38          &lt;5    5.0     TRUE     6    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         5.6    5.6    FALSE     7    5 Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40          &lt;5    5.0     TRUE     8    5 Compliance</span>
<span class="r-in"><span>  <span class="co">#   Copper.orig Copper Censored Month Well  Well.type</span></span></span>
<span class="r-in"><span>  <span class="co">#1           &lt;5    5.0     TRUE     1    1 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#2           &lt;5    5.0     TRUE     2    1 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#3          7.5    7.5    FALSE     3    1 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#9          9.2    9.2    FALSE     1    2 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#10          &lt;5    5.0     TRUE     2    2 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#11          &lt;5    5.0     TRUE     3    2 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#17          &lt;5    5.0     TRUE     1    3 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#18         5.4    5.4    FALSE     2    3 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#19         6.7    6.7    FALSE     3    3 Background</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#29         6.2    6.2    FALSE     5    4 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#30          &lt;5    5.0     TRUE     6    4 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#31         7.8    7.8    FALSE     7    4 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#38          &lt;5    5.0     TRUE     6    5 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#39         5.6    5.6    FALSE     7    5 Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#40          &lt;5    5.0     TRUE     8    5 Compliance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.92c.copper2.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu">tolIntNpar</span><span class="op">(</span><span class="va">Copper</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Background"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>      conf.level <span class="op">=</span> <span class="fl">0.95</span>, lb <span class="op">=</span> <span class="fl">0</span>, ti.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            Copper[Well.type == "Background"]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Coverage:     88.26538%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coverage Type:                   content</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Method:       Exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Type:         upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                95%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Limit Rank(s):         24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval:              LTL = 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UTL = 9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Copper[Well.type == "Background"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Coverage:     88.26538%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Coverage Type:                   content</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Method:       Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Type:         upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Limit Rank(s):         24 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval:              LTL = 0.0</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UTL = 9.2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the last example, except compute an upper </span></span></span>
<span class="r-in"><span>  <span class="co"># \eqn{\beta}-expectation tolerance interval:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.92c.copper2.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu">tolIntNpar</span><span class="op">(</span><span class="va">Copper</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Background"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>      cov.type <span class="op">=</span> <span class="st">"expectation"</span>, lb <span class="op">=</span> <span class="fl">0</span>, ti.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            Copper[Well.type == "Background"]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Coverage:     96%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coverage Type:                   expectation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Method:       Exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval Type:         upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Limit Rank(s):         24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tolerance Interval:              LTL = 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UTL = 9.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Copper[Well.type == "Background"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     24</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Coverage:     96%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Coverage Type:                   expectation</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Method:       Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval Type:         upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Limit Rank(s):         24 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Tolerance Interval:              LTL = 0.0</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UTL = 9.2</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

