<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Half-Width of Confidence Interval for Binomial Proportion or Difference Between Two Proportions — ciBinomHalfWidth • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Half-Width of Confidence Interval for Binomial Proportion or Difference Between Two Proportions — ciBinomHalfWidth"><meta property="og:description" content="Compute the half-width of a confidence interval for a binomial proportion or the difference between
  two proportions, given the sample size(s), estimated proportion(s), and confidence level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Half-Width of Confidence Interval for Binomial Proportion or Difference Between Two Proportions</h1>

    <div class="hidden name"><code>ciBinomHalfWidth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the half-width of a confidence interval for a binomial proportion or the difference between
  two proportions, given the sample size(s), estimated proportion(s), and confidence level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ciBinomHalfWidth</span><span class="op">(</span><span class="va">n.or.n1</span>, p.hat.or.p1.hat <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    n2 <span class="op">=</span> <span class="va">n.or.n1</span>, p2.hat <span class="op">=</span> <span class="fl">0.4</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    sample.type <span class="op">=</span> <span class="st">"one.sample"</span>, ci.method <span class="op">=</span> <span class="st">"score"</span>, </span>
<span>    correct <span class="op">=</span> <span class="cn">TRUE</span>, warn <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n-or-n-">n.or.n1<a class="anchor" aria-label="anchor" href="#arg-n-or-n-"></a></dt>
<dd><p>numeric vector of sample sizes.  <br>
  When <code>sample.type="one.sample"</code>, <code>n.or.n1</code> denotes \(n\),
  the number of observations in the single sample. <br>
  When <code>sample.type="two.sample"</code>, <code>n.or.n1</code> denotes \(n_1\),
  the number of observations from group 1. <br>
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-p-hat-or-p-hat">p.hat.or.p1.hat<a class="anchor" aria-label="anchor" href="#arg-p-hat-or-p-hat"></a></dt>
<dd><p>numeric vector of estimated proportions.  <br>
  When <code>sample.type="one.sample"</code>, <code>p.hat.or.p1.hat</code> denotes the
  estimated value of \(p\), the probability of “success”. <br>
  When <code>sample.type="two.sample"</code>, <code>p.hat.or.p1.hat</code> denotes the
  estimated value of \(p_1\), the probability of “success” in
  group 1.  <br>
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite
  (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>numeric vector of sample sizes for group 2.  The default value is the value of <code>n.or.n1</code>.
  This argument is ignored when <code>sample.type="one.sample"</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-p-hat">p2.hat<a class="anchor" aria-label="anchor" href="#arg-p-hat"></a></dt>
<dd><p>numeric vector of estimated proportions for group 2.
  This argument is ignored when <code>sample.type="one.sample"</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>numeric vector of numbers between 0 and 1 indicating the confidence level associated with
  the confidence interval(s).  The default value is <code>conf.level=0.95</code>.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string indicating whether this is a one-sample or two-sample confidence interval.
  When <code>sample.type="one.sample"</code>, the computed half-width is based on a confidence interval
  for a single proportion.  When <br><code>sample.type="two.sample"</code>, the computed half-width is based
  on a confidence interval for the difference between two proportions.
  The default value is <code>sample.type="one.sample"</code> unless the
  argument <code>n2</code> or <code>p2.hat</code> is supplied.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating which method to use to construct the confidence interval.
  Possible values are <code>"score"</code> (the default), <code>"exact"</code>, <br><code>"adjusted Wald"</code>, and <code>"Wald"</code> (the <code>"Wald"</code> method is
  <strong>never</strong> recommended but is included for historical purposes).
  The exact method is only available for the one-sample case, i.e.,
  when <code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-correct">correct<a class="anchor" aria-label="anchor" href="#arg-correct"></a></dt>
<dd><p>logical scalar indicating whether to use the continuity correction when <br><code>ci.method="score"</code> or <code>ci.method="Wald"</code>.  <br>
  The default value is <code>correct=TRUE</code>.</p></dd>

  <dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical scalar indicating whether to issue a warning when <br><code>ci.method="Wald"</code> for cases when the normal approximation to
  the binomial distribution probably is not accurate.
  The default value is <code>warn=TRUE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If the arguments <code>n.or.n1</code>, <code>p.hat.or.p1.hat</code>, <code>n2</code>, <code>p2.hat</code>, and
  <code>conf.level</code> are not all the same length, they are replicated to be the same length as
  the length of the longest argument.</p>
<p>The values of <code>p.hat.or.p1.hat</code> and <code>p2.hat</code> are automatically adjusted
  to the closest legitimate values, given the user-supplied values of <code>n.or.n1</code> and
  <code>n2</code>.  For example, if <code>n.or.n1=5</code>, legitimate values for
  <code>p.hat.or.p1.hat</code> are 0, 0.2, 0.4, 0.6, 0.8 and 1.  In this case, if the
  user supplies <code>p.hat.or.p1.hat=0.45</code>, then <code>p.hat.or.p1.hat</code> is reset to <br><code>p.hat.or.p1.hat=0.4</code>, and if the user supplies <code>p.hat.or.p1.hat=0.55</code>, <br>
  then <code>p.hat.or.p1.hat</code> is reset to <code>p.hat.or.p1.hat=0.6</code>.  In cases where
  the two closest legitimate values are equal distance from the user-suppled value of
  <code>p.hat.or.p1.hat</code> or <code>p2.hat</code>, the value closest to 0.5 is chosen since
  that will tend to yield the wider confidence interval.</p>

<p><strong>One-Sample Case (<code>sample.type="one.sample"</code>)</strong>.</p><dl><dt><code>ci.method="score"</code></dt>
<dd><p>The confidence interval for \(p\) based on the
  score method was developed by Wilson (1927) and is discussed by Newcombe (1998a),
  Agresti and Coull (1998), and Agresti and Caffo (2000).  When <code>ci=TRUE</code> and
  <code>ci.method="score"</code>, the function <code><a href="ebinom.html">ebinom</a></code> calls the <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code> to compute the confidence interval.  This method
  has been shown to provide the best performance (in terms of actual coverage matching
  assumed coverage) of all the methods provided here, although unlike the exact
  method, the actual coverage can fall below the assumed coverage.</p></dd>


  <dt><code>ci.method="exact"</code></dt>
<dd><p>The confidence interval for \(p\) based on the
  exact (Clopper-Pearson) method is discussed by Newcombe (1998a), Agresti and Coull (1998),
  and Zar (2010, pp.543-547).  This is the method used in the <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>.  This method ensures the actual coverage is greater than
  or equal to the assumed coverage.</p></dd>


  <dt><code>ci.method="Wald"</code></dt>
<dd><p>The confidence interval for \(p\) based on the
  Wald method (with or without a correction for continuity) is the usual
  “normal approximation” method and is discussed by Newcombe (1998a),
  Agresti and Coull (1998), Agresti and Caffo (2000), and Zar (2010, pp.543-547).
  This method is <strong>never</strong> recommended but is included for historical purposes.</p></dd>


  <dt><code>ci.method="adjusted Wald"</code></dt>
<dd><p>The confidence interval for \(p\) based on the
  adjusted Wald method is discussed by Agresti and Coull (1998), Agresti and Caffo (2000), and
  Zar (2010, pp.543-547).  This is a simple modification of the Wald method and
  performs surpringly well.</p></dd>


</dl><p><strong>Two-Sample Case (<code>sample.type="two.sample"</code>)</strong>.</p>
<p></p><dl><dt><code>ci.method="score"</code></dt>
<dd><p>This method is presented in Newcombe (1998b) and
  is based on the score method developed by Wilson (1927) for the one-sample case.
  This is the method used by the R function <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>.  In a comparison of
  11 methods, Newcombe (1998b) showed this method performs remarkably well.</p></dd>


  <dt><code>ci.method="Wald"</code></dt>
<dd><p>The confidence interval for the difference between two
  proportions based on the Wald method (with or without a correction for continuity) is
  the usual “normal approximation” method and is discussed by Newcombe (1998b),
  Agresti and Caffo (2000), and Zar (2010, pp.549-552).  This method is <strong>not</strong>
  recommended but is included for historical purposes.</p></dd>


  <dt><code>ci.method="adjusted Wald"</code></dt>
<dd><p>This method is discussed by Agresti and Caffo (2000),
  and Zar (2010, pp.549-552).  This is a simple modification of the Wald method and
  performs surpringly well.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a list with information about the half-widths, sample sizes, and
  estimated proportions.</p>
<p><strong>One-Sample Case (<code>sample.type="one.sample"</code>)</strong>. <br>
  When <code>sample.type="one.sample"</code>, the function <code>ciBinomHalfWidth</code>
  returns a list with these components:</p>
<p></p>
<dl><dt>half.width</dt>
<dd><p>the half-width(s) of the confidence interval(s)</p></dd>

  <dt>n</dt>
<dd><p>the sample size(s) associated with the confidence interval(s)</p></dd>

  <dt>p.hat</dt>
<dd><p>the estimated proportion(s)</p></dd>

  <dt>method</dt>
<dd><p>the method used to construct the confidence interval(s)</p></dd>



  </dl><p><strong>Two-Sample Case (<code>sample.type="two.sample"</code>)</strong>.  <br>
  When <code>sample.type="two.sample"</code>, the function <code>ciBinomHalfWidth</code>
  returns a list with these components:</p>
<p></p>
<dl><dt>half.width</dt>
<dd><p>the half-width(s) of the confidence interval(s)</p></dd>

  <dt>n1</dt>
<dd><p>the sample size(s) for group 1 associated with the confidence interval(s)</p></dd>

  <dt>p1.hat</dt>
<dd><p>the estimated proportion(s) for group 1</p></dd>

  <dt>n2</dt>
<dd><p>the sample size(s) for group 2 associated with the confidence interval(s)</p></dd>

  <dt>p2.hat</dt>
<dd><p>the estimated proportion(s) for group 2</p></dd>

  <dt>method</dt>
<dd><p>the method used to construct the confidence interval(s)</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Agresti, A., and B.A. Coull. (1998). Approximate is Better than "Exact" for Interval Estimation
  of Binomial Proportions. <em>The American Statistician</em>, <b>52</b>(2), 119–126.</p>
<p>Agresti, A., and B. Caffo. (2000). Simple and Effective Confidence Intervals for Proportions
  and Differences of Proportions Result from Adding Two Successes and Two Failures. <em>The
  American Statistician</em>, <b>54</b>(4), 280–288.</p>
<p>Berthouex, P.M., and L.C. Brown. (1994). <em>Statistics for Environmental Engineers</em>.
  Lewis Publishers, Boca Raton, FL, Chapters 2 and 15.</p>
<p>Cochran, W.G. (1977). <em>Sampling Techniques</em>. John Wiley and Sons, New York, Chapter 3.</p>
<p>Fisher, R.A., and F. Yates. (1963).
  <em>Statistical Tables for Biological, Agricultural, and Medical Research</em>. 6th edition.
  Hafner, New York, 146pp.</p>
<p>Fleiss, J. L. (1981). <em>Statistical Methods for Rates and Proportions</em>. Second Edition.
  John Wiley and Sons, New York, Chapters 1-2.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY, Chapter 11.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, Florida.</p>
<p>Newcombe, R.G. (1998a). Two-Sided Confidence Intervals for the Single Proportion:  Comparison of
  Seven Methods. <em>Statistics in Medicine</em>, <b>17</b>, 857–872.</p>
<p>Newcombe, R.G. (1998b). Interval Estimation for the Difference Between Independent Proportions:
  Comparison of Eleven Methods. <em>Statistics in Medicine</em>, <b>17</b>, 873–890.</p>
<p>Ott, W.R. (1995). <em>Environmental Statistics and Data Analysis</em>.
  Lewis Publishers, Boca Raton, FL, Chapter 4.</p>
<p>USEPA. (1989b). <em>Statistical Analysis of Ground-Water Monitoring Data at RCRA Facilities, Interim Final Guidance</em>.
  EPA/530-SW-89-026. Office of Solid Waste, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C. p.6-38.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ, Chapter 24.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The binomial distribution is used to model processes with binary
  (Yes-No, Success-Failure, Heads-Tails, etc.) outcomes.  It is assumed that the outcome of any
  one trial is independent of any other trial, and that the probability of “success”, \(p\),
  is the same on each trial.  A binomial discrete random variable \(X\) is the number of
  “successes” in \(n\) independent trials.  A special case of the binomial distribution
  occurs when \(n=1\), in which case \(X\) is also called a Bernoulli random variable.</p>
<p>In the context of environmental statistics, the binomial distribution is sometimes used to model
  the proportion of times a chemical concentration exceeds a set standard in a given period of time
  (e.g., Gilbert, 1987, p.143), or to compare the proportion of detects in a compliance well vs. a
  background well (e.g., USEPA, 1989b, Chapter 8, p.3-7).  (However, USEPA 2009, p.8-27
  recommends using the Wilcoxon rank sum test (<code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code>) instead of
  comparing proportions.)</p>
<p>In the course of designing a sampling program, an environmental scientist may wish to determine
  the relationship between sample size, confidence level, and half-width if one of the objectives of
  the sampling program is to produce confidence intervals.  The functions <code>ciBinomHalfWidth</code>,
  <code><a href="ciBinomN.html">ciBinomN</a></code>, and <code><a href="plotCiBinomDesign.html">plotCiBinomDesign</a></code> can be used to investigate these
  relationships for the case of binomial proportions.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ciBinomN.html">ciBinomN</a></code>, <code><a href="plotCiBinomDesign.html">plotCiBinomDesign</a></code>,
  <code><a href="ebinom.html">ebinom</a></code>, <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>, <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at how the half-width of a one-sample confidence interval </span></span></span>
<span class="r-in"><span>  <span class="co"># decreases with sample size:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.26340691 0.13355486 0.09616847 0.04365873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  10  50 100 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.5 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$half.width</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.26340691 0.13355486 0.09616847 0.04365873</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$n</span></span></span>
<span class="r-in"><span>  <span class="co">#[1]  10  50 100 500</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$p.hat</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.5 0.5 0.5 0.5</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$method</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the half-width of a one-sample confidence interval </span></span></span>
<span class="r-in"><span>  <span class="co"># tends to decrease as the estimated value of p decreases below </span></span></span>
<span class="r-in"><span>  <span class="co"># 0.5 or increases above 0.5:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8</span>
<span class="r-in"><span>  <span class="co">#[1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">30</span>, p.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1536299 0.1707256 0.1801322 0.1684587 0.1801322 0.1707256 0.1536299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30 30 30 30 30 30 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$half.width</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.1536299 0.1707256 0.1801322 0.1684587 0.1801322 0.1707256 </span></span></span>
<span class="r-in"><span>  <span class="co">#[7] 0.1536299</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$n</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 30 30 30 30 30 30 30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$p.hat</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.2 0.3 0.4 0.5 0.6 0.7 0.8</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$method</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the half-width of a one-sample confidence interval </span></span></span>
<span class="r-in"><span>  <span class="co"># increases with increasing confidence level:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">20</span>, conf.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1377380 0.1725962 0.2007020 0.2495523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20 20 20 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.5 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$half.width</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.1377380 0.1725962 0.2007020 0.2495523</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$n</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 20 20 20 20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$p.hat</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.5 0.5 0.5 0.5</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$method</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare the half-widths for a one-sample </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence interval based on the different methods:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">30</span>, ci.method <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span><span class="op">$</span><span class="va">half.width</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1684587</span>
<span class="r-in"><span>  <span class="co">#[1] 0.1684587</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">30</span>, ci.method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span><span class="op">$</span><span class="va">half.width</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1870297</span>
<span class="r-in"><span>  <span class="co">#[1] 0.1870297</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">30</span>, ci.method <span class="op">=</span> <span class="st">"adjusted Wald"</span><span class="op">)</span><span class="op">$</span><span class="va">half.width</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1684587</span>
<span class="r-in"><span>  <span class="co">#[1] 0.1684587</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fl">30</span>, ci.method <span class="op">=</span> <span class="st">"Wald"</span><span class="op">)</span><span class="op">$</span><span class="va">half.width</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1955861</span>
<span class="r-in"><span>  <span class="co">#[1] 0.1955861</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at how the half-width of a two-sample </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence interval decreases with increasing </span></span></span>
<span class="r-in"><span>  <span class="co"># sample sizes:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciBinomHalfWidth</span><span class="op">(</span>n.or.n1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">500</span><span class="op">)</span>, sample.type <span class="op">=</span> <span class="st">"two"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $half.width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.53385652 0.21402654 0.14719748 0.06335658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  10  50 100 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p1.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.5 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  10  50 100 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p2.hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4 0.4 0.4 0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Score normal approximation, with continuity correction"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$half.width</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.53385652 0.21402654 0.14719748 0.06335658</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$n1</span></span></span>
<span class="r-in"><span>  <span class="co">#[1]  10  50 100 500</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$p1.hat</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.5 0.5 0.5 0.5</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$n2</span></span></span>
<span class="r-in"><span>  <span class="co">#[1]  10  50 100 500</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$p2.hat</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.4 0.4 0.4 0.4</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$method</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] "Score normal approximation, with continuity correction"</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

