<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Probability That at Least One Set of Future Observations Violates the Given Rule Based on a Simultaneous Prediction Interval for a Normal Distribution — predIntNormSimultaneousTestPower • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Probability That at Least One Set of Future Observations Violates the Given Rule Based on a Simultaneous Prediction Interval for a Normal Distribution — predIntNormSimultaneousTestPower"><meta property="og:description" content="Compute the probability that at least one set of future observations violates the 
  given rule based on a simultaneous prediction interval for the next \(r\) future 
  sampling occasions for a normal distribution.  The three possible rules are: 
  \(k\)-of-\(m\), California, or Modified California."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Probability That at Least One Set of Future Observations Violates the Given Rule Based on a Simultaneous Prediction Interval for a Normal Distribution</h1>
    
    <div class="hidden name"><code>predIntNormSimultaneousTestPower.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the probability that at least one set of future observations violates the 
  given rule based on a simultaneous prediction interval for the next \(r\) future 
  sampling occasions for a normal distribution.  The three possible rules are: 
  \(k\)-of-\(m\), California, or Modified California.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span><span class="va">n</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, n.mean <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">1</span>, 
    rule <span class="op">=</span> <span class="st">"k.of.m"</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, 
    r.shifted <span class="op">=</span> <span class="va">r</span>, K.tol <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span>, integrate.args.list <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>vector of positive integers greater than 2 indicating the sample size upon which 
  the prediction interval is based.</p></dd>
<dt>df</dt>
<dd><p>vector of positive integers indicating the degrees of freedom associated with 
  the sample size.  The default value is <code>df=n-1</code>.</p></dd>
<dt>n.mean</dt>
<dd><p>positive integer specifying the sample size associated with the future averages.  
  The default value is <code>n.mean=1</code> (i.e., individual observations).  Note that all 
  future averages must be based on the same sample size.</p></dd>
<dt>k</dt>
<dd><p>for the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), vector of positive integers 
  specifying the minimum number of observations (or averages) out of \(m\) 
  observations (or averages) (all obtained on one future sampling “occassion”) 
  the prediction interval should contain with confidence level <code>conf.level</code>.  
  The default value is <code>k=1</code>.  This argument is ignored when the argument 
  <code>rule</code> is not equal to <code>"k.of.m"</code>.</p></dd>
<dt>m</dt>
<dd><p>vector of positive integers specifying the maximum number of future observations (or 
  averages) on one future sampling “occasion”.  
  The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which 
  case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.</p></dd>
<dt>r</dt>
<dd><p>vector of positive integers specifying the number of future sampling “occasions”.  
  The default value is <code>r=1</code>.</p></dd>
<dt>rule</dt>
<dd><p>character string specifying which rule to use.  The possible values are 
  <code>"k.of.m"</code> (\(k\)-of-\(m\) rule; the default), <code>"CA"</code> (California rule), 
  and <code>"Modified.CA"</code> (modified California rule).  
  See the DETAILS section below for more information.</p></dd>
<dt>delta.over.sigma</dt>
<dd><p>numeric vector indicating the ratio \(\Delta/\sigma\).  The quantity 
  \(\Delta\) (delta) denotes the difference between the mean of the population 
  that was sampled to construct the prediction interval, and the mean of the 
  population that will be sampled to produce the future observations.  The quantity 
  \(\sigma\) (sigma) denotes the population standard deviation for both populations.  
  See the DETAILS section below for more information.  The default value is 
  <code>delta.over.sigma=0</code>.</p></dd>
<dt>pi.type</dt>
<dd><p>character string indicating what kind of prediction interval to compute.  
  The possible values are <code>pi.type="upper"</code> (the default), and 
  <code>pi.type="lower"</code>.</p></dd>
<dt>conf.level</dt>
<dd><p>vector of values between 0 and 1 indicating the confidence level of the prediction interval.  
  The default value is <code>conf.level=0.95</code>.</p></dd>
<dt>r.shifted</dt>
<dd><p>vector of positive integers specifying the number of future sampling occasions for 
  which the scaled mean is shifted by \(\Delta/\sigma\).  All values must be 
  integeters between <code>1</code> and the corresponding element of <code>r</code>.  
  The default value is <code>r.shifted=r</code>.</p></dd>
<dt>K.tol</dt>
<dd><p>numeric scalar indicating the tolerance to use in the nonlinear search algorithm to 
  compute \(K\).  The default value is <code>K.tol=.Machine$double.eps^(1/2)</code>.  
  For many applications, the value of \(K\) needs to be known only to the second 
  decimal place, in which case setting <code>K.tol=1e-4</code> will speed up computation a 
  bit.</p></dd>
<dt>integrate.args.list</dt>
<dd><p>a list of arguments to supply to the <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code> function.  The 
  default value is <code>integrate.args.list=NULL</code> which means that the 
  default values of <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code> are used.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><b>What is a Simultaneous Prediction Interval?</b> <br>
  A prediction interval for some population is an interval on the real line constructed 
  so that it will contain \(k\) future observations from that population 
  with some specified probability \((1-\alpha)100\%\), where 
  \(0 &lt; \alpha &lt; 1\) and \(k\) is some pre-specified positive integer.  
  The quantity \((1-\alpha)100\%\) is called  
  the confidence coefficient or confidence level associated with the prediction 
  interval.  The function <code><a href="predIntNorm.html">predIntNorm</a></code> computes a standard prediction 
  interval based on a sample from a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a>.</p>
<p>The function <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code> computes a simultaneous prediction 
  interval that will contain a certain number of future observations with probability 
  \((1-\alpha)100\%\) for each of \(r\) future sampling “occasions”, 
  where \(r\) is some pre-specified positive integer.  The quantity \(r\) may 
  refer to \(r\) distinct future sampling occasions in time, or it may for example 
  refer to sampling at \(r\) distinct locations on one future sampling occasion, 
  assuming that the population standard deviation is the same at all of the \(r\) 
  distinct locations.</p>
<p>The function <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code> computes a simultaneous prediction 
  interval based on one of three possible rules:</p><ul><li><p>For the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), at least \(k\) of 
    the next \(m\) future observations will fall in the prediction 
    interval with probability \((1-\alpha)100\%\) on each of the \(r\) future 
    sampling occasions.  If obserations are being taken sequentially, for a particular 
    sampling occasion, up to \(m\) observations may be taken, but once 
    \(k\) of the observations fall within the prediction interval, sampling can stop.  
    Note:  When \(k=m\) and \(r=1\), the results of 
    <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code> are equivalent to the results of 
    <code><a href="predIntNorm.html">predIntNorm</a></code>.</p></li>
<li><p>For the California rule (<code>rule="CA"</code>), with probability 
    \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either 
    the first observation will fall in the prediction interval, or else all of the next 
    \(m-1\) observations will fall in the prediction interval. That is, if the first 
    observation falls in the prediction interval then sampling can stop.  Otherwise, 
    \(m-1\) more observations must be taken.</p></li>
<li><p>For the Modified California rule (<code>rule="Modified.CA"</code>), with probability 
    \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either the 
    first observation will fall in the prediction interval, or else at least 2 out of 
    the next 3 observations will fall in the prediction interval.  That is, if the first 
    observation falls in the prediction interval then sampling can stop.  Otherwise, up 
    to 3 more observations must be taken.</p></li>
</ul><p>Simultaneous prediction intervals can be extended to using averages (means) in place 
  of single observations (USEPA, 2009, Chapter 19).  That is, you can create a 
  simultaneous prediction interval 
  that will contain a specified number of averages (based on which rule you choose) on 
  each of \(r\) future sampling occassions, where each each average is based on 
  \(w\) individual observations.  For the function <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>, 
  the argument <code>n.mean</code> corresponds to \(w\).
  <br></p>  
<p><b>The Form of a Prediction Interval</b> <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a vector of \(n\) 
  observations from a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> with parameters 
  <code>mean=</code>\(\mu\) and <code>sd=</code>\(\sigma\).  Also, let \(w\) denote the 
  sample size associated with the future averages (i.e., <code>n.mean=</code>\(w\)).  
  When \(w=1\), each average is really just a single observation, so in the rest of 
  this help file the term “averages” will replace the phrase 
  “observations or averages”.</p>
<p>For a normal distribution, the form of a two-sided \((1-\alpha)100\%\) 
  prediction interval is: 
  $$[\bar{x} - Ks, \bar{x} + Ks] \;\;\;\;\;\; (1)$$ 
  where \(\bar{x}\) denotes the sample mean:
  $$\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i \;\;\;\;\;\; (2)$$
  \(s\) denotes the sample standard deviation:
  $$s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2 \;\;\;\;\;\; (3)$$
  and \(K\) denotes a constant that depends on the sample size \(n\), the 
  confidence level, the number of future sampling occassions \(r\), and the 
  sample size associated with the future averages, \(w\).  Do not confuse the 
  constant \(K\) (uppercase K) with the number of future averages \(k\) 
  (lowercase k) in the \(k\)-of-\(m\) rule.  The symbol \(K\) is used here 
  to be consistent with the notation used for tolerance intervals 
  (see <code><a href="tolIntNorm.html">tolIntNorm</a></code>).</p>
<p>Similarly, the form of a one-sided lower prediction interval is: 
  $$[\bar{x} - Ks, \infty] \;\;\;\;\;\; (4)$$ 
  and the form of a one-sided upper prediction interval is:
  $$[-\infty, \bar{x} + Ks] \;\;\;\;\;\; (5)$$</p>
<p><b>Note:</b>  For simultaneous prediction intervals, only lower 
  (<code>pi.type="lower"</code>) and upper <br>
  (<code>pi.type="upper"</code>) prediction 
  intervals are available.</p>  
<p>The derivation of the constant \(K\) is explained in the help file for 
  <code><a href="predIntNormSimultaneousK.html">predIntNormSimultaneousK</a></code>.
  <br></p>
<p><b>Computing Power</b> <br>
  The "power" of the prediction interval is defined as the probability that 
  at least one set of future observations violates the given rule based on a 
  simultaneous prediction interval for the next \(r\) future sampling occasions, 
  where the population mean for the future observations is allowed to differ from 
  the population mean for the observations used to construct the prediction interval.</p>
<p>The quantity \(\Delta\) (upper case delta) denotes the difference between the 
  mean of the population that was sampled to construct the prediction interval, and 
  the mean of the population that will be sampled to produce the future observations.  
  The quantity \(\sigma\) (sigma) denotes the population standard deviation of both 
  of these populations.  The argument <code>delta.over.sigma</code> corresponds to the 
  quantity \(\Delta/\sigma\).
  <br></p>
<p><em>Power Based on the k-of-m Rule</em> (<code>rule="k.of.m"</code>) <br>
  For the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>) with \(w=1\) 
  (i.e., <code>n.mean=1</code>), at least \(k\) of the next \(m\) future 
  observations will fall in the prediction interval 
  with probability \((1-\alpha)100\%\) on each of the \(r\) future sampling 
  occasions.  If observations are being taken sequentially, for a particular 
  sampling occasion, up to \(m\) observations may be taken, but once \(k\) 
  of the observations fall within the prediction interval, sampling can stop.  
  Note: When \(k=m\) and \(r=1\), this kind of simultaneous prediction 
  interval becomes the same as a standard prediction interval for the next 
  \(k\) observations (see <code><a href="predIntNorm.html">predIntNorm</a></code>).</p>
<p>Davis and McNichols (1987) show that for a one-sided upper prediction interval 
  (<code>pi.type="upper"</code>), the probability \(p\) that at least \(k\) of the 
  next \(m\) future observations will be contained in the interval given in 
  Equation (5) above, for each of \(r\) 
  future sampling occasions, is given by:
  $$p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r[I(v; k, m+1-k)]^{r-1} [\frac{v^{k-1}(1-v)^{m-k}}{B(k, m+1-k)}] dv \;\;\;\;\;\; (6)$$
  where \(T(x; \nu, \delta)\) denotes the cdf of the 
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">non-central Student's t-distribution</a> with parameters 
  <code>df=</code>\(\nu\) and <code>ncp=</code>\(\delta\) evaluated at \(x\); 
  \(\Phi(x)\) denotes the cdf of the standard <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> 
  evaluated at \(x\); \(I(x; \nu, \omega)\) denotes the cdf of the 
  <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta distribution</a> with parameters <code>shape1=</code>\(\nu\) and 
  <code>shape2=</code>\(\omega\); and \(B(\nu, \omega)\) denotes the value of the 
  <a href="https://rdrr.io/r/base/Special.html" class="external-link">beta function</a> with parameters <code>a=</code>\(\nu\) and 
  <code>b=</code>\(\omega\).</p>
<p>The quantity \(\Delta\) (upper case delta) denotes the difference between the 
  mean of the population that was sampled to construct the prediction interval, and 
  the mean of the population that will be sampled to produce the future observations.  
  The quantity \(\sigma\) (sigma) denotes the population standard deviation of both 
  of these populations.  Usually you assume \(\Delta=0\) unless you are interested 
  in computing the power of the rule to detect a change in means between the 
  populations, as we are here.</p>
<p>If we are interested in using averages instead of single observations, with 
  \(w \ge 1\) (i.e., <code>n.mean</code>\(\ge 1\)), the first 
  term in the integral in Equation (6) that involves the cdf of the 
  <a href="https://rdrr.io/r/stats/TDist.html" class="external-link">non-central Student's t-distribution</a> becomes:
  $$T(\sqrt{n}K; n-1, \frac{\sqrt{n}}{\sqrt{w}}[\Phi^{-1}(v) + \frac{\sqrt{w}\Delta}{\sigma}]) \;\;\;\;\;\; (7)$$</p>  
<p>For a given confidence level \((1-\alpha)100\%\), the power of the rule to detect 
  a change in means is simply given by:
  $$Power = 1 - p \;\;\;\;\;\; (8)$$
  where \(p\) is defined in Equation (6) above using the value of \(K\) that 
  corresponds to \(\Delta/\sigma = 0\).  Thus, when the argument 
  <code>delta.over.sigma=0</code>, the value of \(p\) is \(1-\alpha\) and the power is 
  simply \(\alpha 100\%\).  As <code>delta.over.sigma</code> increases above 0, the power 
  increases.</p>
<p>When <code>pi.type="lower"</code>, the same value of <code>K</code> is used as when 
  <code>pi.type="upper"</code>, but Equation (4) is used to construct the prediction 
  interval.  Thus, the power increases as <code>delta.over.sigma</code> decreases below 0.
  <br></p>
<p><em>Power Based on the California Rule</em> (<code>rule="CA"</code>) <br>  
  For the California rule (<code>rule="CA"</code>), with probability \((1-\alpha)100\%\), 
  for each of the \(r\) future sampling occasions, either the first observation will 
  fall in the prediction interval, or else all of the next \(m-1\) observations will 
  fall in the prediction interval.  That is, if the first observation falls in the 
  prediction interval then sampling can stop.  Otherwise, \(m-1\) more observations 
  must be taken.</p>
<p>The derivation of the power is the same as for the \(k\)-of-\(m\) rule, except 
  that Equation (6) becomes the following (Davis, 1998b):
  $$p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r\{v[1+v^{m-2}(1-v)]\}^{r-1} [1+v^{m-2}(m-1-mv)] dv \;\;\;\;\;\; (9)$$
  <br></p>
<p><em>Power Based on the Modified California Rule</em> (<code>rule="Modified.CA"</code>) <br> 
  For the Modified California rule (<code>rule="Modified.CA"</code>), with probability 
  \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either the 
  first observation will fall in the prediction interval, or else at least 2 out of 
  the next 3 observations will fall in the prediction interval.  That is, if the first 
  observation falls in the prediction interval then sampling can stop.  Otherwise, up 
  to 3 more observations must be taken.</p>
<p>The derivation of the power is the same as for the \(k\)-of-\(m\) rule, except 
  that Equation (6) becomes the following (Davis, 1998b):
  $$p = \int_0^1 T(\sqrt{n}K; n-1, \sqrt{n}[\Phi^{-1}(v) + \frac{\Delta}{\sigma}]) r\{v[1+v(3-v[5-2v])]\}^{r-1} \{1+v[6-v(15-8v)]\} dv \;\;\;\;\;\; (10)$$</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>vector of values between 0 and 1 equal to the probability that 
  the rule will be violated.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>See the help file for <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>See the help file for <code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>.</p>
<p>In the course of designing a sampling program, an environmental scientist may wish 
  to determine the relationship between sample size, significance level, power, and 
  scaled difference if one of the objectives of the sampling program is to determine 
  whether two distributions differ from each other.  The functions 
  <code>predIntNormSimultaneousTestPower</code> and <br><code><a href="plotPredIntNormSimultaneousTestPowerCurve.html">plotPredIntNormSimultaneousTestPowerCurve</a></code> can be 
  used to investigate these relationships for the case of normally-distributed 
  observations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="predIntNormSimultaneous.html">predIntNormSimultaneous</a></code>, <code><a href="predIntNormSimultaneousK.html">predIntNormSimultaneousK</a></code>, <br><code><a href="plotPredIntNormSimultaneousTestPowerCurve.html">plotPredIntNormSimultaneousTestPowerCurve</a></code>, 
  <code><a href="predIntNorm.html">predIntNorm</a></code>, <code><a href="predIntNormK.html">predIntNormK</a></code>, <br><code><a href="predIntNormTestPower.html">predIntNormTestPower</a></code>, <a href="FcnsByCatPredInts.html">Prediction Intervals</a>, 
  <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># For the k-of-m rule with n=4, k=1, m=3, and r=1, show how the power increases </span></span>
<span class="r-in">  <span class="co"># as delta.over.sigma increases. Assume a 95% upper prediction interval.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span>, m <span class="op">=</span> <span class="fl">3</span>, delta.over.sigma <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0500000 0.2954156 0.7008558</span>
<span class="r-in">  <span class="co">#[1] 0.0500000 0.2954156 0.7008558</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Look at how the power increases with sample size for an upper one-sided </span></span>
<span class="r-in">  <span class="co"># prediction interval using the k-of-m rule with k=1, m=3, r=20, </span></span>
<span class="r-in">  <span class="co"># delta.over.sigma=2, and a confidence level of 95%.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">20</span>, delta.over.sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6075972 0.9240924</span>
<span class="r-in">  <span class="co">#[1] 0.6075972 0.9240924</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Compare the power for the 1-of-3 rule with the power for the California and </span></span>
<span class="r-in">  <span class="co"># Modified California rules, based on a 95% upper prediction interval and </span></span>
<span class="r-in">  <span class="co"># delta.over.sigma=2.  Assume a sample size of n=8.  Note that in this case the </span></span>
<span class="r-in">  <span class="co"># power for the Modified California rule is greater than the power for the </span></span>
<span class="r-in">  <span class="co"># 1-of-3 rule and California rule.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, delta.over.sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.788171</span>
<span class="r-in">  <span class="co">#[1] 0.788171 </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span>, m <span class="op">=</span> <span class="fl">3</span>, rule <span class="op">=</span> <span class="st">"CA"</span>, delta.over.sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7160434</span>
<span class="r-in">  <span class="co">#[1] 0.7160434 </span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span>, rule <span class="op">=</span> <span class="st">"Modified.CA"</span>, delta.over.sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8143687</span>
<span class="r-in">  <span class="co">#[1] 0.8143687</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#----------</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Show how the power for an upper 95% simultaneous prediction limit increases </span></span>
<span class="r-in">  <span class="co"># as the number of future sampling occasions r increases.  Here, we'll use the </span></span>
<span class="r-in">  <span class="co"># 1-of-3 rule with n=8 and delta.over.sigma=1.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, </span>
<span class="r-in">    delta.over.sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3492512 0.4032111 0.4503603 0.4633773</span>
<span class="r-in">  <span class="co">#[1] 0.3492512 0.4032111 0.4503603 0.4633773</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># USEPA (2009) contains an example on page 19-23 that involves monitoring </span></span>
<span class="r-in">  <span class="co"># nw=100 compliance wells at a large facility with minimal natural spatial </span></span>
<span class="r-in">  <span class="co"># variation every 6 months for nc=20 separate chemicals.  </span></span>
<span class="r-in">  <span class="co"># There are n=25 background measurements for each chemical to use to create</span></span>
<span class="r-in">  <span class="co"># simultaneous prediction intervals.  We would like to determine which kind of</span></span>
<span class="r-in">  <span class="co"># resampling plan based on normal distribution simultaneous prediction intervals to</span></span>
<span class="r-in">  <span class="co"># use (1-of-m, 1-of-m based on means, or Modified California) in order to have</span></span>
<span class="r-in">  <span class="co"># adequate power of detecting an increase in chemical concentration at any of the</span></span>
<span class="r-in">  <span class="co"># 100 wells while at the same time maintaining a site-wide false positive rate</span></span>
<span class="r-in">  <span class="co"># (SWFPR) of 10% per year over all 4,000 comparisons </span></span>
<span class="r-in">  <span class="co"># (100 wells x 20 chemicals x semi-annual sampling).</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The function predIntNormSimultaneousTestPower includes the argument "r" </span></span>
<span class="r-in">  <span class="co"># that is the number of future sampling occasions (r=2 in this case because </span></span>
<span class="r-in">  <span class="co"># we are performing semi-annual sampling), so to compute the individual test </span></span>
<span class="r-in">  <span class="co"># Type I error level alpha.test (and thus the individual test confidence level), </span></span>
<span class="r-in">  <span class="co"># we only need to worry about the number of wells (100) and the number of </span></span>
<span class="r-in">  <span class="co"># constituents (20): alpha.test = 1-(1-alpha)^(1/(nw x nc)).  The individual </span></span>
<span class="r-in">  <span class="co"># confidence level is simply 1-alpha.test.  Plugging in 0.1 for alpha, </span></span>
<span class="r-in">  <span class="co"># 100 for nw, and 20 for nc yields an individual test confidence level of </span></span>
<span class="r-in">  <span class="co"># 1-alpha.test = 0.9999473.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span class="r-in">  <span class="va">nw</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span class="r-in">  <span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">nc</span> <span class="op">*</span> <span class="va">nw</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="va">conf.level</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9999473</span>
<span class="r-in">  <span class="co">#[1] 0.9999473</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Now we can compute the power of any particular sampling strategy using</span></span>
<span class="r-in">  <span class="co"># predIntNormSimultaneousTestPower.  For example, here is the power of </span></span>
<span class="r-in">  <span class="co"># detecting an increase of three standard deviations in concentration using </span></span>
<span class="r-in">  <span class="co"># the prediction interval based on the "1-of-2" resampling rule:</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">predIntNormSimultaneousTestPower</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">2</span>, rule <span class="op">=</span> <span class="st">"k.of.m"</span>, </span>
<span class="r-in">    delta.over.sigma <span class="op">=</span> <span class="fl">3</span>,  pi.type <span class="op">=</span> <span class="st">"upper"</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3900202</span>
<span class="r-in">  <span class="co">#[1] 0.3900202</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The following commands will reproduce the table shown in Step 2 on page</span></span>
<span class="r-in">  <span class="co"># 19-23 of USEPA (2009).  Because these commands can take more than a few </span></span>
<span class="r-in">  <span class="co"># seconds to execute, we have commented them out here.  To run this example, </span></span>
<span class="r-in">  <span class="co"># just remove the pound signs (#) that are in front of R commands.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#rule.vec &lt;- c(rep("k.of.m", 3), "Modified.CA",  rep("k.of.m", 3))</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#m.vec &lt;- c(2, 3, 4, 4, 1, 2, 1)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#n.mean.vec &lt;- c(rep(1, 4), 2, 2, 3)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#n.scenarios &lt;- length(rule.vec)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#K.vec &lt;- numeric(n.scenarios)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Power.vec &lt;- numeric(n.scenarios)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#K.vec &lt;- predIntNormSimultaneousK(n = 25, k = 1, m = m.vec,  n.mean = n.mean.vec, </span></span>
<span class="r-in">  <span class="co">#  r = 2, rule = rule.vec,  pi.type = "upper", conf.level = conf.level)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Power.vec &lt;- predIntNormSimultaneousTestPower(n = 25, k = 1, m = m.vec, </span></span>
<span class="r-in">  <span class="co">#  n.mean = n.mean.vec, r = 2, rule = rule.vec,  delta.over.sigma = 3, </span></span>
<span class="r-in">  <span class="co">#  pi.type = "upper",  conf.level = conf.level)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Power.df &lt;- data.frame(Rule = rule.vec, k = rep(1, n.scenarios),  m = m.vec, </span></span>
<span class="r-in">  <span class="co">#  N.Mean = n.mean.vec, K = round(K.vec, 2),  Power = round(Power.vec, 2),</span></span>
<span class="r-in">  <span class="co">#  Total.Samples = m.vec * n.mean.vec)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#Power.df</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#         Rule k m N.Mean    K Power Total.Samples</span></span>
<span class="r-in">  <span class="co">#1      k.of.m 1 2      1 3.16  0.39             2</span></span>
<span class="r-in">  <span class="co">#2      k.of.m 1 3      1 2.33  0.65             3</span></span>
<span class="r-in">  <span class="co">#3      k.of.m 1 4      1 1.83  0.81             4</span></span>
<span class="r-in">  <span class="co">#4 Modified.CA 1 4      1 2.57  0.71             4</span></span>
<span class="r-in">  <span class="co">#5      k.of.m 1 1      2 3.62  0.41             2</span></span>
<span class="r-in">  <span class="co">#6      k.of.m 1 2      2 2.33  0.85             4</span></span>
<span class="r-in">  <span class="co">#7      k.of.m 1 1      3 2.99  0.71             3</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># The above table shows the K-multipliers for each prediction interval, along with</span></span>
<span class="r-in">  <span class="co"># the power of detecting a change in concentration of three standard deviations at</span></span>
<span class="r-in">  <span class="co"># any of the 100 wells during the course of a year, for each of the sampling</span></span>
<span class="r-in">  <span class="co"># strategies considered.  The last three rows of the table correspond to sampling</span></span>
<span class="r-in">  <span class="co"># strategies that involve using the mean of two or three observations.</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co">#==========</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Clean up</span></span>
<span class="r-in">  <span class="co">#---------</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">nc</span>, <span class="va">nw</span>, <span class="va">conf.level</span>, <span class="va">rule.vec</span>, <span class="va">m.vec</span>, <span class="va">n.mean.vec</span>, <span class="va">n.scenarios</span>, <span class="va">K.vec</span>, </span>
<span class="r-in">    <span class="va">Power.vec</span>, <span class="va">Power.df</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'rule.vec' not found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'm.vec' not found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'n.mean.vec' not found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'n.scenarios' not found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'K.vec' not found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'Power.vec' not found</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>object 'Power.df' not found</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

