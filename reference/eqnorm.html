<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Quantiles of a Normal Distribution — eqnorm • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Quantiles of a Normal Distribution — eqnorm"><meta property="og:description" content="Estimate quantiles of a normal distribution, and optionally construct a
  confidence interval for a quantile."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Quantiles of a Normal Distribution</h1>

    <div class="hidden name"><code>eqnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate quantiles of a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a>, and optionally construct a
  confidence interval for a quantile.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eqnorm</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">0.5</span>, method <span class="op">=</span> <span class="st">"qmle"</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    ci.method <span class="op">=</span> <span class="st">"exact"</span>, ci.type <span class="op">=</span> <span class="st">"two-sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    digits <span class="op">=</span> <span class="fl">0</span>, warn <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector of observations, or an object resulting from a call to an
  estimating function that assumes a normal (Gaussian) distribution
  (i.e., <code><a href="enorm.html">enorm</a></code>, <code><a href="enormCensored.html">enormCensored</a></code>).
  If <code>x</code> is a numeric vector,
  missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are allowed but will be removed.</p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>numeric vector of probabilities for which quantiles will be estimated.
  All values of <code>p</code> must be between 0 and 1.  When <code>ci=TRUE</code>, <code>p</code>
  must be a scalar. The default value is <code>p=0.5</code>.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string indicating what method to use to estimate the quantile(s).
  Currently the only possible value is <code>method="qmle"</code> (quasi maximum likelihood).
  See the DETAILS section for more information.</p></dd>

  <dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for the quantile.
  The default value is <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating what method to use to construct the confidence interval
  for the quantile.  The possible values are <code>"exact"</code> (exact method; the default)
  and <code>"normal.approx"</code> (normal approximation).  See the DETAILS section for more
  information.</p></dd>

  <dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>character string indicating what kind of confidence interval for the quantile to compute.
  The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
  The default value is <code>conf.level=0.95</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>an integer indicating the number of decimal places to round to when printing out
  the value of <code>100*p</code>. The default value is <code>digits=0</code>.</p></dd>

  <dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical scalar indicating whether to warn in the case when <code>ci=TRUE</code>, <br><code>ci.method="exact"</code>, and the supplied object <code>x</code> is of class
  <code>"estimate"</code> but did not use <code>method="mvue"</code> for estimation.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>x</code> contains any missing (<code>NA</code>), undefined (<code>NaN</code>) or
  infinite (<code>Inf</code>, <code>-Inf</code>) values, they will be removed prior to
  performing the estimation.</p>
<p>Quantiles are estimated by 1) estimating the mean and standard deviation parameters by
  calling <code><a href="enorm.html">enorm</a></code> with <code>method="mvue"</code>, and then
  2) calling the function <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></code> and using the estimated values
  for mean and standard deviation.  This estimator of the \(p\)'th quantile is
  sometimes called the quasi-maximum likelihood estimator (qmle; Cohn et al., 1989)
  because if the maximum likelihood estimator of standard deviation were used
  in place of the minimum variaince unbiased one, then this estimator of the quantile
  would be the mle of the \(p\)'th quantile.</p>
<p>When <code>ci=TRUE</code> and <code>ci.method="exact"</code>, the confidence interval for a
  quantile is computed by using the relationship between a confidence interval for
  a quantile and a tolerance interval.  Specifically, it can be shown
  (e.g., Conover, 1980, pp.119-121) that an upper confidence interval for the
  \(p\)'th quantile with confidence level \(100(1-\alpha)\%\) is equivalent to
  an upper \(\beta\)-content tolerance interval with coverage \(100p\%\) and
  confidence level \(100(1-\alpha)\%\).  Also, a lower confidence interval for
  the \(p\)'th quantile with confidence level \(100(1-\alpha)\%\) is equivalent
  to a lower \(\beta\)-content tolerance interval with coverage \(100(1-p)\%\) and
  confidence level \(100(1-\alpha)\%\).  See the help file for <code><a href="tolIntNorm.html">tolIntNorm</a></code>
  for information on tolerance intervals for a normal distribution.</p>
<p>When <code>ci=TRUE</code> and <code>ci.method="normal.approx"</code>, the confidence interval for a
  quantile is computed by assuming the estimated quantile has an approximately normal
  distribution and using the asymptotic variance to construct the confidence interval
  (see Stedinger, 1983; Stedinger et al., 1993).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>x</code> is a numeric vector, <code>eqnorm</code> returns a list of class
  <code>"estimate"</code> containing the estimated quantile(s) and other information.
  See <code><a href="estimate.object.html">estimate.object</a></code> for details.</p>
<p>If <code>x</code> is the result of calling an estimation function, <code>eqnorm</code>
  returns a list whose class is the same as <code>x</code>.  The list contains the same
  components as <code>x</code>, as well as components called <code>quantiles</code> and
  <code>quantile.method</code>.  In addition, if <code>ci=TRUE</code>, the returned list
  contains a component called <code>interval</code> containing the confidence interval
  information. If <code>x</code> already has a component called <code>interval</code>, this
  component is replaced with the confidence interval information.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002). <em>Statistics for Environmental Engineers</em>.
  Lewis Publishers, Boca Raton.</p>
<p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>. Second Edition.
  John Wiley and Sons, New York.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
  John Wiley &amp; Sons, Hoboken.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY, pp.132-136.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, pp.88-90.</p>
<p>Johnson, N.L., and B.L. Welch. (1940). Applications of the Non-Central t-Distribution.
  <em>Biometrika</em> <b>31</b>, 362-389.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, Florida.</p>
<p>Owen, D.B. (1962). <em>Handbook of Statistical Tables</em>. Addison-Wesley, Reading, MA.</p>
<p>Stedinger, J. (1983). Confidence Intervals for Design Events.
  <em>Journal of Hydraulic Engineering</em> <b>109</b>(1), 13-27.</p>
<p>Stedinger, J.R., R.M. Vogel, and E. Foufoula-Georgiou. (1993).
  Frequency Analysis of Extreme Events. In: Maidment, D.R., ed. <em>Handbook of Hydrology</em>.
  McGraw-Hill, New York, Chapter 18, pp.29-30.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Percentiles are sometimes used in environmental standards and regulations.
  For example, Berthouex and Brown (2002, p.71) note that England has water
  quality limits based on the 90th and 95th percentiles of monitoring data not
  exceeding specified levels.  They also note that the U.S. EPA has specifications
  for air quality monitoring, aquatic standards on toxic chemicals, and maximum
  daily limits for industrial effluents that are all based on percentiles.  Given
  the importance of these quantities, it is essential to characterize the amount
  of uncertainty associated with the estimates of these quantities.  This is done
  with confidence intervals.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="enorm.html">enorm</a></code>, <code><a href="tolIntNorm.html">tolIntNorm</a></code>, <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a></code>,
  <code><a href="estimate.object.html">estimate.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a normal distribution with </span></span></span>
<span class="r-in"><span>  <span class="co"># parameters mean=10 and sd=2, then estimate the 90th </span></span></span>
<span class="r-in"><span>  <span class="co"># percentile and create a one-sided upper 95% confidence interval </span></span></span>
<span class="r-in"><span>  <span class="co"># for that percentile. </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this </span></span></span>
<span class="r-in"><span>  <span class="co"># example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu">eqnorm</span><span class="op">(</span><span class="va">dat</span>, p <span class="op">=</span> <span class="fl">0.9</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            Normal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Parameter(s):          mean = 9.792856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  sd   = 1.821286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation Method:               mvue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Quantile(s):           90'th %ile = 12.12693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quantile Estimation Method:      qmle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            dat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval for:         90'th %ile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Method:      Exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Type:        upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                95%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval:             LCL =     -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UCL = 13.30064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 9.792856</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   = 1.821286</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           90'th %ile = 12.12693</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      qmle</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         90'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =     -Inf</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 13.30064</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span>  <span class="co"># Compare these results with the true 90'th percentile:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.9</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12.5631</span>
<span class="r-in"><span>  <span class="co">#[1] 12.56310</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example 21-4 of USEPA (2009, p. 21-13) shows how to construct a </span></span></span>
<span class="r-in"><span>  <span class="co"># 99% lower confidence limit for the 95th percentile using chrysene </span></span></span>
<span class="r-in"><span>  <span class="co"># data and assuming a lognormal distribution.  The data for this </span></span></span>
<span class="r-in"><span>  <span class="co"># example are stored in EPA.09.Ex.21.1.aldicarb.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The facility permit has established an ACL of 30 ppb that should not </span></span></span>
<span class="r-in"><span>  <span class="co"># be exceeded more than 5% of the time.  Thus, if the lower confidence limit </span></span></span>
<span class="r-in"><span>  <span class="co"># for the 95th percentile is greater than 30 ppb, the well is deemed to be </span></span></span>
<span class="r-in"><span>  <span class="co"># out of compliance.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at the data</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">EPA.09.Ex.21.1.aldicarb.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Month   Well Aldicarb.ppb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 Well.1         19.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 Well.1         29.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3 Well.1         18.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4 Well.1         24.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1 Well.2         23.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2 Well.2         21.9</span>
<span class="r-in"><span>  <span class="co">#  Month   Well Aldicarb.ppb</span></span></span>
<span class="r-in"><span>  <span class="co">#1     1 Well.1         19.9</span></span></span>
<span class="r-in"><span>  <span class="co">#2     2 Well.1         29.6</span></span></span>
<span class="r-in"><span>  <span class="co">#3     3 Well.1         18.7</span></span></span>
<span class="r-in"><span>  <span class="co">#4     4 Well.1         24.2</span></span></span>
<span class="r-in"><span>  <span class="co">#5     1 Well.2         23.7</span></span></span>
<span class="r-in"><span>  <span class="co">#6     2 Well.2         21.9</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="longToWide.html">longToWide</a></span><span class="op">(</span><span class="va">EPA.09.Ex.21.1.aldicarb.df</span>, </span></span>
<span class="r-in"><span>    <span class="st">"Aldicarb.ppb"</span>, <span class="st">"Month"</span>, <span class="st">"Well"</span>, paste.row.name <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Well.1 Well.2 Well.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.1   19.9   23.7    5.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.2   29.6   21.9    3.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.3   18.7   26.9    2.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Month.4   24.2   26.1    6.9</span>
<span class="r-in"><span>  <span class="co">#        Well.1 Well.2 Well.3</span></span></span>
<span class="r-in"><span>  <span class="co">#Month.1   19.9   23.7    5.6</span></span></span>
<span class="r-in"><span>  <span class="co">#Month.2   29.6   21.9    3.3</span></span></span>
<span class="r-in"><span>  <span class="co">#Month.3   18.7   26.9    2.3</span></span></span>
<span class="r-in"><span>  <span class="co">#Month.4   24.2   26.1    6.9</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Estimate the 95th percentile and compute the lower </span></span></span>
<span class="r-in"><span>  <span class="co"># 99% confidence limit for Well 1.</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.21.1.aldicarb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu">eqnorm</span><span class="op">(</span><span class="va">Aldicarb.ppb</span><span class="op">[</span><span class="va">Well</span> <span class="op">==</span> <span class="st">"Well.1"</span><span class="op">]</span>, p <span class="op">=</span> <span class="fl">0.95</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>      ci.type <span class="op">=</span> <span class="st">"lower"</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            Normal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Parameter(s):          mean = 23.10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  sd   =  4.93491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation Method:               mvue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Quantile(s):           95'th %ile = 31.2172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quantile Estimation Method:      qmle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            Aldicarb.ppb[Well == "Well.1"]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval for:         95'th %ile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Method:      Exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Type:        lower</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                99%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval:             LCL = 25.2855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UCL =     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 23.10000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   =  4.93491</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           95'th %ile = 31.2172</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      qmle</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Aldicarb.ppb[Well == "Well.1"]</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     4</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         95'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        lower</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                99%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 25.2855</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL =     Inf</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now compute the 99% lower confidence limit for each of the three </span></span></span>
<span class="r-in"><span>  <span class="co"># wells all at once.</span></span></span>
<span class="r-in"><span>  <span class="co">#------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">LCLs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.21.1.aldicarb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Aldicarb.ppb</span>, <span class="va">Well</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">eqnorm</span><span class="op">(</span><span class="va">x</span>, p <span class="op">=</span> <span class="fl">0.95</span>, method <span class="op">=</span> <span class="st">"qmle"</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>      ci.type <span class="op">=</span> <span class="st">"lower"</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">[</span><span class="st">"LCL"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">LCLs</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Well.1.LCL Well.2.LCL Well.3.LCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      25.29      25.66       5.46 </span>
<span class="r-in"><span>  <span class="co">#Well.1.LCL Well.2.LCL Well.3.LCL </span></span></span>
<span class="r-in"><span>  <span class="co">#     25.29      25.66       5.46 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">LCLs</span> <span class="op">&gt;</span> <span class="fl">30</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Well.1.LCL Well.2.LCL Well.3.LCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      FALSE      FALSE      FALSE </span>
<span class="r-in"><span>  <span class="co">#Well.1.LCL Well.2.LCL Well.3.LCL </span></span></span>
<span class="r-in"><span>  <span class="co">#     FALSE      FALSE      FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">LCLs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example 17-3 of USEPA (2009, p. 17-17) shows how to construct a </span></span></span>
<span class="r-in"><span>  <span class="co"># beta-content upper tolerance limit with 95% coverage and 95% </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence using chrysene data and assuming a lognormal </span></span></span>
<span class="r-in"><span>  <span class="co"># distribution.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># A beta-content upper tolerance limit with 95% coverage and 95% </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence is equivalent to the 95% upper confidence limit for the </span></span></span>
<span class="r-in"><span>  <span class="co"># 95th percentile.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Here we will construct a 95% upper confidence limit for the 95th </span></span></span>
<span class="r-in"><span>  <span class="co"># percentile based on the log-transformed data, then exponentiate the </span></span></span>
<span class="r-in"><span>  <span class="co"># result to get the confidence limit on the original scale.  Note that </span></span></span>
<span class="r-in"><span>  <span class="co"># it is easier to just use the function eqlnorm with the original data </span></span></span>
<span class="r-in"><span>  <span class="co"># to achieve the same result.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">EPA.09.Ex.17.3.chrysene.df</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">log.Chrysene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Chrysene.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">eqnorm</span><span class="op">(</span><span class="va">log.Chrysene</span>, p <span class="op">=</span> <span class="fl">0.95</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            Normal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Parameter(s):          mean = 2.5085773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  sd   = 0.6279479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation Method:               mvue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Quantile(s):           95'th %ile = 3.54146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quantile Estimation Method:      qmle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            log.Chrysene</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval for:         95'th %ile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Method:      Exact</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Type:        upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                95%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval:             LCL =     -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UCL = 4.510032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 2.5085773</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   = 0.6279479</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               mvue</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           95'th %ile = 3.54146</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      qmle</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            log.Chrysene</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     8</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         95'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =     -Inf</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 4.510032</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">4.510032</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 90.92473</span>
<span class="r-in"><span>  <span class="co">#[1] 90.92473</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">log.Chrysene</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="st">"EPA.09.Ex.17.3.chrysene.df"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

