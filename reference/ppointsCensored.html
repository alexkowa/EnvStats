<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plotting Positions for Type I Censored Data — ppointsCensored • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting Positions for Type I Censored Data — ppointsCensored"><meta property="og:description" content="Returns a list of &amp;#8220;ordered&amp;#8221; observations and associated plotting positions based on
  Type I left-censored or right-censored data.  These plotting positions may be used to
  construct empirical cumulative distribution plots or quantile-quantile plots, or to estimate
  distribution parameters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plotting Positions for Type I Censored Data</h1>

    <div class="hidden name"><code>ppointsCensored.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns a list of “ordered” observations and associated plotting positions based on
  Type I left-censored or right-censored data.  These plotting positions may be used to
  construct empirical cumulative distribution plots or quantile-quantile plots, or to estimate
  distribution parameters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ppointsCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, censoring.side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>    prob.method <span class="op">=</span> <span class="st">"michael-schucany"</span>, plot.pos.con <span class="op">=</span> <span class="fl">0.375</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-censored">censored<a class="anchor" aria-label="anchor" href="#arg-censored"></a></dt>
<dd><p>numeric or logical vector indicating which values of <code>x</code> are censored.  This must be the
  same length as <code>x</code>.  If the mode of <code>censored</code> is <code>"logical"</code>, <code>TRUE</code> values
  correspond to elements of <code>x</code> that are censored, and <code>FALSE</code> values correspond to
  elements of <code>x</code> that are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>,
  it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to <code>TRUE</code> and
  <code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-censoring-side">censoring.side<a class="anchor" aria-label="anchor" href="#arg-censoring-side"></a></dt>
<dd><p>character string indicating on which side the censoring occurs.  The possible values are
  <code>"left"</code> (the default) and <code>"right"</code>.</p></dd>

  <dt id="arg-prob-method">prob.method<a class="anchor" aria-label="anchor" href="#arg-prob-method"></a></dt>
<dd><p>character string indicating what method to use to compute the plotting positions
  (empirical probabilities).  Possible values are: <br><code>"kaplan-meier"</code> (product-limit method of Kaplan and Meier (1958)), <br><code>"modified kaplan-meier"</code> (modification of Kaplan-Meier method), <br><code>"nelson"</code> (hazard plotting method of Nelson (1972)), <br><code>"michael-schucany"</code> (generalization of the product-limit method due to Michael and Schucany (1986)), and <br><code>"hirsch-stedinger"</code> (generalization of the product-limit method due to Hirsch and Stedinger (1987)). <br></p>
<p>The default value is <code>prob.method="michael-schucany"</code>.</p>
<p>The <code>"nelson"</code> method is only available for <code>censoring.side="right"</code>, and
  the <code>"modified kaplan-meier"</code> method is only available for <br><code>censoring.side="left"</code>.  See the DETAILS section for more explanation.</p></dd>

  <dt id="arg-plot-pos-con">plot.pos.con<a class="anchor" aria-label="anchor" href="#arg-plot-pos-con"></a></dt>
<dd><p>numeric scalar between 0 and 1 containing the value of the plotting position constant.
  The default value is <code>plot.pos.con=0.375</code>.  See the DETAILS section for more information.
  This argument is used only if <code>prob.method</code> is equal to <code>"michael-schucany"</code> or
  <code>"hirsch-stedinger"</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Methods for computing plotting positions for complete data sets
  (no censored observations) are discussed in D'Agostino, R.B. (1986a) and
  Cleveland (1993).  For data sets with censored observations, these methods
  must be modified.  The function <code>ppointsCensored</code> allows you to compute
  plotting positions based on any of the following methods:</p><ul><li><p>Product-limit method of Kaplan and Meier (1958) (<code>prob.method="kaplan-meier"</code>).</p></li>
<li><p>Hazard plotting method of Nelson (1972) (<code>prob.method="nelson"</code>).</p></li>
<li><p>Generalization of the product-limit method due to Michael and Schucany (1986) <br>
  (<code>prob.method="michael-schucany"</code>) (the default).</p></li>
<li><p>Generalization of the product-limit method due to Hirsch and Stedinger (1987) <br>
  (<code>prob.method="hirsch-stedinger"</code>).</p></li>
</ul><p>Let \(\underline{x}\) denote a random sample of \(N\) observations from
  some distribution.  Assume \(n\) (\(0 &lt; n &lt; N\)) of these
  observations are known and \(c\) (\(c=N-n\)) of these observations are
  all censored below (left-censored) or all censored above (right-censored) at
  \(k\) fixed censoring levels
  $$T_1, T_2, \ldots, T_K; \; K \ge 1 \;\;\;\;\;\; (1)$$
  For the case when \(K \ge 2\), the data are said to be Type I
  <b><em>multiply censored</em></b>.  For the case when \(K=1\),
  set \(T = T_1\).  If the data are left-censored
  and all \(n\) known observations are greater
  than or equal to \(T\), or if the data are right-censored and all \(n\)
  known observations are less than or equal to \(T\), then the data are
  said to be Type I <b><em>singly censored</em></b> (Nelson, 1982, p.7), otherwise
  they are considered to be Type I multiply censored.</p>
<p>Let \(c_j\) denote the number of observations censored below or above censoring
  level \(T_j\) for \(j = 1, 2, \ldots, K\), so that
  $$\sum_{i=1}^K c_j = c \;\;\;\;\;\; (2)$$
  Let \(x_{(1)}, x_{(2)}, \ldots, x_{(N)}\) denote the “ordered” observations,
  where now “observation” means either the actual observation (for uncensored
  observations) or the censoring level (for censored observations).  For
  right-censored data, if a censored observation has the same value as an
  uncensored one, the uncensored observation should be placed first.
  For left-censored data, if a censored observation has the same value as an
  uncensored one, the censored observation should be placed first.</p>
<p>Note that in this case the quantity \(x_{(i)}\) does not necessarily represent
  the \(i\)'th “largest” observation from the (unknown) complete sample.</p>
<p>Finally, let \(\Omega\) (omega) denote the set of \(n\) subscripts in the
  “ordered” sample that correspond to uncensored observations.
  <br></p>
<p><b>Product-Limit Method of Kaplan and Meier</b> (<code>prob.method="kaplan-meier"</code>) <br>
  For complete data sets (no censored observations), the
  <b><em>empirical probabilities</em></b> estimator of the cumulative distribution
  function evaluated at the \(i\)'th ordered observation is given by
  (D'Agostino, 1986a, p.8):
  $$\hat{F}[x_{(i)}] = \hat{p}_i = \frac{\#[x_j \le x_{(i)}]}{n} \;\;\;\;\;\; (3)$$
  where \(\#[x_j \le x_{(i)}]\) denotes the number of observations less than
  or equal to \(x_{(i)}\) (see the help file for <code><a href="ecdfPlot.html">ecdfPlot</a></code>).
  Kaplan and Meier (1958) extended this method of computing the empirical cdf to
  the case of right-censored data.
  <br></p>
<p><em>Right-Censored Data</em> (<code>censoring.side="right"</code>)<br>
  Let \(S(t)\) denote the survival function evaluated at \(t\), that is:
  $$S(t) = 1 - F(t) = Pr(X &gt; t) \;\;\;\;\;\; (4)$$
  Kaplan and Meier (1958) show that a nonparametric estimate of the survival
  function at the \(i\)'th ordered observation that is not censored
  (i.e., \(i \in \Omega\)), is given by:</p><table class="table table"><tr><td>\(\hat{S}[x_{(i)}]\)</td><td>\(=\)</td><td>\(\widehat{Pr}[X &gt; x_{(i)}]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(\widehat{Pr}[X &gt; x_{(1)}]\)</td></tr><tr><td></td><td></td><td>\(\;\; \widehat{Pr}[X &gt; x_{(2)} | X &gt; x_{(1)}] \;\; \cdots\)</td></tr><tr><td></td><td></td><td>\(\;\; \widehat{Pr}[X &gt; x_{(i)} | X &gt; x_{(i-1)}]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(\prod_{j \in \Omega, j \le i} \frac{n_j - d_j}{n_j}, \;\; i \in \Omega \;\;\;\;\; (5)\)</td></tr></table><p>where \(n_j\) is the number of observations (uncensored or censored) with values
  greater than or equal to \(x_{(j)}\), and \(d_j\) denotes the number of
  uncensored observations exactly equal to \(x_{(j)}\) (if there are no tied
  uncensored observations then \(d_j\) will equal 1 for all values of \(j\)).
  (See also Lee and Wang, 2003, pp. 64–69; Michael and Schucany, 1986).  By convention,
  the estimate of the survival function at a censored observation is set equal to
  the estimated value of the survival function at the largest uncensored observation
  less than or equal to that censoring level.  If there are no uncensored observations
  less than or equal to a particular censoring level, the estimate of the survival
  function is set to 1 for that censoring level.</p>
<p>Thus the Kaplan-Meier plotting position at the \(i\)'th ordered observation
  that is not censored (i.e., \(i \in \Omega\)), is given by:
  $$\hat{p}_i = \hat{F}[x_{(i)}] = 1 - \prod_{j \in \Omega, j \le i} \frac{n_j - d_j}{n_j} \;\;\;\;\;\; (6)$$</p>
<p>The plotting position for a censored observation is set equal to the plotting
  position associated with the largest uncensored observation less than or equal to
  that censoring level.  If there are no uncensored observations less than or equal
  to a particular censoring level, the plotting position is set to 0 for that
  censoring level.</p>
<p>As an example, consider the following right-censored data set:
  $$3, \ge4, \ge4, 5, 5, 6$$
  The table below shows how the plotting positions are computed.</p><table class="table table"><tr><td>\(i\)</td><td>\(x_{(i)}\)</td><td>\(n_i\)</td><td>\(d_i\)</td><td>\(\frac{n_i-d_i}{n_i}\)</td><td>Plotting Position</td></tr><tr><td>1</td><td>\(3\)</td><td>\(6\)</td><td>\(1\)</td><td>\(5/6\)</td><td>\(1 - (5/6) = 0.167\)</td></tr><tr><td>2</td><td>\(\ge4\)</td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td>\(\ge4\)</td><td></td><td></td><td></td><td></td></tr><tr><td>4</td><td>\(5\)</td><td>\(3\)</td><td>\(2\)</td><td>\(1/3\)</td><td>\(1 - (5/6)(1/3) = 0.722\)</td></tr><tr><td>5</td><td>\(5\)</td><td></td><td></td><td></td><td>\(0.722\)</td></tr><tr><td>6</td><td>\(6\)</td><td>\(1\)</td><td>\(1\)</td><td>\(0/1\)</td><td>\(1 - (5/6)(1/3)(0/1) = 1\)</td></tr></table><p>Note that for complete data sets, Equation (6) reduces to Equation (3).
  <br></p>
<p><em>Left-Censored Data</em> (<code>censoring.side="left"</code>) <br>
  Gillespie et al. (2010) give formulas for the Kaplan-Meier estimator for the case of
  left-cesoring (<code>censoring.side="left"</code>).  In this case, the plotting position
  for the \(i\)'th ordered observation, assuming it is not censored, is computed as:
  $$\hat{p}_i = \hat{F}[x_{(i)}] = \prod_{j \in \Omega, j &gt; i} \frac{n_j - d_j}{n_j} \;\;\;\;\;\; (7)$$
  where \(n_j\) is the number of observations (uncensored or censored) with values
  less than or equal to \(x_{(j)}\), and \(d_j\) denotes the number of
  uncensored observations exactly equal to \(x_{(j)}\) (if there are no tied
  uncensored observations then \(d_j\) will equal 1 for all values of \(j\)).
  The plotting position is equal to 1 for the largest uncensored order statistic.</p>
<p>As an example, consider the following left-censored data set:
  $$3, &lt;4, &lt;4, 5, 5, 6$$
  The table below shows how the plotting positions are computed.</p><table class="table table"><tr><td>\(i\)</td><td>\(x_{(i)}\)</td><td>\(n_i\)</td><td>\(d_i\)</td><td>\(\frac{n_i-d_i}{n_i}\)</td><td>Plotting Position</td></tr><tr><td>1</td><td>\(3\)</td><td>\(1\)</td><td>\(1\)</td><td>\(0/1\)</td><td>\(1(5/6)(3/5) = 0.5\)</td></tr><tr><td>2</td><td>\(&lt;4\)</td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td>\(&lt;4\)</td><td></td><td></td><td></td><td></td></tr><tr><td>4</td><td>\(5\)</td><td>\(5\)</td><td>\(2\)</td><td>\(3/5\)</td><td>\(0.833\)</td></tr><tr><td>5</td><td>\(5\)</td><td></td><td></td><td></td><td>\(1(5/6) = 0.833\)</td></tr><tr><td>6</td><td>\(6\)</td><td>\(6\)</td><td>\(1\)</td><td>\(5/6\)</td><td>\(1\)</td></tr></table><p>Note that for complete data sets, Equation (7) reduces to Equation (3).
  <br></p>
<p><b>Modified Kaplan-Meier Method</b> (<code>prob.method="modified kaplan-meier"</code>) <br>
  (Left-Censored Data Only.)  For left-censored data, the modified Kaplan-Meier
  method is the same as the Kaplan-Meier method, except that for the largest
  uncensored order statistic, the plotting position is not set to 1 but rather is
  set equal to the Blom plotting position:  \((N - 0.375)/(N + 0.25)\).  This method
  is useful, for example, when creating <a href="qqPlotCensored.html">Quantile-Quantile plots</a>.
  <br></p>
<p><b>Hazard Plotting Method of Nelson</b> (<code>prob.method="nelson"</code>) <br>
  (Right-Censored Data Only.)  For right-censored data, Equation (5) can be
  re-written as:
  $$\hat{S}[x_{(i)}] = \prod_{j \in \Omega, j \le i} \frac{N-j}{N-j+1}, \;\; i \in \Omega \;\;\;\;\;\; (8)$$
  Nelson (1972) proposed the following formula for plotting positions for
  the uncensored observations in the context of estimating the hazard function
  (see Michael and Schucany,1986, p.469):
  $$\hat{p}_i = \hat{F}[x_{(i)}] = 1 - \prod_{j \in \Omega, j \le i} exp(\frac{-1}{N-j+1}) \;\;\;\;\;\; (9)$$
  See Lee and Wang (2003) for more information about the hazard function.</p>
<p>As for the Kaplan and Meier (1958) method, the plotting position for a censored
  observation is set equal to the plotting position associated with the largest
  uncensored observation less than or equal to that censoring level.  If there are
  no uncensored observations less than or equal to a particular censoring level,
  the plotting position is set to 0 for that censoring level.
  <br></p>
<p><b>Generalization of Product-Limit Method, Michael and Schucany</b> <br>
  (<code>prob.method="michael-schucany"</code>) <br>
  For complete data sets, the disadvantage of using Equation (3) above to define
  plotting positions is that it implies the largest observed value is the maximum
  possible value of the distribution (the \(100\)'th percentile).  This may be
  satisfactory if the underlying distribution is known to be discrete, but it is
  usually not satisfactory if the underlying distribution is known to be continuous.</p>
<p>A more frequently used formula for plotting positions for complete data sets is
  given by:
  $$\hat{F}[x_{(i)}] = \hat{p}_i = \frac{i - a}{N - 2a + 1} \;\;\;\;\;\; (10)$$
  where \(0 \le a \le 1\) (Cleveland, 1993, p. 18; D'Agostino, 1986a, pp. 8,25).
  The value of \(a\) is usually chosen so that the plotting positions are
  approximately unbiased (i.e., approximate the mean of their distribution) or else
  approximate the median value of their distribution (see the help file for
  <code><a href="ecdfPlot.html">ecdfPlot</a></code>).  Michael and Schucany (1986) extended this method for
  both left- and right-censored data sets.
  <br></p>
<p><em>Right-Censored Data</em> (<code>censoring.side="right"</code>)<br>
  For right-censored data sets, the plotting positions for the uncensored
  observations are computed as:
  $$\hat{p}_i = 1 - \frac{N-a+1}{N-2a+1} \prod_{j \in \Omega, j \le i} \frac{N-j-a+1}{N-j-a+2} \;\; i \in \Omega \;\;\;\;\;\; (11)$$
  Note that the plotting positions proposed by Herd (1960) and Johnson (1964) are a
  special case of Equation (11) with \(a=0\).  Equation (11) reduces to Equation (10)
  in the case of complete data sets.  Note that unlike the Kaplan-Meier method,
  plotting positions associated with tied uncensored observations are not the same
  (just as in the case for complete data using Equation (10)).</p>
<p>As for the Kaplan and Meier (1958) method, for right-censored data the plotting
  position for a censored observation is set equal to the plotting position associated
  with the largest uncensored observation less than or equal to that censoring level.
  If there are no uncensored observations less than or equal to a particular censoring
  level, the plotting position is set to 0 for that censoring level.
  <br></p>
<p><em>Left-Censored Data</em> (<code>censoring.side="left"</code>) <br>
  For left-censored data sets the plotting positions are computed as:
  $$\hat{p}_i = \frac{N-a+1}{N-2a+1} \prod_{j \in \Omega, j \ge i} \frac{j-a}{j-a+1} \;\; i \in \Omega \;\;\;\;\;\; (12)$$
  Equation (12) reduces to Equation (10) in the case of complete data
  sets.  Note that unlike the Kaplan-Meier method, plotting positions associated with
  tied uncensored observations are not the same (just as in the case for complete
  data using Equation (10)).</p>
<p>For left-censored data, the plotting position for a censored observation is set
  equal to the plotting position associated with the smallest uncensored observation
  greater than or equal to that censoring level.  If there are no uncensored
  observations greater than or equal to a particular censoring level, the plotting
  position is set to 1 for that censoring level.
  <br></p>
<p><b>Generalization of Product-Limit Method, Hirsch and Stedinger</b> <br>
  (<code>prob.method="hirsch-stedinger"</code>) <br>
  Hirsch and Stedinger (1987) use a slightly different approach than Kaplan and Meier
  (1958) and Michael and Schucany (1986) to derive a nonparametric estimate of the
  survival function (probability of exceedance) in the context of left-censored data.
  First they estimate the value of the survival function at each of the censoring
  levels.  The value of the survival function for an uncensored observation between
  two adjacent censoring levels is then computed by linear interpolation (in the form
  of a plotting position).  See also Helsel and Cohn (1988).</p>
<p>The discussion below presents an extension of the method of Hirsch and Stedinger
  (1987) to the case of right-censored data, and then presents the original derivation
  due to Hirsch and Stedinger (1987) for left-censored data.</p>
<p><em>Right-Censored Data</em> (<code>censoring.side="right"</code>)<br>
  For right-censored data, the survival function is estimated as follows.
  For the \(j\)'th censoring level (\(j = 0, 1, \ldots, K\)), write the
  value of the survival function as:</p><table class="table table"><tr><td>\(S(T_j)\)</td><td>\(=\)</td><td>\(Pr[X &gt; T_j]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(Pr[X &gt; T_{j+1}] + Pr[T_j &lt; X \le T_{j+1}]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(S(T_{j+1}) + Pr[T_j &lt; X \le T_{j+1} | X &gt; T_j] Pr[X &gt; T_j]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(S(T_{j+1}) + Pr[T_j &lt; X \le T_{j+1} | X &gt; T_j] S(T_j) \;\;\;\;\;\; (13)\)</td></tr></table><p>where
  $$T_0 = -\infty, \;\;\;\;\;\; (14)$$
  $$T_{K+1} = \infty \;\;\;\;\;\; (15)$$
  Now set</p><table class="table table"><tr><td>\(A_j\)</td><td>\(=\)</td><td># uncensored observations in \((T_j, T_{j+1}] \;\;\;\;\;\; (16)\)</td></tr><tr><td>\(B_j\)</td><td>\(=\)</td><td># observations in \((T_{j+1}, \infty) \;\;\;\;\;\; (17)\)</td></tr></table><p>for \(j = 0, 1, \ldots, K\).  Then the method of moments estimator of the
  conditional probability in Equation (13) is given by:
  $$\widehat{Pr}[T_j &lt; X \le T_{j+1} | X &gt; T_j] = \frac{A_j}{A_j + B_j} \;\;\;\;\;\; (18)$$
  Hence, by equations (13) and (18) we have
  $$\hat{S}(T_j) = \hat{S}(T_{j+1}) + (\frac{A_j}{A_j + B_j}) \hat{S}(T_{j}) \;\;\;\;\;\; (19)$$
  which can be rewritten as:
  $$\hat{S}(T_{j+1}) = \hat{S}(T_j) [1 - (\frac{A_j}{A_j + B_j})] \;\;\;\;\;\; (20)$$
  Equation (20) can be solved interatively for \(j = 1, 2, \ldots, K\).  Note that
  $$\hat{S}(T_0) = \hat{S}(-\infty) = S(-\infty) = 1 \;\;\;\;\;\; (21)$$
  $$\hat{S}(T_{K+1}) = \hat{S}(\infty) = S(\infty) = 0 \;\;\;\;\;\; (22)$$</p>
<p>Once the values of the survival function at the censoring levels are computed, the
  plotting positions for the \(A_j\) uncensored observations in the interval
  \((T_J, T_{j+1}]\) (\(j = 0, 1, \ldots, K\)) are computed as
  $$\hat{p}_i = [1 - \hat{S}(T_j)] + [\hat{S}(T_j) - \hat{S}(T_{j+1})] \frac{r-a}{A_j - 2a + 1} \;\;\;\;\;\; (23)$$
  where \(a\) denotes the plotting position constant, \(0 \le a \le 1\), and
  \(r\) denotes the rank of the \(i\)'th observation among the \(A_j\)
  uncensored observations in the interval \((T_J, T_{j+1}]\).
  (Tied observations are given distinct ranks.)</p>
<p>For the \(c_j\) observations censored at censoring level \(T_j\)
  (\(j = 1, 2, \ldots, K\)), the plotting positions are computed as:
  $$\hat{p}_i = 1 - [\hat{S}(T_j) \frac{r-a}{c_j - 2a + 1}]  \;\;\;\;\;\; (24)$$
  where \(r\) denotes the rank of the \(i\)'th observation among the \(c_j\)
  observations censored at censoring level \(T_j\).  Note that all the
  observations censored at the same censoring level are given distinct ranks,
  even though there is no way to distinguish between them.
  <br></p>
<p><em>Left-Censored Data</em> (<code>censoring.side="left"</code>) <br>
  For left-censored data, Hirsch and Stedinger (1987) modify the definition of the
  survival function as follows:
  $$S^*(t) = Pr[X \ge t] \;\;\;\;\;\; (25)$$
  For continuous distributions, the functions in Equations (4) and (25) are identical.</p>
<p>Hirsch and Stedinger (1987) show that for the \(j\)'th censoring level
  (\(j = 0, 1, \ldots, K\)), the value of the survival function can be written as:</p><table class="table table"><tr><td>\(S(T_j)\)</td><td>\(=\)</td><td>\(Pr[X \ge T_j]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(Pr[X \ge T_{j+1}] + Pr[T_j \le X &lt; T_{j+1}]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(S^*(T_{j+1}) + Pr[T_j \le X &lt; T_{j+1} | X &lt; T_{j+1}] Pr[X &lt; T_{j+1}]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(S^*(T_{j+1}) + Pr[T_j \le X &lt; T_{j+1} | X &lt; T_j] [1 - S^*(T_j)] \;\;\;\;\;\; (26)\)</td></tr></table><p>where \(T_0\) and \(T_{K+1}\) are defined in Equations (14) and (15).</p>
<p>Now set</p><table class="table table"><tr><td>\(A_j\)</td><td>\(=\)</td><td># uncensored observations in \([T_j, T_{j+1}) \;\;\;\;\;\; (27)\)</td></tr><tr><td>\(B_j\)</td><td>\(=\)</td><td># observations in \((-\infty, T_j) \;\;\;\;\;\; (28)\)</td></tr></table><p>for \(j = 0, 1, \ldots, K\).  Then the method of moments estimator of the
  conditional probability in Equation (26) is given by:
  $$Pr[T_j \le X &lt; T_{j+1} | X &lt; T_{j+1}] = \frac{A_j}{A_j + B_j} \;\;\;\;\;\; (29)$$
  Hence, by Equations (26) and (29) we have
  $$\hat{S}(T_j) = \hat{S}(T_{j+1}) + (\frac{A_j}{A_j + B_j}) \hat{S}(T_{j}) \;\;\;\;\;\; (30)$$
  which can be solved interatively for \(j = 1, 2, \ldots, K\).  Note that
  $$\widehat{S^*}(T_{K+1}) = \widehat{S^*}(\infty) = S^*(\infty) = 0 \;\;\;\;\;\; (31)$$
  $$\widehat{S^*}(T_0) = \widehat{S^*}(-\infty) = S^*(-\infty) = 1 \;\;\;\;\;\; (32)$$</p>
<p>Once the values of the survival function at the censoring levels are computed, the
  plotting positions for the \(A_j\) uncensored observations in the interval
  \([T_J, T_{j+1})\) (\(j = 0, 1, \ldots, K\)) are computed as
  $$\hat{p}_i = [1 - \widehat{S^*}(T_j)] + [\widehat{S^*}(T_j) - \widehat{S^*}(T_{j+1})] \frac{r-a}{A_j - 2a + 1} \;\;\;\;\;\; (33)$$
  where \(a\) denotes the plotting position constant, \(0 \le a \le 0.5\), and
  \(r\) denotes the rank of the \(i\)'th observation among the \(A_j\)
  uncensored observations in the interval \([T_J, T_{j+1})\).
  (Tied observations are given distinct ranks.)</p>
<p>For the \(c_j\) observations censored at censoring level \(T_j\)
  (\(j = 1, 2, \ldots, K\)), the plotting positions are computed as:
  $$\hat{p}_i = [1 - \widehat{S^*}(T_j)] \frac{r-a}{c_j - 2a + 1}  \;\;\;\;\;\; (34)$$
  where \(r\) denotes the rank of the \(i\)'th observation among the \(c_j\)
  observations censored at censoring level \(T_j\).  Note that all the
  observations censored at the same censoring level are given distinct ranks,
  even though there is no way to distinguish between them.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>ppointsCensored</code> returns a list with the following components:</p>
<p></p>
<dl><dt>Order.Statistics</dt>
<dd><p>numeric vector of the “ordered” observations.</p></dd>

  <dt>Cumulative.Probabilities</dt>
<dd><p>numeric vector of the associated plotting positions.</p></dd>

  <dt>Censored</dt>
<dd><p>logical vector indicating which of the ordered observations are censored.</p></dd>

  <dt>Censoring.Side</dt>
<dd><p>character string indicating whether the data are left- or right-censored.
    This is same value as the argument <code>censoring.side</code>.</p></dd>

  <dt>Prob.Method</dt>
<dd><p>character string indicating what method was used to compute the plotting positions.
    This is the same value as the argument <code>prob.method</code>.</p></dd>


</dl><p>Optional Component (only present when <code>prob.method="michael-schucany"</code> or <br><code>prob.method="hirsch-stedinger"</code>):</p>
<dl><dt>Plot.Pos.Con</dt>
<dd><p>numeric scalar containing the value of the plotting position constant that was used.
    This is the same as the argument <code>plot.pos.con</code>.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Chambers, J.M., W.S. Cleveland, B. Kleiner, and P.A. Tukey. (1983).
  <em>Graphical Methods for Data Analysis</em>. Duxbury Press, Boston, MA, pp.11-16.</p>
<p>Cleveland, W.S. (1993). <em>Visualizing Data</em>. Hobart Press, Summit, New Jersey, 360pp.</p>
<p>D'Agostino, R.B. (1986a). Graphical Analysis.
  In: D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>.
  Marcel Dekker, New York, Chapter 2, pp.7-62.</p>
<p>Gillespie, B.W., Q. Chen, H. Reichert, A. Franzblau, E. Hedgeman, J. Lepkowski,
  P. Adriaens, A. Demond, W. Luksemburg, and D.H. Garabrant. (2010).  Estimating Population
  Distributions When Some Data Are Below a Limit of Detection by Using a Reverse
  Kaplan-Meier Estimator.  <em>Epidemiology</em> <b>21</b>(4), S64–S70.</p>
<p>Helsel, D.R. (2012). <em>Statistics for Censored Environmental Data Using Minitab and R,
  Second Edition</em>.  John Wiley &amp; Sons, Hoboken, New Jersey.</p>
<p>Helsel, D.R., and T.A. Cohn. (1988). Estimation of Descriptive Statistics for Multiply Censored
  Water Quality Data. <em>Water Resources Research</em> <b>24</b>(12), 1997-2004.</p>
<p>Hirsch, R.M., and J.R. Stedinger. (1987). Plotting Positions for Historical Floods and Their Precision.
  <em>Water Resources Research</em> <b>23</b>(4), 715-727.</p>
<p>Kaplan, E.L., and P. Meier. (1958). Nonparametric Estimation From Incomplete Observations.
  <em>Journal of the American Statistical Association</em> <b>53</b>, 457-481.</p>
<p>Lee, E.T., and J. Wang. (2003). <em>Statistical Methods for Survival Data Analysis,
  Third Edition</em>.  John Wiley and Sons, New York.</p>
<p>Michael, J.R., and W.R. Schucany. (1986). Analysis of Data from Censored Samples.
  In D'Agostino, R.B., and M.A. Stephens, eds. <em>Goodness-of Fit Techniques</em>.
  Marcel Dekker, New York, 560pp, Chapter 11, 461-496.</p>
<p>Nelson, W. (1972). Theory and Applications of Hazard Plotting for Censored Failure Data.
  <em>Technometrics</em> <b>14</b>, 945-966.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C. Chapter 15.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>For censored data sets, plotting positions may be used to construct empirical cumulative distribution
  plots (see <code><a href="ecdfPlotCensored.html">ecdfPlotCensored</a></code>), construct quantile-quantile plots
  (see <code><a href="qqPlotCensored.html">qqPlotCensored</a></code>), or to estimate distribution parameters
  (see <code><a href="FcnsByCatCensoredData.html">FcnsByCatCensoredData</a></code>).</p>
<p>The function <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></code> in the built-in <span style="R">R</span> library
  <span class="pkg">survival</span> computes the survival function for right-censored, left-censored, or
  interval-censored data.  Calling <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></code> with
  <code>type="kaplan-meier"</code> will produce similar results to calling
  <code>ppointsCensored</code> with <code>prob.method="kaplan-meier"</code>.  Also, calling
  <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></code> with <code>type="fh2"</code> will produce similar results
  to calling <code>ppointsCensored</code> with <code>prob.method="nelson"</code>.</p>
<p>Helsel and Cohn (1988, p.2001) found very little effect of changing the value of the plotting position
  constant when using the method of Hirsch and Stedinger (1987) to compute plotting positions for
  multiply left-censored data.  In general, there will be very little difference between plotting positions
  computed by the different methods except in the case of very small samples and a large amount of
  censoring.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></code>, <code><a href="ecdfPlot.html">ecdfPlot</a></code>, <code><a href="qqPlot.html">qqPlot</a></code>,
  <code><a href="ecdfPlotCensored.html">ecdfPlotCensored</a></code>, <code><a href="qqPlotCensored.html">qqPlotCensored</a></code>,
  <code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a normal distribution with mean=20 and sd=5,</span></span></span>
<span class="r-in"><span>  <span class="co"># censor all observations less than 18, then compute plotting positions for</span></span></span>
<span class="r-in"><span>  <span class="co"># this data set.  Compare the plotting positions to the plotting positions</span></span></span>
<span class="r-in"><span>  <span class="co"># for the uncensored data set.  Note that the plotting positions for the</span></span></span>
<span class="r-in"><span>  <span class="co"># censored data set start at the first ordered uncensored observation and</span></span></span>
<span class="r-in"><span>  <span class="co"># that for values of x &gt; 18 the plotting positions for the two data sets are</span></span></span>
<span class="r-in"><span>  <span class="co"># exactly the same. This is because there is only one censoring level and</span></span></span>
<span class="r-in"><span>  <span class="co"># no uncensored observations fall below the censored observations.</span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean<span class="op">=</span><span class="fl">20</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">censored</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">18</span></span></span>
<span class="r-in"><span>  <span class="va">censored</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-in"><span>  <span class="co"># [1] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#[13] FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">censored</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-in"><span>  <span class="co">#[1] 7</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">new.x</span> <span class="op">&lt;-</span> <span class="va">x</span></span></span>
<span class="r-in"><span>  <span class="va">new.x</span><span class="op">[</span><span class="va">censored</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">18</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">new.x</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 18.0 18.0 18.0 18.0 18.0 18.0 18.0 18.1 18.7 19.6 20.2 20.3 20.6 21.4 21.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 21.8 23.2 26.2 26.8 29.7</span>
<span class="r-in"><span>  <span class="co"># [1] 18.0 18.0 18.0 18.0 18.0 18.0 18.0 18.1 18.7 19.6 20.2 20.3 20.6 21.4</span></span></span>
<span class="r-in"><span>  <span class="co">#[15] 21.8 21.8 23.2 26.2 26.8 29.7</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.list</span> <span class="op">&lt;-</span> <span class="fu">ppointsCensored</span><span class="op">(</span><span class="va">new.x</span>, <span class="va">censored</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">p.list</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Order.Statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 18.00000 18.00000 18.00000 18.00000 18.00000 18.00000 18.00000 18.09771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 18.65418 19.58594 20.21931 20.26851 20.55296 21.38869 21.76359 21.82364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 23.16804 26.16527 26.84336 29.67340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Cumulative.Probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.3765432 0.4259259 0.4753086 0.5246914 0.5740741 0.6234568 0.6728395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 0.7222222 0.7716049 0.8209877 0.8703704 0.9197531 0.9691358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Censoring.Side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Prob.Method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "michael-schucany"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Plot.Pos.Con</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$Order.Statistics</span></span></span>
<span class="r-in"><span>  <span class="co"># [1] 18.00000 18.00000 18.00000 18.00000 18.00000 18.00000 18.00000 18.09771</span></span></span>
<span class="r-in"><span>  <span class="co"># [9] 18.65418 19.58594 20.21931 20.26851 20.55296 21.38869 21.76359 21.82364</span></span></span>
<span class="r-in"><span>  <span class="co">#[17] 23.16804 26.16527 26.84336 29.67340</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$Cumulative.Probabilities</span></span></span>
<span class="r-in"><span>  <span class="co"># [1] 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432 0.3765432</span></span></span>
<span class="r-in"><span>  <span class="co"># [8] 0.3765432 0.4259259 0.4753086 0.5246914 0.5740741 0.6234568 0.6728395</span></span></span>
<span class="r-in"><span>  <span class="co">#[15] 0.7222222 0.7716049 0.8209877 0.8703704 0.9197531 0.9691358</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$Censored</span></span></span>
<span class="r-in"><span>  <span class="co"># [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#[13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$Censoring.Side</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] "left"</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$Prob.Method</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] "michael-schucany"</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$Plot.Pos.Con</span></span></span>
<span class="r-in"><span>  <span class="co">#[1] 0.375</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Round off plotting positions to two decimal places</span></span></span>
<span class="r-in"><span>  <span class="co"># and compare to plotting positions that ignore censoring</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p.list</span><span class="op">$</span><span class="va">Cum</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.43 0.48 0.52 0.57 0.62 0.67 0.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 0.77 0.82 0.87 0.92 0.97</span>
<span class="r-in"><span>  <span class="co"># [1] 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.38 0.43 0.48 0.52 0.57 0.62 0.67</span></span></span>
<span class="r-in"><span>  <span class="co">#[15] 0.72 0.77 0.82 0.87 0.92 0.97</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></span><span class="op">(</span><span class="va">x</span>, a<span class="op">=</span><span class="fl">0.375</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.03 0.08 0.13 0.18 0.23 0.28 0.33 0.38 0.43 0.48 0.52 0.57 0.62 0.67 0.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 0.77 0.82 0.87 0.92 0.97</span>
<span class="r-in"><span>  <span class="co"># [1] 0.03 0.08 0.13 0.18 0.23 0.28 0.33 0.38 0.43 0.48 0.52 0.57 0.62 0.67</span></span></span>
<span class="r-in"><span>  <span class="co">#[15] 0.72 0.77 0.82 0.87 0.92 0.97</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, <span class="va">new.x</span>, <span class="va">p.list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Reproduce the example in Appendix B of Helsel and Cohn (1988).  The data</span></span></span>
<span class="r-in"><span>  <span class="co"># are stored in Helsel.Cohn.88.appb.df.  This data frame contains 18</span></span></span>
<span class="r-in"><span>  <span class="co"># observations, of which 9 are censored below one of 2 distinct censoring</span></span></span>
<span class="r-in"><span>  <span class="co"># levels.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Helsel.Cohn.88.app.b.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Conc.orig Conc Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         &lt;1    1     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         &lt;1    1     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         &lt;1    1     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         &lt;1    1     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         &lt;1    1     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         &lt;1    1     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          3    3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          7    7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          9    9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       &lt;10   10     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       &lt;10   10     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       &lt;10   10     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13        12   12    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14        15   15    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15        20   20    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16        27   27    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17        33   33    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18        50   50    FALSE</span>
<span class="r-in"><span>  <span class="co">#   Conc.orig Conc Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#1         &lt;1    1     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#2         &lt;1    1     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#17        33   33    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#18        50   50    FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Helsel.Cohn.88.app.b.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">ppointsCensored</span><span class="op">(</span><span class="va">Conc</span>, <span class="va">Censored</span>, prob.method<span class="op">=</span><span class="st">"hirsch-stedinger"</span>, plot.pos.con<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">p.list</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Order.Statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  1  1  1  1  1  3  7  9 10 10 10 12 15 20 27 33 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Cumulative.Probabilities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.063 0.127 0.190 0.254 0.317 0.381 0.500 0.556 0.611 0.167 0.333 0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.714 0.762 0.810 0.857 0.905 0.952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>  <span class="co">#$Order.Statistics</span></span></span>
<span class="r-in"><span>  <span class="co"># [1]  1  1  1  1  1  1  3  7  9 10 10 10 12 15 20 27 33 50</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#$Cumulative.Probabilities</span></span></span>
<span class="r-in"><span>  <span class="co"># [1] 0.063 0.127 0.190 0.254 0.317 0.381 0.500 0.556 0.611 0.167 0.333 0.500</span></span></span>
<span class="r-in"><span>  <span class="co">#[13] 0.714 0.762 0.810 0.857 0.905 0.952</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">p.list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example 15-1 of USEPA (2009, page 15-10) gives an example of</span></span></span>
<span class="r-in"><span>  <span class="co"># computing plotting positions based on censored manganese</span></span></span>
<span class="r-in"><span>  <span class="co"># concentrations (ppb) in groundwater collected at 5 monitoring</span></span></span>
<span class="r-in"><span>  <span class="co"># wells.  The data for this example are stored in</span></span></span>
<span class="r-in"><span>  <span class="co"># EPA.09.Ex.15.1.manganese.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.09.Ex.15.1.manganese.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample   Well Manganese.Orig.ppb Manganese.ppb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 Well.1                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       2 Well.1               12.1          12.1    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       3 Well.1               16.9          16.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       4 Well.1               21.6          21.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       5 Well.1                 &lt;2           2.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1 Well.2                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       2 Well.2                7.7           7.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       3 Well.2               53.6          53.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       4 Well.2                9.5           9.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      5 Well.2               45.9          45.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      1 Well.3                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      2 Well.3                5.3           5.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      3 Well.3               12.6          12.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      4 Well.3              106.3         106.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      5 Well.3               34.5          34.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      1 Well.4                6.3           6.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      2 Well.4               11.9          11.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      3 Well.4                 10          10.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      4 Well.4                 &lt;2           2.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      5 Well.4               77.2          77.2    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      1 Well.5               17.9          17.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      2 Well.5               22.7          22.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      3 Well.5                3.3           3.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      4 Well.5                8.4           8.4    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      5 Well.5                 &lt;2           2.0     TRUE</span>
<span class="r-in"><span>  <span class="co">#   Sample   Well Manganese.Orig.ppb Manganese.ppb Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#1       1 Well.1                 &lt;5           5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#2       2 Well.1               12.1          12.1    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#3       3 Well.1               16.9          16.9    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#4       4 Well.1               21.6          21.6    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#5       5 Well.1                 &lt;2           2.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#21      1 Well.5               17.9          17.9    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#22      2 Well.5               22.7          22.7    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#23      3 Well.5                3.3           3.3    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#24      4 Well.5                8.4           8.4    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#25      5 Well.5                 &lt;2           2.0     TRUE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.list.EPA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.15.1.manganese.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">ppointsCensored</span><span class="op">(</span><span class="va">Manganese.ppb</span>, <span class="va">Censored</span>,</span></span>
<span class="r-in"><span>      prob.method <span class="op">=</span> <span class="st">"kaplan-meier"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Mn <span class="op">=</span> <span class="va">p.list.EPA</span><span class="op">$</span><span class="va">Order.Statistics</span>, Censored <span class="op">=</span> <span class="va">p.list.EPA</span><span class="op">$</span><span class="va">Censored</span>,</span></span>
<span class="r-in"><span>    CDF <span class="op">=</span> <span class="va">p.list.EPA</span><span class="op">$</span><span class="va">Cumulative.Probabilities</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Mn Censored  CDF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2.0     TRUE 0.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2.0     TRUE 0.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    2.0     TRUE 0.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    3.3    FALSE 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    5.0     TRUE 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    5.0     TRUE 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    5.0     TRUE 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    5.3    FALSE 0.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    6.3    FALSE 0.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   7.7    FALSE 0.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   8.4    FALSE 0.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   9.5    FALSE 0.48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  10.0    FALSE 0.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  11.9    FALSE 0.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  12.1    FALSE 0.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  12.6    FALSE 0.64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  16.9    FALSE 0.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  17.9    FALSE 0.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  21.6    FALSE 0.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  22.7    FALSE 0.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  34.5    FALSE 0.84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  45.9    FALSE 0.88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  53.6    FALSE 0.92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  77.2    FALSE 0.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 106.3    FALSE 1.00</span>
<span class="r-in"><span>  <span class="co">#      Mn Censored  CDF</span></span></span>
<span class="r-in"><span>  <span class="co">#1    2.0     TRUE 0.21</span></span></span>
<span class="r-in"><span>  <span class="co">#2    2.0     TRUE 0.21</span></span></span>
<span class="r-in"><span>  <span class="co">#3    2.0     TRUE 0.21</span></span></span>
<span class="r-in"><span>  <span class="co">#4    3.3    FALSE 0.28</span></span></span>
<span class="r-in"><span>  <span class="co">#5    5.0     TRUE 0.28</span></span></span>
<span class="r-in"><span>  <span class="co">#6    5.0     TRUE 0.28</span></span></span>
<span class="r-in"><span>  <span class="co">#7    5.0     TRUE 0.28</span></span></span>
<span class="r-in"><span>  <span class="co">#8    5.3    FALSE 0.32</span></span></span>
<span class="r-in"><span>  <span class="co">#9    6.3    FALSE 0.36</span></span></span>
<span class="r-in"><span>  <span class="co">#10   7.7    FALSE 0.40</span></span></span>
<span class="r-in"><span>  <span class="co">#11   8.4    FALSE 0.44</span></span></span>
<span class="r-in"><span>  <span class="co">#12   9.5    FALSE 0.48</span></span></span>
<span class="r-in"><span>  <span class="co">#13  10.0    FALSE 0.52</span></span></span>
<span class="r-in"><span>  <span class="co">#14  11.9    FALSE 0.56</span></span></span>
<span class="r-in"><span>  <span class="co">#15  12.1    FALSE 0.60</span></span></span>
<span class="r-in"><span>  <span class="co">#16  12.6    FALSE 0.64</span></span></span>
<span class="r-in"><span>  <span class="co">#17  16.9    FALSE 0.68</span></span></span>
<span class="r-in"><span>  <span class="co">#18  17.9    FALSE 0.72</span></span></span>
<span class="r-in"><span>  <span class="co">#19  21.6    FALSE 0.76</span></span></span>
<span class="r-in"><span>  <span class="co">#20  22.7    FALSE 0.80</span></span></span>
<span class="r-in"><span>  <span class="co">#21  34.5    FALSE 0.84</span></span></span>
<span class="r-in"><span>  <span class="co">#22  45.9    FALSE 0.88</span></span></span>
<span class="r-in"><span>  <span class="co">#23  53.6    FALSE 0.92</span></span></span>
<span class="r-in"><span>  <span class="co">#24  77.2    FALSE 0.96</span></span></span>
<span class="r-in"><span>  <span class="co">#25 106.3    FALSE 1.00</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">p.list.EPA</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

