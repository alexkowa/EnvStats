<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Table of Confidence Intervals for Proportion or Difference Between Two Proportions — ciTableProp • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Table of Confidence Intervals for Proportion or Difference Between Two Proportions — ciTableProp"><meta property="og:description" content='Create a table of confidence intervals for probability of "success" for a
  binomial distribution or the difference between two proportions following
  Bacchetti (2010), by varying the estimated proportion or differene between
  the two estimated proportions given the sample size(s).'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Table of Confidence Intervals for Proportion or Difference Between Two Proportions</h1>

    <div class="hidden name"><code>ciTableProp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a table of confidence intervals for probability of "success" for a
  binomial distribution or the difference between two proportions following
  Bacchetti (2010), by varying the estimated proportion or differene between
  the two estimated proportions given the sample size(s).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ciTableProp</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">10</span>, p1.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span>, n2 <span class="op">=</span> <span class="va">n1</span>, </span>
<span>    p2.hat.minus.p1.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span>, sample.type <span class="op">=</span> <span class="st">"two.sample"</span>, </span>
<span>    ci.type <span class="op">=</span> <span class="st">"two.sided"</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, digits <span class="op">=</span> <span class="fl">2</span>, ci.method <span class="op">=</span> <span class="st">"score"</span>, </span>
<span>    correct <span class="op">=</span> <span class="cn">TRUE</span>, tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="op">(</span><span class="va">digits</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-n-">n1<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>positive integer greater than 1 specifying the sample size when <br><code>sample.type="one.sample"</code> or the sample size for group 1 when <br><code>sample.type="two.sample"</code>.  The default value is <code>n1=10</code>.</p></dd>

  <dt id="arg-p-hat">p1.hat<a class="anchor" aria-label="anchor" href="#arg-p-hat"></a></dt>
<dd><p>numeric vector of values between 0 and 1 indicating the estimated proportion
  (<code>sample.type="one.sample"</code>) or the estimated proportion for group 1 <br>
  (<code>sample.type="two.sample"</code>).  The default value is <code>c(0.1, 0.2, 0.3)</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), an infinite
  (<code>-Inf</code>, <code>Inf</code>) values are not allowed.</p></dd>

  <dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>positive integer greater than 1 specifying the sample size for group 2 when
  <code>sample.type="two.sample"</code>.  The default value is <code>n2=n1</code>, i.e.,
  equal sample sizes.  This argument is ignored when <code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-p-hat-minus-p-hat">p2.hat.minus.p1.hat<a class="anchor" aria-label="anchor" href="#arg-p-hat-minus-p-hat"></a></dt>
<dd><p>numeric vector indicating the assumed difference between the two sample proportions
  when <code>sample.type="two.sample"</code>.  The default value is <code>c(0.2, 0.1, 0)</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), an infinite
  (<code>-Inf</code>, <code>Inf</code>) values are not allowed.  This argument is ignored when
  <code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string specifying whether to create confidence intervals for the difference
  between two proportions (<code>sample.type="two.sample"</code>; the default) or confidence
  intervals for a single proportion (<code>sample.type="one.sample"</code>).</p></dd>

  <dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>character string indicating what kind of confidence interval to compute.  The
  possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
  The default value is <code>conf.level=0.95</code>.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>positive integer indicating how many decimal places to display in the table.  The
  default value is <code>digits=2</code>.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating the method to use to construct the confidence interval.
  The default value is <code>ci.method="score"</code> (i.e., the score method; see the
  help file for <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>), which is the only method available when <br><code>sample.type="two.sample"</code>.  When <code>sample.type="one.sample"</code>, you may
  also set <code>ci.method="exact"</code> (i.e., the exact method).</p></dd>

  <dt id="arg-correct">correct<a class="anchor" aria-label="anchor" href="#arg-correct"></a></dt>
<dd><p>logical scalar indicating whether to use the correction for continuity when <br><code>ci.method="score"</code> (see the help file for <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>).  The
  default value is <code>correct=TRUE</code>.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numeric scalar indicating how close the values of the adjusted elements of <br><code>p2.hat.minus.p1.hat</code> have to be in order to provide a simply display
  of confidence intervals (see DETAILS section below).  The default value is <br><code>tol=10^-(digits + 1)</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><em>One-Sample Case</em> (<code>sample.type="one.sample"</code>) <br>
  For the one-sample case, the function <code>ciTableProp</code> calls the <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code> when <br><code>ci.method="score"</code>, and calls the <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>, when <code>ci.method="exact"</code>.  To ensure that the
  user-supplied values of <code>p1.hat</code> are valid for the given user-supplied values
  of <code>n1</code>, values for the argument <code>x</code> to the function
  <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code> or <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code> are computed using the formula</p>
<p><code>x &lt;- unique(round((p1.hat * n1), 0))</code></p>
<p>and the argument <code>p.hat</code> is then adjusted using the formula</p>
<p><code>p.hat &lt;- x/n1</code>
  <br></p>
<p><em>Two-Sample Case</em> (<code>sample.type="two.sample"</code>) <br>
  For the two-sample case, the function <code>ciTableProp</code> calls the <span style="R">R</span> function
  <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>.  To ensure that the user-supplied values of <code>p1.hat</code>
  are valid for the given user-supplied values of <code>n1</code>, the values for the
  first component of the argument <code>x</code> to the function
  <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code> are computed using the formula</p>
<p><code>x1 &lt;- unique(round((p1.hat * n1), 0))</code> <br></p>
<p>and the argument <code>p1.hat</code> is then adjusted using the formula</p>
<p><code>p1.hat &lt;- x1/n1</code></p>
<p>Next, the estimated proportions from group 2 are computed by adding together all
  possible combinations from the elements of <code>p1.hat</code> and
  <code>p2.hat.minus.p1.hat</code>.  These estimated proportions from group 2 are then
  adjusted using the formulas:</p>
<p><code>x2.rep &lt;- round((p2.hat.rep * n2), 0)</code> <br><code>p2.hat.rep &lt;- x2.rep/n2</code></p>
<p>If any of these adjusted proportions from group 2 are \(\le 0\) or \(\ge 1\)
  the function terminates with a message indicating that impossible
  values have been supplied.</p>
<p>In cases where the sample sizes are small there may be instances where the
  user-supplied values of <code>p1.hat</code> and/or <code>p2.hat.minus.p1.hat</code> are not
  attainable.  The argument <code>tol</code> is used to determine whether to return
  the table in conventional form or whether it is necessary to modify the table
  to include twice as many columns (see EXAMPLES section below).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a data frame with elements that are character strings indicating the
  confidence intervals.</p>
<p>When <code>sample.type="two.sample"</code>, a data frame with the rows varying
  the estimated proportion for group 1 (i.e., the values of <code>p1.hat</code>) and
  the columns varying the estimated difference between the proportions from
  group 2 and group 1 (i.e., the values of <code>p2.hat.minus.p1.hat</code>).  In cases
  where the sample sizes are small, it may not be possible to obtain certain
  differences for given values of <code>p1.hat</code>, in which case the returned
  data frame contains twice as many columns indicating the actual difference
  in one column and the compute confidence interval next to it (see EXAMPLES
  section below).</p>
<p>When <code>sample.type="one.sample"</code>, a 1-row data frame with the columns
  varying the estimated proportion (i.e., the values of <code>p1.hat</code>).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bacchetti, P. (2010).  Current sample size conventions: Flaws, Harms, and
    Alternatives.  <em>BMC Medicine</em> <b>8</b>, 17–23.</p>
<p>Also see the references in the help files for <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code> and
  <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Bacchetti (2010) presents strong arguments against the current convention in
  scientific research for computing sample size that is based on formulas that
  use a fixed Type I error (usually 5%) and a fixed minimal power (often 80%)
  without regard to costs.  He notes that a key input to these formulas is a
  measure of variability (usually a standard deviation) that is difficult to
  measure accurately "unless there is so much preliminary data that the study
  isn't really needed."  Also, study designers often avoid defining what a
  scientifically meaningful difference is by presenting sample size results in
  terms of the effect size (i.e., the difference of interest divided by the
  elusive standard deviation).  Bacchetti (2010) encourages study designers to use
  simple tables in a sensitivity analysis to see what results of a study may look
  like for low, moderate, and high rates of variability and large, intermediate,
  and no underlying differences in the populations or processes being studied.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>, <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>, <code><a href="ciTableMean.html">ciTableMean</a></code>,
  <code><a href="ciBinomHalfWidth.html">ciBinomHalfWidth</a></code>, <code><a href="ciBinomN.html">ciBinomN</a></code>,
  <code><a href="plotCiBinomDesign.html">plotCiBinomDesign</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Reproduce Table 1 in Bacchetti (2010).  This involves planning a study with </span></span></span>
<span class="r-in"><span>  <span class="co"># n1 = n2 = 935 subjects per group, where Group 1 is the control group and </span></span></span>
<span class="r-in"><span>  <span class="co"># Group 2 is the treatment group.  The outcome in the study is proportion of </span></span></span>
<span class="r-in"><span>  <span class="co"># subjects with serious outcomes or death.  A negative value for the difference </span></span></span>
<span class="r-in"><span>  <span class="co"># in proportions between groups (Group 2 proportion - Group 1 proportion) </span></span></span>
<span class="r-in"><span>  <span class="co"># indicates the treatment group has a better outcome.  In this table, the </span></span></span>
<span class="r-in"><span>  <span class="co"># proportion of subjects in Group 1 with serious outcomes or death is set </span></span></span>
<span class="r-in"><span>  <span class="co"># to 3%, 6.5%, and 12%, and the difference in proportions between the two </span></span></span>
<span class="r-in"><span>  <span class="co"># groups is set to -2.8 percentage points, -1.4 percentage points, and 0.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciTableProp</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">935</span>, p1.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.065</span>, <span class="fl">0.12</span><span class="op">)</span>, n2 <span class="op">=</span> <span class="fl">935</span>, </span></span>
<span class="r-in"><span>    p2.hat.minus.p1.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.028</span>, <span class="op">-</span><span class="fl">0.014</span>, <span class="fl">0</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Diff=-0.028      Diff=-0.014           Diff=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.030 [-0.040, -0.015] [-0.029,  0.001] [-0.015,  0.015]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.065 [-0.049, -0.007] [-0.036,  0.008] [-0.022,  0.022]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.120 [-0.057,  0.001] [-0.044,  0.016] [-0.029,  0.029]</span>
<span class="r-in"><span>  <span class="co">#                  Diff=-0.028      Diff=-0.014           Diff=0</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.030 [-0.040, -0.015] [-0.029,  0.001] [-0.015,  0.015]</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.065 [-0.049, -0.007] [-0.036,  0.008] [-0.022,  0.022]</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.120 [-0.057,  0.001] [-0.044,  0.016] [-0.029,  0.029]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Show how the returned data frame has to be modified for cases of small </span></span></span>
<span class="r-in"><span>  <span class="co"># sample sizes where not all user-supplied differenes are possible.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciTableProp</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">5</span>, n2 <span class="op">=</span> <span class="fl">5</span>, p1.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.12</span><span class="op">)</span>, p2.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Diff            CI Diff            CI Diff            CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.4  0.2 [-0.61, 1.00]  0.0 [-0.61, 0.61]    0 [-0.61, 0.61]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.6  0.2 [-0.55, 0.95]  0.2 [-0.55, 0.95]    0 [-0.61, 0.61]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.2  0.2 [-0.55, 0.95]  0.2 [-0.55, 0.95]    0 [-0.50, 0.50]</span>
<span class="r-in"><span>  <span class="co">#           Diff            CI Diff            CI Diff            CI</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.4  0.2 [-0.61, 1.00]  0.0 [-0.61, 0.61]    0 [-0.61, 0.61]</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.6  0.2 [-0.55, 0.95]  0.2 [-0.55, 0.95]    0 [-0.61, 0.61]</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.2  0.2 [-0.55, 0.95]  0.2 [-0.55, 0.95]    0 [-0.50, 0.50]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Suppose we are planning a study to compare the proportion of nondetects at </span></span></span>
<span class="r-in"><span>  <span class="co"># a background and downgradient well, and we can use ciTableProp to look how </span></span></span>
<span class="r-in"><span>  <span class="co"># the confidence interval for the difference between the two proportions using </span></span></span>
<span class="r-in"><span>  <span class="co"># say 36 quarterly samples at each well varies with the observed estimated </span></span></span>
<span class="r-in"><span>  <span class="co"># proportions.  Here we'll let the argument "p1.hat" denote the proportion of </span></span></span>
<span class="r-in"><span>  <span class="co"># nondetects observed at the downgradient well and set this equal to </span></span></span>
<span class="r-in"><span>  <span class="co"># 20%, 40% and 60%.  The argument "p2.hat.minus.p1.hat" represents the proportion </span></span></span>
<span class="r-in"><span>  <span class="co"># of nondetects at the background well minus the proportion of nondetects at the </span></span></span>
<span class="r-in"><span>  <span class="co"># downgradient well.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ciTableProp</span><span class="op">(</span>n1 <span class="op">=</span> <span class="fl">36</span>, p1.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span>, n2 <span class="op">=</span> <span class="fl">36</span>, </span></span>
<span class="r-in"><span>    p2.hat.minus.p1.hat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Diff=0.31     Diff=0.14        Diff=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.19 [ 0.07, 0.54] [-0.09, 0.37] [-0.18, 0.18]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.39 [ 0.06, 0.55] [-0.12, 0.39] [-0.23, 0.23]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P1.hat=0.61 [ 0.09, 0.52] [-0.10, 0.38] [-0.23, 0.23]</span>
<span class="r-in"><span>  <span class="co">#                Diff=0.31     Diff=0.14        Diff=0</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.19 [ 0.07, 0.54] [-0.09, 0.37] [-0.18, 0.18]</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.39 [ 0.06, 0.55] [-0.12, 0.39] [-0.23, 0.23]</span></span></span>
<span class="r-in"><span>  <span class="co">#P1.hat=0.61 [ 0.09, 0.52] [-0.10, 0.38] [-0.23, 0.23]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We see that even if the observed difference in the proportion of nondetects </span></span></span>
<span class="r-in"><span>  <span class="co"># is about 15 percentage points, all of the confidence intervals for the </span></span></span>
<span class="r-in"><span>  <span class="co"># difference between the proportions of nondetects at the two wells contain 0, </span></span></span>
<span class="r-in"><span>  <span class="co"># so if a difference of 15 percentage points is important to substantiate, we </span></span></span>
<span class="r-in"><span>  <span class="co"># may need to increase our sample sizes.</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

