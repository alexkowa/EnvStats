<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plots for Sampling Design Based on Confidence Interval for Binomial Proportion or Difference Between Two Proportions — plotCiBinomDesign • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plots for Sampling Design Based on Confidence Interval for Binomial Proportion or Difference Between Two Proportions — plotCiBinomDesign"><meta property="og:description" content="Create plots for a sampling design based on a confidence interval for
  a binomial proportion or the difference between two proportions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots for Sampling Design Based on Confidence Interval for Binomial Proportion or Difference Between Two Proportions</h1>

    <div class="hidden name"><code>plotCiBinomDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create plots for a sampling design based on a confidence interval for
  a binomial proportion or the difference between two proportions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotCiBinomDesign</span><span class="op">(</span>x.var <span class="op">=</span> <span class="st">"n"</span>, y.var <span class="op">=</span> <span class="st">"half.width"</span>, </span>
<span>    range.x.var <span class="op">=</span> <span class="cn">NULL</span>, n.or.n1 <span class="op">=</span> <span class="fl">25</span>, p.hat.or.p1.hat <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    n2 <span class="op">=</span> <span class="va">n.or.n1</span>, p2.hat <span class="op">=</span> <span class="fl">0.4</span>, ratio <span class="op">=</span> <span class="fl">1</span>, half.width <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>    conf.level <span class="op">=</span> <span class="fl">0.95</span>, sample.type <span class="op">=</span> <span class="st">"one.sample"</span>, ci.method <span class="op">=</span> <span class="st">"score"</span>, </span>
<span>    correct <span class="op">=</span> <span class="cn">TRUE</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, n.or.n1.min <span class="op">=</span> <span class="fl">2</span>, </span>
<span>    n.or.n1.max <span class="op">=</span> <span class="fl">10000</span>, tol.half.width <span class="op">=</span> <span class="fl">0.005</span>, tol.p.hat <span class="op">=</span> <span class="fl">0.005</span>, </span>
<span>    maxiter <span class="op">=</span> <span class="fl">10000</span>, plot.it <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, n.points <span class="op">=</span> <span class="fl">100</span>, </span>
<span>    plot.col <span class="op">=</span> <span class="fl">1</span>, plot.lwd <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>, plot.lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    digits <span class="op">=</span> <span class="va">.Options</span><span class="op">$</span><span class="va">digits</span>, </span>
<span>    main <span class="op">=</span> <span class="cn">NULL</span>, xlab <span class="op">=</span> <span class="cn">NULL</span>, ylab <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"l"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x-var">x.var<a class="anchor" aria-label="anchor" href="#arg-x-var"></a></dt>
<dd><p>character string indicating what variable to use for the x-axis.  Possible values are
  <code>"n"</code> (sample size; the default),
  <code>"half.width"</code> (the half-width of the confidence interval),
  <code>"p.hat"</code> (the estimated probability of “success”), and
  <code>"conf.level"</code> (the confidence level).</p></dd>

  <dt id="arg-y-var">y.var<a class="anchor" aria-label="anchor" href="#arg-y-var"></a></dt>
<dd><p>character string indicating what variable to use for the y-axis.  Possible values are
  <code>"half.width"</code> (the half-width of the confidence interval; the default), and
  <code>"n"</code> (sample size).</p></dd>

  <dt id="arg-range-x-var">range.x.var<a class="anchor" aria-label="anchor" href="#arg-range-x-var"></a></dt>
<dd><p>numeric vector of length 2 indicating the range of the x-variable to use for the plot.
  The default value depends on the value of <code>x.var</code>.  <br>
  When <code>x.var="n"</code> the default value is <code>c(10,50)</code>.  <br>
  When <code>x.var="half.width"</code>, the default value is <code>c(0.03, 0.1)</code>.  <br>
  When <code>x.var="p.hat"</code>, the default value is <code>c(0.5, 0.9)</code>.  <br>
  When <code>x.var="conf.level"</code>, the default value is <code>c(0.8, 0.99)</code>.</p></dd>

  <dt id="arg-n-or-n-">n.or.n1<a class="anchor" aria-label="anchor" href="#arg-n-or-n-"></a></dt>
<dd><p>numeric scalar indicating the sample size.  The default value is <code>n.or.n1=25</code>.
  When <code>sample.type="one.sample"</code>, <code>n.or.n1</code> denotes the number of observations
  in the single sample.  When <code>sample.type="two.sample"</code>, <code>n.or.n1</code> denotes the
  number of observations from group 1.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored if either <code>x.var="n"</code> or <code>y.var="n"</code>.</p></dd>

  <dt id="arg-p-hat-or-p-hat">p.hat.or.p1.hat<a class="anchor" aria-label="anchor" href="#arg-p-hat-or-p-hat"></a></dt>
<dd><p>numeric scalar indicating an estimated proportion.  <br>
  When <code>sample.type="one.sample"</code>, <code>p.hat.or.p1.hat</code> denotes the estimated value of
  \(p\), the probability of “success”.  <br>
  When <code>sample.type="two.sample"</code>, <code>p.hat.or.p1.hat</code> denotes the estimated value of
  \(p_1\), the probability of “success” in group 1.  <br>
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored if <code>x.var="p.hat"</code>.</p></dd>

  <dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>numeric scalar indicating the sample size for group 2.  The default value is the value of <code>n.or.n1</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored when <br><code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-p-hat">p2.hat<a class="anchor" aria-label="anchor" href="#arg-p-hat"></a></dt>
<dd><p>numeric scalar indicating the estimated proportion for group 2.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored if <code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-ratio">ratio<a class="anchor" aria-label="anchor" href="#arg-ratio"></a></dt>
<dd><p>numeric vector indicating the ratio of sample size in group 2 to sample size in group 1 (\(n_2/n_1\)).
  The default value is <code>ratio=1</code>.  All values of <code>ratio</code> must be greater than or equal to 1.
  This argument is only used when <br><code>sample.type="two.sample"</code> and either <code>x.var="n"</code> or <code>y.var="n"</code>.</p></dd>

  <dt id="arg-half-width">half.width<a class="anchor" aria-label="anchor" href="#arg-half-width"></a></dt>
<dd><p>positive numeric scalar indicating the half-width of the confidence interval.
  The default value is <code>half.width=0.05</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored if either <code>x.var="half.width"</code> or <code>y.var="half.width"</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a numeric scalar between 0 and 1 indicating the confidence level associated with the confidence intervals.
  The default value is <code>conf.level=0.95</code>.  This argument is ignored when
  <code>x.var="conf.level"</code>.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string indicating whether this is a one-sample or two-sample confidence interval.
  When <code>sample.type="one.sample"</code>, the computations for the plot are based on a confidence
  interval for a single proportion.  When <br><code>sample.type="two.sample"</code>, the computations for
  the plot are based on a confidence interval for the difference between two proportions.
  The default value is <code>sample.type="one.sample"</code> unless the arguments <code>n2</code>,
  <code>p2.hat</code>, and/or <code>ratio</code> are supplied.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating which method to use to construct the confidence interval.
  Possible values are <code>"score"</code> (the default), <code>"exact"</code>, <code>"adjusted Wald"</code>,
  and <code>"Wald"</code> (the <code>"Wald"</code> method is <strong>never</strong> recommended but is included
  for historical purposes).  The exact method is only available for the one-sample case, i.e.,
  when <code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-correct">correct<a class="anchor" aria-label="anchor" href="#arg-correct"></a></dt>
<dd><p>logical scalar indicating whether to use the continuity correction when <br><code>ci.method="score"</code> or <code>ci.method="Wald"</code>.  The default value is <br><code>correct=TRUE</code>.  This argument is ignored if <code>ci.method="exact"</code> or <br><code>ci.method="adjusted Wald"</code>.</p></dd>

  <dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical scalar indicating whether to issue a warning when <code>ci.method="Wald"</code>
  for cases when the normal approximation to the binomial distribution probably is not accurate.
  The default value is <code>warn=TRUE</code>.</p></dd>

  <dt id="arg-n-or-n-min">n.or.n1.min<a class="anchor" aria-label="anchor" href="#arg-n-or-n-min"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>,
  integer indicating the minimum allowed value for
  \(n\) (<code>sample.type="one.sample"</code>) or <br>
  \(n_1\) (<code>sample.type="two.sample"</code>).  <br>
  The default value is <code>n.or.n1.min=2</code>.</p></dd>

  <dt id="arg-n-or-n-max">n.or.n1.max<a class="anchor" aria-label="anchor" href="#arg-n-or-n-max"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>,
  integer indicating the maximum allowed value for
  \(n\) (<code>sample.type="one.sample"</code>) or <br>
  \(n_1\) (<code>sample.type="two.sample"</code>).  <br>
  The default value is <code>n.or.n1.max=10000</code>.</p></dd>

  <dt id="arg-tol-half-width">tol.half.width<a class="anchor" aria-label="anchor" href="#arg-tol-half-width"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>,
  numeric scalar indicating the tolerance to use for the half width for
  the search algorithm.  The sample sizes are computed so that the actual
  half width is less than or equal to <br><code>half.width + tol.half.width</code>.  The default value is <br><code>tol.half.width=0.005</code>.</p></dd>

  <dt id="arg-tol-p-hat">tol.p.hat<a class="anchor" aria-label="anchor" href="#arg-tol-p-hat"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>,
  numeric scalar indicating the tolerance to use for the estimated
  proportion(s) for the search algorithm.
  For the one-sample case, the sample sizes are computed so that
  the absolute value of the difference between the user supplied
  value of <code>p.hat.or.p1.hat</code> and the actual estimated proportion is
  less than or equal to <code>tol.p.hat</code>.
  For the two-sample case, the sample sizes are computed so that
  the absolute value of the difference between the user supplied
  value of <code>p.hat.or.p1.hat</code> and the actual estimated proportion
  for group 1 is less than or equal to <code>tol.p.hat</code>, and the
  absolute value of the difference between the user supplied
  value of <code>p2.hat</code> and the actual estimated proportion
  for group 2 is less than or equal to <code>tol.p.hat</code>.
  The default value is <code>tol.p.hat=0.005</code>.</p></dd>

  <dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>,
  integer indicating the maximum number of iterations to use for
  the search algorithm.  The default value is <code>maxiter=1000</code>.</p></dd>

  <dt id="arg-plot-it">plot.it<a class="anchor" aria-label="anchor" href="#arg-plot-it"></a></dt>
<dd><p>a logical scalar indicating whether to create a plot or add to the existing plot
  (see description of the argument <code>add</code> below) on the current graphics device.
  If <code>plot.it=FALSE</code>, no plot is produced, but a list of (x,y) values is returned
  (see the VALUE section below).  The default value is <code>plot.it=TRUE</code>.</p></dd>

  <dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>a logical scalar indicating whether to add the design plot to the existing plot
  (<code>add=TRUE</code>), or to create a plot from scratch (<code>add=FALSE</code>).
  The default value is <code>add=FALSE</code>.  This argument is ignored if <code>plot.it=FALSE</code>.</p></dd>

  <dt id="arg-n-points">n.points<a class="anchor" aria-label="anchor" href="#arg-n-points"></a></dt>
<dd><p>a numeric scalar specifying how many (x,y) pairs to use to produce the plot.
  There are <code>n.points</code> x-values evenly spaced between <code>range.x.var[1]</code> and <br><code>range.x.var[2]</code>.  The default value is <code>n.points=100</code>.  This argument is
  ignored when <code>x.var="n"</code>, in which case the x-values are all the integers between
  <code>range.x.var[1]</code> and <code>range.x.var[2]</code>.</p></dd>

  <dt id="arg-plot-col">plot.col<a class="anchor" aria-label="anchor" href="#arg-plot-col"></a></dt>
<dd><p>a numeric scalar or character string determining the color of the plotted line or points.  The default value
  is <code>plot.col=1</code>.  See the entry for <code>col</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-plot-lwd">plot.lwd<a class="anchor" aria-label="anchor" href="#arg-plot-lwd"></a></dt>
<dd><p>a numeric scalar determining the width of the plotted line.  The default value is
  <code>3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-plot-lty">plot.lty<a class="anchor" aria-label="anchor" href="#arg-plot-lty"></a></dt>
<dd><p>a numeric scalar determining the line type of the plotted line.  The default value is
  <code>plot.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>a scalar indicating how many significant digits to print out on the plot.  The default
  value is the current setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a>("digits")</code>.</p></dd>

  <dt id="arg-main-xlab-ylab-type-">main, xlab, ylab, type,...<a class="anchor" aria-label="anchor" href="#arg-main-xlab-ylab-type-"></a></dt>
<dd><p>additional graphical parameters (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>See the help files for <code><a href="ciBinomHalfWidth.html">ciBinomHalfWidth</a></code> and <code><a href="ciBinomN.html">ciBinomN</a></code>
  for information on how to compute a one-sample confidence interval for
  a single binomial proportion or a two-sample confidence interval for the difference between
  two proportions, how the half-width is computed when other quantities are fixed, and how
  the sample size is computed when other quantities are fixed.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>plotCiBinomDesign</code> invisibly returns a list with components:</p>
<p></p>
<dl><dt>x.var</dt>
<dd><p>x-coordinates of the points that have been or would have been plotted</p></dd>

  <dt>y.var</dt>
<dd><p>y-coordinates of the points that have been or would have been plotted</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Agresti, A., and B.A. Coull. (1998). Approximate is Better than "Exact" for Interval Estimation
  of Binomial Proportions. <em>The American Statistician</em>, <b>52</b>(2), 119–126.</p>
<p>Agresti, A., and B. Caffo. (2000). Simple and Effective Confidence Intervals for Proportions
  and Differences of Proportions Result from Adding Two Successes and Two Failures. <em>The
  American Statistician</em>, <b>54</b>(4), 280–288.</p>
<p>Berthouex, P.M., and L.C. Brown. (1994). <em>Statistics for Environmental Engineers</em>.
  Lewis Publishers, Boca Raton, FL, Chapters 2 and 15.</p>
<p>Cochran, W.G. (1977). <em>Sampling Techniques</em>. John Wiley and Sons, New York, Chapter 3.</p>
<p>Fisher, R.A., and F. Yates. (1963).
  <em>Statistical Tables for Biological, Agricultural, and Medical Research</em>. 6th edition.
  Hafner, New York, 146pp.</p>
<p>Fleiss, J. L. (1981). <em>Statistical Methods for Rates and Proportions</em>. Second Edition.
  John Wiley and Sons, New York, Chapters 1-2.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY, Chapter 11.</p>
<p>Newcombe, R.G. (1998a). Two-Sided Confidence Intervals for the Single Proportion:  Comparison of
  Seven Methods. <em>Statistics in Medicine</em>, <b>17</b>, 857–872.</p>
<p>Newcombe, R.G. (1998b). Interval Estimation for the Difference Between Independent Proportions:
  Comparison of Eleven Methods. <em>Statistics in Medicine</em>, <b>17</b>, 873–890.</p>
<p>Ott, W.R. (1995). <em>Environmental Statistics and Data Analysis</em>.
  Lewis Publishers, Boca Raton, FL, Chapter 4.</p>
<p>USEPA. (1989b). <em>Statistical Analysis of Ground-Water Monitoring Data at RCRA Facilities, Interim Final Guidance</em>.
  EPA/530-SW-89-026. Office of Solid Waste, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>. Fifth Edition.
  Prentice-Hall, Upper Saddle River, NJ, Chapter 24.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The binomial distribution is used to model processes with binary
  (Yes-No, Success-Failure, Heads-Tails, etc.) outcomes.  It is assumed that the outcome of any
  one trial is independent of any other trial, and that the probability of “success”, \(p\),
  is the same on each trial.  A binomial discrete random variable \(X\) is the number of
  “successes” in \(n\) independent trials.  A special case of the binomial distribution
  occurs when \(n=1\), in which case \(X\) is also called a Bernoulli random variable.</p>
<p>In the context of environmental statistics, the binomial distribution is sometimes used to model
  the proportion of times a chemical concentration exceeds a set standard in a given period of time
  (e.g., Gilbert, 1987, p.143), or to compare the proportion of detects in a compliance well vs. a
  background well (e.g., USEPA, 1989b, Chapter 8, p.3-7).  (However, USEPA 2009, p.8-27
  recommends using the Wilcoxon rank sum test (<code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></code>) instead of
  comparing proportions.)</p>
<p>In the course of designing a sampling program, an environmental scientist may wish to determine
  the relationship between sample size, confidence level, and half-width if one of the objectives of
  the sampling program is to produce confidence intervals.  The functions <code>ciBinomHalfWidth</code>,
  <code><a href="ciBinomN.html">ciBinomN</a></code>, and <code>plotCiBinomDesign</code> can be used to investigate these
  relationships for the case of binomial proportions.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ciBinomHalfWidth.html">ciBinomHalfWidth</a></code>, <code><a href="ciBinomN.html">ciBinomN</a></code>,
  <code><a href="ebinom.html">ebinom</a></code>, <code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>, <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code>,
  <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at the relationship between half-width and sample size </span></span></span>
<span class="r-in"><span>  <span class="co"># for a one-sample confidence interval for a binomial proportion, </span></span></span>
<span class="r-in"><span>  <span class="co"># assuming an estimated proportion of 0.5 and a confidence level of </span></span></span>
<span class="r-in"><span>  <span class="co"># 95%.  The jigsaw appearance of the plot is the result of using the </span></span></span>
<span class="r-in"><span>  <span class="co"># score method:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiBinomDesign</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Redo the example above, but use the traditional (and inaccurate)</span></span></span>
<span class="r-in"><span>  <span class="co"># Wald method.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiBinomDesign</span><span class="op">(</span>ci.method <span class="op">=</span> <span class="st">"Wald"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot sample size vs. the estimated proportion for various half-widths, </span></span></span>
<span class="r-in"><span>  <span class="co"># using a 95% confidence level and the adjusted Wald method:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># NOTE:  This example takes several seconds to run so it has been </span></span></span>
<span class="r-in"><span>  <span class="co">#        commented out.  Simply remove the pound signs (#) from in front </span></span></span>
<span class="r-in"><span>  <span class="co">#        of the R commands to run it.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#dev.new()</span></span></span>
<span class="r-in"><span>  <span class="co">#plotCiBinomDesign(x.var = "p.hat", y.var = "n", </span></span></span>
<span class="r-in"><span>  <span class="co">#    half.width = 0.04, ylim = c(0, 600), main = "",</span></span></span>
<span class="r-in"><span>  <span class="co">#    xlab = expression(hat(p))) </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#plotCiBinomDesign(x.var = "p.hat", y.var = "n", </span></span></span>
<span class="r-in"><span>  <span class="co">#    half.width = 0.05, add = TRUE, plot.col = 2) </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#plotCiBinomDesign(x.var = "p.hat", y.var = "n", </span></span></span>
<span class="r-in"><span>  <span class="co">#    half.width = 0.06, add = TRUE, plot.col = 3) </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#legend(0.5, 150, paste("Half-Width =", c(0.04, 0.05, 0.06)), </span></span></span>
<span class="r-in"><span>  <span class="co">#    lty = rep(1, 3), lwd = rep(2, 3), col=1:3, bty = "n") </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#mtext(expression(paste("Sample Size vs. ", hat(p), </span></span></span>
<span class="r-in"><span>  <span class="co">#  " for Confidence Interval for p")), line = 2.5, cex = 1.25)</span></span></span>
<span class="r-in"><span>  <span class="co">#mtext("with Confidence=95%  and Various Values of Half-Width", </span></span></span>
<span class="r-in"><span>  <span class="co">#  line = 1.5, cex = 1.25)</span></span></span>
<span class="r-in"><span>  <span class="co">#mtext(paste("CI Method = Score Normal Approximation", </span></span></span>
<span class="r-in"><span>  <span class="co">#  "with Continuity Correction"), line = 0.5)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Modifying the example on pages 8-5 to 8-7 of USEPA (1989b), </span></span></span>
<span class="r-in"><span>  <span class="co"># look at the relationship between half-width and sample size </span></span></span>
<span class="r-in"><span>  <span class="co"># for a 95% confidence interval for the difference between the </span></span></span>
<span class="r-in"><span>  <span class="co"># proportion of detects at the background and compliance wells. </span></span></span>
<span class="r-in"><span>  <span class="co"># Use the estimated proportion of detects from the original data. </span></span></span>
<span class="r-in"><span>  <span class="co"># (The data are stored in EPA.89b.cadmium.df.)  </span></span></span>
<span class="r-in"><span>  <span class="co"># Assume equal sample sizes at each well.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.89b.cadmium.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Cadmium.orig Cadmium Censored  Well.type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           0.1   0.100    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          0.12   0.120    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          0.26   0.260    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           0.1   0.100    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8         0.014   0.014    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         0.12   0.120    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         0.21   0.210    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         0.12   0.120    FALSE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24          BDL   0.000     TRUE Background</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         0.12   0.120    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         0.08   0.080    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28          0.2   0.200    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32        0.012   0.012    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         0.12   0.120    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         0.07   0.070    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         0.19   0.190    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         0.01   0.010    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51         0.11   0.110    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52         0.06   0.060    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54         0.23   0.230    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56         0.11   0.110    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58        0.031   0.031    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64         0.12   0.120    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65         0.08   0.080    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67         0.26   0.260    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69         0.02   0.020    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71        0.024   0.024    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78         0.04   0.040    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81          0.1   0.100    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83         0.01   0.010    FALSE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87          BDL   0.000     TRUE Compliance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88          BDL   0.000     TRUE Compliance</span>
<span class="r-in"><span>  <span class="co">#   Cadmium.orig Cadmium Censored  Well.type</span></span></span>
<span class="r-in"><span>  <span class="co">#1           0.1   0.100    FALSE Background</span></span></span>
<span class="r-in"><span>  <span class="co">#2          0.12   0.120    FALSE Background</span></span></span>
<span class="r-in"><span>  <span class="co">#3           BDL   0.000     TRUE Background</span></span></span>
<span class="r-in"><span>  <span class="co"># ..........................................</span></span></span>
<span class="r-in"><span>  <span class="co">#86          BDL   0.000     TRUE Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#87          BDL   0.000     TRUE Compliance</span></span></span>
<span class="r-in"><span>  <span class="co">#88          BDL   0.000     TRUE Compliance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.back</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.89b.cadmium.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Background"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.back</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3333333</span>
<span class="r-in"><span>  <span class="co">#[1] 0.3333333 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.89b.cadmium.df</span>,  </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="va">Censored</span><span class="op">[</span><span class="va">Well.type</span><span class="op">==</span><span class="st">"Compliance"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p.hat.comp</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.375</span>
<span class="r-in"><span>  <span class="co">#[1] 0.375 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiBinomDesign</span><span class="op">(</span>p.hat.or.p1.hat <span class="op">=</span> <span class="va">p.hat.back</span>, </span></span>
<span class="r-in"><span>      p2.hat <span class="op">=</span> <span class="va">p.hat.comp</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">p.hat.back</span>, <span class="va">p.hat.comp</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

