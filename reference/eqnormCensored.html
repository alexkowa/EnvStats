<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate Quantiles of a Normal Distribution Based on Type I Censored Data — eqnormCensored • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Quantiles of a Normal Distribution Based on Type I Censored Data — eqnormCensored"><meta property="og:description" content="Estimate quantiles of a normal distribution given a
  sample of data that has been subjected to Type I censoring, and optionally
  construct a confidence interval for a quantile."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Quantiles of a Normal Distribution Based on Type I Censored Data</h1>

    <div class="hidden name"><code>eqnormCensored.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate quantiles of a <a href="https://rdrr.io/r/stats/Normal.html" class="external-link">normal distribution</a> given a
  sample of data that has been subjected to Type I censoring, and optionally
  construct a confidence interval for a quantile.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eqnormCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, censoring.side <span class="op">=</span> <span class="st">"left"</span>, p <span class="op">=</span> <span class="fl">0.5</span>, method <span class="op">=</span> <span class="st">"mle"</span>, </span>
<span>    ci <span class="op">=</span> <span class="cn">FALSE</span>, ci.method <span class="op">=</span> <span class="st">"exact.for.complete"</span>, ci.type <span class="op">=</span> <span class="st">"two-sided"</span>, </span>
<span>    conf.level <span class="op">=</span> <span class="fl">0.95</span>, digits <span class="op">=</span> <span class="fl">0</span>, nmc <span class="op">=</span> <span class="fl">1000</span>, seed <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector of observations.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>)
  values are allowed but will be removed.</p></dd>

  <dt id="arg-censored">censored<a class="anchor" aria-label="anchor" href="#arg-censored"></a></dt>
<dd><p>numeric or logical vector indicating which values of <code>x</code> are censored.
  This must be the same length as <code>x</code>.  If the mode of <code>censored</code> is
  <code>"logical"</code>, <code>TRUE</code> values correspond to elements of <code>x</code> that
  are censored, and <code>FALSE</code> values correspond to elements of <code>x</code> that
  are not censored.  If the mode of <code>censored</code> is <code>"numeric"</code>,
  it must contain only <code>1</code>'s and <code>0</code>'s; <code>1</code> corresponds to
  <code>TRUE</code> and <code>0</code> corresponds to <code>FALSE</code>.  Missing (<code>NA</code>)
  values are allowed but will be removed.</p></dd>

  <dt id="arg-censoring-side">censoring.side<a class="anchor" aria-label="anchor" href="#arg-censoring-side"></a></dt>
<dd><p>character string indicating on which side the censoring occurs.  The possible
  values are <code>"left"</code> (the default) and <code>"right"</code>.</p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>numeric vector of probabilities for which quantiles will be estimated.
  All values of <code>p</code> must be between 0 and 1.  When <code>ci=TRUE</code>, <code>p</code>
  must be a scalar. The default value is <code>p=0.5</code>.</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string specifying the method of estimating the mean and standard deviation.</p>
<p>For singly censored data, the possible values are: <br><code>"mle"</code> (maximum likelihood; the default), <br><code>"bcmle"</code> (bias-corrected maximum likelihood), <br><code>"qq.reg"</code> (quantile-quantile regression), <br><code>"qq.reg.w.cen.level"</code> (quantile-quantile regression including the
  censoring level), <br><code>"impute.w.qq.reg"</code> (moment estimation based on imputation using the
  <code>qq.reg method</code>), <br><code>"impute.w.qq.reg.w.cen.level"</code> (moment estimation based on imputation
  using the <code>qq.reg.w.cen.level method</code>), <br><code>"impute.w.mle"</code> (moment estimation based on imputation using the mle), <br><code>"iterative.impute.w.qq.reg"</code> (moment estimation based on iterative
  imputation using the <code>qq.reg method</code>), <br><code>"m.est"</code> (robust M-estimation), and <br><code>"half.cen.level"</code> (moment estimation based on setting the censored
  observations to half the censoring level).  <br></p>
<p>For multiply censored data, the possible values are: <br><code>"mle"</code> (maximum likelihood; the default), <br><code>"qq.reg"</code> (quantile-quantile regression), <br><code>"impute.w.qq.reg"</code> (moment estimation based on imputation using the
  <code>qq.reg method</code>), and <br><code>"half.cen.level"</code> (moment estimation based on setting the censored
  observations to half the censoring level). <br></p>
<p>See the DETAILS section for more information.</p></dd>

  <dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for the quantile.
  The default value is <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-method">ci.method<a class="anchor" aria-label="anchor" href="#arg-ci-method"></a></dt>
<dd><p>character string indicating what method to use to construct the confidence interval
  for the quantile.  The possible values are: <br><code>"exact.for.complete"</code> (exact method for complete (i.e., uncensored) data; the default), <br><code>"gpq"</code> (method based on generalized pivotal quantities), and <br><code>"normal.approx"</code> (normal approximation).</p>
<p>See the DETAILS section for more information.  This argument is ignored if <br><code>ci=FALSE</code>.</p></dd>

  <dt id="arg-ci-type">ci.type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>character string indicating what kind of confidence interval for the quantile to compute.
  The possible values are <code>"two-sided"</code> (the default), <code>"lower"</code>, and
  <code>"upper"</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level of the confidence interval.
  The default value is <code>conf.level=0.95</code>.  This argument is ignored if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>an integer indicating the number of decimal places to round to when printing out
  the value of <code>100*p</code>. The default value is <code>digits=0</code>.</p></dd>

  <dt id="arg-nmc">nmc<a class="anchor" aria-label="anchor" href="#arg-nmc"></a></dt>
<dd><p>numeric scalar indicating the number of Monte Carlo simulations to run when
  <code>ci.method="gpq"</code>.  The default is <code>nmc=1000</code>.  This argument is ignored
  if <code>ci=FALSE</code>.</p></dd>

  <dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer supplied to the function <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code> and used when
  <code>ci.method="gpq"</code>.  The default value is
  <code>seed=NULL</code>, in which case the current value of <code>.Random.seed</code> is used.
  This argument is ignored when <code>ci=FALSE</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><b>Estimating Quantiles</b> <br>
  Quantiles are estimated by:</p><ol><li><p>estimating the mean and standard deviation parameters by
      calling <code><a href="enormCensored.html">enormCensored</a></code>, and then</p></li>
<li><p>calling the function <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></code> and using the estimated
      values for the mean and standard deviation.</p></li>
</ol><p>The estimated quantile thus depends on the method of estimating the mean and
  standard deviation.
  <br></p>
<p><b>Confidence Intervals for Quantiles</b> <br></p>
<p><em>Exact Method When Data are Complete</em> (<code>ci.method="exact.for.complete"</code>) <br>
  When <code>ci.method="exact.for.complete"</code>, the function <code>eqnormCensored</code>
  calls the function <code><a href="eqnorm.html">eqnorm</a></code>, supplying it with the estimated mean
  and standard deviation, and setting the argument <br><code>ci.method="exact"</code>.  Thus, this
  is the exact method for computing a confidence interval for a quantile had the data
  been complete.  Because the data have been subjected to Type I censoring, this method
  of constructing a confidence interval for the quantile is an approximation.
  <br></p>
<p><em>Normal Approximation</em> (<code>ci.method="normal.approx"</code>) <br>
  When <code>ci.method="normal.approx"</code>, the function <code>eqnormCensored</code>
  calls the function <code><a href="eqnorm.html">eqnorm</a></code>, supplying it with the estimated mean
  and standard deviation, and setting the argument <br><code>ci.method="normal.approx"</code>.
  Thus, this is the normal approximation method for computing a confidence interval
  for a quantile had the data been complete.  Because the data have been subjected
  to Type I censoring, this method of constructing a confidence interval for the
  quantile is an approximation both because of the normal approximation and because
  the estimates of the mean and standard devation are based on censored, instead of
  complete, data.
  <br></p>
<p><em>Generalized Pivotal Quantity</em> (<code>ci.method="gpq"</code>) <br>
  When <code>ci.method="gpq"</code>, the function <code>eqnormCensored</code> uses the
  relationship between confidence intervals for quantiles and tolerance intervals
  and calls the function <code><a href="tolIntNormCensored.html">tolIntNormCensored</a></code> with the argument
  <code>ti.method="gpq"</code> to construct the confidence interval.
  Specifically, it can be shown
  (e.g., Conover, 1980, pp.119-121) that an upper confidence interval for the
  \(p\)'th quantile with confidence level \(100(1-\alpha)\%\) is equivalent to
  an upper \(\beta\)-content tolerance interval with coverage \(100p\%\) and
  confidence level \(100(1-\alpha)\%\).  Also, a lower confidence interval for
  the \(p\)'th quantile with confidence level \(100(1-\alpha)\%\) is equivalent
  to a lower \(\beta\)-content tolerance interval with coverage \(100(1-p)\%\) and
  confidence level \(100(1-\alpha)\%\).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>eqnormCensored</code> returns a list of class <code>"estimateCensored"</code>
  containing the estimated quantile(s) and other information.
  See <code><a href="estimateCensored.object.html">estimateCensored.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002). <em>Statistics for Environmental Engineers</em>.
  Lewis Publishers, Boca Raton.</p>
<p>Caudill, S.P., L.-Y. Wong, W.E. Turner, R. Lee, A. Henderson, D. G. Patterson Jr.
  (2007).  Percentile Estimation Using Variable Censored Data.
  <em>Chemosphere</em> <b>68</b>, 169–180.</p>
<p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>. Second Edition.
  John Wiley and Sons, New York.</p>
<p>Draper, N., and H. Smith. (1998). <em>Applied Regression Analysis</em>. Third Edition.
  John Wiley and Sons, New York.</p>
<p>Ellison, B.E. (1964). On Two-Sided Tolerance Intervals for a Normal Distribution.
  <em>Annals of Mathematical Statistics</em> <b>35</b>, 762-772.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
  John Wiley &amp; Sons, Hoboken.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY, pp.132-136.</p>
<p>Guttman, I. (1970). <em>Statistical Tolerance Regions: Classical and Bayesian</em>.
  Hafner Publishing Co., Darien, CT.</p>
<p>Hahn, G.J. (1970b). Statistical Intervals for a Normal Population, Part I: Tables, Examples
  and Applications. <em>Journal of Quality Technology</em> <b>2</b>(3), 115-125.</p>
<p>Hahn, G.J. (1970c). Statistical Intervals for a Normal Population, Part II: Formulas, Assumptions,
  Some Derivations. <em>Journal of Quality Technology</em> <b>2</b>(4), 195-206.</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991). <em>Statistical Intervals: A Guide for Practitioners</em>.
  John Wiley and Sons, New York.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, pp.88-90.</p>
<p>Hewett, P., and G.H. Ganser. (2007).  A Comparison of Several Methods for Analyzing
  Censored Data.  <em>Annals of Occupational Hygiene</em> <b>51</b>(7), 611–632.</p>
<p>Johnson, N.L., and B.L. Welch. (1940). Applications of the Non-Central t-Distribution.
  <em>Biometrika</em> <b>31</b>, 362-389.</p>
<p>Krishnamoorthy K., and T. Mathew. (2009).
  <em>Statistical Tolerance Regions: Theory, Applications, and Computation</em>.
  John Wiley and Sons, Hoboken.</p>
<p>Kroll, C.N., and J.R. Stedinger. (1996).  Estimation of Moments and Quantiles
  Using Censored Data.  <em>Water Resources Research</em> <b>32</b>(4), 1005–1012.</p>
<p>Millard, S.P., and N.K. Neerchal. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton.</p>
<p>Odeh, R.E., and D.B. Owen. (1980). <em>Tables for Normal Tolerance Limits, Sampling Plans,
  and Screening</em>. Marcel Dekker, New York.</p>
<p>Owen, D.B. (1962). <em>Handbook of Statistical Tables</em>. Addison-Wesley, Reading, MA.</p>
<p>Serasinghe, S.K. (2010).  <em>A Simulation Comparison of Parametric and
  Nonparametric Estimators of Quantiles from Right Censored Data</em>.  A Report
  submitted in partial fulfillment of the requirements for the degree Master of
  Science, Department of Statistics, College of Arts and Sciences, Kansas State
  University, Manhattan, Kansas.</p>

<p>Singh, A., R. Maichle, and S. Lee. (2006).  <em>On the Computation of a 95%
  Upper Confidence Limit of the Unknown Population Mean Based Upon Data Sets
  with Below Detection Limit Observations</em>.  EPA/600/R-06/022, March 2006.
  Office of Research and Development, U.S. Environmental Protection Agency,
  Washington, D.C.</p>
<p>Singh, A., R. Maichle, and N. Armbya. (2010a).
  <em>ProUCL Version 4.1.00 User Guide (Draft)</em>. EPA/600/R-07/041, May 2010.
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Singh, A., N. Armbya, and A. Singh. (2010b).
  <em>ProUCL Version 4.1.00 Technical Guide (Draft)</em>. EPA/600/R-07/041, May 2010.
  Office of Research and Development, U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Stedinger, J. (1983). Confidence Intervals for Design Events.
  <em>Journal of Hydraulic Engineering</em> <b>109</b>(1), 13-27.</p>
<p>Stedinger, J.R., R.M. Vogel, and E. Foufoula-Georgiou. (1993).
  Frequency Analysis of Extreme Events. In: Maidment, D.R., ed. <em>Handbook of Hydrology</em>.
  McGraw-Hill, New York, Chapter 18, pp.29-30.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>Wald, A., and J. Wolfowitz. (1946). Tolerance Limits for a Normal Distribution.
  <em>Annals of Mathematical Statistics</em> <b>17</b>, 208-215.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Percentiles are sometimes used in environmental standards and regulations.
  For example, Berthouex and Brown (2002, p.71) note that England has water
  quality limits based on the 90th and 95th percentiles of monitoring data not
  exceeding specified levels.  They also note that the U.S. EPA has specifications
  for air quality monitoring, aquatic standards on toxic chemicals, and maximum
  daily limits for industrial effluents that are all based on percentiles.  Given
  the importance of these quantities, it is essential to characterize the amount
  of uncertainty associated with the estimates of these quantities.  This is done
  with confidence intervals.</p>
<p>A sample of data contains censored observations if some of the observations are
  reported only as being below or above some censoring level.  In environmental
  data analysis, Type I left-censored data sets are common, with values being
  reported as “less than the detection limit” (e.g., Helsel, 2012).  Data
  sets with only one censoring level are called <em>singly censored</em>; data sets with
  multiple censoring levels are called <em>multiply</em> or <em>progressively censored</em>.</p>
<p>Statistical methods for dealing with censored data sets have a long history in the
  field of survival analysis and life testing.  More recently, researchers in the
  environmental field have proposed alternative methods of computing estimates and
  confidence intervals in addition to the classical ones such as maximum likelihood
  estimation.</p>
<p>Helsel (2012, Chapter 6) gives an excellent review of past studies of the
  properties of various estimators based on censored environmental data.</p>
<p>In practice, it is better to use a confidence interval for a percentile, rather
  than rely on a single point-estimate of percentile.  Confidence intervals
  for percentiles of a normal distribution depend on the properties of the estimators
  for both the mean and standard deviation.</p>
<p>Few studies have been done to evaluate the performance of methods for constructing
  confidence intervals for the mean or joint confidence regions for the mean and
  standard deviation when data are subjected to single or multiple censoring (see,
  for example, Singh et al., 2006).  Studies to evaluate the performance of a
  confidence interval for a percentile include:  Caudill et al. (2007), Hewett and
  Ganner (2007), Kroll and Stedinger (1996), and Serasinghe (2010).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="enormCensored.html">enormCensored</a></code>, <code><a href="tolIntNormCensored.html">tolIntNormCensored</a></code>, <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a></code>,
  <code><a href="estimateCensored.object.html">estimateCensored.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 15 observations from a normal distribution with </span></span></span>
<span class="r-in"><span>  <span class="co"># parameters mean=10 and sd=2, and censor observations less than 8. </span></span></span>
<span class="r-in"><span>  <span class="co"># Then generate 15 more observations from this distribution and  censor </span></span></span>
<span class="r-in"><span>  <span class="co"># observations less than 7.</span></span></span>
<span class="r-in"><span>  <span class="co"># Then estimate the 90th percentile and create a one-sided upper 95% </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence interval for that percentile. </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">x.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">x.1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  6.343542  7.068499  7.828525  8.029036  8.155088  9.436470  9.495908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 10.030262 10.079205 10.182946 10.217551 10.370811 10.987640 11.422285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 13.989393</span>
<span class="r-in"><span>  <span class="co"># [1]  6.343542  7.068499  7.828525  8.029036  8.155088  9.436470</span></span></span>
<span class="r-in"><span>  <span class="co"># [7]  9.495908 10.030262 10.079205 10.182946 10.217551 10.370811</span></span></span>
<span class="r-in"><span>  <span class="co">#[13] 10.987640 11.422285 13.989393</span></span></span>
<span class="r-in"><span>  <span class="va">censored.1</span> <span class="op">&lt;-</span> <span class="va">x.1</span> <span class="op">&lt;</span> <span class="fl">8</span></span></span>
<span class="r-in"><span>  <span class="va">x.1</span><span class="op">[</span><span class="va">censored.1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">8</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">x.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">x.2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  5.355255  6.065562  6.783680  6.867676  8.219412  8.593224  9.319168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8]  9.347066  9.837844  9.918844 10.055054 10.498296 10.834382 11.341558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 12.528482</span>
<span class="r-in"><span>  <span class="co"># [1]  5.355255  6.065562  6.783680  6.867676  8.219412  8.593224</span></span></span>
<span class="r-in"><span>  <span class="co"># [7]  9.319168  9.347066  9.837844  9.918844 10.055054 10.498296</span></span></span>
<span class="r-in"><span>  <span class="co">#[13] 10.834382 11.341558 12.528482</span></span></span>
<span class="r-in"><span>  <span class="va">censored.2</span> <span class="op">&lt;-</span> <span class="va">x.2</span> <span class="op">&lt;</span> <span class="fl">7</span></span></span>
<span class="r-in"><span>  <span class="va">x.2</span><span class="op">[</span><span class="va">censored.2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">7</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x.1</span>, <span class="va">x.2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">censored</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">censored.1</span>, <span class="va">censored.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">eqnormCensored</span><span class="op">(</span><span class="va">x</span>, <span class="va">censored</span>, p <span class="op">=</span> <span class="fl">0.9</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 23.33333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mean       sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9.227116 2.073889 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MLE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   11.88491 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Quantile(s) Based on\n                                 MLE Estimators"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "90'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     LCL     UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -Inf 12.9131 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact for\n                                 Complete Data"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimateCensored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimateCensored"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#Based on Type I Censored Data</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Side:                  left</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Level(s):              7 8 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 9.390624</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   = 1.827156</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               MLE</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           90'th %ile = 11.73222</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Quantile(s) Based on</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 MLE Estimators</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Variable:              censored</span></span></span>
<span class="r-in"><span>  <span class="co">#  </span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Percent Censored:                16.66667%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         90'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Sample Size:             30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact for</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Complete Data</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =     -Inf</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 12.63808</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare these results with the true 90'th percentile:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.9</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12.5631</span>
<span class="r-in"><span>  <span class="co">#[1] 12.56310</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x.1</span>, <span class="va">censored.1</span>, <span class="va">x.2</span>, <span class="va">censored.2</span>, <span class="va">x</span>, <span class="va">censored</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Chapter 15 of USEPA (2009) gives several examples of estimating the mean</span></span></span>
<span class="r-in"><span>  <span class="co"># and standard deviation of a lognormal distribution on the log-scale using </span></span></span>
<span class="r-in"><span>  <span class="co"># manganese concentrations (ppb) in groundwater at five background wells. </span></span></span>
<span class="r-in"><span>  <span class="co"># In EnvStats these data are stored in the data frame </span></span></span>
<span class="r-in"><span>  <span class="co"># EPA.09.Ex.15.1.manganese.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Here we will estimate the mean and standard deviation using the MLE, </span></span></span>
<span class="r-in"><span>  <span class="co"># and then construct an upper 95% confidence limit for the 90th percentile. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We will log-transform the original observations and then call </span></span></span>
<span class="r-in"><span>  <span class="co"># eqnormCensored.  Alternatively, we could have more simply called </span></span></span>
<span class="r-in"><span>  <span class="co"># eqlnormCensored.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># First look at the data:</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.09.Ex.15.1.manganese.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample   Well Manganese.Orig.ppb Manganese.ppb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       1 Well.1                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       2 Well.1               12.1          12.1    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       3 Well.1               16.9          16.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       4 Well.1               21.6          21.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       5 Well.1                 &lt;2           2.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       1 Well.2                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       2 Well.2                7.7           7.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       3 Well.2               53.6          53.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       4 Well.2                9.5           9.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      5 Well.2               45.9          45.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11      1 Well.3                 &lt;5           5.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12      2 Well.3                5.3           5.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13      3 Well.3               12.6          12.6    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14      4 Well.3              106.3         106.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15      5 Well.3               34.5          34.5    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16      1 Well.4                6.3           6.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      2 Well.4               11.9          11.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18      3 Well.4                 10          10.0    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19      4 Well.4                 &lt;2           2.0     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20      5 Well.4               77.2          77.2    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21      1 Well.5               17.9          17.9    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22      2 Well.5               22.7          22.7    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23      3 Well.5                3.3           3.3    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24      4 Well.5                8.4           8.4    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25      5 Well.5                 &lt;2           2.0     TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#   Sample   Well Manganese.Orig.ppb Manganese.ppb Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#1       1 Well.1                 &lt;5           5.0     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#2       2 Well.1               12.1          12.1    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#3       3 Well.1               16.9          16.9    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span>  <span class="co">#23      3 Well.5                3.3           3.3    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#24      4 Well.5                8.4           8.4    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#25      5 Well.5                 &lt;2           2.0     TRUE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="longToWide.html">longToWide</a></span><span class="op">(</span><span class="va">EPA.09.Ex.15.1.manganese.df</span>, </span></span>
<span class="r-in"><span>    <span class="st">"Manganese.Orig.ppb"</span>, <span class="st">"Sample"</span>, <span class="st">"Well"</span>,</span></span>
<span class="r-in"><span>    paste.row.name <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Well.1 Well.2 Well.3 Well.4 Well.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample.1     &lt;5     &lt;5     &lt;5    6.3   17.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample.2   12.1    7.7    5.3   11.9   22.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample.3   16.9   53.6   12.6     10    3.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample.4   21.6    9.5  106.3     &lt;2    8.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample.5     &lt;2   45.9   34.5   77.2     &lt;2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#         Well.1 Well.2 Well.3 Well.4 Well.5</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample.1     &lt;5     &lt;5     &lt;5    6.3   17.9</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample.2   12.1    7.7    5.3   11.9   22.7</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample.3   16.9   53.6   12.6     10    3.3</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample.4   21.6    9.5  106.3     &lt;2    8.4</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample.5     &lt;2   45.9   34.5   77.2     &lt;2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now estimate the mean, standard deviation, and 90th percentile </span></span></span>
<span class="r-in"><span>  <span class="co"># on the log-scale using the MLE, and construct an upper 95% </span></span></span>
<span class="r-in"><span>  <span class="co"># confidence limit for the 90th percentile on the log-scale:</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">est.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.15.1.manganese.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu">eqnormCensored</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Manganese.ppb</span><span class="op">)</span>, <span class="va">Censored</span>, </span></span>
<span class="r-in"><span>      p <span class="op">=</span> <span class="fl">0.9</span>, ci <span class="op">=</span> <span class="cn">TRUE</span>, ci.type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">est.list</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Normal"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.side</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "left"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6931472 1.6094379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $percent.censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     mean       sd </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.215905 1.356291 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n.param.est</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "MLE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "log(Manganese.ppb)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $censoring.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "censored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantiles</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.954062 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $quantile.method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Quantile(s) Based on\n                                 MLE Estimators"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Confidence"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parameter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "90'th %ile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $limits</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -Inf 4.708904 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "upper"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Exact for\n                                 Complete Data"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $conf.level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "intervalEstimateCensored"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "estimateCensored"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#Based on Type I Censored Data</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            Normal</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Side:                  left</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Level(s):              0.6931472 1.6094379 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          mean = 2.215905</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 sd   = 1.356291</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               MLE</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Quantile(s):           90'th %ile = 3.954062</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Quantile Estimation Method:      Quantile(s) Based on</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 MLE Estimators</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            log(Manganese.ppb)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Censoring Variable:              censored</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     25</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Percent Censored:                24%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         90'th %ile</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Sample Size:             25</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Exact for</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 Complete Data</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL =     -Inf</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 4.708904</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># To estimate the 90th percentile on the original scale, </span></span></span>
<span class="r-in"><span>  <span class="co"># we need to exponentiate the results</span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">est.list</span><span class="op">$</span><span class="va">quantiles</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90'th %ile </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   52.14674 </span>
<span class="r-in"><span>  <span class="co">#90'th %ile </span></span></span>
<span class="r-in"><span>  <span class="co">#  52.14674 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">est.list</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">limits</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      LCL      UCL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 110.9305 </span>
<span class="r-in"><span>  <span class="co">#     LCL      UCL </span></span></span>
<span class="r-in"><span>  <span class="co">#  0.0000 110.9305</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">est.list</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

