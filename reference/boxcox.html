<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Boxcox Power Transformation — boxcox • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Boxcox Power Transformation — boxcox"><meta property="og:description" content='boxcox is a generic function used to compute the value(s) of an objective
  for one or more Box-Cox power transformations, or to compute an optimal power
  transformation based on a specified objective.  The function invokes particular
  methods which depend on the class of the first
  argument.
Currently, there is a default method and a method for objects of class "lm".'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Boxcox Power Transformation</h1>

    <div class="hidden name"><code>boxcox.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>boxcox</code> is a generic function used to compute the value(s) of an objective
  for one or more Box-Cox power transformations, or to compute an optimal power
  transformation based on a specified objective.  The function invokes particular
  <code><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></code> which depend on the <code><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></code> of the first
  argument.</p>
<p>Currently, there is a default method and a method for objects of class <code>"lm"</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span>, </span>
<span>    lambda <span class="op">=</span> <span class="op">{</span><span class="kw">if</span> <span class="op">(</span><span class="va">optimize</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">}</span>, </span>
<span>    optimize <span class="op">=</span> <span class="cn">FALSE</span>, objective.name <span class="op">=</span> <span class="st">"PPCC"</span>, </span>
<span>    eps <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, include.x <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'lm'</span></span>
<span><span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span>, </span>
<span>    lambda <span class="op">=</span> <span class="op">{</span><span class="kw">if</span> <span class="op">(</span><span class="va">optimize</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">}</span>, </span>
<span>    optimize <span class="op">=</span> <span class="cn">FALSE</span>, objective.name <span class="op">=</span> <span class="st">"PPCC"</span>, </span>
<span>    eps <span class="op">=</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>, include.x <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class <code>"lm"</code> for which the response variable is all positive
  numbers, or else a numeric vector of positive numbers.  When <code>x</code> is an
  object of class <code>"lm"</code>, the object must have been created with a
  call to the function <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> that includes the <code>data</code> argument.
  When <code>x</code> is a numeric vector of positive observations, missing (<code>NA</code>),
  undefined (<code>NaN</code>), and infinite (<code>-Inf, Inf</code>) values are allowed but
  will be removed.</p></dd>

  <dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>numeric vector of finite values indicating what powers to use for the
  Box-Cox transformation.  When <code>optimize=FALSE</code>, the default value is <br><code>lambda=seq(-2, 2, by=0.5)</code>.  When <code>optimize=TRUE</code>, <code>lambda</code>
  must be a vector with two values indicating the range over which the
  optimization will occur and the range of these two values must include 1.
  In this case, the default value is <code>lambda=c(-2, 2)</code>.</p></dd>

  <dt id="arg-optimize">optimize<a class="anchor" aria-label="anchor" href="#arg-optimize"></a></dt>
<dd><p>logical scalar indicating whether to simply evalute the objective function at the
  given values of <code>lambda</code> (<code>optimize=FALSE</code>; the default), or to compute
  the optimal power transformation within the bounds specified by
  <code>lambda</code> (<code>optimize=TRUE</code>).</p></dd>

  <dt id="arg-objective-name">objective.name<a class="anchor" aria-label="anchor" href="#arg-objective-name"></a></dt>
<dd><p>character string indicating what objective to use. The possible values are
  <code>"PPCC"</code> (probability plot correlation coefficient; the default),
  <code>"Shapiro-Wilk"</code> (the Shapiro-Wilk goodness-of-fit statistic), and
  <code>"Log-Likelihood"</code> (the log-likelihood function).</p></dd>

  <dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>finite, positive numeric scalar.  When the absolute value of <code>lambda</code> is less
  than <code>eps</code>, lambda is assumed to be 0 for the Box-Cox transformation.
  The default value is <code>eps=.Machine$double.eps</code>.</p></dd>

  <dt id="arg-include-x">include.x<a class="anchor" aria-label="anchor" href="#arg-include-x"></a></dt>
<dd><p>logical scalar indicating whether to include the finite, non-missing values of
  the argument <code>x</code> with the returned object. The default value is
  <code>include.x=TRUE</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>optional arguments for possible future methods.  Currently not used.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Two common assumptions for several standard parametric hypothesis tests are:</p><ol><li><p>The observations all come from a normal distribution.</p></li>
<li><p>The observations all come from distributions with the same variance.</p></li>
</ol><p>For example, the standard one-sample t-test assumes all the observations
  come from the same normal distribution, and the standard two-sample t-test
  assumes that all the observations come from a normal distribution with the same
  variance, although the mean may differ between the two groups.</p>
<p>When the original data do not satisfy the above assumptions, data transformations
  are often used to attempt to satisfy these assumptions.  The rest of this section
  is divided into two parts:  one that discusses Box-Cox transformations in the
  context of the original observations, and one that  discusses Box-Cox
  transformations in the context of linear models.
  <br></p>
<p><b>Box-Cox Transformations Based on the Original Observations</b> <br>
  Box and Cox (1964) presented a formalized method for deciding on a data
  transformation.  Given a random variable \(X\) from some distribution with
  only positive values, the Box-Cox family of power transformations is defined as:</p><table class="table table"><tr><td>\(Y\)</td><td>=</td><td>\(\frac{X^\lambda - 1}{\lambda}\)</td><td>\(\lambda \ne 0\)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>\(log(X)\)</td><td>\(\lambda = 0 \;\;\;\;\;\; (1)\)</td></tr></table><p>where \(Y\) is assumed to come from a normal distribution.  This transformation is
  continuous in \(\lambda\).  Note that this transformation also preserves ordering.
  See the help file for <code><a href="boxcoxTransform.html">boxcoxTransform</a></code> for more information on data
  transformations.</p>
<p>Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a random sample of
  \(n\) observations from some distribution and assume that there exists some
  value of \(\lambda\) such that the transformed observations</p><table class="table table"><tr><td>\(y_i\)</td><td>=</td><td>\(\frac{x_i^\lambda - 1}{\lambda}\)</td><td>\(\lambda \ne 0\)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>\(log(x_i)\)</td><td>\(\lambda = 0 \;\;\;\;\;\; (2)\)</td></tr></table><p>(\(i = 1, 2, \ldots, n\)) form a random sample from a normal distribution.</p>
<p>Box and Cox (1964) proposed choosing the appropriate value of \(\lambda\) based on
  maximizing the likelihood function.  Alternatively, an appropriate value of
  \(\lambda\) can be chosen based on another objective, such as maximizing the
  probability plot correlation coefficient or the Shapiro-Wilk goodness-of-fit
  statistic.</p>
<p>In the case when <code>optimize=TRUE</code>, the function <code>boxcox</code> calls the
  <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> to minimize the negative value of the
  objective (i.e., maximize the objective) over the range of possible values of
  \(\lambda\) specified in the argument <code>lambda</code>.  The starting value for
  the optimization is always \(\lambda=1\) (i.e., no transformation).</p>
<p>The rest of this sub-section explains how the objective is computed for the
  various options for <code>objective.name</code>.
  <br></p>
<p><em>Objective Based on Probability Plot Correlation Coefficient</em> (<code>objective.name="PPCC"</code>) <br>
  When <code>objective.name="PPCC"</code>, the objective is computed as the value of the
  normal probability plot correlation coefficient based on the transformed data
  (see the description of the Probability Plot Correlation Coefficient (PPCC)
  goodness-of-fit test in the help file for <code><a href="gofTest.html">gofTest</a></code>).  That is,
  the objective is the correlation coefficient for the normal
  <a href="qqPlot.html">quantile-quantile plot</a> for the transformed data.
  Large values of the PPCC tend to indicate a good fit to a normal distribution.
  <br></p>
<p><em>Objective Based on Shapiro-Wilk Goodness-of-Fit Statistic</em> (<code>objective.name="Shapiro-Wilk"</code>) <br>
  When <code>objective.name="Shapiro-Wilk"</code>, the objective is computed as the value of
  the Shapiro-Wilk goodness-of-fit statistic based on the transformed data
  (see the description of the Shapiro-Wilk test in the help file for
  <code><a href="gofTest.html">gofTest</a></code>).  Large values of the Shapiro-Wilk statistic tend to
  indicate a good fit to a normal distribution.
  <br></p>
<p><em>Objective Based on Log-Likelihood Function</em> (<code>objective.name="Log-Likelihood"</code>) <br>
  When <code>objective.name="Log-Likelihood"</code>, the objective is computed as the value
  of the log-likelihood function.  Assuming the transformed observations in
  Equation (2) above come from a normal distribution with mean \(\mu\) and
  standard deviation \(\sigma\), we can use the change of variable formula to
  write the log-likelihood function as:
  $$log[L(\lambda, \mu, \sigma)] = \frac{-n}{2}log(2\pi) - \frac{n}{2}log(\sigma^2) - \frac{1}{2\sigma^2} \sum_{i=1}^n (y_i - \mu)^2 + (\lambda - 1) \sum_{i=1}^n log(x_i) \;\;\;\;\;\; (3)$$
  where \(y_i\) is defined in Equation (2) above (Box and Cox, 1964).
  For a fixed value of \(\lambda\), the log-likelihood function
  is maximized by replacing \(\mu\) and \(\sigma\) with their maximum likelihood
  estimators:
  $$\hat{\mu} = \frac{1}{n} \sum_{i=1}^n y_i \;\;\;\;\;\; (4)$$
  $$\hat{\sigma} = [\frac{1}{n} \sum_{i=1}^n (y_i - \bar{y})^2]^{1/2} \;\;\;\;\;\; (5)$$
  Thus, when <code>optimize=TRUE</code>, Equation (3) is maximized by iteratively solving for
  \(\lambda\) using the values for \(\mu\) and \(\sigma\) given in
  Equations (4) and (5).  When <code>optimize=FALSE</code>, the value of the objective is
  computed by using Equation (3), using the values of \(\lambda\) specified in the
  argument <code>lambda</code>, and using the values for \(\mu\) and \(\sigma\) given
  in Equations (4) and (5).
  <br></p>
<p><b>Box-Cox Transformation for Linear Models</b> <br>
  In the case of a standard linear regression model with \(n\) observations and
  \(p\) predictors:
  $$Y_i = \beta_0 + \beta_1 X_{i1} + \ldots + \beta_p X_{ip} + \epsilon_i, \; i=1,2,\ldots,n \;\;\;\;\;\; (6)$$
  the standard assumptions are:</p><ol><li><p>The error terms \(\epsilon_i\) come from a normal distribution with mean 0.</p></li>
<li><p>The variance is the same for all of the error terms and does not depend on
        the predictor variables.</p></li>
</ol><p>Assuming \(Y\) is a random variable from some distribution that may depend on
  the predictor variables and \(Y\) takes on only positive values, the Box-Cox
  family of power transformations is defined as:</p><table class="table table"><tr><td>\(Y^*\)</td><td>=</td><td>\(\frac{Y^\lambda - 1}{\lambda}\)</td><td>\(\lambda \ne 0\)</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td>\(log(Y)\)</td><td>\(\lambda = 0 \;\;\;\;\;\; (7)\)</td></tr></table><p>where \(Y^*\) becomes the new response variable and the errors are now
  assumed to come from a normal distribution with a mean of 0 and a constant variance.</p>
<p>In this case, the objective is computed as described above, but it is based on the
  residuals from the fitted linear model in which the response variable is now
  \(Y^*\) instead of \(Y\).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>When <code>x</code> is an object of class <code>"lm"</code>, <code>boxcox</code> returns
  a list of class <code>"boxcoxLm"</code> containing the results.  See
  the help file for <code><a href="boxcoxLm.object.html">boxcoxLm.object</a></code> for details.</p>
<p>When <code>x</code> is simply a numeric vector of positive numbers,
  <code>boxcox</code> returns a list of class <code>"boxcox"</code> containing the
  results.  See the help file for <code><a href="boxcox.object.html">boxcox.object</a></code> for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers, Second Edition</em>.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Box, G.E.P., and D.R. Cox. (1964).  An Analysis of Transformations
  (with Discussion).  <em>Journal of the Royal Statistical Society, Series B</em>
  <b>26</b>(2), 211–252.</p>
<p>Draper, N., and H. Smith. (1998). <em>Applied Regression Analysis</em>. Third Edition.
  John Wiley and Sons, New York, pp.47-53.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution
  Monitoring</em>. Van Nostrand Reinhold, NY.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY.</p>
<p>Hinkley, D.V., and G. Runger. (1984).  The Analysis of Transformed Data
  (with Discussion).  <em>Journal of the American Statistical Association</em>
  <b>79</b>, 302–320.</p>
<p>Hoaglin, D.C., F.M. Mosteller, and J.W. Tukey, eds. (1983).
  <em>Understanding Robust and Exploratory Data Analysis</em>.
  John Wiley and Sons, New York, Chapter 4.</p>
<p>Hoaglin, D.C. (1988).  Transformations in Everyday Experience.
  <em>Chance</em> <b>1</b>, 40–45.</p>
<p>Johnson, N. L., S. Kotz, and A.W. Kemp. (1992).  <em>Univariate
  Discrete Distributions, Second Edition</em>.  John Wiley and Sons, New York,
  p.163.</p>
<p>Johnson, R.A., and D.W. Wichern. (2007).
  <em>Applied Multivariate Statistical Analysis, Sixth Edition</em>.
  Pearson Prentice Hall, Upper Saddle River, NJ, pp.192–195.</p>
<p>Shumway, R.H., A.S. Azari, and P. Johnson. (1989).
  Estimating Mean Concentrations Under Transformations for Environmental
  Data With Detection Limits.  <em>Technometrics</em> <b>31</b>(3), 347–356.</p>
<p>Stoline, M.R. (1991).  An Examination of the Lognormal and Box and Cox
  Family of Transformations in Fitting Environmental Data.
  <em>Environmetrics</em> <b>2</b>(1), 85–106.</p>
<p>van Belle, G., L.D. Fisher, Heagerty, P.J., and Lumley, T. (2004).
  <em>Biostatistics: A Methodology for the Health Sciences, 2nd Edition</em>.
  John Wiley &amp; Sons, New York.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>.
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ,
  Chapter 13.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Data transformations are often used to induce normality, homoscedasticity,
  and/or linearity, common assumptions of parametric statistical tests and
  estimation procedures.  Transformations are not “tricks” used by the
  data analyst to hide what is going on, but rather useful tools for
  understanding and dealing with data (Berthouex and Brown, 2002, p.61).
  Hoaglin (1988) discusses “hidden” transformations that are used everyday,
  such as the pH scale for measuring acidity.  Johnson and Wichern (2007, p.192)
  note that "Transformations are nothing more than a reexpression of the data
  in different units."</p>
<p>In the case of a linear model, there are at least two approaches to improving
  a model fit:  transform the \(Y\) and/or \(X\) variable(s), and/or use
  more predictor variables.  Often in environmental data analysis, we assume the
  observations come from a lognormal distribution and automatically take
  logarithms of the data.  For a simple linear regression
  (i.e., one predictor variable), if regression diagnostic plots indicate that a
  straight line fit is not adequate, but that the variance of the errors
  appears to be fairly constant, you may only need to transform the predictor
  variable \(X\) or perhaps use a quadratic or cubic model in \(X\).
  On the other hand, if the diagnostic plots indicate that the constant
  variance and/or normality assumptions are suspect, you probably need to consider
  transforming the response variable \(Y\).  Data transformations for
  linear regression models are discussed in Draper and Smith (1998, Chapter 13)
  and Helsel and Hirsch (1992, pp. 228-229).</p>
<p>One problem with data transformations is that translating results on the
  transformed scale back to the original scale is not always straightforward.
  Estimating quantities such as means, variances, and confidence limits in the
  transformed scale and then transforming them back to the original scale
  usually leads to biased and inconsistent estimates (Gilbert, 1987, p.149;
  van Belle et al., 2004, p.400).  For example, exponentiating the confidence
  limits for a mean based on log-transformed data does not yield a
  confidence interval for the mean on the original scale.  Instead, this yields
  a confidence interval for the median (see the help file for <code><a href="elnormAlt.html">elnormAlt</a></code>).
  It should be noted, however, that quantiles (percentiles) and rank-based
  procedures are invariant to monotonic transformations
  (Helsel and Hirsch, 1992, p.12).</p>
<p>Finally, there is no guarantee that a Box-Cox tranformation based on the
  “optimal” value of \(\lambda\) will provide an adequate transformation
  to allow the assumption of approximate normality and constant variance.  Any
  set of transformed data should be inspected relative to the assumptions you
  want to make about it (Johnson and Wichern, 2007, p.194).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="boxcox.object.html">boxcox.object</a></code>, <code><a href="plot.boxcox.html">plot.boxcox</a></code>, <code><a href="print.boxcox.html">print.boxcox</a></code>,
  <code><a href="boxcoxLm.object.html">boxcoxLm.object</a></code>, <code><a href="plot.boxcoxLm.html">plot.boxcoxLm</a></code>, <code><a href="print.boxcoxLm.html">print.boxcoxLm</a></code>,
  <code><a href="boxcoxTransform.html">boxcoxTransform</a></code>, <a href="FcnsByCatDataTrans.html">Data Transformations</a>,
  <a href="FcnsByCatGOFTests.html">Goodness-of-Fit Tests</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 30 observations from a lognormal distribution with </span></span></span>
<span class="r-in"><span>  <span class="co"># mean=10 and cv=2.  Look at some values of various objectives </span></span></span>
<span class="r-in"><span>  <span class="co"># for various transformations.  Note that for both the PPCC and </span></span></span>
<span class="r-in"><span>  <span class="co"># the Log-Likelihood objective, the optimal value of lambda is </span></span></span>
<span class="r-in"><span>  <span class="co"># about 0, indicating that a log transformation is appropriate.  </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalAlt.html">rlnormAlt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">10</span>, cv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="st">"cyan"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Using the PPCC objective:</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5423739 0.6402782 0.7818160 0.9272219 0.9921702 0.9581178 0.8749611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.7827009 0.7004547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PPCC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    NA    NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.0192184  1.3268068 13.0050656 14.6964419  4.4758993  2.8075661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  2.7475058  4.5005255  2.2994106  3.6594709  9.2627400  8.0372560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  3.6735836  3.7105992  3.4081524 13.4421468  0.9784090  2.1583361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  4.1931244  6.3832010  9.2376357  3.2546640  2.6481660 12.4014044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  0.4022087 22.4564613  1.0683931 30.0176128  8.8987899  1.5006026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcox"</span>
<span class="r-in"><span>  <span class="co">#Results of Box-Cox Transformation</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Objective Name:                  PPCC</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># lambda      PPCC</span></span></span>
<span class="r-in"><span>  <span class="co">#   -2.0 0.5423739</span></span></span>
<span class="r-in"><span>  <span class="co">#   -1.5 0.6402782</span></span></span>
<span class="r-in"><span>  <span class="co">#   -1.0 0.7818160</span></span></span>
<span class="r-in"><span>  <span class="co">#   -0.5 0.9272219</span></span></span>
<span class="r-in"><span>  <span class="co">#    0.0 0.9921702</span></span></span>
<span class="r-in"><span>  <span class="co">#    0.5 0.9581178</span></span></span>
<span class="r-in"><span>  <span class="co">#    1.0 0.8749611</span></span></span>
<span class="r-in"><span>  <span class="co">#    1.5 0.7827009</span></span></span>
<span class="r-in"><span>  <span class="co">#    2.0 0.7004547</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span>, optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04530789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9925919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PPCC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -2     2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.0192184  1.3268068 13.0050656 14.6964419  4.4758993  2.8075661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  2.7475058  4.5005255  2.2994106  3.6594709  9.2627400  8.0372560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  3.6735836  3.7105992  3.4081524 13.4421468  0.9784090  2.1583361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  4.1931244  6.3832010  9.2376357  3.2546640  2.6481660 12.4014044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  0.4022087 22.4564613  1.0683931 30.0176128  8.8987899  1.5006026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcox"</span>
<span class="r-in"><span>  <span class="co">#Results of Box-Cox Transformation</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Objective Name:                  PPCC</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Bounds for Optimization:         lower = -2</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 upper =  2</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Optimal Value:                   lambda = 0.04530789</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Value of Objective:              PPCC = 0.9925919</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Using the Log-Likelihodd objective</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span>, objective.name <span class="op">=</span> <span class="st">"Log-Likelihood"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -154.94255 -128.59988 -106.23882  -90.84800  -85.10204  -88.69825  -99.42630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] -115.23701 -134.54125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Log-Likelihood"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    NA    NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.0192184  1.3268068 13.0050656 14.6964419  4.4758993  2.8075661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  2.7475058  4.5005255  2.2994106  3.6594709  9.2627400  8.0372560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  3.6735836  3.7105992  3.4081524 13.4421468  0.9784090  2.1583361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  4.1931244  6.3832010  9.2376357  3.2546640  2.6481660 12.4014044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  0.4022087 22.4564613  1.0683931 30.0176128  8.8987899  1.5006026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcox"</span>
<span class="r-in"><span>  <span class="co">#Results of Box-Cox Transformation</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Objective Name:                  Log-Likelihood</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># lambda Log-Likelihood</span></span></span>
<span class="r-in"><span>  <span class="co">#   -2.0     -154.94255</span></span></span>
<span class="r-in"><span>  <span class="co">#   -1.5     -128.59988</span></span></span>
<span class="r-in"><span>  <span class="co">#   -1.0     -106.23882</span></span></span>
<span class="r-in"><span>  <span class="co">#   -0.5      -90.84800</span></span></span>
<span class="r-in"><span>  <span class="co">#    0.0      -85.10204</span></span></span>
<span class="r-in"><span>  <span class="co">#    0.5      -88.69825</span></span></span>
<span class="r-in"><span>  <span class="co">#    1.0      -99.42630</span></span></span>
<span class="r-in"><span>  <span class="co">#    1.5     -115.23701</span></span></span>
<span class="r-in"><span>  <span class="co">#    2.0     -134.54125</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span>, objective.name <span class="op">=</span> <span class="st">"Log-Likelihood"</span>, optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0405156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -85.07123</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Log-Likelihood"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -2     2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2.0192184  1.3268068 13.0050656 14.6964419  4.4758993  2.8075661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  2.7475058  4.5005255  2.2994106  3.6594709  9.2627400  8.0372560</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  3.6735836  3.7105992  3.4081524 13.4421468  0.9784090  2.1583361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19]  4.1931244  6.3832010  9.2376357  3.2546640  2.6481660 12.4014044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25]  0.4022087 22.4564613  1.0683931 30.0176128  8.8987899  1.5006026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "x"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bad.obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcox"</span>
<span class="r-in"><span>  <span class="co">#Results of Box-Cox Transformation</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Objective Name:                  Log-Likelihood</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            x</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     30</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Bounds for Optimization:         lower = -2</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 upper =  2</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Optimal Value:                   lambda = 0.0405156</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Value of Objective:              Log-Likelihood = -85.07123</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot the results based on the PPCC objective</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="va">boxcox.list</span> <span class="op">&lt;-</span> <span class="fu">boxcox</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boxcox.list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Look at QQ-Plots for the candidate values of lambda</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boxcox.list</span>, plot.type <span class="op">=</span> <span class="st">"Q-Q Plots"</span>, same.window <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The data frame Environmental.df contains daily measurements of </span></span></span>
<span class="r-in"><span>  <span class="co"># ozone concentration, wind speed, temperature, and solar radiation</span></span></span>
<span class="r-in"><span>  <span class="co"># in New York City for 153 consecutive days between May 1 and </span></span></span>
<span class="r-in"><span>  <span class="co"># September 30, 1973.  In this example, we'll plot ozone vs. </span></span></span>
<span class="r-in"><span>  <span class="co"># temperature and look at the Q-Q plot of the residuals.  Then </span></span></span>
<span class="r-in"><span>  <span class="co"># we'll look at possible Box-Cox transformations.  The "optimal" one </span></span></span>
<span class="r-in"><span>  <span class="co"># based on the PPCC looks close to a log-transformation </span></span></span>
<span class="r-in"><span>  <span class="co"># (i.e., lambda=0).  The power that produces the largest PPCC is </span></span></span>
<span class="r-in"><span>  <span class="co"># about 0.2, so a cube root (lambda=1/3) transformation might work too.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Environmental.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ozone radiation temperature wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/01/1973    41       190          67  7.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/02/1973    36       118          72  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/03/1973    12       149          74 12.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/04/1973    18       313          62 11.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/05/1973    NA        NA          56 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 05/06/1973    28        NA          66 14.9</span>
<span class="r-in"><span>  <span class="co">#           ozone radiation temperature wind</span></span></span>
<span class="r-in"><span>  <span class="co">#05/01/1973    41       190          67  7.4</span></span></span>
<span class="r-in"><span>  <span class="co">#05/02/1973    36       118          72  8.0</span></span></span>
<span class="r-in"><span>  <span class="co">#05/03/1973    12       149          74 12.6</span></span></span>
<span class="r-in"><span>  <span class="co">#05/04/1973    18       313          62 11.5</span></span></span>
<span class="r-in"><span>  <span class="co">#05/05/1973    NA        NA          56 14.3</span></span></span>
<span class="r-in"><span>  <span class="co">#05/06/1973    28        NA          66 14.9</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">Environmental.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            ozone radiation temperature wind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/25/1973    14        20          63 16.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/26/1973    30       193          70  6.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/27/1973    NA       145          77 13.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/28/1973    14       191          75 14.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/29/1973    18       131          76  8.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 09/30/1973    20       223          68 11.5</span>
<span class="r-in"><span>  <span class="co">#           ozone radiation temperature wind</span></span></span>
<span class="r-in"><span>  <span class="co">#09/25/1973    14        20          63 16.6</span></span></span>
<span class="r-in"><span>  <span class="co">#09/26/1973    30       193          70  6.9</span></span></span>
<span class="r-in"><span>  <span class="co">#09/27/1973    NA       145          77 13.2</span></span></span>
<span class="r-in"><span>  <span class="co">#09/28/1973    14       191          75 14.3</span></span></span>
<span class="r-in"><span>  <span class="co">#09/29/1973    18       131          76  8.0</span></span></span>
<span class="r-in"><span>  <span class="co">#09/30/1973    20       223          68 11.5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Fit the model with the raw Ozone data</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="va">ozone.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ozone</span> <span class="op">~</span> <span class="va">temperature</span>, data <span class="op">=</span> <span class="va">Environmental.df</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot Ozone vs. Temperature, with fitted line </span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Environmental.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">temperature</span>, <span class="va">ozone</span>, xlab <span class="op">=</span> <span class="st">"Temperature (degrees F)"</span>,</span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"Ozone (ppb)"</span>, main <span class="op">=</span> <span class="st">"Ozone vs. Temperature"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">ozone.fit</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at the Q-Q Plot for the residuals </span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">ozone.fit</span><span class="op">$</span><span class="va">residuals</span>, add.line <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at Box-Cox transformations of Ozone </span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="va">boxcox.list</span> <span class="op">&lt;-</span> <span class="fu">boxcox</span><span class="op">(</span><span class="va">ozone.fit</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">boxcox.list</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4286781 0.4673544 0.5896132 0.8301458 0.9871519 0.9819825 0.9408694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.8840770 0.8213675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PPCC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    NA    NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lm.obj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = ozone ~ temperature, data = Environmental.df, y = TRUE, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     qr = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  temperature  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -146.995        2.429  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ozone.fit"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcoxLm"</span>
<span class="r-in"><span>  <span class="co">#Results of Box-Cox Transformation</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Objective Name:                  PPCC</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Linear Model:                    ozone.fit</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     116</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co"># lambda      PPCC</span></span></span>
<span class="r-in"><span>  <span class="co">#   -2.0 0.4286781</span></span></span>
<span class="r-in"><span>  <span class="co">#   -1.5 0.4673544</span></span></span>
<span class="r-in"><span>  <span class="co">#   -1.0 0.5896132</span></span></span>
<span class="r-in"><span>  <span class="co">#   -0.5 0.8301458</span></span></span>
<span class="r-in"><span>  <span class="co">#    0.0 0.9871519</span></span></span>
<span class="r-in"><span>  <span class="co">#    0.5 0.9819825</span></span></span>
<span class="r-in"><span>  <span class="co">#    1.0 0.9408694</span></span></span>
<span class="r-in"><span>  <span class="co">#    1.5 0.8840770</span></span></span>
<span class="r-in"><span>  <span class="co">#    2.0 0.8213675</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot PPCC vs. lambda based on Q-Q plots of residuals </span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boxcox.list</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at Q-Q plots of residuals for the various transformation </span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boxcox.list</span>, plot.type <span class="op">=</span> <span class="st">"Q-Q Plots"</span>, same.window <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compute the "optimal" transformation</span></span></span>
<span class="r-in"><span>  <span class="co">#-------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu">boxcox</span><span class="op">(</span><span class="va">ozone.fit</span>, optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2004305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9940222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $objective.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PPCC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $optimize.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -2     2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.220446e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lm.obj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = ozone ~ temperature, data = Environmental.df, y = TRUE, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     qr = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  temperature  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -146.995        2.429  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sample.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $data.name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ozone.fit"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "boxcoxLm"</span>
<span class="r-in"><span>  <span class="co">#Results of Box-Cox Transformation</span></span></span>
<span class="r-in"><span>  <span class="co">#---------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Objective Name:                  PPCC</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Linear Model:                    ozone.fit</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     116</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Bounds for Optimization:         lower = -2</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 upper =  2</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Optimal Value:                   lambda = 0.2004305</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Value of Objective:              PPCC = 0.9940222</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">boxcox.list</span>, <span class="va">ozone.fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

