<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Kendall's Nonparametric Test for Montonic Trend — kendallTrendTest • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Kendall's Nonparametric Test for Montonic Trend — kendallTrendTest"><meta property="og:description" content="Perform a nonparametric test for a monotonic trend based on Kendall's
  tau statistic, and optionally compute a confidence interval for the
  slope."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kendall's Nonparametric Test for Montonic Trend</h1>

    <div class="hidden name"><code>kendallTrendTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform a nonparametric test for a monotonic trend based on Kendall's
  tau statistic, and optionally compute a confidence interval for the
  slope.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kendallTrendTest</span><span class="op">(</span><span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">kendallTrendTest</span><span class="op">(</span><span class="va">y</span>, data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">subset</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.pass</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">kendallTrendTest</span><span class="op">(</span><span class="va">y</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>along <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>, correct <span class="op">=</span> <span class="cn">TRUE</span>, ci.slope <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>, warn <span class="op">=</span> <span class="cn">TRUE</span>, data.name <span class="op">=</span> <span class="cn">NULL</span>, data.name.x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parent.of.data <span class="op">=</span> <span class="cn">NULL</span>, subset.expression <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>an object containing data for the trend test.  In the default method,
  the argument <code>y</code> must be numeric vector of observations.
  In the formula method, <code>y</code> must be a formula of the form <code>y ~ 1</code> or
  <code>y ~ x</code>.  The form <code>y ~ 1</code> indicates use the observations in the vector
  <code>y</code> for the test for trend and use the default value of the argument <code>x</code>
  in the call to <code>kendallTrendTest.default</code>.  The form <code>y ~ x</code> indicates
  use the observations in the vector <code>y</code> for the test for trend and use the
  specified value of the argument <code>x</code> in the call to
  <code>kendallTrendTest.default</code>.  Missing (<code>NA</code>), undefined (<code>NaN</code>),
  and infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be
  removed.</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>specifies an optional data frame, list or environment (or object coercible by
  <code>as.data.frame</code> to a data frame) containing the variables in the model.
  If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>,
  typically the environment from which <code>kendallTrendTest</code> is called.</p></dd>

  <dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>specifies an optional vector specifying a subset of observations to be used.</p></dd>

  <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>specifies a function which indicates what should happen when the data contain <code>NA</code>s.
  The default is <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.pass</a></code>.</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>numeric vector of "predictor" values.  The length of <code>x</code> must equal the length of <code>y</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are
  allowed but will be removed.  The default value of <code>x</code> is the vector
  of numbers \(1, 2, \dots, n\) where \(n\) is the number of elements in
  <code>y</code>.</p></dd>

  <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>character string indicating the kind of alternative hypothesis.  The
  possible values are <code>"two.sided"</code> (tau not equal to 0; the default),
  <code>"less"</code> (tau less than 0), and <code>"greater"</code> (tau greater than 0).</p></dd>

  <dt id="arg-correct">correct<a class="anchor" aria-label="anchor" href="#arg-correct"></a></dt>
<dd><p>logical scalar indicating whether to use the correction for continuity in
  computing the \(z\)-statistic that is based on the test statistic \(S\).
  The default value is <code>TRUE</code>.</p></dd>

  <dt id="arg-ci-slope">ci.slope<a class="anchor" aria-label="anchor" href="#arg-ci-slope"></a></dt>
<dd><p>logical scalar indicating whether to compute a confidence interval for the
  slope.  The default value is <code>TRUE</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>numeric scalar between 0 and 1 indicating the confidence level associated
  with the confidence interval for the slope.  The default value is
  <code>0.95</code>.</p></dd>

  <dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical scalar indicating whether to print a warning message when
  <code>y</code> does not contain at least two non-missing values,
  or when <code>x</code> does not contain at least two unique non-missing values.
  The default value is <code>TRUE</code>.</p></dd>

  <dt id="arg-data-name">data.name<a class="anchor" aria-label="anchor" href="#arg-data-name"></a></dt>
<dd><p>character string indicating the name of the data used for the trend test.
  The default value is <code>deparse(substitute(y))</code>.</p></dd>

  <dt id="arg-data-name-x">data.name.x<a class="anchor" aria-label="anchor" href="#arg-data-name-x"></a></dt>
<dd><p>character string indicating the name of the data used for the predictor variable x.
  If <code>x</code> is not supplied this argument is ignored.  When <code>x</code> is supplied,
  the default value is <code>deparse(substitute(x))</code>.</p></dd>

  <dt id="arg-parent-of-data">parent.of.data<a class="anchor" aria-label="anchor" href="#arg-parent-of-data"></a></dt>
<dd><p>character string indicating the source of the data used for the trend test.</p></dd>

  <dt id="arg-subset-expression">subset.expression<a class="anchor" aria-label="anchor" href="#arg-subset-expression"></a></dt>
<dd><p>character string indicating the expression used to subset the data.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments affecting the test for trend.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>kendallTrendTest</code> performs Kendall's nonparametric test for a monotonic trend,
  which is a special case of the test for independence based on Kendall's tau statistic
  (see <code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></code>).  The slope is estimated using the method of Theil (1950) and
  Sen (1968).  When <code>ci.slope=TRUE</code>, the confidence interval for the slope is
  computed using Gilbert's (1987) Modification of the Theil/Sen Method.</p>
<p>Kendall's test for a monotonic trend is a special case of the test for independence
  based on Kendall's tau statistic.  The first section below explains the general case
  of testing for independence.  The second section explains the special case of
  testing for monotonic trend.  The last section explains how a simple linear
  regression model is a special case of a monotonic trend and how the slope may be
  estimated.
  <br></p>
<p><b>The General Case of Testing for Independence</b> <br></p>
<p><em>Definition of Kendall's Tau</em> <br>
  Let \(X\) and \(Y\) denote two continuous random variables with some joint
  (bivariate) distribution.  Let \((X_1, Y_1), (X_2, Y_2), \ldots, (X_n, Y_n)\)
  denote a set of \(n\) bivariate observations from this distribution, and assume
  these bivariate observations are mutually independent.  Kendall (1938, 1975) proposed
  a test for the hypothesis that the \(X\) and \(Y\) random variables are
  independent based on estimating the following quantity:
  $$\tau = \{ 2 Pr[(X_2 - X_1)(Y_2 - Y_1) &gt; 0] \} - 1 \;\;\;\;\;\; (1)$$
  The quantity in Equation (1) is called Kendall's tau, although this term is more
  often applied to the estimate of \(\tau\) (see Equation (2) below).
  If \(X\) and \(Y\) are independent, then \(\tau=0\).  Furthermore, for most
  distributions of interest, if \(\tau=0\) then the random variables \(X\) and
  \(Y\) are independent.  (It can be shown that there exist some distributions for
  which \(\tau=0\) and the random variables \(X\) and \(Y\) are not independent;
  see Hollander and Wolfe (1999, p.364)).</p>
<p>Note that Kendall's tau is similar to a correlation coefficient in that
  \(-1 \le \tau \le 1\).  If \(X\) and \(Y\) always vary in the same direction,
  that is if \(X_1 &lt; X_2\) always implies \(Y_1 &lt; Y_2\), then \(\tau = 1\).
  If \(X\) and \(Y\) always vary in the opposite direction, that is if
  \(X_1 &lt; X_2\) always implies \(Y_1 &gt; Y_2\), then \(\tau = -1\).  If
  \(\tau &gt; 0\), this indicates \(X\) and \(Y\) are positively associated.
  If \(\tau &lt; 0\), this indicates \(X\) and \(Y\) are negatively associated.
  <br></p>
<p><em>Estimating Kendall's Tau</em> <br>
  The quantity in Equation (1) can be estimated by:
  $$\hat{\tau} = \frac{2S}{n(n-1)} \;\;\;\;\;\; (2)$$
  where
  $$S = \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} sign[(X_j - X_i)(Y_j - Y_i)] \;\;\;\;\;\; (3)$$
  and \(sign()\) denotes the <code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></code> function:</p><table class="table table"><tr><td></td><td>\(-1\)</td><td>\(x &lt; 0\)</td></tr><tr><td>\(sign(x) =\)</td><td>\(0\)</td><td>\(x = 0 \;\;\;\;\;\; (4)\)</td></tr><tr><td></td><td>\(1\)</td><td>\(x &gt; 0\)</td></tr></table><p>(Hollander and Wolfe, 1999, Chapter 8; Conover, 1980, pp.256–260;
  Gilbert, 1987, Chapter 16; Helsel and Hirsch, 1992, pp.212–216;
  Gibbons et al., 2009, Chapter 11). The quantity defined in Equation (2) is called
  Kendall's rank correlation coefficient or more often Kendall's tau.</p>
<p>Note that the quantity \(S\) defined in Equation (3) is equal to the number of
  concordant pairs minus the number of discordant pairs.  Hollander and Wolfe
  (1999, p.364) use the notation \(K\) instead of \(S\), and Conover (1980, p.257)
  uses the notation \(T\).
  <br></p>
<p><em>Testing the Null Hypothesis of Independence</em> <br>
  The null hypothesis \(H_0: \tau = 0\), can be tested using the statistic \(S\)
  defined in Equation (3) above.  Tables of the distribution of \(S\) for small
  samples are given in Hollander and Wolfe (1999), Conover (1980, pp.458–459),
  Gilbert (1987, p.272), Helsel and Hirsch (1992, p.469), and Gibbons (2009, p.210).
  The function <code>kendallTrendTest</code> uses the large sample approximation to the
  distribution of \(S\) under the null hypothesis, which is given by:
  $$z = \frac{S - E(S)}{\sqrt{Var(S)}} \;\;\;\;\;\; (5)$$
  where
  $$E(S) = 0 \;\;\;\;\;\; (6)$$
  $$Var(S) = \frac{n(n-1)(2n+5)}{18} \;\;\;\;\;\; (7)$$
  Under the null hypothesis, the quantity \(z\) defined in Equation (5) is
  approximately distributed as a standard normal random variable.</p>
<p>Both Kendall (1975) and Mann (1945) show that the normal approximation is excellent
  even for samples as small as \(n=10\), provided that the following continuity
  correction is used:
  $$z = \frac{S - sign(S)}{\sqrt{Var(S)}} \;\;\;\;\;\; (8)$$
  The function <code>kendallTrendTest</code> performs the usual one-sample z-test using
  the statistic computed in Equation (8) or Equation (5).  The argument
  <code>correct</code> determines which equation is used to compute the z-statistic.
  By default, <code>correct=TRUE</code> so Equation (8) is used.</p>
<p>In the case of tied observations in either the observed \(X\)'s and/or observed
  \(Y\)'s, the formula for the variance of \(S\) given in Equation (7) must be
  modified as follows:</p><table class="table table"><tr><td>\(Var(S) =\)</td><td>\(\frac{n(n-1)(2n+5)}{18} -\)</td></tr><tr><td></td><td></td></tr><tr><td></td><td>\(\frac{\sum_{i=1}^{g} t_i(t_i-1)(2t_i+5)}{18} - \)</td></tr><tr><td></td><td></td></tr><tr><td></td><td>\(\frac{\sum_{j=1}^{h} u_j(u_j-1)(2u_j+5)}{18} + \)</td></tr><tr><td></td><td></td></tr><tr><td></td><td>\(\frac{[\sum_{i=1}^{g} t_i(t_i-1)(t_i-2)][\sum_{j=1}^{h} u_j(u_j-1)(u_j-2)]}{9n(n-1)(n-2)} +\)</td></tr><tr><td></td><td></td></tr><tr><td></td><td>\(\frac{[\sum_{i=1}^{g} t_i(t_i-1)][\sum_{j=1}^{h} u_j(u_j-1)]}{2n(n-1)} \;\;\;\;\;\; (9)\)</td></tr></table><p>where \(g\) is the number of tied groups in the \(X\) observations,
  \(t_i\) is the size of the \(i\)'th tied group in the \(X\) observations,
  \(h\) is the number of tied groups in the \(Y\) observations, and
  \(u_j\) is the size of the \(j\)'th tied group in the \(Y\) observations.
  In the case of no ties in either the \(X\) or \(Y\) observations, Equation (9)
  reduces to Equation (7).
  <br></p>
<p><b>The Special Case of Testing for Monotonic Trend</b> <br>
  Often in environmental sampling, observations are taken periodically over time
  (Hirsch et al., 1982; van Belle and Hughes, 1984; Hirsch and Slack, 1984).  In
  this case, the random variables \(Y_1, Y_2, \ldots, Y_n\) can be thought of as
  representing the observations, and the variables \(X_1, X_2, \ldots, X_n\)
  are no longer random but represent the time at which the \(i\)'th observation
  was taken.  If the observations are equally spaced over time, then it is useful to
  make the simplification \(X_i = i\) for \(i = 1, 2, \ldots, n\).  This is in
  fact the default value of the argument <code>x</code> for the function
  <code>kendallTrendTest</code>.</p>
<p>In the case where the \(X\)'s represent time and are all distinct, the test for
  independence between \(X\) and \(Y\) is equivalent to testing for a monotonic
  trend in \(Y\), and the test statistic \(S\) simplifies to:
  $$S = \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} sign(Y_j - Y_i) \;\;\;\;\;\; (10)$$
  Also, the formula for the variance of \(S\) in the presence of ties (under the
  null hypothesis \(H_0: \tau = 0\)) simplifies to:
  $$Var(S) = \frac{n(n-1)(2n+5)}{18} - \frac{\sum_{j=1}^{h} u_j(u_j-1)(2u_j+5)}{18} \;\;\;\;\;\; (11)$$
  A form of the test statistic \(S\) in Equation (10) was introduced by Mann (1945).
  <br></p>
<p><b>The Special Case of a Simple Linear Model:  Estimating the Slope</b> <br>
  Consider the simple linear regression model
  $$Y_i = \beta_0 + \beta_1 X_i + \epsilon_i \;\;\;\;\;\; (12)$$
  where \(\beta_0\) denotes the intercept, \(\beta_1\) denotes the slope,
  \(i = 1, 2, \ldots, n\), and the \(\epsilon\)'s are assumed to be
  independent and identically distributed random variables from the same distribution.
  This is a special case of dependence between the \(X\)'s and the \(Y\)'s, and
  the null hypothesis of a zero slope can be tested using Kendall's test statistic
  \(S\) (Equation (3) or (10) above) and the associated z-statistic
  (Equation (5) or (8) above) (Hollander and Wolfe, 1999, pp.415–420).</p>
<p>Theil (1950) proposed the following nonparametric estimator of the slope:
  $$\hat{\beta}_1 = Median(\frac{Y_j - Y_i}{X_j - X_i}); \;\; i &lt; j \;\;\;\;\;\; (13)$$
  Note that the computation of the estimated slope involves computing
  $$N = {n \choose 2} = \frac{n(n-1)}{2} \;\;\;\;\;\; (14)$$
  “two-point” estimated slopes (assuming no tied \(X\) values), and taking
  the median of these N values.</p>
<p>Sen (1968) generalized this estimator to the case where there are possibly tied
  observations in the \(X\)'s.  In this case, Sen simply ignores the two-point
  estimated slopes where the \(X\)'s are tied and computes the median based on the
  remaining \(N'\) two-point estimated slopes.  That is, Sen's estimator is given by:
  $$\hat{\beta}_1 = Median(\frac{Y_j - Y_i}{X_j - X_i}); \;\; i &lt; j, X_i \ne X_j  \;\;\;\;\;\; (15)$$
  (Hollander and Wolfe, 1999, pp.421–422).</p>
<p>Conover (1980, p. 267) suggests the following estimator for the intercept:
  $$\hat{\beta}_0 = Y_{0.5} - \hat{\beta}_1 X_{0.5} \;\;\;\;\;\; (16)$$
  where \(X_{0.5}\) and \(Y_{0.5}\) denote the sample medians of the \(X\)'s
  and \(Y\)'s, respectively.  With these estimators of slope and intercept, the
  estimated regression line passes through the point \((X_{0.5}, Y_{0.5})\).</p>
<p><b>NOTE:</b> The function <code>kendallTrendTest</code> always returns estimates of
  slope and intercept assuming a linear model (Equation (12)), while the p-value
  is based on Kendall's tau, which is testing for the broader alternative of any
  kind of dependence between the \(X\)'s and \(Y\)'s.
  <br></p>
<p><em>Confidence Interval for the Slope</em> <br>
  Theil (1950) and Sen (1968) proposed methods to compute a confidence interval for
  the true slope, assuming the linear model of Equation (12) (see
  Hollander and Wolfe, 1999, pp.421-422).  Gilbert (1987, p.218) illustrates a
  simpler method than the one given by Sen (1968) that is based on a normal
  approximation.  Gilbert's (1987) method is an extension of the one given in
  Hollander and Wolfe (1999, p.424) that allows for ties and/or multiple
  observations per time period.  This method is valid for a sample size as small as
  \(n=10\) unless there are several tied observations.</p>
<p>Let \(N'\) denote the number of defined two-point estimated slopes that are used
  in Equation (15) above (if there are no tied \(X\) values then \(N' = N\)), and
  let \(\hat{\beta}_{1_{(1)}}, \hat{\beta}_{1_{(2)}}, \ldots, \hat{\beta}_{1_{(N')}}\)
  denote the \(N'\) ordered slopes.  For Gilbert's (1987) method, a
  \(100(1-\alpha)\%\) two-sided confidence interval for the true slope is given by:
  $$[\hat{\beta}_{1_{(M1)}}, \hat{\beta}_{1_{(M2+1)}}] \;\;\;\;\;\; (17)$$
  where
  $$M1 = \frac{N' - C_{\alpha}}{2} \;\;\;\;\;\; (18)$$
  $$M2 = \frac{N' + C_{\alpha}}{2} \;\;\;\;\;\; (19)$$
  $$C_\alpha = z_{1 - \alpha/2} \sqrt{Var(S)} \;\;\;\;\;\; (20)$$
  \(Var(S)\) is defined in Equations (7), (9), or (11), and
  \(z_p\) denotes the \(p\)'th quantile of the standard normal distribution.
  One-sided confidence intervals may computed in a similar fashion.</p>
<p>Usually the quantities \(M1\) and \(M2\) will not be integers.
  Gilbert (1987, p.219) suggests interpolating between adjacent values in this case,
  which is what the function <code>kendallTrendTest</code> does.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>"htest"</code> containing the results of the hypothesis
  test.  See the help file for <code><a href="htest.object.html">htest.object</a></code> for details.
  In addition, the following components are part of the list returned by
  <code>kendallTrendTest</code>:</p>
<p></p>
<dl><dt>S</dt>
<dd><p>The value of the Kendall S-statistic.</p></dd>

  <dt>var.S</dt>
<dd><p>The variance of the Kendall S-statistic.</p></dd>

  <dt>slopes</dt>
<dd><p>A numeric vector of all possible two-point slope estimates.
    This component is used by the function <code><a href="kendallSeasonalTrendTest.html">kendallSeasonalTrendTest</a></code>.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Bradley, J.V. (1968). <em>Distribution-Free Statistical Tests</em>.
  Prentice-Hall, Englewood Cliffs, NJ.</p>
<p>Conover, W.J. (1980). <em>Practical Nonparametric Statistics</em>. Second Edition.
  John Wiley and Sons, New York, pp.256-272.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
  John Wiley &amp; Sons, Hoboken.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY, Chapter 16.</p>
<p>Helsel, D.R. and R.M. Hirsch. (1988). Discussion of Applicability of the t-test for Detecting Trends
  in Water Quality Variables. <em>Water Resources Bulletin</em> <b>24</b>(1), 201-204.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992). <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, NY.</p>
<p>Helsel, D.R., and R. M. Hirsch. (2002). <em>Statistical Methods in Water Resources</em>.
  Techniques of Water Resources Investigations, Book 4, chapter A3. U.S. Geological Survey.
  Available on-line at <a href="https://pubs.usgs.gov/tm/04/a03/tm4a3.pdf" class="external-link">https://pubs.usgs.gov/tm/04/a03/tm4a3.pdf</a>.</p>
<p>Hirsch, R.M., J.R. Slack, and R.A. Smith. (1982). Techniques of Trend Analysis for Monthly Water Quality
  Data. <em>Water Resources Research</em> <b>18</b>(1), 107-121.</p>
<p>Hirsch, R.M. and J.R. Slack. (1984). A Nonparametric Trend Test for Seasonal Data with Serial Dependence.
  <em>Water Resources Research</em> <b>20</b>(6), 727-732.</p>
<p>Hirsch, R.M., R.B. Alexander, and R.A. Smith. (1991). Selection of Methods for the Detection and
  Estimation of Trends in Water Quality. <em>Water Resources Research</em> <b>27</b>(5), 803-813.</p>
<p>Hollander, M., and D.A. Wolfe. (1999). <em>Nonparametric Statistical Methods,
  Second Edition</em>.  John Wiley and Sons, New York.</p>
<p>Kendall, M.G. (1938). A New Measure of Rank Correlation. <em>Biometrika</em> <b>30</b>, 81-93.</p>
<p>Kendall, M.G. (1975). <em>Rank Correlation Methods</em>. Charles Griffin, London.</p>
<p>Mann, H.B. (1945). Nonparametric Tests Against Trend. <em>Econometrica</em> <b>13</b>, 245-259.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, Florida.</p>
<p>Sen, P.K. (1968). Estimates of the Regression Coefficient Based on Kendall's Tau.
  <em>Journal of the American Statistical Association</em> <b>63</b>, 1379-1389.</p>
<p>Theil, H. (1950). A Rank-Invariant Method of Linear and Polynomial Regression Analysis, I-III.
  <em>Proc. Kon. Ned. Akad. v. Wetensch. A.</em> <b>53</b>, 386-392, 521-525, 1397-1412.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>van Belle, G., and J.P. Hughes. (1984). Nonparametric Tests for Trend in Water Quality.
  <em>Water Resources Research</em> <b>20</b>(1), 127-136.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Kendall's test for independence or trend is a nonparametric test.  No
  assumptions are made about the distribution of the \(X\) and \(Y\)
  variables.  Hirsch et al. (1982) introduced the "seasonal Kendall test" to
  test for trend within each season.  They note that Kendall's test for trend
  is easy to compute, even in the presence of missing values, and can also be
  used with censored values.</p>
<p>van Belle and Hughes (1984) note that Kendall's test for trend is slightly
  less powerful than the test based on Spearman's rho, but it converges to
  normality faster.  Also, Bradley (1968, p.288) shows that for the case of a
  linear model with normal (Gaussian) errors, the asymptotic relative
  efficiency of Kendall's test for trend versus the parametric test for a
  zero slope is 0.98.</p>
<p>The results of the function <code>kendallTrendTest</code> are similar to the
  results of the built-in <span style="R">R</span> function <code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></code> with the
  argument <code>method="kendall"</code> except that <code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></code>
  1) computes exact p-values when the number of pairs is less than 50 and
  there are no ties, and 2) does not return a confidence interval for
  the slope.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></code>, <code><a href="kendallSeasonalTrendTest.html">kendallSeasonalTrendTest</a></code>, <code><a href="htest.object.html">htest.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Reproduce Example 17-6 on page 17-33 of USEPA (2009).  This example</span></span></span>
<span class="r-in"><span>  <span class="co"># tests for trend in sulfate concentrations (ppm) collected at various</span></span></span>
<span class="r-in"><span>  <span class="co"># months between 1989 and 1996.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">EPA.09.Ex.17.6.sulfate.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sample.No Year Month Sampling.Date       Date Sulfate.ppm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1   89     6          89.6 1989-06-01         480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         2   89     8          89.8 1989-08-01         450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         3   90     1          90.1 1990-01-01         490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         4   90     3          90.3 1990-03-01         520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         5   90     6          90.6 1990-06-01         485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         6   90     8          90.8 1990-08-01         510</span>
<span class="r-in"><span>  <span class="co">#  Sample.No Year Month Sampling.Date       Date Sulfate.ppm</span></span></span>
<span class="r-in"><span>  <span class="co">#1         1   89     6          89.6 1989-06-01         480</span></span></span>
<span class="r-in"><span>  <span class="co">#2         2   89     8          89.8 1989-08-01         450</span></span></span>
<span class="r-in"><span>  <span class="co">#3         3   90     1          90.1 1990-01-01         490</span></span></span>
<span class="r-in"><span>  <span class="co">#4         4   90     3          90.3 1990-03-01         520</span></span></span>
<span class="r-in"><span>  <span class="co">#5         5   90     6          90.6 1990-06-01         485</span></span></span>
<span class="r-in"><span>  <span class="co">#6         6   90     8          90.8 1990-08-01         510</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot the data</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.17.6.sulfate.df</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Sampling.Date</span>, <span class="va">Sulfate.ppm</span>, pch <span class="op">=</span> <span class="fl">15</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">900</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlab <span class="op">=</span> <span class="st">"Sampling Date"</span>, ylab <span class="op">=</span> <span class="st">"Sulfate Conc (ppm)"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Figure 17-6. Time Series Plot of \nSulfate Concentrations (ppm)"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Sulfate.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sulfate.ppm</span> <span class="op">~</span> <span class="va">Sampling.Date</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">EPA.09.Ex.17.6.sulfate.df</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">Sulfate.fit</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Perform the Kendall test for trend</span></span></span>
<span class="r-in"><span>  <span class="co">#-----------------------------------</span></span></span>
<span class="r-in"><span>  <span class="fu">kendallTrendTest</span><span class="op">(</span><span class="va">Sulfate.ppm</span> <span class="op">~</span> <span class="va">Sampling.Date</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">EPA.09.Ex.17.6.sulfate.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Hypothesis Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Hypothesis:                 tau = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative Hypothesis:          True tau is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Name:                       Kendall's Test for Trend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  (with continuity correction)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Parameter(s):          tau       =     0.7667984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  slope     =    26.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  intercept = -1909.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation Method:               slope:      Theil/Sen Estimator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  intercept:  Conover's Estimator</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            y = Sulfate.ppm  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  x = Sampling.Date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data Source:                     EPA.09.Ex.17.6.sulfate.df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Statistic:                  z = 5.107322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P-value:                         3.267574e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval for:         slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Method:      Gilbert's Modification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  of Theil/Sen Method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval Type:        two-sided</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                95%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Interval:             LCL = 20.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UCL = 35.71182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Hypothesis Test</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Null Hypothesis:                 tau = 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Alternative Hypothesis:          True tau is not equal to 0</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Name:                       Kendall's Test for Trend</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 (with continuity correction)</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimated Parameter(s):          tau       =     0.7667984</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 slope     =    26.6666667</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 intercept = -1909.3333333</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Estimation Method:               slope:      Theil/Sen Estimator</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 intercept:  Conover's Estimator</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            y = Sulfate.ppm</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 x = Sampling.Date</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data Source:                     EPA.09.Ex.17.6.sulfate.df</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     23</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Test Statistic:                  z = 5.107322</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#P-value:                         3.267574e-07</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval for:         slope</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Method:      Gilbert's Modification</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 of Theil/Sen Method</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval Type:        two-sided</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                95%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Interval:             LCL = 20.00000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UCL = 35.71182</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">Sulfate.fit</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

