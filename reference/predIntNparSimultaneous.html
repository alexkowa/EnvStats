<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Nonparametric Simultaneous Prediction Interval for a Continuous Distribution — predIntNparSimultaneous • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Nonparametric Simultaneous Prediction Interval for a Continuous Distribution — predIntNparSimultaneous"><meta property="og:description" content="Construct a nonparametric simultaneous prediction interval for the next
  \(r\) sampling &amp;#8220;occasions&amp;#8221; based on one of three
  possible rules: k-of-m, California, or Modified California.  The simultaneous
  prediction interval assumes the observations from from a continuous distribution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nonparametric Simultaneous Prediction Interval for a Continuous Distribution</h1>

    <div class="hidden name"><code>predIntNparSimultaneous.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Construct a nonparametric simultaneous prediction interval for the next
  \(r\) sampling “occasions” based on one of three
  possible rules: k-of-m, California, or Modified California.  The simultaneous
  prediction interval assumes the observations from from a continuous distribution.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">x</span>, n.median <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="fl">1</span>, rule <span class="op">=</span> <span class="st">"k.of.m"</span>, </span>
<span>    lpl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"upper"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pi.type</span> <span class="op">==</span> <span class="st">"lower"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    lb <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ub <span class="op">=</span> <span class="cn">Inf</span>, pi.type <span class="op">=</span> <span class="st">"upper"</span>, integrate.args.list <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a numeric vector of observations.  Missing (<code>NA</code>), undefined (<code>NaN</code>), and
  infinite (<code>Inf</code>, <code>-Inf</code>) values are allowed but will be removed.</p></dd>

  <dt id="arg-n-median">n.median<a class="anchor" aria-label="anchor" href="#arg-n-median"></a></dt>
<dd><p>positive odd integer specifying the sample size associated with the future medians.
  The default value is <code>n.median=1</code> (i.e., individual observations).  Note that
  all future medians must be based on the same sample size.</p></dd>

  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>for the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), a positive integer
  specifying the minimum number of observations (or medians) out of \(m\)
  observations (or medians) (all obtained on one future sampling “occassion”)
  the prediction interval should contain.
  The default value is <code>k=1</code>.  This argument is ignored when the argument
  <code>rule</code> is not equal to <code>"k.of.m"</code>.</p></dd>

  <dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>positive integer specifying the maximum number of future observations (or
  medians) on one future sampling “occasion”.
  The default value is <code>m=2</code>, except when <code>rule="Modified.CA"</code>, in which
  case this argument is ignored and <code>m</code> is automatically set equal to <code>4</code>.</p></dd>

  <dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>positive integer specifying the number of future sampling “occasions”.
  The default value is <code>r=1</code>.</p></dd>

  <dt id="arg-rule">rule<a class="anchor" aria-label="anchor" href="#arg-rule"></a></dt>
<dd><p>character string specifying which rule to use.  The possible values are
  <code>"k.of.m"</code> (\(k\)-of-\(m\) rule; the default), <code>"CA"</code> (California rule),
  and <code>"Modified.CA"</code> (modified California rule).
  See the DETAILS section below for more information.</p></dd>

  <dt id="arg-lpl-rank">lpl.rank<a class="anchor" aria-label="anchor" href="#arg-lpl-rank"></a></dt>
<dd><p>positive integer indicating the rank of the order statistic to use for the lower
  bound of the prediction interval.  When <code>pi.type="lower"</code>, the default value
  is <code>lpl.rank=1</code> (implying the minimum value of <code>x</code> is used as the lower
  bound of the prediction interval).  When <code>pi.type="upper"</code>, the argument
  <code>lpl.rank</code> is set equal to <code>0</code> and the value of <code>lb</code> is used as the
  lower bound of the tolerance interval.</p></dd>

  <dt id="arg-n-plus-one-minus-upl-rank">n.plus.one.minus.upl.rank<a class="anchor" aria-label="anchor" href="#arg-n-plus-one-minus-upl-rank"></a></dt>
<dd><p>positive integer related to the rank of the order statistic to use for the upper
  bound of the prediction interval.  A value of <code>n.plus.one.minus.upl.rank=1</code>
  (the default) means use the first largest value, and in general a value of <br><code>n.plus.one.minus.upl.rank=</code>\(i\) means use the \(i\)'th largest value.
  When <br><code>pi.type="lower"</code>, the argument <code>n.plus.one.minus.upl.rank</code> is set
  equal to <code>0</code> and the value of <code>ub</code> is used as the upper bound of the
  prediction interval.</p></dd>

  <dt id="arg-lb-ub">lb, ub<a class="anchor" aria-label="anchor" href="#arg-lb-ub"></a></dt>
<dd><p>scalars indicating lower and upper bounds on the distribution.  By default,
  <code>lb=-Inf</code> and <code>ub=Inf</code>.  If you are constructing a prediction interval for
  a distribution that you know has a lower bound other than <code>-Inf</code>
  (e.g., <code>0</code>), set <code>lb</code> to this value.  Similarly, if you know the
  distribution has an upper bound other than <code>Inf</code>, set <code>ub</code> to this value.
  The argument <code>lb</code> is ignored if <code>pi.type="two-sided"</code> or
  <code>pi.type="lower"</code>.  The argument <code>ub</code> is ignored if
  <code>pi.type="two-sided"</code> or <code>pi.type="upper"</code>.</p></dd>

  <dt id="arg-pi-type">pi.type<a class="anchor" aria-label="anchor" href="#arg-pi-type"></a></dt>
<dd><p>character string indicating what kind of prediction interval to compute.
  The possible values are <code>"upper"</code> (the default) and <code>"lower"</code>.</p></dd>

  <dt id="arg-integrate-args-list">integrate.args.list<a class="anchor" aria-label="anchor" href="#arg-integrate-args-list"></a></dt>
<dd><p>a list of arguments to supply to the <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code> function.  The
  default value is <code>integrate.args.list=NULL</code> which means that the
  default values of <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></code> are used.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><em>What is a Nonparametric Simultaneous Prediction Interval?</em> <br>
  A nonparametric prediction interval for some population is an interval on the real line
  constructed so that it will contain at least \(k\) of \(m\) future observations from
  that population with some specified probability \((1-\alpha)100\%\), where
  \(0 &lt; \alpha &lt; 1\) and \(k\) and \(m\) are some pre-specified positive integers
  and \(k \le m\).  The quantity \((1-\alpha)100\%\) is called
  the confidence coefficient or confidence level associated with the prediction
  interval.  The function <code><a href="predIntNpar.html">predIntNpar</a></code> computes a standard
  nonparametric prediction interval.</p>
<p>The function <code>predIntNparSimultaneous</code> computes a nonparametric simultaneous
  prediction interval that will contain a certain number of future observations
  with probability \((1-\alpha)100\%\) for each of \(r\) future sampling
  “occasions”,
  where \(r\) is some pre-specified positive integer.  The quantity \(r\) may
  refer to \(r\) distinct future sampling occasions in time, or it may for example
  refer to sampling at \(r\) distinct locations on one future sampling occasion,
  assuming that the population standard deviation is the same at all of the \(r\)
  distinct locations.</p>
<p>The function <code>predIntNparSimultaneous</code> computes a nonparametric simultaneous
  prediction interval based on one of three possible rules:</p><ul><li><p>For the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>), at least \(k\) of
    the next \(m\) future observations will fall in the prediction
    interval with probability \((1-\alpha)100\%\) on each of the \(r\) future
    sampling occasions.  If obserations are being taken sequentially, for a particular
    sampling occasion, up to \(m\) observations may be taken, but once
    \(k\) of the observations fall within the prediction interval, sampling can stop.
    Note:  For this rule, when \(r=1\), the results of <code>predIntNparSimultaneous</code>
    are equivalent to the results of <code><a href="predIntNpar.html">predIntNpar</a></code>.</p></li>
<li><p>For the California rule (<code>rule="CA"</code>), with probability
    \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either
    the first observation will fall in the prediction interval, or else all of the next
    \(m-1\) observations will fall in the prediction interval. That is, if the first
    observation falls in the prediction interval then sampling can stop.  Otherwise,
    \(m-1\) more observations must be taken.</p></li>
<li><p>For the Modified California rule (<code>rule="Modified.CA"</code>), with probability
    \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either the
    first observation will fall in the prediction interval, or else at least 2 out of
    the next 3 observations will fall in the prediction interval.  That is, if the first
    observation falls in the prediction interval then sampling can stop.  Otherwise, up
    to 3 more observations must be taken.</p></li>
</ul><p>Nonparametric simultaneous prediction intervals can be extended to using medians
  in place of single observations (USEPA, 2009, Chapter 19).  That is, you can
  create a nonparametric simultaneous prediction interval that will contain a
  specified number of medians (based on which rule you choose) on each of \(r\)
  future sampling occassions, where each each median is based on \(b\) individual
  observations.  For the function <code>predIntNparSimultaneous</code>, the argument
  <code>n.median</code> corresponds to \(b\).
  <br></p>
<p><b>The Form of a Nonparametric Prediction Interval</b> <br>
  Let \(\underline{x} = x_1, x_2, \ldots, x_n\) denote a vector of \(n\)
  independent observations from some continuous distribution, and let
  \(x_{(i)}\) denote the the \(i\)'th order statistics in \(\underline{x}\).
  A two-sided nonparametric prediction interval is constructed as:
  $$[x_{(u)}, x_{(v)}] \;\;\;\;\;\; (1)$$
  where \(u\) and \(v\) are positive integers between 1 and \(n\), and
  \(u &lt; v\).  That is, \(u\) denotes the rank of the lower prediction limit, and
  \(v\) denotes the rank of the upper prediction limit.  To make it easier to write
  some equations later on, we can also write the prediction interval (1) in a slightly
  different way as:
  $$[x_{(u)}, x_{(n + 1 - w)}] \;\;\;\;\;\; (2)$$
  where
  $$w = n + 1 - v \;\;\;\;\;\; (3)$$
  so that \(w\) is a positive integer between 1 and \(n-1\), and
  \(u &lt; n+1-w\).  In terms of the arguments to the function <code>predIntNparSimultaneous</code>,
  the argument <code>lpl.rank</code> corresponds to \(u\), and the argument
  <code>n.plus.one.minus.upl.rank</code> corresponds to \(w\).</p>
<p>If we allow \(u=0\) and \(w=0\) and define lower and upper bounds as:
  $$x_{(0)} = lb \;\;\;\;\;\; (4)$$
  $$x_{(n+1)} = ub \;\;\;\;\;\; (5)$$
  then Equation (2) above can also represent a one-sided lower or one-sided upper
  prediction interval as well.  That is, a one-sided lower nonparametric prediction
  interval is constructed as:
  $$[x_{(u)}, x_{(n + 1)}] =  [x_{(u)}, ub] \;\;\;\;\;\; (6)$$
  and a one-sided upper nonparametric prediction interval is constructed as:
  $$[x_{(0)}, x_{(n + 1 - w)}]  = [lb, x_{(n + 1 - w)}] \;\;\;\;\;\; (7)$$
  Usually, \(lb = -\infty\) or \(lb = 0\) and \(ub = \infty\).</p>
<p><b>Note:</b>  For nonparametric simultaneous prediction intervals, only lower
  (<code>pi.type="lower"</code>) and upper (<code>pi.type="upper"</code>) prediction
  intervals are available.
  <br></p>
<p><b>Constructing Nonparametric Simultaneous Prediction Intervals for Future Observations</b> <br>
  First we will show how to construct a nonparametric simultaneous prediction interval based on
  future observations (i.e., \(b=1\), <code>n.median=1</code>), and then extend the formulas to
  future medians.
  <br></p>
<p><em>Simultaneous Prediction Intervals for the k-of-m Rule</em> (<code>rule="k.of.m"</code>) <br>
  For the \(k\)-of-\(m\) rule (<code>rule="k.of.m"</code>) with \(w=1\)
  (i.e., <code>n.median=1</code>), at least \(k\) of the next \(m\) future
  observations will fall in the prediction interval
  with probability \((1-\alpha)100\%\) on each of the \(r\) future sampling
  occasions.  If observations are being taken sequentially, for a particular
  sampling occasion, up to \(m\) observations may be taken, but once \(k\)
  of the observations fall within the prediction interval, sampling can stop.
  Note: When \(r=1\), this kind of simultaneous prediction
  interval becomes the same as a standard nonparametric prediction interval
  (see <code><a href="predIntNpar.html">predIntNpar</a></code>).</p>
<p>Chou and Owen (1986) developed the theory for nonparametric simultaneous prediction limits
  for various rules, including the 1-of-\(m\) rule.  Their theory, however, does not cover
  the California or Modified California rules, and uses an \(r\)-fold summation involving a
  minimum of \(2^r\) terms.  Davis and McNichols (1994b; 1999) extended the results of
  Chou and Owen (1986) to include the California and Modified California rule, and developed
  algorithms that involve summing far fewer terms.</p>
<p>Davis and McNichols (1999) give formulas for the probabilities associated with the
  one-sided upper simultaneous prediction interval shown in Equation (7).  For the
  \(k\)-of-\(m\) rule, the probability that at least \(k\) of the next \(m\)
  future observations will be contained in the interval given in Equation (7) for each
  of \(r\) future sampling occasions is given by:</p><table class="table table"><tr><td>\(1 - \alpha\)</td><td>\(=\)</td><td>\(E[\sum_{i=0}^{m-k} {{k-1+i} \choose {k-1}} Y^k (1-Y)^i]^r\)</td></tr><tr><td></td><td>\(=\)</td><td>\(\int_0^1 [\sum_{i=0}^{m-k} {{k-1+i} \choose {k-1}} y^k (1-y)^i]^r f(y) dy \;\;\;\;\;\; (8)\)</td></tr></table><p>where \(Y\) denotes a random variable with a <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta distribution</a>
  with parameters \(v\) and \(n+1-v\), and \(f()\) denotes the pdf of this
  distribution.  Note that \(v\) denotes the rank of the order statistic used as the
  upper prediction limit (i.e., <code>n.plus.one.minus.upl.rank=</code>\(n+1-v\)), and
  that \(v\) is usually equal to \(n\).</p>
<p>Also note that the summation term in Equation (8) corresponds to the cumulative
  distribution function of a <a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">Negative Binomial distribution</a>
  with parameters <code>size=</code>\(k\) and <code>prob=</code>\(y\) evaluated at
  <code>q=</code>\(m-k\).</p>
<p>When <code>pi.type="lower"</code>, \(Y\) denotes a random variable with a
  <a href="https://rdrr.io/r/stats/Beta.html" class="external-link">beta distribution</a> with parameters \(n+1-u\) and
  \(u\).  Note that \(u\) denotes the rank of the order statistic used as the
  lower prediction limit (i.e., <code>lpl.rank=</code>\(u\)), and
  that \(u\) is usually equal to \(1\).
  <br></p>
<p><em>Simultaneous Prediction Intervals for the California Rule</em> (<code>rule="CA"</code>) <br>
  For the California rule (<code>rule="CA"</code>), with probability \((1-\alpha)100\%\),
  for each of the \(r\) future sampling occasions, either the first observation will
  fall in the prediction interval, or else all of the next \(m-1\) observations will
  fall in the prediction interval.  That is, if the first observation falls in the
  prediction interval then sampling can stop.  Otherwise, \(m-1\) more observations
  must be taken.</p>
<p>In this case, the probability is given by:</p><table class="table table"><tr><td>\(1 - \alpha\)</td><td>\(=\)</td><td>\(E[\sum_{i=0}^r {r \choose i} Y^{r - i + (m-1)i} (1-Y)^i]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(\int_0^1  [\sum_{i=0}^r {r \choose i} y^{r - i + (m-1)i} (1-y)^i] f(y) dy \;\;\;\;\;\; (9)\)</td></tr></table><p><em>Simultaneous Prediction Intervals for the Modified California Rule</em> (<code>rule="Modified.CA"</code>) <br>
  For the Modified California rule (<code>rule="Modified.CA"</code>), with probability
  \((1-\alpha)100\%\), for each of the \(r\) future sampling occasions, either the
  first observation will fall in the prediction interval, or else at least 2 out of
  the next 3 observations will fall in the prediction interval.  That is, if the first
  observation falls in the prediction interval then sampling can stop.  Otherwise, up
  to 3 more observations must be taken.</p>
<p>In this case, the probability is given by:</p><table class="table table"><tr><td>\(1 - \alpha\)</td><td>\(=\)</td><td>\(E[Y^r (1 + Q + Q^2 - 2Q^3)^r]\)</td></tr><tr><td></td><td>\(=\)</td><td>\(\int_0^1 [y^r (1 + q + q^2 - 2q^3)^r] f(y) dy \;\;\;\;\;\; (10)\)</td></tr></table><p>where \(Q = 1 - Y\) and \(q = 1 - y\).</p>
<p>Davis and McNichols (1999) provide algorithms for computing the probabilities based on expanding
  polynomials and the formula for the expected value of a beta random variable.  In the discussion
  section of Davis and McNichols (1999), however, Vangel points out that numerical integration is
  adequate, and this is how these probabilities are computed in the function
  <code>predIntNparSimultaneous</code>.
  <br></p>
<p><b>Constructing Nonparametric Simultaneous Prediction Intervals for Future Medians</b> <br>
  USEPA (2009, Chapter 19; Cameron, 2011) extends nonparametric simultaneous
  prediction intervals to testing future medians for the case of the 1-of-1 and
  1-of-2 plans for medians of order 3.  In general, each of the rules
  (\(k\)-of-\(m\), California, and Modified California) can be easily
  extended to the case of using medians as long as the medians are based on an
  odd (as opposed to even) sample size.</p>
<p>For each of the above rules, if we are interested in using medians instead of
  single observations (i.e., \(b \ge 1\); <code>n.median</code>\(\ge 1\)), and we
  force \(b\) to be odd, then a median will be less than a prediction limit
  once \((b+1)/2\) observations are less than the prediction limit.  Thus,
  Equations (8) - (10) are modified by replacing \(y\) with the term:
  $$\sum_{i=0}^{b - b'} {{b' - 1 + i} \choose {b' - 1}} y^{b'} (1 - y)^i \;\;\;\;\;\; (11)$$
  where
  $$b' = \frac{b+1}{2} \;\;\;\;\;\; (12)$$</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of class <code>"estimate"</code> containing the simultaneous prediction interval
  and other information.  See the help file for <code><a href="estimate.object.html">estimate.object</a></code> for
  details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cameron, Kirk. (2011).  Personal communication, February 16, 2011.
    MacStat Consulting, Ltd., Colorado Springs, Colorado.</p>
<p>Chew, V. (1968).  Simultaneous Prediction Intervals.  <em>Technometrics</em>
  <b>10</b>(2), 323–331.</p>
<p>Danziger, L., and S. Davis. (1964).  Tables of Distribution-Free Tolerance Limits.
  <em>Annals of Mathematical Statistics</em> <b>35</b>(5), 1361–1365.</p>
<p>Davis, C.B. (1994).  Environmental Regulatory Statistics.  In Patil, G.P.,
  and C.R. Rao, eds., <em>Handbook of Statistics, Vol. 12: Environmental Statistics</em>.
  North-Holland, Amsterdam, a division of Elsevier, New York, NY, Chapter 26, 817–865.</p>
<p>Davis, C.B., and R.J. McNichols. (1987).  One-sided Intervals for at Least p of m
  Observations from a Normal Population on Each of r Future Occasions.
  <em>Technometrics</em> <b>29</b>, 359–370.</p>
<p>Davis, C.B., and R.J. McNichols. (1994a).  Ground Water Monitoring Statistics Update:
  Part I: Progress Since 1988.  <em>Ground Water Monitoring and Remediation</em>
  <b>14</b>(4), 148–158.</p>
<p>Davis, C.B., and R.J. McNichols. (1994b).  Ground Water Monitoring Statistics Update:
  Part II:  Nonparametric Prediction Limits.
  <em>Ground Water Monitoring and Remediation</em> <b>14</b>(4), 159–175.</p>
<p>Davis, C.B., and R.J. McNichols. (1999).  Simultaneous Nonparametric Prediction
  Limits (with Discusson).  <em>Technometrics</em> <b>41</b>(2), 89–112.</p>
<p>Gibbons, R.D. (1987a).  Statistical Prediction Intervals for the Evaluation of
  Ground-Water Quality.  <em>Ground Water</em> <b>25</b>, 455–465.</p>
<p>Gibbons, R.D. (1991b).  Statistical Tolerance Limits for Ground-Water Monitoring.
  <em>Ground Water</em> <b>29</b>, 563–570.</p>
<p>Gibbons, R.D., and J. Baker. (1991).  The Properties of Various Statistical
  Prediction Intervals for Ground-Water Detection Monitoring.
  <em>Journal of Environmental Science and Health</em> <b>A26</b>(4), 535–553.</p>
<p>Gibbons, R.D., D.K. Bhaumik, and S. Aryal. (2009).
  <em>Statistical Methods for Groundwater Monitoring</em>, Second Edition.
  John Wiley &amp; Sons, Hoboken.</p>
<p>Hahn, G.J., and W.Q. Meeker. (1991).
  <em>Statistical Intervals: A Guide for Practitioners</em>.  John Wiley and Sons,
  New York, 392pp.</p>
<p>Hahn, G., and W. Nelson. (1973).  A Survey of Prediction Intervals and Their
  Applications.  <em>Journal of Quality Technology</em> <b>5</b>, 178–188.</p>
<p>Hall, I.J., R.R. Prairie, and C.K. Motlagh. (1975).  Non-Parametric Prediction
  Intervals.  <em>Journal of Quality Technology</em> <b>7</b>(3), 109–114.</p>
<p>Millard, S.P., and Neerchal, N.K. (2001). <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, Florida.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
<p>USEPA. (2010).  <em>Errata Sheet - March 2009 Unified Guidance</em>.
  EPA 530/R-09-007a, August 9, 2010.  Office of Resource Conservation and Recovery, Program Information and Implementation Division.
  U.S. Environmental Protection Agency, Washington, D.C.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Prediction and tolerance intervals have long been applied to quality control and
  life testing problems (Hahn, 1970b,c; Hahn and Nelson, 1973;
  Krishnamoorthy and Mathew, 2009).
  In the context of environmental statistics, prediction intervals are useful for
  analyzing data from groundwater detection monitoring programs at hazardous and
  solid waste facilities (e.g., Gibbons et al., 2009; Millard and Neerchal, 2001;
  USEPA, 2009).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="predIntNparSimultaneousConfLevel.html">predIntNparSimultaneousConfLevel</a></code>,
  <code><a href="predIntNparSimultaneousN.html">predIntNparSimultaneousN</a></code>, <br><code><a href="plotPredIntNparSimultaneousDesign.html">plotPredIntNparSimultaneousDesign</a></code>,
  <code><a href="predIntNparSimultaneousTestPower.html">predIntNparSimultaneousTestPower</a></code>,
  <code><a href="predIntNpar.html">predIntNpar</a></code>, <code><a href="tolIntNpar.html">tolIntNpar</a></code>,
  <code><a href="estimate.object.html">estimate.object</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Generate 20 observations from a lognormal mixture distribution with </span></span></span>
<span class="r-in"><span>  <span class="co"># parameters mean1=1, cv1=0.5, mean2=5, cv2=1, and p.mix=0.1.  Use </span></span></span>
<span class="r-in"><span>  <span class="co"># predIntNparSimultaneous to construct an upper one-sided prediction interval </span></span></span>
<span class="r-in"><span>  <span class="co"># using the maximum observed value using the 1-of-3 rule.  </span></span></span>
<span class="r-in"><span>  <span class="co"># (Note: the call to set.seed simply allows you to reproduce this example.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">250</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalMixAlt.html">rlnormMixAlt</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, mean1 <span class="op">=</span> <span class="fl">1</span>, cv1 <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    mean2 <span class="op">=</span> <span class="fl">5</span>, cv2 <span class="op">=</span> <span class="fl">1</span>, p.mix <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            dat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Method:      exact </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Type:        upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                99.94353%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Limit Rank(s):        20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interval Should Contain:         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Observations:             3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval:             LPL = 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UPL = 1.817311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Method:      exact </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                99.94353%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Limit Rank(s):        20 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Minimum Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Observations</span></span></span>
<span class="r-in"><span>  <span class="co">#Interval Should Contain:         1</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Total Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Observations:             3</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval:             LPL = 0.000000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UPL = 1.817311</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare the confidence levels for the 1-of-3 rule, California Rule, and </span></span></span>
<span class="r-in"><span>  <span class="co"># Modified California Rule.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9994353</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9994353</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, m <span class="op">=</span> <span class="fl">3</span>, rule <span class="op">=</span> <span class="st">"CA"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9919066</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9919066</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, rule <span class="op">=</span> <span class="st">"Modified.CA"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9984943</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9984943</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#=========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Repeat the above example, but create the baseline data using just </span></span></span>
<span class="r-in"><span>  <span class="co"># n=8 observations and set r to 4 future sampling occasions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">598</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="LognormalMixAlt.html">rlnormMixAlt</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">8</span>, mean1 <span class="op">=</span> <span class="fl">1</span>, cv1 <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>    mean2 <span class="op">=</span> <span class="fl">5</span>, cv2 <span class="op">=</span> <span class="fl">1</span>, p.mix <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">4</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            dat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Method:      exact </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Type:        upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                97.7599%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Limit Rank(s):        8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interval Should Contain</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (per Sampling Occasion):         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (per Sampling Occasion):         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling Occasions:              4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval:             LPL = 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UPL = 5.683453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            dat</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     8</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Method:      exact </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                97.7599%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Limit Rank(s):        8 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Minimum Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Observations</span></span></span>
<span class="r-in"><span>  <span class="co">#Interval Should Contain</span></span></span>
<span class="r-in"><span>  <span class="co">#(per Sampling Occasion):         1</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Total Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Observations</span></span></span>
<span class="r-in"><span>  <span class="co">#(per Sampling Occasion):         3</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number of Future</span></span></span>
<span class="r-in"><span>  <span class="co">#Sampling Occasions:              4</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval:             LPL = 0.000000</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UPL = 5.683453</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare the confidence levels for the 1-of-3 rule, California Rule, and </span></span></span>
<span class="r-in"><span>  <span class="co"># Modified California Rule.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">4</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.977599</span>
<span class="r-in"><span>  <span class="co">#[1] 0.977599</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, m <span class="op">=</span> <span class="fl">3</span>, r <span class="op">=</span> <span class="fl">4</span>, rule <span class="op">=</span> <span class="st">"CA"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8737798</span>
<span class="r-in"><span>  <span class="co">#[1] 0.8737798</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">dat</span>, r <span class="op">=</span> <span class="fl">4</span>, rule <span class="op">=</span> <span class="st">"Modified.CA"</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">interval</span><span class="op">$</span><span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9510178</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9510178</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example 19-5 of USEPA (2009, p. 19-33) shows how to compute nonparametric upper </span></span></span>
<span class="r-in"><span>  <span class="co"># simultaneous prediction limits for various rules based on trace mercury data (ppb) </span></span></span>
<span class="r-in"><span>  <span class="co"># collected in the past year from a site with four background wells and 10 compliance </span></span></span>
<span class="r-in"><span>  <span class="co"># wells (data for two of the compliance wells  are shown in the guidance document).  </span></span></span>
<span class="r-in"><span>  <span class="co"># The facility must monitor the 10 compliance wells for five constituents </span></span></span>
<span class="r-in"><span>  <span class="co"># (including mercury) annually.</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Here we will compute the confidence level associated with two different sampling plans: </span></span></span>
<span class="r-in"><span>  <span class="co"># 1) the 1-of-2 retesting plan for a median of order 3 using the background maximum and </span></span></span>
<span class="r-in"><span>  <span class="co"># 2) the 1-of-4 plan on individual observations using the 3rd highest background value.</span></span></span>
<span class="r-in"><span>  <span class="co"># The data for this example are stored in EPA.09.Ex.19.5.mercury.df.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We will pool data from 4 background wells that were sampled on </span></span></span>
<span class="r-in"><span>  <span class="co"># a number of different occasions, giving us a sample size of </span></span></span>
<span class="r-in"><span>  <span class="co"># n = 20 to use to construct the prediction limit.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># There are 10 compliance wells and we will monitor 5 different </span></span></span>
<span class="r-in"><span>  <span class="co"># constituents at each well annually.  For this example, USEPA (2009) </span></span></span>
<span class="r-in"><span>  <span class="co"># recommends setting r to the product of the number of compliance wells and </span></span></span>
<span class="r-in"><span>  <span class="co"># the number of evaluations per year.  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># To determine the minimum confidence level we require for </span></span></span>
<span class="r-in"><span>  <span class="co"># the simultaneous prediction interval, USEPA (2009) recommends </span></span></span>
<span class="r-in"><span>  <span class="co"># setting the maximum allowed individual Type I Error level per constituent to:</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>  <span class="co"># 1 - (1 - SWFPR)^(1 / Number of Constituents)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># which translates to setting the confidence limit to </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># (1 - SWFPR)^(1 / Number of Constituents)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># where SWFPR = site-wide false positive rate.  For this example, we </span></span></span>
<span class="r-in"><span>  <span class="co"># will set SWFPR = 0.1.  Thus, the required individual Type I Error level </span></span></span>
<span class="r-in"><span>  <span class="co"># and confidence level per constituent are given as follows:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># n  = 20 based on 4 Background Wells</span></span></span>
<span class="r-in"><span>  <span class="co"># nw = 10 Compliance Wells</span></span></span>
<span class="r-in"><span>  <span class="co"># nc =  5 Constituents</span></span></span>
<span class="r-in"><span>  <span class="co"># ne =  1 Evaluation per year</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">n</span>  <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span>  <span class="va">nw</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>  <span class="va">nc</span> <span class="op">&lt;-</span>  <span class="fl">5</span></span></span>
<span class="r-in"><span>  <span class="va">ne</span> <span class="op">&lt;-</span>  <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Set number of future sampling occasions r to </span></span></span>
<span class="r-in"><span>  <span class="co"># Number Compliance Wells x Number Evaluations per Year</span></span></span>
<span class="r-in"><span>  <span class="va">r</span>  <span class="op">&lt;-</span>  <span class="va">nw</span> <span class="op">*</span> <span class="va">ne</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">nc</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">conf.level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9791484</span>
<span class="r-in"><span>  <span class="co">#[1] 0.9791484</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">conf.level</span></span></span>
<span class="r-in"><span>  <span class="va">alpha</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02085164</span>
<span class="r-in"><span>  <span class="co">#[1] 0.02085164</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Look at the data:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.5.mercury.df</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Event Well  Well.type Mercury.ppb.orig Mercury.ppb Censored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 BG-1 Background             0.21        0.21    FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 BG-1 Background              &lt;.2        0.20     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3 BG-1 Background              &lt;.2        0.20     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4 BG-1 Background              &lt;.2        0.20     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5 BG-1 Background              &lt;.2        0.20     TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6 BG-1 Background                           NA    FALSE</span>
<span class="r-in"><span>  <span class="co">#  Event Well  Well.type Mercury.ppb.orig Mercury.ppb Censored</span></span></span>
<span class="r-in"><span>  <span class="co">#1     1 BG-1 Background             0.21        0.21    FALSE</span></span></span>
<span class="r-in"><span>  <span class="co">#2     2 BG-1 Background              &lt;.2        0.20     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#3     3 BG-1 Background              &lt;.2        0.20     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#4     4 BG-1 Background              &lt;.2        0.20     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#5     5 BG-1 Background              &lt;.2        0.20     TRUE</span></span></span>
<span class="r-in"><span>  <span class="co">#6     6 BG-1 Background                           NA    FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="longToWide.html">longToWide</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.5.mercury.df</span>, <span class="st">"Mercury.ppb.orig"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"Event"</span>, <span class="st">"Well"</span>, paste.row.name <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         BG-1 BG-2 BG-3 BG-4 CW-1 CW-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event.1 0.21  &lt;.2  &lt;.2  &lt;.2 0.22 0.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event.2  &lt;.2  &lt;.2 0.23 0.25  0.2 0.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event.3  &lt;.2  &lt;.2  &lt;.2 0.28  &lt;.2 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event.4  &lt;.2 0.21 0.23  &lt;.2 0.25 0.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event.5  &lt;.2  &lt;.2 0.24  &lt;.2 0.24 0.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Event.6                      &lt;.2 0.54</span>
<span class="r-in"><span>  <span class="co">#        BG-1 BG-2 BG-3 BG-4 CW-1 CW-2</span></span></span>
<span class="r-in"><span>  <span class="co">#Event.1 0.21  &lt;.2  &lt;.2  &lt;.2 0.22 0.36</span></span></span>
<span class="r-in"><span>  <span class="co">#Event.2  &lt;.2  &lt;.2 0.23 0.25  0.2 0.41</span></span></span>
<span class="r-in"><span>  <span class="co">#Event.3  &lt;.2  &lt;.2  &lt;.2 0.28  &lt;.2 0.28</span></span></span>
<span class="r-in"><span>  <span class="co">#Event.4  &lt;.2 0.21 0.23  &lt;.2 0.25 0.45</span></span></span>
<span class="r-in"><span>  <span class="co">#Event.5  &lt;.2  &lt;.2 0.24  &lt;.2 0.24 0.43</span></span></span>
<span class="r-in"><span>  <span class="co">#Event.6                      &lt;.2 0.54</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Construct the upper simultaneous prediction limit using the 1-of-2  </span></span></span>
<span class="r-in"><span>  <span class="co"># retesting plan for a median of order 3 based on the background maximum </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Hg.Back</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.5.mercury.df</span>, </span></span>
<span class="r-in"><span>    <span class="va">Mercury.ppb</span><span class="op">[</span><span class="va">Well.type</span> <span class="op">==</span> <span class="st">"Background"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pred.int.1.of.2.med.3</span> <span class="op">&lt;-</span> <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">Hg.Back</span>, n.median <span class="op">=</span> <span class="fl">3</span>, </span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">2</span>, r <span class="op">=</span> <span class="va">r</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 4 nonfinite values in x : 4 NA's</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>4 observations with NA/NaN/Inf in 'x' removed.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pred.int.1.of.2.med.3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            Hg.Back</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number NA/NaN/Inf's:             4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Method:      exact </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Type:        upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                99.40354%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Limit Rank(s):        20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Medians</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interval Should Contain</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (per Sampling Occasion):         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Medians</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (per Sampling Occasion):         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling Occasions:              10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size for Medians:         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval:             LPL = 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UPL = 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Hg.Back</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number NA/NaN/Inf's:             4</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Method:      exact </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                99.40354%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Limit Rank(s):        20 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Minimum Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Medians</span></span></span>
<span class="r-in"><span>  <span class="co">#Interval Should Contain</span></span></span>
<span class="r-in"><span>  <span class="co">#(per Sampling Occasion):         1</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Total Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Medians</span></span></span>
<span class="r-in"><span>  <span class="co">#(per Sampling Occasion):         2</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number of Future</span></span></span>
<span class="r-in"><span>  <span class="co">#Sampling Occasions:              10</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size for Medians:         3</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval:             LPL = 0.00</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UPL = 0.28</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the achieved confidence level of 99.4% is greater than the </span></span></span>
<span class="r-in"><span>  <span class="co"># required confidence level of 97.9%.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now determine whether either compliance well indicates evidence of </span></span></span>
<span class="r-in"><span>  <span class="co"># Mercury contamination.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compliance Well 1</span></span></span>
<span class="r-in"><span>  <span class="co">#------------------</span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.5.mercury.df</span>, <span class="va">Mercury.ppb.orig</span><span class="op">[</span><span class="va">Well</span> <span class="op">==</span> <span class="st">"CW-1"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "0.22" "0.2"  "&lt;.2"  "0.25" "0.24" "&lt;.2" </span>
<span class="r-in"><span>  <span class="co">#[1] "0.22" "0.2"  "&lt;.2"  "0.25" "0.24" "&lt;.2"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The median of the first 3 observations is 0.2, which is less than </span></span></span>
<span class="r-in"><span>  <span class="co"># the UPL of 0.28, so there is no evidence of contamination.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compliance Well 2</span></span></span>
<span class="r-in"><span>  <span class="co">#------------------</span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.5.mercury.df</span>, <span class="va">Mercury.ppb.orig</span><span class="op">[</span><span class="va">Well</span> <span class="op">==</span> <span class="st">"CW-2"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "0.36" "0.41" "0.28" "0.45" "0.43" "0.54"</span>
<span class="r-in"><span>  <span class="co">#[1] "0.36" "0.41" "0.28" "0.45" "0.43" "0.54"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The median of the first 3 observations is 0.36, so 3 more observations have to </span></span></span>
<span class="r-in"><span>  <span class="co"># be looked at.  The median of the second 3 observations is 0.45, which is </span></span></span>
<span class="r-in"><span>  <span class="co"># larger than the UPL of 0.28, so there is evidence of contamination.  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#----------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now create the upper simultaneous prediction limit using the 1-of-4 plan </span></span></span>
<span class="r-in"><span>  <span class="co"># on individual observations using the 3rd highest background value.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pred.int.1.of.4.3rd</span> <span class="op">&lt;-</span> <span class="fu">predIntNparSimultaneous</span><span class="op">(</span><span class="va">Hg.Back</span>, k <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">4</span>, </span></span>
<span class="r-in"><span>    r <span class="op">=</span> <span class="va">r</span>, lb <span class="op">=</span> <span class="fl">0</span>, n.plus.one.minus.upl.rank <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 4 nonfinite values in x : 4 NA's</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>4 observations with NA/NaN/Inf in 'x' removed.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">pred.int.1.of.4.3rd</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Distribution Parameter Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assumed Distribution:            None</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:                            Hg.Back</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size:                     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number NA/NaN/Inf's:             4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Method:      exact </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval Type:        upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:                98.64909%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Limit Rank(s):        18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interval Should Contain</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (per Sampling Occasion):         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total Number of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Future Observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (per Sampling Occasion):         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling Occasions:              10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Interval:             LPL = 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  UPL = 0.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Results of Distribution Parameter Estimation</span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Assumed Distribution:            None</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Data:                            Hg.Back</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Sample Size:                     20</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number NA/NaN/Inf's:             4</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Method:      exact </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval Type:        upper</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Confidence Level:                98.64909%</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Limit Rank(s):        18 </span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Minimum Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Observations</span></span></span>
<span class="r-in"><span>  <span class="co">#Interval Should Contain</span></span></span>
<span class="r-in"><span>  <span class="co">#(per Sampling Occasion):         1</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Total Number of</span></span></span>
<span class="r-in"><span>  <span class="co">#Future Observations</span></span></span>
<span class="r-in"><span>  <span class="co">#(per Sampling Occasion):         4</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Number of Future</span></span></span>
<span class="r-in"><span>  <span class="co">#Sampling Occasions:              10</span></span></span>
<span class="r-in"><span>  <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="co">#Prediction Interval:             LPL = 0.00</span></span></span>
<span class="r-in"><span>  <span class="co">#                                 UPL = 0.24</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Note that the achieved confidence level of 98.6% is greater than the </span></span></span>
<span class="r-in"><span>  <span class="co"># required confidence level of 97.9%.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now determine whether either compliance well indicates evidence of </span></span></span>
<span class="r-in"><span>  <span class="co"># Mercury contamination.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compliance Well 1</span></span></span>
<span class="r-in"><span>  <span class="co">#------------------</span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.5.mercury.df</span>, <span class="va">Mercury.ppb.orig</span><span class="op">[</span><span class="va">Well</span> <span class="op">==</span> <span class="st">"CW-1"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "0.22" "0.2"  "&lt;.2"  "0.25" "0.24" "&lt;.2" </span>
<span class="r-in"><span>  <span class="co">#[1] "0.22" "0.2"  "&lt;.2"  "0.25" "0.24" "&lt;.2"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The first observation is less than the UPL of 0.24, which is less than </span></span></span>
<span class="r-in"><span>  <span class="co"># the UPL of 0.28, so there is no evidence of contamination.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compliance Well 2</span></span></span>
<span class="r-in"><span>  <span class="co">#------------------</span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.19.5.mercury.df</span>, <span class="va">Mercury.ppb.orig</span><span class="op">[</span><span class="va">Well</span> <span class="op">==</span> <span class="st">"CW-2"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">Hg.CW.2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "0.36" "0.41" "0.28" "0.45" "0.43" "0.54"</span>
<span class="r-in"><span>  <span class="co">#[1] "0.36" "0.41" "0.28" "0.45" "0.43" "0.54"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># All of the first 4 observations are greater than the UPL of 0.24, so there </span></span></span>
<span class="r-in"><span>  <span class="co"># is evidence of contamination.  </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Cleanup</span></span></span>
<span class="r-in"><span>  <span class="co">#--------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">n</span>, <span class="va">nw</span>, <span class="va">nc</span>, <span class="va">ne</span>, <span class="va">r</span>, <span class="va">conf.level</span>, <span class="va">alpha</span>, <span class="va">Hg.Back</span>, <span class="va">pred.int.1.of.2.med.3</span>, </span></span>
<span class="r-in"><span>    <span class="va">pred.int.1.of.4.3rd</span>, <span class="va">Hg.CW.1</span>, <span class="va">Hg.CW.2</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

