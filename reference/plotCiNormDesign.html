<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plots for Sampling Design Based on Confidence Interval for Mean of a Normal Distribution or Difference Between Two Means — plotCiNormDesign • EnvStats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plots for Sampling Design Based on Confidence Interval for Mean of a Normal Distribution or Difference Between Two Means — plotCiNormDesign"><meta property="og:description" content="Create plots involving sample size, half-width, estimated standard deviation, and confidence level
  for a confidence interval for the mean of a normal distribution or the difference between two means."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EnvStats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexkowa/EnvStats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots for Sampling Design Based on Confidence Interval for Mean of a Normal Distribution or Difference Between Two Means</h1>

    <div class="hidden name"><code>plotCiNormDesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create plots involving sample size, half-width, estimated standard deviation, and confidence level
  for a confidence interval for the mean of a normal distribution or the difference between two means.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotCiNormDesign</span><span class="op">(</span>x.var <span class="op">=</span> <span class="st">"n"</span>, y.var <span class="op">=</span> <span class="st">"half.width"</span>, </span>
<span>    range.x.var <span class="op">=</span> <span class="cn">NULL</span>, n.or.n1 <span class="op">=</span> <span class="fl">25</span>, n2 <span class="op">=</span> <span class="va">n.or.n1</span>, </span>
<span>    half.width <span class="op">=</span> <span class="va">sigma.hat</span><span class="op">/</span><span class="fl">2</span>, sigma.hat <span class="op">=</span> <span class="fl">1</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, </span>
<span>    sample.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span>, <span class="st">"one.sample"</span>, <span class="st">"two.sample"</span><span class="op">)</span>, </span>
<span>    round.up <span class="op">=</span> <span class="cn">FALSE</span>, n.max <span class="op">=</span> <span class="fl">5000</span>, tol <span class="op">=</span> <span class="fl">1e-07</span>, maxiter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    plot.it <span class="op">=</span> <span class="cn">TRUE</span>, add <span class="op">=</span> <span class="cn">FALSE</span>, n.points <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    plot.col <span class="op">=</span> <span class="st">"black"</span>, plot.lwd <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>, plot.lty <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    digits <span class="op">=</span> <span class="va">.Options</span><span class="op">$</span><span class="va">digits</span>, </span>
<span>    main <span class="op">=</span> <span class="cn">NULL</span>, xlab <span class="op">=</span> <span class="cn">NULL</span>, ylab <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="st">"l"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x-var">x.var<a class="anchor" aria-label="anchor" href="#arg-x-var"></a></dt>
<dd><p>character string indicating what variable to use for the x-axis.
  Possible values are <code>"n"</code> (sample size; the default),
  <code>"half.width"</code> (the half-width of the confidence interval),
  <code>"sigma.hat"</code> (the estimated standard deviation), and
  <code>"conf.level"</code> (the confidence level).</p></dd>

  <dt id="arg-y-var">y.var<a class="anchor" aria-label="anchor" href="#arg-y-var"></a></dt>
<dd><p>character string indicating what variable to use for the y-axis.
  Possible values are <code>"half.width"</code> (the half-width of the confidence interval; the default), and
  <code>"n"</code> (sample size).</p></dd>

  <dt id="arg-range-x-var">range.x.var<a class="anchor" aria-label="anchor" href="#arg-range-x-var"></a></dt>
<dd><p>numeric vector of length 2 indicating the range of the x-variable to use for the plot.
  The default value depends on the value of <code>x.var</code>.
  When <code>x.var="n"</code> the default value is <code>c(2,50)</code>.
  When <code>x.var="half.width"</code> the default value is <code>c(0.1/sigma.hat, 2/sigma.hat)</code>.
  When <code>x.var="sigma.hat"</code>, the default value is <code>c(0.1, 2)</code>.
  When <code>x.var="conf.level"</code>, the default value is <code>c(0.5, 0.99)</code>.</p></dd>

  <dt id="arg-n-or-n-">n.or.n1<a class="anchor" aria-label="anchor" href="#arg-n-or-n-"></a></dt>
<dd><p>numeric scalar indicating the sample size.  The default value is <code>n.or.n1=25</code>.
  When <code>sample.type="one.sample"</code>, this argument denotes the number of observations
  in the single sample.
  When <code>sample.type="two.sample"</code>, this argument denotes the number of observations
  from group 1.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored if either <code>x.var="n"</code> or <code>y.var="n"</code>.</p></dd>

  <dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>numeric scalar indicating the sample size for group 2.
  The default value is the value of <code>n.or.n1</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored when <br><code>sample.type="one.sample"</code>.</p></dd>

  <dt id="arg-half-width">half.width<a class="anchor" aria-label="anchor" href="#arg-half-width"></a></dt>
<dd><p>positive numeric scalar indicating the half-width of the confidence interval.
  The default value is <code>sigma.hat/2</code>.
  Missing (<code>NA</code>), undefined (<code>NaN</code>), and infinite (<code>Inf</code>, <code>-Inf</code>) values are not allowed.
  This argument is ignored if either <br><code>x.var="half.width"</code> or <code>y.var="half.width"</code>.</p></dd>

  <dt id="arg-sigma-hat">sigma.hat<a class="anchor" aria-label="anchor" href="#arg-sigma-hat"></a></dt>
<dd><p>positive numeric scalar specifying the estimated standard deviation.
  The default value is <code>sigma.hat=1</code>.
  This argument is ignored if <code>x.var="sigma.hat"</code>.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>a scalar between 0 and 1 indicating the confidence level associated with the confidence interval.
  The default value is <code>conf.level=0.95</code>.  This argument is ignored if <code>x.var="conf.level"</code>.</p></dd>

  <dt id="arg-sample-type">sample.type<a class="anchor" aria-label="anchor" href="#arg-sample-type"></a></dt>
<dd><p>character string indicating whether this is a one-sample or two-sample confidence interval. <br>
  When <code>sample.type="one.sample"</code>, the computations for the plot are based on a confidence
  interval for a single mean.  <br>
  When <code>sample.type="two.sample"</code>, the computations for the
  plot are based on a confidence interval for the difference between two means. <br>
  The default value is <code>sample.type="one.sample"</code> unless the argument <code>n2</code> is supplied.</p></dd>

  <dt id="arg-round-up">round.up<a class="anchor" aria-label="anchor" href="#arg-round-up"></a></dt>
<dd><p>logical scalar indicating whether to round up the computed sample sizes to the next smallest integer.
  The default value is <code>round.up=FALSE</code>.  This argument is ignored unless <code>y.var="n"</code>.</p></dd>

  <dt id="arg-n-max">n.max<a class="anchor" aria-label="anchor" href="#arg-n-max"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>, positive integer greater than 1
  specifying the maximum sample size for the single
  group when <code>sample.type="one.sample"</code> or for group 1 when
  <code>sample.type="two.sample"</code>.  The default value is <code>n.max=5000</code>.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>, numeric scalar indicating the tolerance to
  use in the <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> search algorithm.  The default value is
  <code>tol=1e-7</code>.</p></dd>

  <dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>for the case when <code>y.var="n"</code>, positive integer indicating the maximum
  number of iterations to use in the <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></code> search algorithm.
  The default value is <code>maxiter=1000</code>.</p></dd>

  <dt id="arg-plot-it">plot.it<a class="anchor" aria-label="anchor" href="#arg-plot-it"></a></dt>
<dd><p>a logical scalar indicating whether to create a plot or add to the existing plot
  (see explanation of the argument <code>add</code> below) on the current graphics device.
  If <code>plot.it=FALSE</code>, no plot is produced, but a list of (x,y) values is returned
  (see the section VALUE).  The default value is <code>plot.it=TRUE</code>.</p></dd>

  <dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>a logical scalar indicating whether to add the design plot to the existing plot (<code>add=TRUE</code>),
  or to create a plot from scratch (<code>add=FALSE</code>).  The default value is <code>add=FALSE</code>.
  This argument is ignored if <code>plot.it=FALSE</code>.</p></dd>

  <dt id="arg-n-points">n.points<a class="anchor" aria-label="anchor" href="#arg-n-points"></a></dt>
<dd><p>a numeric scalar specifying how many (x,y) pairs to use to produce the plot.
  There are <code>n.points</code> x-values evenly spaced between <code>range.x.var[1]</code> and <br><code>range.x.var[2]</code>.  The default value is <code>n.points=100</code>.</p></dd>

  <dt id="arg-plot-col">plot.col<a class="anchor" aria-label="anchor" href="#arg-plot-col"></a></dt>
<dd><p>a numeric scalar or character string determining the color of the plotted line or points.  The default value
  is <code>plot.col=1</code>.  See the entry for <code>col</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-plot-lwd">plot.lwd<a class="anchor" aria-label="anchor" href="#arg-plot-lwd"></a></dt>
<dd><p>a numeric scalar determining the width of the plotted line.  The default value is
  <code>3*par("cex")</code>.  See the entry for <code>lwd</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-plot-lty">plot.lty<a class="anchor" aria-label="anchor" href="#arg-plot-lty"></a></dt>
<dd><p>a numeric scalar determining the line type of the plotted line.  The default value is
  <code>plot.lty=1</code>.  See the entry for <code>lty</code> in the help file for <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>
  for more information.</p></dd>

  <dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>a scalar indicating how many significant digits to print out on the plot.  The default
  value is the current setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a>("digits")</code>.</p></dd>

  <dt id="arg-main-xlab-ylab-type-">main, xlab, ylab, type, ...<a class="anchor" aria-label="anchor" href="#arg-main-xlab-ylab-type-"></a></dt>
<dd><p>additional graphical parameters (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>See the help files for <code><a href="ciNormHalfWidth.html">ciNormHalfWidth</a></code> and <code><a href="ciNormN.html">ciNormN</a></code>
  for information on how to compute a one-sample confidence interval for the mean of
  a normal distribution or a two-sample confidence interval for the difference between
  two means, how the half-width is computed when other quantities are fixed, and how the
  sample size is computed when other quantities are fixed.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><code>plotCiNormDesign</code> invisibly returns a list with components:</p>
<p></p>
<dl><dt>x.var</dt>
<dd><p>x-coordinates of points that have been or would have been plotted.</p></dd>

  <dt>y.var</dt>
<dd><p>y-coordinates of points that have been or would have been plotted.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Berthouex, P.M., and L.C. Brown. (2002).
  <em>Statistics for Environmental Engineers</em>.  Second Edition.
  Lewis Publishers, Boca Raton, FL.</p>
<p>Gilbert, R.O. (1987). <em>Statistical Methods for Environmental Pollution Monitoring</em>.
  Van Nostrand Reinhold, New York, NY.</p>
<p>Helsel, D.R., and R.M. Hirsch. (1992).
  <em>Statistical Methods in Water Resources Research</em>.
  Elsevier, New York, NY, Chapter 7.</p>
<p>Millard, S.P., and N. Neerchal. (2001).  <em>Environmental Statistics with S-PLUS</em>.
  CRC Press, Boca Raton, FL.</p>
<p>Ott, W.R. (1995). <em>Environmental Statistics and Data Analysis</em>.
  Lewis Publishers, Boca Raton, FL.</p>
<p>USEPA. (2009).  <em>Statistical Analysis of Groundwater Monitoring Data at RCRA Facilities, Unified Guidance</em>.
  EPA 530/R-09-007, March 2009.  Office of Resource Conservation and Recovery Program Implementation and Information Division.
  U.S. Environmental Protection Agency, Washington, D.C. p.21-3.</p>
<p>Zar, J.H. (2010). <em>Biostatistical Analysis</em>.
  Fifth Edition. Prentice-Hall, Upper Saddle River, NJ,
  Chapters 7 and 8.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steven P. Millard (<a href="mailto:EnvStats@ProbStatInfo.com">EnvStats@ProbStatInfo.com</a>)</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The normal distribution and lognormal distribution are probably the two most frequently used
  distributions to model environmental data.  In order to make any kind of probability
  statement about a normally-distributed population (of chemical concentrations for example),
  you have to first estimate the mean and standard deviation (the population parameters) of the
  distribution.  Once you estimate these parameters, it is often useful to characterize the
  uncertainty in the estimate of the mean.  This is done with confidence intervals.</p>
<p>In the course of designing a sampling program, an environmental scientist may wish to determine
  the relationship between sample size, confidence level, and half-width if one of the objectives
  of the sampling program is to produce confidence intervals.  The functions
  <code><a href="ciNormHalfWidth.html">ciNormHalfWidth</a></code>, <code><a href="ciNormN.html">ciNormN</a></code>, and <code>plotCiNormDesign</code>
  can be used to investigate these relationships for the case of normally-distributed observations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ciNormHalfWidth.html">ciNormHalfWidth</a></code>, <code><a href="ciNormN.html">ciNormN</a></code>, <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">Normal</a></code>,
  <code><a href="enorm.html">enorm</a></code>, <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></code>, <br><a href="FcnsByCatEstDistParams.html">Estimating Distribution Parameters</a>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co"># Look at the relationship between half-width and sample size </span></span></span>
<span class="r-in"><span>  <span class="co"># for a one-sample confidence interval for the mean, assuming </span></span></span>
<span class="r-in"><span>  <span class="co"># an estimated standard deviation of 1 and a confidence level of 95%.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiNormDesign</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Plot sample size vs. the estimated standard deviation for </span></span></span>
<span class="r-in"><span>  <span class="co"># various levels of confidence, using a half-width of 0.5.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiNormDesign</span><span class="op">(</span>x.var <span class="op">=</span> <span class="st">"sigma.hat"</span>, y.var <span class="op">=</span> <span class="st">"n"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiNormDesign</span><span class="op">(</span>x.var <span class="op">=</span> <span class="st">"sigma.hat"</span>, y.var <span class="op">=</span> <span class="st">"n"</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span>, </span></span>
<span class="r-in"><span>    add <span class="op">=</span> <span class="cn">TRUE</span>, plot.col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiNormDesign</span><span class="op">(</span>x.var <span class="op">=</span> <span class="st">"sigma.hat"</span>, y.var <span class="op">=</span> <span class="st">"n"</span>, conf.level <span class="op">=</span> <span class="fl">0.8</span>, </span></span>
<span class="r-in"><span>    add <span class="op">=</span> <span class="cn">TRUE</span>, plot.col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">60</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"95%"</span>, <span class="st">"90%"</span>, <span class="st">"80%"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Sample Size vs. Estimated SD for Confidence Interval for Mean"</span>,</span></span>
<span class="r-in"><span>    font <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">1.25</span>, line <span class="op">=</span> <span class="fl">2.75</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"with Half-Width=0.5 and Various Confidence Levels"</span>, font <span class="op">=</span> <span class="fl">2</span>, </span></span>
<span class="r-in"><span>    cex <span class="op">=</span> <span class="fl">1.25</span>, line <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#--------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Modifying the example on pages 21-4 to 21-5 of USEPA (2009), </span></span></span>
<span class="r-in"><span>  <span class="co"># look at the relationship between half-width and sample size for a </span></span></span>
<span class="r-in"><span>  <span class="co"># 95% confidence interval for the mean level of Aldicarb at the </span></span></span>
<span class="r-in"><span>  <span class="co"># first compliance well.  Use the estimated standard deviation from </span></span></span>
<span class="r-in"><span>  <span class="co"># the first four months of data. </span></span></span>
<span class="r-in"><span>  <span class="co"># (The data are stored in EPA.09.Ex.21.1.aldicarb.df.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">EPA.09.Ex.21.1.aldicarb.df</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Month   Well Aldicarb.ppb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      1 Well.1         19.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      2 Well.1         29.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      3 Well.1         18.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      4 Well.1         24.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      1 Well.2         23.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      2 Well.2         21.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      3 Well.2         26.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      4 Well.2         26.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      1 Well.3          5.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     2 Well.3          3.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     3 Well.3          2.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     4 Well.3          6.9</span>
<span class="r-in"><span>  <span class="co">#   Month   Well Aldicarb.ppb</span></span></span>
<span class="r-in"><span>  <span class="co">#1      1 Well.1         19.9</span></span></span>
<span class="r-in"><span>  <span class="co">#2      2 Well.1         29.6</span></span></span>
<span class="r-in"><span>  <span class="co">#3      3 Well.1         18.7</span></span></span>
<span class="r-in"><span>  <span class="co">#4      4 Well.1         24.2</span></span></span>
<span class="r-in"><span>  <span class="co">#...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mu.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.21.1.aldicarb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Aldicarb.ppb</span><span class="op">[</span><span class="va">Well</span><span class="op">==</span><span class="st">"Well.1"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mu.hat</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 23.1</span>
<span class="r-in"><span>  <span class="co">#[1] 23.1 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">sigma.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">EPA.09.Ex.21.1.aldicarb.df</span>, </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">Aldicarb.ppb</span><span class="op">[</span><span class="va">Well</span><span class="op">==</span><span class="st">"Well.1"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">sigma.hat</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.93491</span>
<span class="r-in"><span>  <span class="co">#[1] 4.93491 </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">plotCiNormDesign</span><span class="op">(</span>sigma.hat <span class="op">=</span> <span class="va">sigma.hat</span>, digits <span class="op">=</span> <span class="fl">2</span>, </span></span>
<span class="r-in"><span>    range.x.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#==========</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Clean up</span></span></span>
<span class="r-in"><span>  <span class="co">#---------</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">mu.hat</span>, <span class="va">sigma.hat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steven P. Millard, Alexander Kowarik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

